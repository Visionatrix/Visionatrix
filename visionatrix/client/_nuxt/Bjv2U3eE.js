import{_ as Ge,o as c,c as U,a as y,y as _e,x as Re,n as K,f as Y,A as Je,B as Pe,C as Qe,a1 as _t,D as ye,K as S,W as Ke,S as $e,q as ce,a2 as $t,s as T,G as Oe,E as Ie,a3 as Ct,a4 as ot,a5 as It,a6 as He,a7 as St,a8 as at,a9 as Rt,aa as ut,ab as Mt,ac as Pt,p as n,ad as zt,ae as Ye,af as Ft,ag as Ut,ah as ze,g as de,J as Be,T as dt,ai as Me,i as I,l as C,w as M,b as v,F as te,r as me,d as N,m as oe,O as Q,aj as je,t as W,U as Ve,P as Ze,R as Ot,L as Se,h as be,I as jt,ak as ct,k as Te,al as et,am as Bt,an as Vt,ao as Tt,ap as mt,Q as Xe,aq as Nt,M as Ne,ar as ft,as as ae,at as pt,j as tt,au as qt,av as Et,aw as Dt,v as At}from"./CMe_58gS.js";import{b as qe,a as Wt,_ as Lt}from"./DkjBr2Pp.js";import{u as gt,_ as Ee}from"./CNC5nKJN.js";import{_ as De}from"./DKWqSJCh.js";import{_ as Ce,a as Ht}from"./Bn6z21Lh.js";import{_ as nt}from"./CsDi35MA.js";import{a as Ae,_ as vt}from"./Cac1FLKD.js";import{_ as ht,a as Xt}from"./CUJVnHuU.js";const Gt={wrapper:"relative",container:"relative w-full flex overflow-x-auto snap-x snap-mandatory scroll-smooth",item:"flex flex-none snap-center",arrows:{wrapper:"flex items-center justify-between"},indicators:{wrapper:"absolute flex items-center justify-center gap-3 bottom-4 inset-x-0",base:"rounded-full h-3 w-3",active:"bg-primary-500 dark:bg-primary-400",inactive:"bg-gray-100 dark:bg-gray-800"},default:{prevButton:{color:"black",class:"rtl:[&_span:first-child]:rotate-180 absolute start-4 top-1/2 transform -translate-y-1/2 rounded-full",icon:"i-heroicons-chevron-left-20-solid"},nextButton:{color:"black",class:"rtl:[&_span:last-child]:rotate-180 absolute end-4 top-1/2 transform -translate-y-1/2 rounded-full",icon:"i-heroicons-chevron-right-20-solid"}}},Jt={wrapper:"relative w-full flex items-center",base:"w-full absolute appearance-none cursor-pointer disabled:cursor-not-allowed disabled:bg-opacity-50 focus:outline-none peer group",rounded:"rounded-lg",background:"bg-transparent",ring:"focus-visible:ring-2 focus-visible:ring-{color}-500 dark:focus-visible:ring-{color}-400 focus-visible:ring-offset-2 focus-visible:ring-offset-white dark:focus-visible:ring-offset-gray-900",progress:{base:"absolute pointer-events-none peer-disabled:bg-opacity-50",rounded:"rounded-s-lg",background:"bg-{color}-500 dark:bg-{color}-400",size:{"2xs":"h-px",xs:"h-0.5",sm:"h-1",md:"h-2",lg:"h-3",xl:"h-4","2xl":"h-5"}},thumb:{base:"[&::-webkit-slider-thumb]:relative [&::-moz-range-thumb]:relative [&::-webkit-slider-thumb]:z-[1] [&::-moz-range-thumb]:z-[1] [&::-webkit-slider-thumb]:appearance-none [&::-moz-range-thumb]:appearance-none [&::-webkit-slider-thumb]:rounded-full [&::-moz-range-thumb]:rounded-full [&::-moz-range-thumb]:border-0",color:"text-{color}-500 dark:text-{color}-400",background:"[&::-webkit-slider-thumb]:bg-white [&::-webkit-slider-thumb]:dark:bg-gray-900 [&::-moz-range-thumb]:bg-current",ring:"[&::-webkit-slider-thumb]:ring-2 [&::-webkit-slider-thumb]:ring-current",size:{"2xs":"[&::-webkit-slider-thumb]:h-1.5 [&::-moz-range-thumb]:h-1.5 [&::-webkit-slider-thumb]:w-1.5 [&::-moz-range-thumb]:w-1.5 [&::-webkit-slider-thumb]:mt-[-2.5px] [&::-moz-range-thumb]:mt-[-2.5px]",xs:"[&::-webkit-slider-thumb]:h-2 [&::-moz-range-thumb]:h-2 [&::-webkit-slider-thumb]:w-2 [&::-moz-range-thumb]:w-2 [&::-webkit-slider-thumb]:mt-[-3px] [&::-moz-range-thumb]:mt-[-3px]",sm:"[&::-webkit-slider-thumb]:h-3 [&::-moz-range-thumb]:h-3 [&::-webkit-slider-thumb]:w-3 [&::-moz-range-thumb]:w-3 [&::-webkit-slider-thumb]:-mt-1 [&::-moz-range-thumb]:-mt-1",md:"[&::-webkit-slider-thumb]:h-4 [&::-moz-range-thumb]:h-4 [&::-webkit-slider-thumb]:w-4 [&::-moz-range-thumb]:w-4 [&::-webkit-slider-thumb]:-mt-1 [&::-moz-range-thumb]:-mt-1",lg:"[&::-webkit-slider-thumb]:h-5 [&::-moz-range-thumb]:h-5 [&::-webkit-slider-thumb]:w-5 [&::-moz-range-thumb]:w-5 [&::-webkit-slider-thumb]:-mt-1 [&::-moz-range-thumb]:-mt-1",xl:"[&::-webkit-slider-thumb]:h-6 [&::-moz-range-thumb]:h-6 [&::-webkit-slider-thumb]:w-6 [&::-moz-range-thumb]:w-6 [&::-webkit-slider-thumb]:-mt-1 [&::-moz-range-thumb]:-mt-1","2xl":"[&::-webkit-slider-thumb]:h-7 [&::-moz-range-thumb]:h-7 [&::-webkit-slider-thumb]:w-7 [&::-moz-range-thumb]:w-7 [&::-webkit-slider-thumb]:-mt-1 [&::-moz-range-thumb]:-mt-1"}},track:{base:"[&::-webkit-slider-runnable-track]:group-disabled:bg-opacity-50 [&::-moz-range-track]:group-disabled:bg-opacity-50",background:"[&::-webkit-slider-runnable-track]:bg-gray-200 [&::-moz-range-track]:bg-gray-200 [&::-webkit-slider-runnable-track]:dark:bg-gray-700 [&::-moz-range-track]:dark:bg-gray-700",rounded:"[&::-webkit-slider-runnable-track]:rounded-lg [&::-moz-range-track]:rounded-lg",size:{"2xs":"[&::-webkit-slider-runnable-track]:h-px [&::-moz-range-track]:h-px",xs:"[&::-webkit-slider-runnable-track]:h-0.5 [&::-moz-range-track]:h-0.5",sm:"[&::-webkit-slider-runnable-track]:h-1 [&::-moz-range-track]:h-1",md:"[&::-webkit-slider-runnable-track]:h-2 [&::-moz-range-track]:h-2",lg:"[&::-webkit-slider-runnable-track]:h-3 [&::-moz-range-track]:h-3",xl:"[&::-webkit-slider-runnable-track]:h-4 [&::-moz-range-track]:h-4","2xl":"[&::-webkit-slider-runnable-track]:h-5 [&::-moz-range-track]:h-5"}},size:{"2xs":"h-1.5",xs:"h-2",sm:"h-3",md:"h-4",lg:"h-5",xl:"h-6","2xl":"h-7"},default:{size:"md",color:"primary"}},we=Qe(ye.ui.strategy,ye.ui.textarea,_t),Qt=Y({inheritAttrs:!1,props:{modelValue:{type:[String,Number],default:""},id:{type:String,default:null},name:{type:String,default:null},placeholder:{type:String,default:null},required:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},rows:{type:Number,default:3},maxrows:{type:Number,default:0},autoresize:{type:Boolean,default:!1},autofocus:{type:Boolean,default:!1},autofocusDelay:{type:Number,default:100},resize:{type:Boolean,default:!1},padded:{type:Boolean,default:!0},size:{type:String,default:null,validator(e){return Object.keys(we.size).includes(e)}},color:{type:String,default:()=>we.default.color,validator(e){return[...ye.ui.colors,...Object.keys(we.color)].includes(e)}},variant:{type:String,default:()=>we.default.variant,validator(e){return[...Object.keys(we.variant),...Object.values(we.color).flatMap(l=>Object.keys(l))].includes(e)}},textareaClass:{type:String,default:null},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})},modelModifiers:{type:Object,default:()=>({})}},emits:["update:modelValue","blur","change"],setup(e,{emit:l}){const{ui:t,attrs:a}=Je("textarea",Pe(e,"ui"),we,Pe(e,"class")),{emitFormBlur:i,emitFormInput:o,inputId:s,color:f,size:p,name:b}=gt(e,we),h=S(Ke({},e.modelModifiers,{trim:!1,lazy:!1,number:!1,nullify:!1})),$=S(null),F=()=>{var d;e.autofocus&&((d=$.value)==null||d.focus())},P=()=>{if(e.autoresize){if(!$.value)return;$.value.rows=e.rows;const d=$.value.style.overflow;$.value.style.overflow="hidden";const r=window.getComputedStyle($.value),g=Number.parseInt(r.paddingTop),V=Number.parseInt(r.paddingBottom),u=g+V,w=Number.parseInt(r.lineHeight),{scrollHeight:_}=$.value,z=(_-u)/w;z>e.rows&&($.value.rows=e.maxrows?Math.min(z,e.maxrows):z),$.value.style.overflow=d}},x=d=>{h.value.trim&&(d=d.trim()),h.value.number&&(d=Ct(d)),h.value.nullify&&(d||(d=null)),l("update:modelValue",d),o()},R=d=>{P(),h.value.lazy||x(d.target.value)},O=d=>{const r=d.target.value;l("change",r),h.value.lazy&&x(r),h.value.trim&&(d.target.value=r.trim())},k=d=>{l("blur",d),i()};$e(()=>{setTimeout(()=>{F()},e.autofocusDelay)}),ce(()=>e.modelValue,()=>{$t(P)}),$e(()=>{setTimeout(()=>{F(),P()},100)});const m=T(()=>{var r,g;const d=((g=(r=t.value.color)==null?void 0:r[f.value])==null?void 0:g[e.variant])||t.value.variant[e.variant];return Oe(Ie(t.value.base,t.value.form,t.value.rounded,t.value.placeholder,t.value.size[p.value],e.padded?t.value.padding[p.value]:"p-0",d==null?void 0:d.replaceAll("{color}",f.value),!e.resize&&"resize-none"),e.textareaClass)});return{ui:t,attrs:a,name:b,inputId:s,textarea:$,textareaClass:m,onInput:R,onChange:O,onBlur:k}}}),Kt=["id","value","name","rows","required","disabled","placeholder"];function Yt(e,l,t,a,i,o){return c(),U("div",{class:K(e.ui.wrapper)},[y("textarea",_e({id:e.inputId,ref:"textarea",value:e.modelValue,name:e.name,rows:e.rows,required:e.required,disabled:e.disabled,placeholder:e.placeholder,class:e.textareaClass},e.attrs,{onInput:l[0]||(l[0]=(...s)=>e.onInput&&e.onInput(...s)),onBlur:l[1]||(l[1]=(...s)=>e.onBlur&&e.onBlur(...s)),onChange:l[2]||(l[2]=(...s)=>e.onChange&&e.onChange(...s))}),null,16,Kt),Re(e.$slots,"default")],2)}const Zt=Ge(Qt,[["render",Yt]]);async function en(e,l){return await tn(l).catch(a=>(console.error("Failed to get image meta for "+l,a+""),{width:0,height:0,ratio:0}))}async function tn(e){if(typeof Image>"u")throw new TypeError("Image not supported");return new Promise((l,t)=>{const a=new Image;a.onload=()=>{const i={width:a.width,height:a.height,ratio:a.width/a.height};l(i)},a.onerror=i=>t(i),a.src=e})}function st(e){return l=>l?e[l]||l:e.missingValue}function nn({formatter:e,keyMap:l,joinWith:t="/",valueMap:a}={}){e||(e=(o,s)=>`${o}=${s}`),l&&typeof l!="function"&&(l=st(l));const i=a||{};return Object.keys(i).forEach(o=>{typeof i[o]!="function"&&(i[o]=st(i[o]))}),(o={})=>Object.entries(o).filter(([f,p])=>typeof p<"u").map(([f,p])=>{const b=i[f];return typeof b=="function"&&(p=b(o[f])),f=typeof l=="function"?l(f):f,e(f,p)}).join(t)}function pe(e=""){if(typeof e=="number")return e;if(typeof e=="string"&&e.replace("px","").match(/^\d+$/g))return Number.parseInt(e,10)}function ln(e=""){if(e===void 0||!e.length)return[];const l=new Set;for(const t of e.split(" ")){const a=Number.parseInt(t.replace("x",""));a&&l.add(a)}return Array.from(l)}function on(e){if(e.length===0)throw new Error("`densities` must not be empty, configure to `1` to render regular size only (DPR 1.0)")}function an(e){const l={};if(typeof e=="string")for(const t of e.split(/[\s,]+/).filter(a=>a)){const a=t.split(":");a.length!==2?l["1px"]=a[0].trim():l[a[0].trim()]=a[1].trim()}else Object.assign(l,e);return l}function sn(e){const l={options:e},t=(i,o={})=>wt(l,i,o),a=(i,o={},s={})=>t(i,{...s,modifiers:Ke(o,s.modifiers||{})}).url;for(const i in e.presets)a[i]=(o,s,f)=>a(o,s,{...e.presets[i],...f});return a.options=e,a.getImage=t,a.getMeta=(i,o)=>rn(l,i,o),a.getSizes=(i,o)=>cn(l,i,o),l.$img=a,a}async function rn(e,l,t){const a=wt(e,l,{...t});return typeof a.getMeta=="function"?await a.getMeta():await en(e,a.url)}function wt(e,l,t){var b,h;if(l&&typeof l!="string")throw new TypeError(`input must be a string (received ${typeof l}: ${JSON.stringify(l)})`);if(!l||l.startsWith("data:"))return{url:l};const{provider:a,defaults:i}=un(e,t.provider||e.options.provider),o=dn(e,t.preset);if(l=ot(l)?l:It(l),!a.supportsAlias){for(const $ in e.options.alias)if(l.startsWith($)){const F=e.options.alias[$];F&&(l=He(F,l.slice($.length)))}}if(a.validateDomains&&ot(l)){const $=St(l).host;if(!e.options.domains.find(F=>F===$))return{url:l}}const s=Ke(t,o,i);s.modifiers={...s.modifiers};const f=s.modifiers.format;(b=s.modifiers)!=null&&b.width&&(s.modifiers.width=pe(s.modifiers.width)),(h=s.modifiers)!=null&&h.height&&(s.modifiers.height=pe(s.modifiers.height));const p=a.getImage(l,s,e);return p.format=p.format||f||"",p}function un(e,l){const t=e.options.providers[l];if(!t)throw new Error("Unknown provider: "+l);return t}function dn(e,l){if(!l)return{};if(!e.options.presets[l])throw new Error("Unknown preset: "+l);return e.options.presets[l]}function cn(e,l,t){var x,R,O,k,m;const a=pe((x=t.modifiers)==null?void 0:x.width),i=pe((R=t.modifiers)==null?void 0:R.height),o=an(t.sizes),s=(O=t.densities)!=null&&O.trim()?ln(t.densities.trim()):e.options.densities;on(s);const f=a&&i?i/a:0,p=[],b=[];if(Object.keys(o).length>=1){for(const d in o){const r=it(d,String(o[d]),i,f,e);if(r!==void 0){p.push({size:r.size,screenMaxWidth:r.screenMaxWidth,media:`(max-width: ${r.screenMaxWidth}px)`});for(const g of s)b.push({width:r._cWidth*g,src:rt(e,l,t,r,g)})}}mn(p)}else for(const d of s){const r=Object.keys(o)[0];let g=r?it(r,String(o[r]),i,f,e):void 0;g===void 0&&(g={size:"",screenMaxWidth:0,_cWidth:(k=t.modifiers)==null?void 0:k.width,_cHeight:(m=t.modifiers)==null?void 0:m.height}),b.push({width:d,src:rt(e,l,t,g,d)})}fn(b);const h=b[b.length-1],$=p.length?p.map(d=>`${d.media?d.media+" ":""}${d.size}`).join(", "):void 0,F=$?"w":"x",P=b.map(d=>`${d.src} ${d.width}${F}`).join(", ");return{sizes:$,srcset:P,src:h==null?void 0:h.src}}function it(e,l,t,a,i){const o=i.options.screens&&i.options.screens[e]||Number.parseInt(e),s=l.endsWith("vw");if(!s&&/^\d+$/.test(l)&&(l=l+"px"),!s&&!l.endsWith("px"))return;let f=Number.parseInt(l);if(!o||!f)return;s&&(f=Math.round(f/100*o));const p=a?Math.round(f*a):t;return{size:l,screenMaxWidth:o,_cWidth:f,_cHeight:p}}function rt(e,l,t,a,i){return e.$img(l,{...t.modifiers,width:a._cWidth?a._cWidth*i:void 0,height:a._cHeight?a._cHeight*i:void 0},t)}function mn(e){var t;e.sort((a,i)=>a.screenMaxWidth-i.screenMaxWidth);let l=null;for(let a=e.length-1;a>=0;a--){const i=e[a];i.media===l&&e.splice(a,1),l=i.media}for(let a=0;a<e.length;a++)e[a].media=((t=e[a+1])==null?void 0:t.media)||""}function fn(e){e.sort((t,a)=>t.width-a.width);let l=null;for(let t=e.length-1;t>=0;t--){const a=e[t];a.width===l&&e.splice(t,1),l=a.width}}const pn=nn({keyMap:{format:"f",fit:"fit",width:"w",height:"h",resize:"s",quality:"q",background:"b"},joinWith:"&",formatter:(e,l)=>at(e)+"_"+at(l)}),gn=(e,{modifiers:l={},baseURL:t}={},a)=>{l.width&&l.height&&(l.resize=`${l.width}x${l.height}`,delete l.width,delete l.height);const i=pn(l)||"_";return t||(t=He(a.options.nuxt.baseURL,"/_ipx")),{url:He(t,i,Rt(e))}},vn=!0,hn=!0,wn=Object.freeze(Object.defineProperty({__proto__:null,getImage:gn,supportsAlias:hn,validateDomains:vn},Symbol.toStringTag,{value:"Module"})),yt={screens:{xs:320,sm:640,md:768,lg:1024,xl:1280,xxl:1536,"2xl":1536},presets:{},provider:"ipxStatic",domains:[],alias:{},densities:[1,2],format:["webp"]};yt.providers={ipxStatic:{provider:wn,defaults:{}}};const lt=()=>{const e=Mt(),l=ut();return l.$img||l._img||(l._img=sn({...yt,nuxt:{baseURL:e.app.baseURL},runtimeConfig:e}))};function yn(e){var l;(l=performance==null?void 0:performance.mark)==null||l.call(performance,"mark_feature_usage",{detail:{feature:e}})}const bn={src:{type:String,required:!1},format:{type:String,required:!1},quality:{type:[Number,String],required:!1},background:{type:String,required:!1},fit:{type:String,required:!1},modifiers:{type:Object,required:!1},preset:{type:String,required:!1},provider:{type:String,required:!1},sizes:{type:[Object,String],required:!1},densities:{type:String,required:!1},preload:{type:[Boolean,Object],required:!1},width:{type:[String,Number],required:!1},height:{type:[String,Number],required:!1},alt:{type:String,required:!1},referrerpolicy:{type:String,required:!1},usemap:{type:String,required:!1},longdesc:{type:String,required:!1},ismap:{type:Boolean,required:!1},loading:{type:String,required:!1,validator:e=>["lazy","eager"].includes(e)},crossorigin:{type:[Boolean,String],required:!1,validator:e=>["anonymous","use-credentials","",!0,!1].includes(e)},decoding:{type:String,required:!1,validator:e=>["async","auto","sync"].includes(e)},nonce:{type:[String],required:!1}},kn=e=>{const l=T(()=>({provider:e.provider,preset:e.preset})),t=T(()=>({width:pe(e.width),height:pe(e.height),alt:e.alt,referrerpolicy:e.referrerpolicy,usemap:e.usemap,longdesc:e.longdesc,ismap:e.ismap,crossorigin:e.crossorigin===!0?"anonymous":e.crossorigin||void 0,loading:e.loading,decoding:e.decoding,nonce:e.nonce})),a=lt(),i=T(()=>({...e.modifiers,width:pe(e.width),height:pe(e.height),format:e.format,quality:e.quality||a.options.quality,background:e.background,fit:e.fit}));return{options:l,attrs:t,modifiers:i}},xn={...bn,placeholder:{type:[Boolean,String,Number,Array],required:!1},placeholderClass:{type:String,required:!1},custom:{type:Boolean,required:!1}},_n=["src"],ke=Y({__name:"NuxtImg",props:xn,emits:["load","error"],setup(e,{emit:l}){const t=e,a=Pt(),i=l,o=!1,s=lt(),f=kn(t),p=S(!1),b=S(),h=T(()=>s.getSizes(t.src,{...f.options.value,sizes:t.sizes,densities:t.densities,modifiers:{...f.modifiers.value,width:pe(t.width),height:pe(t.height)}})),$=T(()=>{const k={...f.attrs.value,"data-nuxt-img":""};return(!t.placeholder||p.value)&&(k.sizes=h.value.sizes,k.srcset=h.value.srcset),k}),F=T(()=>{let k=t.placeholder;if(k===""&&(k=!0),!k||p.value)return!1;if(typeof k=="string")return k;const m=Array.isArray(k)?k:typeof k=="number"?[k,k]:[10,10];return s(t.src,{...f.modifiers.value,width:m[0],height:m[1],quality:m[2]||50,blur:m[3]||3},f.options.value)}),P=T(()=>t.sizes?h.value.src:s(t.src,f.modifiers.value,f.options.value)),x=T(()=>F.value?F.value:P.value),O=ut().isHydrating;return $e(()=>{if(F.value||t.custom){const k=new Image;P.value&&(k.src=P.value),t.sizes&&(k.sizes=h.value.sizes||"",k.srcset=h.value.srcset),k.onload=m=>{p.value=!0,i("load",m)},k.onerror=m=>{i("error",m)},yn("nuxt-image");return}b.value&&(b.value.complete&&O&&(b.value.getAttribute("data-error")?i("error",new Event("error")):i("load",new Event("load"))),b.value.onload=k=>{i("load",k)},b.value.onerror=k=>{i("error",k)})}),(k,m)=>k.custom?Re(k.$slots,"default",zt(_e({key:1},{...n(o)?{onerror:"this.setAttribute('data-error', 1)"}:{},imgAttrs:{...$.value,...n(a)},isLoaded:p.value,src:x.value}))):(c(),U("img",_e({key:0,ref_key:"imgEl",ref:b,class:t.placeholder&&!p.value?t.placeholderClass:void 0},{...n(o)?{onerror:"this.setAttribute('data-error', 1)"}:{},...$.value,...n(a)},{src:x.value}),null,16,_n))}}),Ue=Qe(ye.ui.strategy,ye.ui.range,Jt),$n=Y({inheritAttrs:!1,props:{modelValue:{type:Number,default:0},id:{type:String,default:null},name:{type:String,default:null},disabled:{type:Boolean,default:!1},min:{type:Number,default:0},max:{type:Number,default:100},step:{type:Number,default:1},size:{type:String,default:null,validator(e){return Object.keys(Ue.size).includes(e)}},color:{type:String,default:()=>Ue.default.color,validator(e){return ye.ui.colors.includes(e)}},inputClass:{type:String,default:null},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})}},emits:["update:modelValue","change"],setup(e,{emit:l}){const{ui:t,attrs:a}=Je("range",Pe(e,"ui"),Ue),{emitFormChange:i,inputId:o,color:s,size:f,name:p}=gt(e,Ue),b=T({get(){return e.modelValue},set(k){l("update:modelValue",k)}}),h=k=>{l("change",k.target.value),i()},$=T(()=>Oe(Ie(t.value.wrapper,t.value.size[f.value]),e.class)),F=T(()=>Oe(Ie(t.value.base,t.value.background,t.value.rounded,s.value&&t.value.ring.replaceAll("{color}",s.value),t.value.size[f.value]),e.inputClass)),P=T(()=>Ie(t.value.thumb.base,s.value&&t.value.thumb.color.replaceAll("{color}",s.value),t.value.thumb.ring,t.value.thumb.background,t.value.thumb.size[f.value])),x=T(()=>Ie(t.value.track.base,t.value.track.background,t.value.track.rounded,t.value.track.size[f.value])),R=T(()=>Ie(t.value.progress.base,t.value.progress.rounded,s.value&&t.value.progress.background.replaceAll("{color}",s.value),t.value.progress.size[f.value])),O=T(()=>{const{modelValue:k,min:m,max:d}=e;return{width:`${(Math.max(m,Math.min(k,d))-m)/(d-m)*100}%`}});return{ui:t,attrs:a,name:p,inputId:o,value:b,wrapperClass:$,inputClass:F,thumbClass:P,trackClass:x,progressClass:R,progressStyle:O,onChange:h}}}),Cn=["id","name","min","max","disabled","step"];function In(e,l,t,a,i,o){return c(),U("div",{class:K(e.wrapperClass)},[Ye(y("input",_e({id:e.inputId,ref:"input","onUpdate:modelValue":l[0]||(l[0]=s=>e.value=s),name:e.name,min:e.min,max:e.max,disabled:e.disabled,step:e.step,type:"range",class:[e.inputClass,e.thumbClass,e.trackClass]},e.attrs,{onChange:l[1]||(l[1]=(...s)=>e.onChange&&e.onChange(...s))}),null,16,Cn),[[Ft,e.value,void 0,{number:!0}]]),y("span",{class:K(e.progressClass),style:Ut(e.progressStyle)},null,6)],2)}const bt=Ge($n,[["render",In]]),Sn={class:"image-mask flex flex-col w-full"},Rn={class:"canvas flex flex-col items-center justify-center mb-3 w-full"},Mn={class:"preview-over-original relative"},Pn={class:"actions flex items-center justify-center mb-3 mx-auto"},zn={class:"options w-full max-w-[320px]"},Fn=Y({__name:"ImageInpaint",props:je({imageSrc:{type:String,required:!0}},{imageInpaintMask:{default:"",type:String},imageInpaintMaskModifiers:{},imageInpaintMaskData:{default:{},type:Object},imageInpaintMaskDataModifiers:{}}),emits:["update:imageInpaintMask","update:imageInpaintMaskData"],setup(e){const l=e,t=ze(e,"imageInpaintMask"),a=ze(e,"imageInpaintMaskData"),i=de(),o=S(null),s=S(null),f=S(null),p=S(null),b=S(30),h=S([]),$=S({width:i.$state.outputMaxSize,height:i.$state.outputMaxSize}),F=S(null),P=S({x:0,y:0}),x=S({x:0,y:0,radius:b.value,fill:"rgba(255, 255, 255, 0.5)",stroke:null,strokeWidth:0,visible:!1}),R=S(5),O=S(!1),k=S([]),m=S([]);function d(){if(!o.value||!f.value){console.error("Could not get stage, image layer, or mask layer");return}const B=o.value.getNode(),q=p.value?p.value.width:B.width(),H=p.value?p.value.height:B.height(),j=document.createElement("canvas");j.width=q,j.height=H;const X=j.getContext("2d");if(!X){console.error("Could not get 2d context for mask canvas");return}X.fillStyle="black",X.fillRect(0,0,q,H);const re=q/B.width(),ue=H/B.height();X.fillStyle="white",h.value.forEach(he=>{X.beginPath(),X.arc(he.x*re,he.y*ue,he.radius*Math.max(re,ue),0,Math.PI*2,!0),X.closePath(),X.fill()});const fe=j.toDataURL("image/png",1);fe?(z(),t.value=fe,x.value.visible=!1,O.value=!1):console.error("Could not get data URI for masked image")}function r(B){const q=o.value.getNode();if(B.type.startsWith("touch")){const H=B.evt.touches[0]||B.evt.changedTouches[0];return{x:H.clientX-q.getContainer().offsetLeft,y:H.clientY-q.getContainer().offsetTop}}return q.getPointerPosition()}function g(B){B.type==="mousedown"&&B.evt.button!==0||(O.value=!0,P.value=r(B),_(),V(P.value))}function V(B){const q={x:B.x,y:B.y,radius:b.value,fill:"rgba(255, 255, 255, 1)"};h.value=h.value.filter(H=>!(u({x:H.x,y:H.y},B)+H.radius<=q.radius)),h.value.push(q)}function u(B,q){return Math.sqrt(Math.pow(q.x-B.x,2)+Math.pow(q.y-B.y,2))}function w(B){if(B.type.startsWith("touch")&&B.evt.preventDefault(),ee(B),!O.value)return;const q=r(B);u(P.value,r(B))>=R.value&&(V(q),P.value=q)}function _(){k.value.push([...h.value]),m.value=[]}function z(){a.value={circles:[...h.value],brushRadius:b.value,undoStack:k.value,redoStack:m.value}}function E(){a.value!==null&&(h.value=a.value.circles||[],b.value=a.value.brushRadius||30,k.value=a.value.undoStack||[],m.value=a.value.redoStack||[])}function Z(){k.value.length!==0&&(m.value.push([...h.value]),h.value=k.value.pop()||[])}function ne(){m.value.length!==0&&(k.value.push([...h.value]),h.value=m.value.pop()||[])}function le(){O.value=!1}function ge(){t.value=""}function D(){_(),h.value=[],t.value=""}const A=T(()=>k.value.length>0),G=T(()=>m.value.length>0);function ee(B){const q=r(B);x.value.x=q.x,x.value.y=q.y}function ie(){x.value.visible=!1,O.value=!1}function ve(){x.value.visible=!0,x.value.radius=b.value}function L(){const B=new Image;B.src=l.imageSrc,B.onload=()=>{p.value=B,se(),xe()}}function se(){if(!p.value)return;const B=window.innerWidth,q=window.innerHeight,H=p.value.width/p.value.height;let j,X;const re=Math.min(B*.9,1200),ue=Math.min(q*.8,i.outputMaxSize);H>re/ue?(j=re,X=j/H):(X=ue,j=X*H),$.value={width:Math.floor(j),height:Math.floor(X)},xe()}function xe(){const B=$.value.width,q=$.value.height,H=p.value.width,j=p.value.height,X=B/H,re=q/j,ue=Math.min(X,re);F.value={x:0,y:0,width:H*ue,height:j*ue}}return Be(()=>{L(),E()}),$e(()=>{if(o.value){const B=o.value.getNode();B.on("touchstart",g),B.on("touchmove",w),B.on("touchend",le),B.on("touchcancel",ie)}}),dt(()=>{if(o.value){const B=o.value.getNode();B.off("touchstart"),B.off("touchmove"),B.off("touchend"),B.off("touchcancel")}z()}),(B,q)=>{const H=ke,j=Me("v-image"),X=Me("v-layer"),re=Me("v-circle"),ue=Me("v-stage"),fe=oe,he=bt,J=De;return c(),U("div",Sn,[y("div",Rn,[q[1]||(q[1]=y("p",{class:"text-sm my-2 text-slate-500"},"Select the target area for image inpaint",-1)),y("div",Mn,[e.imageSrc&&e.imageSrc!==""&&t.value!==""?(c(),I(H,{key:0,src:e.imageSrc,fit:"inside",width:n($).width,height:n($).height,draggable:"false",class:K({absolute:t.value!==""})},null,8,["src","width","height","class"])):C("",!0),t.value?(c(),I(H,{key:1,src:t.value,fit:"inside",width:n($).width,height:n($).height,draggable:"false",class:"opacity-50"},null,8,["src","width","height"])):C("",!0)]),t.value===""?(c(),I(ue,{key:0,ref_key:"stageRef",ref:o,config:n($),onMousedown:g,onMousemove:w,onMouseup:le,onMouseleave:ie,onMouseenter:ve},{default:M(()=>[v(X,{ref_key:"imageLayerRef",ref:s},{default:M(()=>[v(j,{image:n(p),config:n($)},null,8,["image","config"])]),_:1},512),v(X,{ref_key:"maskLayerRef",ref:f},{default:M(()=>[(c(!0),U(te,null,me(n(h),(We,xt)=>(c(),I(re,{key:xt,config:We},null,8,["config"]))),128)),n(x).visible?(c(),I(re,{key:0,config:n(x)},null,8,["config"])):C("",!0)]),_:1},512)]),_:1},8,["config"])):C("",!0)]),y("div",Pn,[v(fe,{class:"mr-2",size:"xs",icon:"i-heroicons-clipboard-document-check-16-solid",variant:"soft",disabled:n(h).length===0||t.value!=="",onClick:d},{default:M(()=>q[2]||(q[2]=[N(" Apply ")])),_:1},8,["disabled"]),v(fe,{class:"mr-2",size:"xs",icon:"i-heroicons-arrow-uturn-left-16-solid",variant:"soft",color:"cyan",disabled:!n(A)||t.value!=="",onClick:Z},null,8,["disabled"]),v(fe,{class:"mr-2",size:"xs",icon:"i-heroicons-arrow-uturn-right-16-solid",variant:"soft",color:"cyan",disabled:!n(G)||t.value!=="",onClick:ne},null,8,["disabled"]),v(fe,{class:"mr-2",size:"xs",icon:"i-heroicons-arrow-turn-up-left-20-solid",variant:"soft",disabled:n(h).length===0&&t.value==="",color:"red",onClick:D},{default:M(()=>q[3]||(q[3]=[N(" Reset ")])),_:1},8,["disabled"]),v(fe,{size:"xs",icon:"i-heroicons-pencil-solid",variant:"soft",disabled:t.value==="",color:"orange",onClick:ge},{default:M(()=>q[4]||(q[4]=[N(" Edit ")])),_:1},8,["disabled"])]),y("div",zn,[v(J,{class:"mb-3 text-sm",hint:`value: ${n(b)}`,label:"Brush radius"},{default:M(()=>[v(he,{modelValue:n(b),"onUpdate:modelValue":q[0]||(q[0]=We=>Q(b)?b.value=We:null),min:1,max:100,size:"sm",class:"my-2",disabled:t.value!==""},null,8,["modelValue","disabled"])]),_:1},8,["hint"])])])}}}),Un="0.05";function On(e,l){const t=parseFloat(e);if(isNaN(t))return e;const a=t+l;return a<0?"0":String(Number(a.toFixed(10)))}function jn(e,l){let t=l,a=l,i=0,o=0;for(;t>=0&&(t--,!(e[t]==="("&&i===o));)e[t]==="("&&i++,e[t]===")"&&o++;if(t<0)return!1;for(i=0,o=0;a<e.length&&!(e[a]===")"&&i===o);)e[a]==="("&&i++,e[a]===")"&&o++,a++;return a===e.length?!1:{start:t+1,end:a}}function Bn(e){const l=/^\((.*)\)$/,t=e.match(l),a=/:([+-]?(\d*\.)?\d+([eE][+-]?\d+)?)/,i=e.match(a);return t&&!i?`(${t[1]}:1.0)`:e}function Vn(e){const l=e.composedPath()[0],t=parseFloat(Un);if(l.tagName!=="TEXTAREA"||!(e.key==="ArrowUp"||e.key==="ArrowDown")||!e.ctrlKey&&!e.metaKey)return;e.preventDefault();let a=l.selectionStart,i=l.selectionEnd,o=l.value.substring(a,i);if(!o){const p=jn(l.value,a);if(p)a=p.start,i=p.end,o=l.value.substring(a,i);else{const b=" .,\\/!?%^*;:{}=-_`~()\r\n	";for(;!b.includes(l.value[a-1])&&a>0;)a--;for(;!b.includes(l.value[i])&&i<l.value.length;)i++;if(o=l.value.substring(a,i),!o)return}}o[o.length-1]===" "&&(o=o.substring(0,o.length-1),i-=1),l.value[a-1]==="("&&l.value[i]===")"&&(a-=1,i+=1,o=l.value.substring(a,i)),(o[0]!=="("||o[o.length-1]!==")")&&(o=`(${o})`),o=Bn(o);const s=e.key==="ArrowUp"?t:-t,f=o.replace(/\((.*):(\d+(?:\.\d+)?)\)/,(p,b,h)=>(h=On(h,s),Number(h)==1?b:`(${b}:${h})`));return l.setRangeText(f,a,i,"select"),l.value}const Tn={key:0,class:"text-red-300"},Nn={key:0,class:"flex items-center"},qn={key:2,class:"flex flex-row flex-grow items-center justify-between"},En={key:3,class:"flex flex-row flex-grow items-center"},Dn={class:"sm:inline"},An={class:"preview-over-original relative"},Wn={key:1,class:"text-red-300 text-sm"},Ln=Y({__name:"InputParam",props:{inputParam:{type:Object,required:!0},index:{type:Number,required:!0},inputParamsMap:{type:Array,required:!0},advanced:{type:Boolean,default:!1}},setup(e){const l=e,t=S(!1),a=S(null),i=S(""),o=S({width:0,height:0}),s=S(""),f=S({}),p=S(null),b=l.inputParamsMap[l.index][l.inputParam.name].source_input_name,h=l.inputParamsMap.findIndex(r=>{if(Object.keys(r)[0]===l.inputParamsMap[l.index][l.inputParam.name].source_input_name)return!0});function $(){try{const r=l.inputParamsMap.find(g=>{const V=Object.keys(g)[0];if(V===b)return g[V]});O(r[b].value)}catch{o.value.width=0,o.value.height=0}}$e(()=>{l.inputParam.type==="range_scale"&&$(),l.inputParam.type==="image-mask"&&ce(s,r=>{const g=new File([s.value],`image-mask-${l.inputParam.name}.png`,{type:"image/png"});l.inputParamsMap[l.index][l.inputParam.name].value=g,l.inputParamsMap[l.index][l.inputParam.name].mask_applied=r!==""})}),l.inputParam.type==="range_scale"&&ce(l.inputParamsMap,()=>{$()});function F(r){return r?URL.createObjectURL(r):""}function P(){URL.revokeObjectURL(i.value),i.value="",a.value&&(a.value.$refs.input.value=""),l.inputParamsMap[l.index][l.inputParam.name].value=null,l.inputParamsMap[l.index][l.inputParam.name].image_preview_url=""}function x(){URL.revokeObjectURL(s.value),s.value="",f.value={},l.inputParamsMap[l.index][l.inputParam.name].value=null,l.inputParamsMap[l.index][l.inputParam.name].mask_applied=!1}const R=T(()=>l.inputParam.type!=="bool"?l.inputParam.display_name:"");function O(r){if(!(r instanceof File)){o.value.width=0,o.value.height=0;return}const g=URL.createObjectURL(r),V=new Image;V.onload=function(){o.value.width=V.naturalWidth,o.value.height=V.naturalHeight,URL.revokeObjectURL(V.src)},V.src=g}const k=T(()=>{if(l.inputParam.type==="range_scale"){const r=l.inputParamsMap[l.index][l.inputParam.name].value;return`value: ${r}x (${o.value.width}x${o.value.height} -> ${(o.value.width*r).toFixed(0)}x${(o.value.height*r).toFixed(0)})`}return["range","range_scale"].includes(l.inputParam.type)?`value: ${l.inputParamsMap[l.index][l.inputParam.name].value}`:""}),m=S(null);function d(r){const g=Vn(r);g&&(l.inputParamsMap[l.index][l.inputParam.name].value=g)}return $e(()=>{l.inputParam.type==="text"&&m.value&&m.value.$refs.textarea.addEventListener("keydown",d),l.inputParam.type==="image-mask"&&(p.value=l.inputParamsMap[h][b],ce(l.inputParamsMap[h][b],r=>{s.value="",f.value={},p.value=r}))}),dt(()=>{URL.revokeObjectURL(i.value),URL.revokeObjectURL(s.value),l.inputParam.type==="text"&&m.value&&m.value.$refs.textarea.removeEventListener("keydown",d)}),(r,g)=>{var D;const V=Zt,u=Ee,w=oe,_=ke,z=Fn,E=Ce,Z=nt,ne=Ae,le=bt,ge=De;return(((D=e.inputParam)==null?void 0:D.advanced)||!1)===e.advanced?(c(),I(ge,{key:0,label:n(R),class:"mb-3",help:n(k)},{hint:M(()=>[e.inputParam.optional?C("",!0):(c(),U("span",Tn,"required"))]),default:M(()=>{var A,G,ee,ie,ve;return[e.inputParam.type==="text"?(c(),I(V,{key:0,ref_key:"textareaInput",ref:m,size:"md",placeholder:e.inputParam.display_name,required:!e.inputParam.optional,resize:!0,label:e.inputParam.display_name,value:e.inputParamsMap[e.index][e.inputParam.name].value,autoresize:"",variant:"outline",onInput:g[0]||(g[0]=L=>{const se=L.target;e.inputParamsMap[e.index][e.inputParam.name].value=se.value})},null,8,["placeholder","required","label","value"])):C("",!0),e.inputParam.type==="number"?(c(),U(te,{key:1},[e.inputParam.name==="seed"?(c(),U("div",Nn,[e.inputParam.type==="number"?(c(),I(u,{key:0,modelValue:e.inputParamsMap[e.index][e.inputParam.name].value,"onUpdate:modelValue":g[1]||(g[1]=L=>e.inputParamsMap[e.index][e.inputParam.name].value=L),type:"number",label:e.inputParam.display_name,required:!e.inputParam.optional,max:e.inputParam.max||100,min:e.inputParam.min||0,variant:"outline"},null,8,["modelValue","label","required","max","min"])):C("",!0),v(w,{icon:"i-heroicons-arrow-path",color:"violet",variant:"outline",size:"xs",class:"ml-2",onClick:g[2]||(g[2]=()=>{e.inputParamsMap[e.index][e.inputParam.name].value=Math.floor(Math.random()*1e7)})})])):(c(),I(u,{key:1,modelValue:e.inputParamsMap[e.index][e.inputParam.name].value,"onUpdate:modelValue":g[3]||(g[3]=L=>e.inputParamsMap[e.index][e.inputParam.name].value=L),type:"number",label:e.inputParam.display_name,required:!e.inputParam.optional,max:e.inputParam.max||100,min:e.inputParam.min||0,variant:"outline"},null,8,["modelValue","label","required","max","min"]))],64)):C("",!0),e.inputParam.type==="image"?(c(),U("div",qn,[v(u,{ref_key:"imageInput",ref:a,type:"file",accept:"image/*",class:"w-full",variant:"outline",color:"gray",label:e.inputParam.display_name,onChange:g[4]||(g[4]=L=>{console.debug("files",L);const se=L==null?void 0:L[0];e.inputParamsMap[e.index][e.inputParam.name].value=se,i.value=F(se),e.inputParamsMap[e.index][e.inputParam.name].image_preview_url=n(i),console.debug("inputParamsMap",e.inputParamsMap)})},null,8,["label"]),n(i)!==""?(c(),I(_,{key:0,src:n(s)?n(s):n(i),class:"h-10 rounded-lg cursor-pointer ml-2",onClick:g[5]||(g[5]=()=>{t.value=!0})},null,8,["src"])):C("",!0),n(i)!==""?(c(),I(w,{key:1,icon:"i-heroicons-x-mark",variant:"outline",class:"ml-2",onClick:P})):C("",!0)])):C("",!0),e.inputParam.type==="image-mask"?(c(),U("div",En,[n(p)?(c(),I(w,{key:0,icon:"i-heroicons-paint-brush-16-solid",class:"mr-2",color:"violet",variant:"outline",size:"xs",disabled:!((A=n(p))!=null&&A.value),onClick:g[6]||(g[6]=()=>{t.value=!0})},{default:M(()=>[y("span",Dn,W(n(s)!==""?"Edit mask":"Draw mask"),1)]),_:1},8,["disabled"])):C("",!0),y("div",An,[n(p)&&((G=n(p))!=null&&G.value)?(c(),I(_,{key:0,src:(ee=n(p))==null?void 0:ee.image_preview_url,class:K(["h-10 rounded-lg cursor-pointer",{absolute:n(s)!==""}]),onClick:g[7]||(g[7]=()=>{t.value=!0})},null,8,["src","class"])):C("",!0),n(s)?(c(),I(_,{key:1,src:n(s),class:"h-10 rounded-lg cursor-pointer opacity-50",onClick:g[8]||(g[8]=()=>{t.value=!0})},null,8,["src"])):C("",!0)]),!n(p)||n(p)&&!((ie=n(p))!=null&&ie.value)?(c(),U("span",Wn," Select source image ")):C("",!0),n(s)?(c(),I(w,{key:2,icon:"i-heroicons-x-mark",variant:"outline",color:"violet",class:"ml-2",onClick:x})):C("",!0)])):C("",!0),e.inputParam.type==="image"||e.inputParam.type==="image-mask"?(c(),I(E,{key:4,modelValue:n(t),"onUpdate:modelValue":g[13]||(g[13]=L=>Q(t)?t.value=L:null),class:"z-[90] overflow-y-auto",transition:!1,fullscreen:""},{default:M(()=>{var L;return[v(w,{class:"absolute top-4 right-4 z-[100]",icon:"i-heroicons-x-mark",variant:"ghost",onClick:g[9]||(g[9]=()=>t.value=!1)}),e.inputParam.type==="image"?(c(),U("div",{key:0,class:"flex items-center justify-center w-full h-full p-4",onClick:g[10]||(g[10]=Ve(()=>t.value=!1,["left"]))},[v(_,{class:"lg:h-full",fit:"inside",src:n(i)},null,8,["src"])])):(c(),I(z,{key:1,ref:"imageInpaint","image-inpaint-mask":n(s),"onUpdate:imageInpaintMask":g[11]||(g[11]=se=>Q(s)?s.value=se:null),"image-inpaint-mask-data":n(f),"onUpdate:imageInpaintMaskData":g[12]||(g[12]=se=>Q(f)?f.value=se:null),class:"flex items-center justify-center w-full h-full p-4","image-src":(L=n(p))==null?void 0:L.image_preview_url},null,8,["image-inpaint-mask","image-inpaint-mask-data","image-src"]))]}),_:1},8,["modelValue"])):C("",!0),e.inputParam.type==="list"?(c(),I(Z,{key:5,modelValue:e.inputParamsMap[e.index][e.inputParam.name].value,"onUpdate:modelValue":g[14]||(g[14]=L=>e.inputParamsMap[e.index][e.inputParam.name].value=L),placeholder:e.inputParam.display_name,options:Object.keys(e.inputParam.options)},null,8,["modelValue","placeholder","options"])):C("",!0),e.inputParam.type==="bool"?(c(),I(ne,{key:6,modelValue:e.inputParamsMap[e.index][e.inputParam.name].value,"onUpdate:modelValue":g[15]||(g[15]=L=>e.inputParamsMap[e.index][e.inputParam.name].value=L),label:(ve=e.inputParam)==null?void 0:ve.display_name},null,8,["modelValue","label"])):C("",!0),["range","range_scale"].includes(e.inputParam.type)?(c(),I(le,{key:7,modelValue:e.inputParamsMap[e.index][e.inputParam.name].value,"onUpdate:modelValue":g[16]||(g[16]=L=>e.inputParamsMap[e.index][e.inputParam.name].value=L),label:e.inputParam.display_name,size:"sm",min:e.inputParam.min,max:e.inputParam.max,step:e.inputParam.step},null,8,["modelValue","label","min","max","step"])):C("",!0)]}),_:1},8,["label","help"])):C("",!0)}}}),Hn={key:0,class:"heading"},Xn={key:1},Gn={key:0,class:"max-h-96 overflow-y-auto mt-5"},Jn={class:"heading"},Qn={key:0,class:"p-4"},Kn={key:0,class:"flex items-center w-full max-w-xs"},Yn=Y({__name:"InputParams",props:je({inputParamsMap:{type:Array,required:!0},additionalInputParamsMap:{type:Array,required:!1,default:[]},advanced:{type:Boolean,default:!1}},{profilingOptions:{default:{},type:Object},profilingOptionsModifiers:{},profilingEnabled:{default:!1,type:Boolean},profilingEnabledModifiers:{}}),emits:["update:profilingOptions","update:profilingEnabled"],setup(e){const l=e,t=de(),a=Ze(),i=Ot(),o=S(!l.advanced),s=ze(e,"profilingOptions"),f=ze(e,"profilingEnabled"),p=S(!0),b=T(()=>i.workers.map(h=>({value:h.worker_id,label:`${h.worker_id} (type: ${h.device_type}, vram_total: ${Se(h.vram_total)})`})));return Be(()=>{var $;if(!a.isAdmin)return;const h=localStorage.getItem(`profilingOptions_${($=t.currentFlow)==null?void 0:$.name}`);h&&(s.value=JSON.parse(h)),i.fetchWorkersInfo().then(()=>{i.workers.find(P=>{var x;return P.worker_id===((x=s.value["X-WORKER-ID"])==null?void 0:x.value)})||(s.value["X-WORKER-ID"]=null)})}),(h,$)=>{const F=be,P=Ln,x=Ae,R=nt,O=oe,k=Ee,m=De;return c(),U(te,null,[e.advanced?(c(),U("div",Hn,[y("h4",{class:"text-md font-bold cursor-pointer select-none flex items-center mb-3",onClick:$[0]||($[0]=()=>{o.value=!n(o)})},[v(F,{name:n(o)?"i-heroicons-chevron-up":"i-heroicons-chevron-down",class:"mr-2"},null,8,["name"]),$[3]||($[3]=N(" Advanced options "))])])):C("",!0),n(o)?(c(),U("div",Xn,[(c(!0),U(te,null,me(n(t).currentFlow.input_params,(d,r)=>(c(),I(P,{key:r,"input-params-map":e.inputParamsMap,index:r,"input-param":d,advanced:e.advanced},null,8,["input-params-map","index","input-param","advanced"]))),128)),(c(!0),U(te,null,me(e.additionalInputParamsMap,(d,r)=>(c(),I(P,{key:Object.keys(d)[0],"input-params-map":e.additionalInputParamsMap,index:r,"input-param":d[Object.keys(d)[0]],advanced:e.advanced},null,8,["input-params-map","index","input-param","advanced"]))),128)),n(a).isAdmin&&e.advanced?(c(),U("div",Gn,[y("div",Jn,[y("h4",{class:"text-md font-bold cursor-pointer select-none flex items-center mb-3",onClick:$[1]||($[1]=()=>{p.value=!n(p)})},[v(F,{name:n(p)?"i-heroicons-chevron-down":"i-heroicons-chevron-up",class:"mr-2"},null,8,["name"]),v(F,{name:"i-mdi-bug-outline",class:"mr-2"}),$[4]||($[4]=N(" Execution settings "))])]),n(p)?C("",!0):(c(),U("div",Qn,[v(x,{modelValue:f.value,"onUpdate:modelValue":$[2]||($[2]=d=>f.value=d),label:"Enable Execution settings",class:"mb-3"},null,8,["modelValue"]),(c(!0),U(te,null,me(Object.keys(s.value),d=>(c(),I(m,{key:d,label:d},{default:M(()=>[d==="X-WORKER-ID"?(c(),U("div",Kn,[v(R,{modelValue:s.value[d],"onUpdate:modelValue":r=>s.value[d]=r,options:n(b),placeholder:"Select worker",class:"w-full my-3"},null,8,["modelValue","onUpdate:modelValue","options"]),v(O,{icon:"i-heroicons-x-mark",variant:"outline",size:"sm",color:"orange",class:"ml-2",onClick:()=>s.value[d]=null},null,8,["onClick"]),v(O,{icon:"i-heroicons-arrow-path-solid",variant:"outline",size:"sm",color:"blue",class:"ml-2",onClick:()=>{n(i).fetchWorkersInfo().then(()=>{s.value[d]=n(b).find(r=>{var g;return r.value===((g=s.value[d])==null?void 0:g.value)})})}},null,8,["onClick"])])):(c(),I(k,{key:1,modelValue:s.value[d],"onUpdate:modelValue":r=>s.value[d]=r,placeholder:"Enter value",class:"my-3"},null,8,["modelValue","onUpdate:modelValue"]))]),_:2},1032,["label"]))),128))]))])):C("",!0)])):C("",!0)],64)}}}),Zn={key:0,id:"prompt",class:"w-full my-10 lg:my-0 p-4 ring-1 ring-gray-200 dark:ring-gray-800 rounded-lg"},el={class:"action flex items-center"},tl=Y({__name:"Prompt",setup(e,{expose:l}){var d,r,g,V;const t=de(),a=Ze();let i=localStorage.getItem(`input_params_map_${(d=t.currentFlow)==null?void 0:d.name}`);if(i){const u=JSON.parse(i);"flow_version"in u&&u.flow_version.split(".")[0]===((r=t.currentFlow)==null?void 0:r.version.split(".")[0])?i=u:(i=null,localStorage.removeItem(`input_params_map_${(g=t.currentFlow)==null?void 0:g.name}`))}const o=S(((V=t.currentFlow)==null?void 0:V.input_params.map(u=>{var w;if(u.type==="text")return{[u.name]:{value:i!==null&&i[u.name]?i[u.name]:u.default||"",type:u.type,optional:u.optional,advanced:u.advanced||!1,default:u.default||"",translatable:u.translatable||!1}};if(u.type==="number")return{[u.name]:{value:i!==null&&i[u.name]?i[u.name]:u.default||0,type:u.type,optional:u.optional,advanced:u.advanced||!1,default:u.default||0}};if(u.type==="image")return{[u.name]:{value:null,type:u.type,optional:u.optional,advanced:u.advanced||!1}};if(u.type==="image-mask")return{[u.name]:{value:null,type:u.type,optional:u.optional,advanced:u.advanced||!1,source_input_name:u.source_input_name||null}};if(u.type==="list")return{[u.name]:{value:i!==null&&i[u.name]?i[u.name]:u.default||Object.keys(u.options)[0]||"",type:u.type,optional:u.optional,options:u.options,advanced:u.advanced||!1,default:Object.keys(u.options)[0]||""}};if(u.type==="bool")return{[u.name]:{value:i!==null&&i[u.name]?i[u.name]:u.default||!1,type:u.type,optional:u.optional,advanced:u.advanced||!1,default:u.default||!1}};if(["range","range_scale"].includes(u.type)){const _={value:i!==null&&i[u.name]?i[u.name]:u.default||0,type:u.type,optional:u.optional,advanced:u.advanced||!1,min:u.min||0,max:u.max||100,step:u.step||1,default:u.default||0};if(u.type==="range_scale"&&(_.source_input_name=u.source_input_name||null,_.source_input_name===null||_.source_input_name==="")){const z=(w=t.currentFlow)==null?void 0:w.input_params.find(E=>E.type==="image"&&!E.optional);z&&(_.source_input_name=z.name)}return{[u.name]:_}}}))||[]),s=S([]);t.currentFlow.is_seed_supported&&s.value.push({seed:{name:"seed",display_name:"Random seed",value:Math.floor(Math.random()*1e7),type:"number",optional:!0,advanced:!0,min:0,max:1e7}});const f=jt(),p=S(t.currentFlow.is_translations_supported&&f.settingsMap.translations_provider.value.trim()!==""),b=S(p.value);Be(()=>{const u=localStorage.getItem("translatePrompt");u&&(b.value=JSON.parse(u))}),ce(b,u=>{localStorage.setItem("translatePrompt",JSON.stringify(u))});function h(u){console.debug("Copy prompt inputs",u),Object.keys(u).forEach(_=>{const z=o.value.findIndex(E=>Object.keys(E)[0]===_);z!==-1&&(o.value[z][_].value=u[_].value)});const w=document.getElementById("prompt");w&&w.scrollIntoView({behavior:"smooth"})}l({copyPromptInputs:h}),o.value.forEach(u=>{const w=Object.keys(u)[0];["image","image-mask"].includes(u[w].type)||ce(()=>u[w].value,()=>{var z,E;const _={};o.value.forEach(Z=>{const ne=Object.keys(Z)[0];_[ne]=Z[ne].value}),localStorage.setItem(`input_params_map_${(z=t.currentFlow)==null?void 0:z.name}`,JSON.stringify({..._,flow_version:(E=t.currentFlow)==null?void 0:E.version}))})});const $=T(()=>o.value.filter(u=>{const w=Object.keys(u)[0];return!["image","image-mask"].includes(u[w].type)}).some(u=>{const w=Object.keys(u)[0];return u[w].value!==u[w].default}));function F(){o.value.forEach(u=>{const w=Object.keys(u)[0];u[w].type==="text"?u[w].value=u[w].default||"":u[w].type==="number"?u[w].value=u[w].default||u[w].min||0:u[w].type==="list"?u[w].value=Object.keys(u[w].options)[0]||"":u[w].type==="bool"?u[w].value=u[w].default||!1:["range","range_scale"].includes(u[w].type)&&(u[w].value=u[w].default||u[w].min||0)})}const P=S(!1),x=S(1),R=S(!1),O=T(()=>o.value.every(u=>{var z;const w=Object.keys(u)[0];if(u[w].optional)return!0;const _=u[w].value;if(u[w].type==="text")return _!=="";if(u[w].type==="number")return _>=u[w].min&&_<=u[w].max;if(u[w].type==="list")return _!==""&&Object.keys(u[w].options).includes(_);if(u[w].type==="bool")return!0;if(u[w].type==="range")return _>=u[w].min&&_<=u[w].max;if(u[w].type==="range_scale")return _>=u[w].min&&_<=u[w].max;if(u[w].type==="image")return _ instanceof File&&_.size>0;if(u[w].type==="image-mask")return _ instanceof File&&_.size>0&&(((z=u[w])==null?void 0:z.mask_applied)||!1)})),k=S({"X-WORKER-UNLOAD-MODELS":1,"X-WORKER-EXECUTION-PROFILER":1,"X-WORKER-ID":null}),m=S(!1);return ce(()=>k.value,()=>{var u;a.isAdmin&&localStorage.setItem(`profilingOptions_${(u=t.currentFlow)==null?void 0:u.name}`,JSON.stringify(k.value))},{deep:!0}),(u,w)=>{const _=be,z=Yn,E=Ee,Z=De,ne=Ae,le=oe,ge=Te;return n(t).currentFlow?(c(),U("div",Zn,[y("h2",{class:"text-lg font-bold cursor-pointer select-none flex items-center mb-3",onClick:w[0]||(w[0]=()=>{R.value=!n(R)})},[v(_,{name:n(R)?"i-heroicons-chevron-down":"i-heroicons-chevron-up",class:"mr-2"},null,8,["name"]),w[10]||(w[10]=N(" Prompt "))]),Ye(y("div",null,[v(z,{"input-params-map":n(o),"onUpdate:inputParamsMap":w[1]||(w[1]=D=>Q(o)?o.value=D:null),"additional-input-params-map":n(s),"onUpdate:additionalInputParamsMap":w[2]||(w[2]=D=>Q(s)?s.value=D:null),advanced:!1},null,8,["input-params-map","additional-input-params-map"]),n(s).length>0?(c(),I(z,{key:0,"input-params-map":n(o),"onUpdate:inputParamsMap":w[3]||(w[3]=D=>Q(o)?o.value=D:null),"additional-input-params-map":n(s),"onUpdate:additionalInputParamsMap":w[4]||(w[4]=D=>Q(s)?s.value=D:null),"profiling-options":n(k),"onUpdate:profilingOptions":w[5]||(w[5]=D=>Q(k)?k.value=D:null),"profiling-enabled":n(m),"onUpdate:profilingEnabled":w[6]||(w[6]=D=>Q(m)?m.value=D:null),advanced:!0},null,8,["input-params-map","additional-input-params-map","profiling-options","profiling-enabled"])):C("",!0),n(t).currentFlow.is_count_supported?(c(),I(Z,{key:1,label:"Number of results"},{default:M(()=>[v(E,{modelValue:n(x),"onUpdate:modelValue":w[7]||(w[7]=D=>Q(x)?x.value=D:null),type:"number",min:"1",max:"50",label:"Batch size",class:"mb-3 max-w-fit flex justify-end"},null,8,["modelValue"])]),_:1})):C("",!0),n(p)?(c(),I(Z,{key:2,class:"my-3 flex justify-end"},{default:M(()=>[v(ne,{modelValue:n(b),"onUpdate:modelValue":w[8]||(w[8]=D=>Q(b)?b.value=D:null),label:"Translate prompt"},null,8,["modelValue"])]),_:1})):C("",!0),y("div",{class:K(["flex",{"justify-between":n($),"justify-end":!n($)}])},[n($)?(c(),I(ge,{key:0,text:"Reset input params values to defaults"},{default:M(()=>[v(le,{icon:"i-heroicons-arrow-path-rounded-square",variant:"ghost",color:"amber",onClick:F},{default:M(()=>w[11]||(w[11]=[N(" Reset params ")])),_:1})]),_:1})):C("",!0),y("div",el,[v(le,{icon:"i-heroicons-sparkles-16-solid",variant:"outline",loading:n(P),disabled:!n(O),onClick:w[9]||(w[9]=()=>{P.value=!0;let D={};n(a).isAdmin&&n(m)&&(D=Object.fromEntries(Object.entries(n(k)).filter(([A,G])=>G!==null).map(([A,G])=>A==="X-WORKER-ID"?[A,G==null?void 0:G.value]:[A,G]))),n(t).runFlow(n(t).currentFlow,[...n(o),...n(s)],n(x),n(p)&&n(b),!1,null,D).finally(()=>{P.value=!1;const A=n(s).find(G=>Object.keys(G)[0]==="seed");A.seed.value=Number(A.seed.value)+n(x)+1})})},{default:M(()=>w[12]||(w[12]=[N(" Run prompt ")])),_:1},8,["loading","disabled"])])],2)],512),[[ct,!n(R)]])])):C("",!0)}}}),nl=e=>{const l=S(0);function t(o){e.value.style.scrollSnapType="none",e.value.style.scrollBehavior="auto",l.value=o.pageX,window.addEventListener("mousemove",i),window.addEventListener("mouseup",a)}function a(){e.value.style.removeProperty("scroll-behavior"),e.value.style.removeProperty("scroll-snap-type"),e.value.style.removeProperty("pointer-events"),window.removeEventListener("mousemove",i),window.removeEventListener("mouseup",a)}function i(o){o.preventDefault(),e.value.style.pointerEvents="none";const s=o.pageX-l.value;l.value=o.pageX,e.value.scrollBy(-s,0)}$e(()=>{e.value&&e.value.addEventListener("mousedown",t)}),et(()=>{e.value&&e.value.removeEventListener("mousedown",t)})},Le=Qe(ye.ui.strategy,ye.ui.carousel,Gt),ll=Y({components:{UButton:oe},inheritAttrs:!1,props:{items:{type:Array,default:()=>[]},arrows:{type:Boolean,default:!1},indicators:{type:Boolean,default:!1},dir:{type:String,default:"ltr"},prevButton:{type:Object,default:()=>Le.default.prevButton},nextButton:{type:Object,default:()=>Le.default.nextButton},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:void 0}},setup(e,{expose:l}){const{ui:t,attrs:a}=Je("carousel",Pe(e,"ui"),Le,Pe(e,"class")),i=S(),o=S(0),{x:s}=Bt(i,{behavior:"smooth"}),{width:f}=Vt(i);nl(i),Tt(i,O=>{var m,d;const[k]=O;o.value=((d=(m=k==null?void 0:k.target)==null?void 0:m.firstElementChild)==null?void 0:d.clientWidth)||0});const p=T(()=>e.dir==="rtl"),b=T(()=>o.value?p.value?Math.round(-s.value/o.value)+1:Math.round(s.value/o.value)+1:0),h=T(()=>{if(!o.value)return 0;const O=Math.round(f.value/o.value);return e.items.length<=O?0:e.items.length-O+1}),$=T(()=>b.value<=1),F=T(()=>b.value===h.value);function P(){s.value+=p.value?-o.value:o.value}function x(){s.value-=p.value?-o.value:o.value}function R(O){s.value=(O-1)*o.value*(p.value?-1:1)}return l({pages:h,page:b,prev:x,next:P,select:R}),{ui:t,attrs:a,isFirst:$,isLast:F,carouselRef:i,pages:h,currentPage:b,onClickNext:P,onClickPrev:x,onClick:R,twMerge:Oe}}}),ol=["dir"],al=["role"],sl=["aria-selected","aria-label","onClick"];function il(e,l,t,a,i,o){const s=oe;return c(),U("div",_e({class:e.ui.wrapper},e.attrs,{dir:e.dir}),[y("div",{ref:"carouselRef",class:K([e.ui.container,"no-scrollbar"])},[(c(!0),U(te,null,me(e.items,(f,p)=>(c(),U("div",{key:p,class:K(e.ui.item),role:e.indicators?"tabpanel":null},[Re(e.$slots,"default",{item:f,index:p},void 0,!0)],10,al))),128))],2),e.arrows?(c(),U("div",{key:0,class:K(e.ui.arrows.wrapper)},[Re(e.$slots,"prev",{onClick:e.onClickPrev,disabled:e.isFirst},()=>{var f;return[e.prevButton?(c(),I(s,_e({key:0,disabled:e.isFirst},{...e.ui.default.prevButton,...e.prevButton},{class:e.twMerge(e.ui.default.prevButton.class,(f=e.prevButton)==null?void 0:f.class),"aria-label":"Prev",onClick:e.onClickPrev}),null,16,["disabled","class","onClick"])):C("",!0)]},!0),Re(e.$slots,"next",{onClick:e.onClickNext,disabled:e.isLast},()=>{var f;return[e.nextButton?(c(),I(s,_e({key:0,disabled:e.isLast},{...e.ui.default.nextButton,...e.nextButton},{class:e.twMerge(e.ui.default.nextButton.class,(f=e.nextButton)==null?void 0:f.class),"aria-label":"Next",onClick:e.onClickNext}),null,16,["disabled","class","onClick"])):C("",!0)]},!0)],2)):C("",!0),e.indicators?(c(),U("div",{key:1,role:"tablist",class:K(e.ui.indicators.wrapper)},[(c(!0),U(te,null,me(e.pages,f=>Re(e.$slots,"indicator",{key:f,onClick:e.onClick,active:f===e.currentPage,page:f},()=>[y("button",{type:"button",role:"tab","aria-selected":f===e.currentPage,class:K([e.ui.indicators.base,f===e.currentPage?e.ui.indicators.active:e.ui.indicators.inactive]),"aria-label":`set slide ${f}`,onClick:p=>e.onClick(f)},null,10,sl)],!0)),128))],2)):C("",!0)],16,ol)}const Fe=Ge(ll,[["render",il],["__scopeId","data-v-a3da86ff"]]),rl={class:"flex flex-col basis-full"},ul=Y({__name:"InputFiles",props:{running:{type:Object,required:!0}},setup(e){const l=lt(),t=function(f,p){return`${mt()}/tasks/inputs?task_id=${f}&input_index=${p}`},a=S(!1),i=S(""),o=S(0),s=S(!0);return(f,p)=>{var x,R,O,k,m;const b=be,h=ke,$=Fe,F=oe,P=Ce;return e.running&&e.running.input_files&&((x=Object.keys(e.running.input_files))==null?void 0:x.length)>0?(c(),U("div",{key:0,class:K(["ml-2 mt-2 mb-5",{"mb-10":((R=Object.keys(e.running.input_files))==null?void 0:R.length)>1&&!n(s)}])},[y("h4",{class:"mb-3 font-bold cursor-pointer select-none flex items-center text-sm",onClick:p[0]||(p[0]=()=>s.value=!n(s))},[v(b,{name:n(s)?"i-heroicons-chevron-down":"i-heroicons-chevron-up",class:"mr-2"},null,8,["name"]),y("span",null," Input files ("+W((O=Object.keys(e.running.input_files))==null?void 0:O.length)+") ",1)]),n(s)?C("",!0):(c(),U(te,{key:0},[((k=Object.keys(e.running.input_files))==null?void 0:k.length)===1?(c(),I(h,{key:0,class:"mb-5 rounded-lg cursor-pointer",fit:"outside",loading:"lazy",placeholder:n(l)(`${("buildBackendUrl"in f?f.buildBackendUrl:n(Xe))()}/vix_logo.png`,{f:"png",blur:3,q:50}),src:t(e.running.task_id,0),onClick:p[1]||(p[1]=()=>{i.value=t(e.running.task_id,0),o.value=0,a.value=!0})},null,8,["placeholder","src"])):C("",!0),((m=Object.keys(e.running.input_files))==null?void 0:m.length)>1?(c(),I($,{key:1,items:Object.keys(e.running.input_files).map(d=>({task_id:e.running.task_id,index:d})),ui:{item:"basis-full md:basis-1/2",indicators:{wrapper:"relative bottom-0 mt-4"}},page:1,indicators:""},{default:M(({item:d})=>[y("div",rl,[v(h,{class:"rounded-lg cursor-pointer",fit:"outside",loading:"lazy",placeholder:n(l)(`${("buildBackendUrl"in f?f.buildBackendUrl:n(Xe))()}/vix_logo.png`,{f:"png",blur:3,q:50}),src:t(d.task_id,d.index),onClick:()=>{i.value=t(e.running.task_id,d.index),o.value=d.index,a.value=!0}},null,8,["placeholder","src","onClick"])])]),_:1},8,["items"])):C("",!0),v(P,{modelValue:n(a),"onUpdate:modelValue":p[4]||(p[4]=d=>Q(a)?a.value=d:null),class:"z-[90]",transition:!1,fullscreen:""},{default:M(()=>[v(F,{class:"absolute top-4 right-4",icon:"i-heroicons-x-mark",variant:"ghost",onClick:p[2]||(p[2]=()=>a.value=!1)}),y("div",{class:"flex items-center justify-center w-full h-full p-4",onClick:p[3]||(p[3]=Ve(()=>a.value=!1,["left"]))},[n(i)?(c(),I(h,{key:0,class:"lg:h-full",fit:"inside",loading:"lazy",placeholder:"/vix_logo.png",src:n(i)},null,8,["src"])):C("",!0)])]),_:1},8,["modelValue"])],64))],2)):C("",!0)}}}),dl=Y({__name:"ErrorAlert",props:{running:{type:Object,required:!0}},setup(e){const l=de(),t=S(!1);return(a,i)=>{const o=ht;return c(),I(o,{class:"mb-5",icon:"i-heroicons-exclamation-circle-16-solid",color:"red",variant:"soft",title:"Task failed",description:e.running.error,actions:[{variant:"outline",color:"yellow",label:"Restart",loading:n(t),icon:"i-heroicons-arrow-path",click:()=>{t.value=!0,n(l).restartFlow(e.running).finally(()=>{t.value=!1})}}]},null,8,["description","actions"])}}}),cl={class:"mb-5"},ml={class:"text-sm mb-5 text-slate-500"},fl={class:"flex justify-between"},pl=Y({__name:"Item",props:{running:{type:Object,required:!0}},setup(e){const l=de(),t=S(!1),a=S(!1);function i(o){return[[{label:"Comfy flow",labelClass:"text-blue-500",icon:"i-heroicons-arrow-down-tray",iconClass:"bg-blue-500",click:()=>{var s;return l.downloadFlowComfy((s=l.currentFlow)==null?void 0:s.name,o.task_id)}}],[{label:`Raise priority ${o.priority>0?`(${o.priority})`:""}`,labelClass:"text-gray-500",icon:"i-heroicons-arrow-up",iconClass:"bg-gray-500",disabled:o.priority===15||o.progress>0,click:()=>{a.value=!0,l.raiseQueuePriority(o).finally(()=>{a.value=!1})}},{label:`Lower priority ${o.priority>0?`(${o.priority})`:""}`,labelClass:"text-gray-500",icon:"i-heroicons-arrow-down",iconClass:"bg-gray-500",disabled:o.priority===0||o.progress>0,click:()=>{a.value=!0,l.lowerQueuePriority(o).finally(()=>{a.value=!1})}},{label:`Reset priority ${o.priority>0?`(${o.priority})`:""}`,labelClass:"text-gray-500",icon:"i-heroicons-arrow-path-rounded-square-solid",iconClass:"bg-gray-500",disabled:o.priority===0||o.progress>0,click:()=>{a.value=!0,l.resetQueuePriority(o).finally(()=>{a.value=!1})}}]]}return(o,s)=>{var F,P;const f=vt,p=ul,b=dl,h=oe,$=qe;return c(),U("div",cl,[v(f,{class:"mb-3",value:(F=e.running)==null?void 0:F.progress,indicator:"",color:e.running.error?"red":"green"},null,8,["value","color"]),y("p",ml,W([`${(P=e.running)!=null&&P.priority&&e.running.priority>0?"["+e.running.priority+"] ":""}#${e.running.task_id}`,...Object.keys(e.running.input_params_mapped).filter(x=>e.running.input_params_mapped[x].value&&e.running.input_params_mapped[x].value!=="").map(x=>`${e.running.input_params_mapped[x].display_name}: ${e.running.input_params_mapped[x].value}`)].join(" | ")+`${e.running.execution_time?" | execution_time: "+e.running.execution_time.toFixed(2)+"s":""}`),1),v(p,{running:e.running},null,8,["running"]),e.running.error?(c(),I(b,{key:0,running:e.running},null,8,["running"])):C("",!0),y("div",fl,[v(h,{icon:e.running.progress>=0&&e.running.progress<100?"i-heroicons-stop":"i-heroicons-minus-circle",color:e.running.error?"red":"orange",variant:"outline",loading:n(t),onClick:s[0]||(s[0]=()=>{t.value=!0,n(l).cancelRunningFlow(e.running).finally(()=>{t.value=!1})})},{default:M(()=>[N(W(e.running.progress>=0&&e.running.progress<100?"Cancel":"Remove"),1)]),_:1},8,["icon","color","loading"]),v($,{items:i(e.running),mode:"click",popper:{placement:"bottom-end"}},{default:M(()=>[v(h,{color:"blue",variant:"outline",icon:"i-heroicons-ellipsis-vertical-16-solid"})]),_:1},8,["items"])])])}}}),gl={class:"w-full p-4 ring-1 ring-gray-200 dark:ring-gray-800 rounded-lg shadow-md mt-5 mb-10"},vl={class:"flex items-center justify-between mb-2"},hl={key:0},wl={key:1,class:"text-red-400"},yl=Y({__name:"Queue",setup(e){const l=de(),t=S(!0),a=S(!1);return(i,o)=>{var b,h,$,F,P,x,R,O,k;const s=be,f=oe,p=pl;return c(),U("div",gl,[y("div",vl,[y("h2",{class:"text-lg font-bold cursor-pointer select-none flex items-center",onClick:o[0]||(o[0]=()=>{t.value=!n(t)})},[v(s,{name:n(t)?"i-heroicons-chevron-down":"i-heroicons-chevron-up",class:"mr-2"},null,8,["name"]),y("span",null," Queue ("+W(n(l).flowsRunningByName((b=n(l).currentFlow)==null?void 0:b.name).length)+") ",1),n(l).flowsRunningByName((h=n(l).currentFlow)==null?void 0:h.name).length>0?(c(),U("span",hl,"  - "+W(`${((F=n(l).flowsRunningByName(($=n(l).currentFlow)==null?void 0:$.name).filter(m=>m.progress>0)[0])==null?void 0:F.progress.toFixed(0))??0}%`),1)):C("",!0),n(l).flowsRunningByNameWithErrors((P=n(l))==null?void 0:P.currentFlow.name).length>0?(c(),U("span",wl,"  ("+W(n(l).flowsRunningByNameWithErrors((x=n(l).currentFlow)==null?void 0:x.name).length)+") ",1)):C("",!0)]),(R=n(l).currentFlow)!=null&&R.name&&n(l).flowsRunningByName((O=n(l).currentFlow)==null?void 0:O.name).length>0?(c(),I(f,{key:0,icon:"i-heroicons-stop",color:"orange",variant:"outline",loading:n(a),onClick:o[1]||(o[1]=()=>{var m;a.value=!0,n(l).cancelRunningFlows((m=n(l).currentFlow)==null?void 0:m.name).finally(()=>{a.value=!1})})},{default:M(()=>o[2]||(o[2]=[N(" Cancel all ")])),_:1},8,["loading"])):C("",!0)]),n(t)?C("",!0):(c(!0),U(te,{key:0},me(n(l).flowsRunningByName((k=n(l).currentFlow)==null?void 0:k.name),m=>(c(),I(p,{key:m.task_id,running:m},null,8,["running"]))),128))])}}}),bl=Y({__name:"ScrollToTop",props:{show:{type:Boolean,required:!0},target:{type:String,required:!0}},setup(e){const l=e;function t(){const a=document.getElementById(l.target);a&&a.scrollIntoView({behavior:"smooth"})}return(a,i)=>{const o=oe;return e.show?(c(),I(o,{key:0,icon:"i-heroicons-arrow-small-up",color:"black",variant:"outline",onClick:t})):C("",!0)}}});function kt(e={}){const{copy:l,isSupported:t}=Nt(),a=Ne();function i(o,s={},f={}){t&&l(o).then(()=>{!s.title&&!s.description||a.add({...s,...e})},function(p){a.add({...f,description:f.description||p.message,...e})})}return{copy:i}}const kl={class:"flex flex-col items-center mb-2 max-w-fit mx-auto z-0"},xl={class:"text-slate-500 text-center text-sm w-full mx-auto flex flex-wrap items-center justify-center md:justify-between"},_l={class:"toggles py-2"},$l={class:"mr-2 inline-flex items-center text-sm"},Cl=["for"],Il={class:"mr-2 inline-flex items-center text-sm"},Sl=["for"],Rl={key:0,class:"flex items-center"},Ml=["title"],Pl=Y({__name:"Child",props:{flowResult:{type:Object,required:!0},outputsIndex:{type:Number,required:!1,default:()=>0},openImageModal:{type:Function,required:!0}},setup(e){const l=e,t=de(),a=(m,d=null,r=!1)=>{if(m.child_tasks.length===0)return m;const g=m.child_tasks.findIndex(V=>V.parent_task_node_id===d);return g!==-1?(r||(o.value=m),a(m.child_tasks[g],m.child_tasks[g].outputs[0].comfy_node_id,r)):m};function i(m,d,r=null){if(r!==null&&m.parent_task_node_id===r||Number(m.task_id)===d)return m;for(let g=0;g<m.child_tasks.length;g++)for(let V=0;V<m.child_tasks[g].outputs.length;V++){const u=i(m.child_tasks[g],d,m.child_tasks[g].outputs[V].comfy_node_id);if(u!==null)return u}return null}const o=S(l.flowResult),s=S(a(l.flowResult,l.flowResult.outputs[l.outputsIndex].comfy_node_id,!1));function f(m){var d;return[[{label:`${(d=t.flowByName((m==null?void 0:m.flow_name)??(m==null?void 0:m.name)))==null?void 0:d.display_name}#${m.task_id}`,disabled:!0}],[{label:"View image",icon:"i-heroicons-eye",click:()=>{l.openImageModal(ae({task_id:m.task_id,node_id:m.outputs.length>1?m.outputs[l.outputsIndex].comfy_node_id:m.outputs[0].comfy_node_id}))}}]]}function p(m){var r;const d=[[{label:`${(r=t.flowByName((m==null?void 0:m.flow_name)??(m==null?void 0:m.name)))==null?void 0:r.display_name}#${m.task_id}`,disabled:!0}],[{label:"View image",icon:"i-heroicons-eye",disabled:m.progress<100||m.error!=="",click:()=>{l.openImageModal(ae({task_id:m.task_id,node_id:m.outputs.length>1?m.outputs[l.outputsIndex].comfy_node_id:m.outputs[0].comfy_node_id}))}},{label:m.progress<100?"Cancel":"Delete",labelClass:m.progress<100?"text-orange-500":"text-red-500",icon:m.progress<100?"i-heroicons-stop":"i-heroicons-trash",iconClass:m.progress<100?"bg-orange-500":"bg-red-500",click:()=>{t.deleteFlowHistory(m.task_id).then(()=>{const g=i(l.flowResult,m.parent_task_id,m.parent_task_node_id);g&&(g.child_tasks=g.child_tasks.filter(V=>Number(V.task_id)!==Number(m.task_id))),x(!1,l.flowResult)})}}]];return m.progress<100&&(d[0][1]={label:`Progress: ${Math.ceil(m.progress)}% (${m.execution_time.toFixed(2)}s)`,labelClass:"text-blue-500",disabled:!0}),m.error!==""&&d[0].push({label:`Error: ${m.error}`,labelClass:"text-red-500",slot:"error",click:()=>{kt().copy(m.error),Ne().add({title:"Clipboard",description:`Task #${m.task_id} error copied to clipboard`,timeout:2e3})}}),d}function b(){const m=o.value.parent_task_id;if(!m)return;const d=i(l.flowResult,m,o.value.parent_task_node_id);d&&(o.value=d)}function h(){if(o.value.child_tasks.length===0)return;const m=o.value.outputs.length>1?o.value.outputs[l.outputsIndex].comfy_node_id:o.value.outputs[0].comfy_node_id,d=o.value.child_tasks.find(r=>r.parent_task_node_id===m);d&&(o.value=d)}const $=T(()=>{if(o.value.child_tasks.length===0)return;const m=o.value.outputs.length>1?o.value.outputs[l.outputsIndex].comfy_node_id:o.value.outputs[0].comfy_node_id;return o.value.child_tasks.find(r=>r.parent_task_node_id===m).task_id!==s.value.task_id});function F(){const m=s.value.parent_task_id;if(!m)return;const d=i(l.flowResult,m,s.value.parent_task_node_id);d&&(s.value=d)}function P(){if(s.value.child_tasks.length===0)return;const m=Number(s.value.outputs[0].comfy_node_id),d=s.value.child_tasks.find(r=>Number(r.parent_task_node_id)===m);d&&(s.value=d)}function x(m=!1,d=null){m||(o.value=d),s.value=a(d,d==null?void 0:d.outputs[l.outputsIndex].comfy_node_id,m),R.value=!1}ce(l.flowResult,m=>{x(!0,m)});const R=S(!1),O=S(!0),k=S(null);return ce(R,m=>{m?(k.value=o.value,o.value=l.flowResult):k.value&&(o.value=k.value,s.value=ft(k.value,l.outputsIndex,o.value.outputs.length>1?o.value.outputs[l.outputsIndex].comfy_node_id:o.value.outputs[0].comfy_node_id))}),(m,d)=>{const r=ke,g=Me("ImgComparisonSlider"),V=Ht,u=oe,w=qe,_=be,z=Te;return c(),U("div",kl,[Ye(v(r,{class:"mb-2 rounded-lg cursor-pointer",height:n(t).outputMaxSize,width:n(t).outputMaxSize,draggable:"false",fit:"cover",loading:"lazy",src:("outputResultSrc"in m?m.outputResultSrc:n(ae))({task_id:n(s).progress===100?n(s).task_id:e.flowResult.task_id,node_id:n(s).progress===100?n(s).outputs[0].comfy_node_id:e.flowResult.outputs[e.outputsIndex].comfy_node_id}),onClick:d[0]||(d[0]=E=>e.openImageModal(("outputResultSrc"in m?m.outputResultSrc:n(ae))({task_id:n(s).task_id??e.flowResult.task_id,node_id:n(s).outputs[0].comfy_node_id??e.flowResult.outputs[e.outputsIndex].comfy_node_id})))},null,8,["height","width","src"]),[[ct,!n(O)]]),n(O)?(c(),I(g,{key:0,class:"mb-2 mx-auto outline-none w-fit rounded-lg"},{default:M(()=>{var E,Z,ne;return[v(r,{slot:"first",height:n(t).outputMaxSize,width:n(t).outputMaxSize,fit:"cover",draggable:"false",src:("outputResultSrc"in m?m.outputResultSrc:n(ae))({task_id:n(R)?e.flowResult.task_id:n(o).task_id,node_id:n(R)?e.flowResult.outputs[e.outputsIndex].comfy_node_id:n(o).parent_task_node_id!==null?(E=n(o))==null?void 0:E.outputs[0].comfy_node_id:((Z=n(o))==null?void 0:Z.outputs[e.outputsIndex].comfy_node_id)??((ne=n(o))==null?void 0:ne.outputs[0].comfy_node_id)})},null,8,["height","width","src"]),n(s)&&n(s).progress===100?(c(),I(r,{key:0,slot:"second",height:n(t).outputMaxSize,width:n(t).outputMaxSize,fit:"cover",draggable:"false",src:("outputResultSrc"in m?m.outputResultSrc:n(ae))({task_id:n(s).task_id,node_id:n(s).outputs[0].comfy_node_id})},null,8,["height","width","src"])):(c(),I(r,{key:1,slot:"second",height:n(t).outputMaxSize,width:n(t).outputMaxSize,fit:"cover",draggable:"false",src:`${("buildBackendUrl"in m?m.buildBackendUrl:n(Xe))()}/vix_logo.png`},null,8,["height","width","src"]))]}),_:1})):C("",!0),y("div",xl,[y("div",_l,[y("div",$l,[v(V,{id:`toggle-compare-${e.flowResult.task_id}-${e.outputsIndex}`,modelValue:n(O),"onUpdate:modelValue":d[1]||(d[1]=E=>Q(O)?O.value=E:null),size:"xs",class:"mr-2"},null,8,["id","modelValue"]),y("label",{class:"cursor-pointer select-none",for:`toggle-compare-${e.flowResult.task_id}-${e.outputsIndex}`}," Comparison ",8,Cl)]),y("div",Il,[v(V,{id:`toggle-original-${e.flowResult.task_id}-${e.outputsIndex}`,modelValue:n(R),"onUpdate:modelValue":d[2]||(d[2]=E=>Q(R)?R.value=E:null),disabled:!n(O),size:"xs",class:"mr-2"},null,8,["id","modelValue","disabled"]),y("label",{class:"cursor-pointer select-none",for:`toggle-original-${e.flowResult.task_id}-${e.outputsIndex}`}," Original ",8,Sl)])]),n(O)?(c(),U("div",Rl,[v(u,{icon:"i-heroicons-arrow-small-left-20-solid",size:"2xs",variant:"soft",color:"cyan",disabled:n(R)||n(o).parent_task_id===null,onClick:b},null,8,["disabled"]),v(w,{items:f(n(o)),mode:"click",popper:{placement:"top"}},{default:M(()=>[v(u,{variant:"link",color:"white",size:"xs"},{default:M(()=>[N(" #"+W(n(R)?e.flowResult.task_id:n(o).task_id),1)]),_:1})]),_:1},8,["items"]),v(u,{icon:"i-heroicons-arrow-small-right-20-solid",size:"2xs",variant:"soft",color:"cyan",disabled:n(R)||!n($),onClick:h},null,8,["disabled"]),v(_,{class:"mx-3",name:"i-heroicons-arrows-right-left-16-solid"}),v(u,{icon:"i-heroicons-arrow-small-left-20-solid",size:"2xs",variant:"soft",color:"cyan",disabled:!i(l.flowResult,n(s).parent_task_id,n(s).parent_task_node_id)||n(s).parent_task_id===Number(n(o).task_id)||n(s).parent_task_id===null,onClick:F},null,8,["disabled"]),v(w,{items:p(n(s)),mode:"click",popper:{placement:"top"}},{error:M(({item:E})=>[y("div",{class:"text-red-500 truncate",title:E.label},W(E.label),9,Ml)]),default:M(()=>[v(u,{class:K({"text-blue-500":n(s).progress!==100&&n(s).error==="","text-red-500":n(s).error!==""}),variant:"link",color:"white",size:"xs"},{default:M(()=>[N(W(n(s).progress===100?"#"+n(s).task_id:Math.ceil(n(s).progress)+"%"),1)]),_:1},8,["class"])]),_:1},8,["items"]),v(u,{icon:"i-heroicons-arrow-small-right-20-solid",size:"2xs",variant:"soft",color:"cyan",disabled:n(s).child_tasks.length===0,onClick:P},null,8,["disabled"]),v(z,{class:"ml-3",text:"Reset comparison",popper:{placement:"top"}},{default:M(()=>[v(u,{icon:"i-heroicons-arrow-path-rounded-square-solid",size:"2xs",variant:"outline",color:"white",onClick:d[3]||(d[3]=()=>x(!1,e.flowResult))})]),_:1})])):C("",!0)])])}}}),zl={class:"image-output"},Fl={class:"flex flex-col basis-full justify-between mx-2"},Ul=Y({__name:"Image",props:{flowResult:{type:Object,required:!0},handleSendToFlow:{type:Function,required:!0},openImageModal:{type:Function,required:!0}},setup(e){const l=de();return(t,a)=>{var p,b;const i=Pl,o=ke,s=oe,f=Fe;return c(),U("div",zl,[e.flowResult.outputs.length===1?(c(),U(te,{key:0},[(p=e.flowResult)!=null&&p.child_tasks&&((b=e.flowResult)==null?void 0:b.child_tasks.length)>0?(c(),I(i,{key:0,"flow-result":e.flowResult,"open-image-modal":e.openImageModal},null,8,["flow-result","open-image-modal"])):e.flowResult.outputs.length===1?(c(),I(o,{key:1,class:"mb-2 mx-auto rounded-lg cursor-pointer",height:n(l).$state.outputMaxSize,width:n(l).$state.outputMaxSize,draggable:"false",fit:"cover",loading:"lazy",src:("outputResultSrc"in t?t.outputResultSrc:n(ae))({task_id:e.flowResult.task_id,node_id:e.flowResult.outputs[0].comfy_node_id}),onClick:a[0]||(a[0]=h=>e.openImageModal(("outputResultSrc"in t?t.outputResultSrc:n(ae))({task_id:e.flowResult.task_id,node_id:e.flowResult.outputs[0].comfy_node_id})))},null,8,["height","width","src"])):C("",!0)],64)):e.flowResult.outputs.length>1?(c(),I(f,{key:1,class:"mb-3 rounded-lg overflow-hidden",items:e.flowResult.outputs.map((h,$)=>({task_id:e.flowResult.task_id,node_id:h.comfy_node_id,index:$})),ui:{item:"basis-full md:basis-1/2",indicators:{wrapper:"relative bottom-0 mt-4 md:hidden"}},page:1,indicators:""},{default:M(({item:h})=>{var $;return[y("div",Fl,[($=e.flowResult)!=null&&$.child_tasks&&("hasChildTaskByParentTaskNodeId"in t?t.hasChildTaskByParentTaskNodeId:n(pt))(e.flowResult,h.index,h.node_id)?(c(),I(i,{key:0,"flow-result":e.flowResult,"outputs-index":h.index,"open-image-modal":e.openImageModal},null,8,["flow-result","outputs-index","open-image-modal"])):(c(),I(o,{key:1,class:K(`mb-2 h-100 max-h-[${n(l).$state.outputMaxSize}px] mx-auto rounded-lg cursor-pointer`),draggable:"false",height:n(l).$state.outputMaxSize,width:n(l).$state.outputMaxSize,fit:"cover",loading:"lazy",src:("outputResultSrc"in t?t.outputResultSrc:n(ae))(h),onClick:F=>e.openImageModal(("outputResultSrc"in t?t.outputResultSrc:n(ae))(h))},null,8,["class","height","width","src","onClick"])),v(s,{class:"mt-2 w-fit mx-auto",icon:"i-heroicons-arrow-uturn-up-solid",color:"violet",size:"xs",variant:"outline",onClick:()=>{e.handleSendToFlow(e.flowResult,h.index)}},{default:M(()=>a[1]||(a[1]=[N(" Send to flow ")])),_:2},1032,["onClick"])])]}),_:1},8,["items"])):C("",!0)])}}}),Ol={class:"image-output"},jl=["width","height"],Bl=["src"],Vl={class:"flex flex-col basis-full justify-between mx-2"},Tl=["width","height"],Nl=["src"],ql=Y({__name:"Video",props:{flowResult:{type:Object,required:!0},handleSendToFlow:{type:Function,required:!0},openImageModal:{type:Function,required:!0}},setup(e){const l=de();return(t,a)=>{const i=oe,o=Fe;return c(),U("div",Ol,[e.flowResult.outputs.length===1?(c(),U("video",{key:0,controls:"",class:"mb-2 mx-auto rounded-lg",style:{"max-height":"80vh"},width:n(l).$state.outputMaxSize,height:n(l).$state.outputMaxSize},[y("source",{src:("outputResultSrc"in t?t.outputResultSrc:n(ae))({task_id:e.flowResult.task_id,node_id:e.flowResult.outputs[0].comfy_node_id})},null,8,Bl)],8,jl)):e.flowResult.outputs.length>1?(c(),I(o,{key:1,class:"mb-3 rounded-lg overflow-hidden",items:e.flowResult.outputs.map((s,f)=>({task_id:e.flowResult.task_id,node_id:s.comfy_node_id,index:f})),ui:{item:"basis-full md:basis-1/2",indicators:{wrapper:"relative bottom-0 mt-4 md:hidden"}},page:1,indicators:""},{default:M(({item:s})=>[y("div",Vl,[y("video",{controls:"",class:"mb-2 mx-auto rounded-lg",width:n(l).$state.outputMaxSize,height:n(l).$state.outputMaxSize},[y("source",{src:("outputResultSrc"in t?t.outputResultSrc:n(ae))({task_id:e.flowResult.task_id,node_id:e.flowResult.outputs[0].comfy_node_id})},null,8,Nl)],8,Tl),v(i,{class:"mt-2 w-fit mx-auto",icon:"i-heroicons-arrow-uturn-up-solid",color:"violet",size:"xs",variant:"outline",onClick:()=>{e.handleSendToFlow(e.flowResult,s.index)}},{default:M(()=>a[0]||(a[0]=[N(" Send to flow ")])),_:2},1032,["onClick"])])]),_:1},8,["items"])):C("",!0)])}}}),El={class:"image-output"},Dl=["src"],Al={class:"flex flex-col basis-full justify-between mx-2"},Wl=["src"],Ll=Y({__name:"Audio",props:{flowResult:{type:Object,required:!0}},setup(e){return(l,t)=>{const a=Fe;return c(),U("div",El,[e.flowResult.outputs.length===1?(c(),U("audio",{key:0,controls:"",class:"mb-2 mx-auto rounded-lg",src:("outputResultSrc"in l?l.outputResultSrc:n(ae))({task_id:e.flowResult.task_id,node_id:e.flowResult.outputs[0].comfy_node_id})},null,8,Dl)):e.flowResult.outputs.length>1?(c(),I(a,{key:1,class:"mb-3 rounded-lg overflow-hidden",items:e.flowResult.outputs.map((i,o)=>({task_id:e.flowResult.task_id,node_id:i.comfy_node_id,index:o})),ui:{item:"basis-full md:basis-1/2",indicators:{wrapper:"relative bottom-0 mt-4 md:hidden"}},page:1,indicators:""},{default:M(()=>[y("div",Al,[y("audio",{controls:"",class:"mb-2 mx-auto rounded-lg",src:("outputResultSrc"in l?l.outputResultSrc:n(ae))({task_id:e.flowResult.task_id,node_id:e.flowResult.outputs[0].comfy_node_id})},null,8,Wl)])]),_:1},8,["items"])):C("",!0)])}}}),Hl={class:"w-full h-full p-4"},Xl={class:"mt-4 max-h-96 overflow-y-auto text-sm whitespace-pre-wrap"},Gl=Y({__name:"Params",props:{flowResult:{type:Object,required:!0}},setup(e){const l=e,t=S(!1),a=T(()=>["#"+l.flowResult.task_id,...Object.keys(l.flowResult.input_params_mapped).filter(f=>l.flowResult.input_params_mapped[f].value&&l.flowResult.input_params_mapped[f].value!=="").map(f=>t.value&&l.flowResult.translated_input_params_mapped&&l.flowResult.translated_input_params_mapped[f]?`${l.flowResult.input_params_mapped[f].display_name}: ${l.flowResult.translated_input_params_mapped[f].value}`:`${l.flowResult.input_params_mapped[f].display_name}: ${l.flowResult.input_params_mapped[f].value}`)].join(" | ")+`${l.flowResult.execution_time?" | execution_time: "+l.flowResult.execution_time.toFixed(2)+"s":""}`);et(()=>{l.flowResult.showInputFiles=!1,l.flowResult.showExecutionDetailsModal=!1});const i=T(()=>l.flowResult.execution_details&&l.flowResult.extra_flags!==null),o=T(()=>{const f={unload_models:l.flowResult.extra_flags.unload_models,max_memory_usage:l.flowResult.execution_details.max_memory_usage,disable_smart_memory:l.flowResult.execution_details.disable_smart_memory,vram_state:l.flowResult.execution_details.vram_state};return JSON.stringify(f,null,"	")});function s(){const f={extra_flags:l.flowResult.extra_flags,execution_details:l.flowResult.execution_details},p=new Blob([JSON.stringify(f,null,"	")],{type:"application/json"}),b=URL.createObjectURL(p),h=document.createElement("a");h.href=b,h.download=`${l.flowResult.task_id}_execution_details.json`,h.click(),window.URL.revokeObjectURL(b)}return(f,p)=>{const b=oe,h=Ce,$=Te,F=tt,P=be;return c(),U(te,null,[n(i)?(c(),I(h,{key:0,modelValue:e.flowResult.showExecutionDetailsModal,"onUpdate:modelValue":p[2]||(p[2]=x=>e.flowResult.showExecutionDetailsModal=x)},{default:M(()=>[v(b,{class:"absolute top-4 right-4",icon:"i-heroicons-x-mark",variant:"ghost",onClick:p[0]||(p[0]=()=>e.flowResult.showExecutionDetailsModal=!1)}),y("div",Hl,[p[6]||(p[6]=y("h3",{class:"text-center font-bold"}," Execution details ",-1)),y("div",Xl,W(n(o)),1),v(b,{class:"mt-3",icon:"i-heroicons-arrow-down-tray-20-solid",variant:"outline",size:"xs",color:"gray",onClick:p[1]||(p[1]=()=>s())},{default:M(()=>p[5]||(p[5]=[N(" Download raw details ")])),_:1})])]),_:1},8,["modelValue"])):C("",!0),e.flowResult.translated_input_params_mapped&&Object.keys(e.flowResult.translated_input_params_mapped).length>0?(c(),I($,{key:1,text:n(t)?"Hide translated input params":"Show translated input params",popper:{placement:"top"}},{default:M(()=>[v(b,{class:"mb-2 mr-2",color:"white",size:"xs",variant:"outline",icon:"i-heroicons-language-solid",onClick:p[3]||(p[3]=()=>{t.value=!n(t)})})]),_:1},8,["text"])):C("",!0),(c(!0),U(te,null,me(n(a).split("|"),x=>(c(),I(F,{key:x,class:"mr-2 mb-2 last:mr-0 hover:cursor-pointer",variant:"soft",color:"gray",onClick:()=>{("useCopyToClipboard"in f?f.useCopyToClipboard:n(kt))().copy(x.split(":")[1].trim()),("useToast"in f?f.useToast:n(Ne))().add({title:"Clipboard",description:`${x.split(":")[0].trim()} copied to clipboard`,timeout:2e3})}},{default:M(()=>[N(W(x),1)]),_:2},1032,["onClick"]))),128)),e.flowResult.input_files.length>0?(c(),I(F,{key:2,class:"mr-2 mb-2 last:mr-0 hover:cursor-pointer select-none",variant:"subtle",color:"sky",onClick:p[4]||(p[4]=()=>{e.flowResult.showInputFiles=!e.flowResult.showInputFiles})},{default:M(()=>[v(P,{name:e.flowResult.showInputFiles?"i-heroicons-chevron-down":"i-heroicons-chevron-up",class:"mr-1"},null,8,["name"]),v(P,{name:"i-heroicons-document-solid",class:"mr-1"}),N(" "+W(`input_files: ${e.flowResult.input_files.length}`),1)]),_:1})):C("",!0)],64)}}}),Jl={key:0,class:K("w-full p-1")},Ql={class:"flex flex-col basis-full justify-between mx-2"},Kl=Y({__name:"InputFiles",props:{flowResult:{type:Object,required:!0}},setup(e){const l=de(),t=(s,f)=>`${mt()}/tasks/inputs?task_id=${s}&input_index=${f}`,a=S(!1),i=S(""),o=S(0);return(s,f)=>{var F,P;const p=ke,b=Fe,h=oe,$=Ce;return e.flowResult.showInputFiles?(c(),U("div",Jl,[((F=Object.keys(e.flowResult.input_files))==null?void 0:F.length)===1?(c(),I(p,{key:0,class:K(`mb-5 mx-auto rounded-lg cursor-pointer max-h-[${n(l).$state.outputMaxSize}px] w-auto`),fit:"outside",loading:"lazy",src:t(e.flowResult.task_id,0),onClick:f[0]||(f[0]=()=>{i.value=t(e.flowResult.task_id,0),o.value=0,a.value=!0})},null,8,["class","src"])):C("",!0),((P=Object.keys(e.flowResult.input_files))==null?void 0:P.length)>1?(c(),I(b,{key:1,items:Object.keys(e.flowResult.input_files).map(x=>({task_id:e.flowResult.task_id,index:x})),ui:{item:"basis-full md:basis-1/2",indicators:{wrapper:"relative bottom-0 my-2"}},page:1,indicators:""},{default:M(({item:x})=>[y("div",Ql,[v(p,{class:K(`mb-5 mx-auto rounded-lg cursor-pointer max-h-[${n(l).$state.outputMaxSize}px] w-auto`),fit:"outside",loading:"lazy",draggable:"false",src:t(x.task_id,x.index),onClick:()=>{i.value=t(e.flowResult.task_id,x.index),o.value=x.index,a.value=!0}},null,8,["class","src","onClick"])])]),_:1},8,["items"])):C("",!0),v($,{modelValue:n(a),"onUpdate:modelValue":f[3]||(f[3]=x=>Q(a)?a.value=x:null),class:"z-[90]",transition:!1,fullscreen:""},{default:M(()=>[v(h,{class:"absolute top-4 right-4",icon:"i-heroicons-x-mark",variant:"ghost",onClick:f[1]||(f[1]=()=>a.value=!1)}),y("div",{class:"flex items-center justify-center w-full h-full p-4",onClick:f[2]||(f[2]=Ve(()=>a.value=!1,["left"]))},[n(i)?(c(),I(p,{key:0,class:"lg:h-full",fit:"inside",loading:"lazy",placeholder:"/vix_logo.png",src:n(i)},null,8,["src"])):C("",!0)])]),_:1},8,["modelValue"])])):C("",!0)}}}),Yl={class:"p-4"},Zl={class:"flex justify-center mb-4"},eo={key:0,class:"text-sm text-slate-500 text-center mb-4"},to={class:"text-md text-center text-red-500 mb-4"},no={key:1},lo={class:"flex items-center justify-between"},oo=Y({__name:"SendToFlowModal",props:je({flowResult:{type:Object,required:!1,default:()=>null},outputImgSrc:{type:String,required:!0},outputParamIndex:{type:Number,required:!0},inputParamsMapped:{type:Object,required:!0},isChildTask:{type:Boolean,required:!1,default:!1},translatePrompt:{type:Boolean,required:!1,default:!1}},{show:{default:!1,type:Boolean},showModifiers:{}}),emits:je(["update:show"],["update:show"]),setup(e,{emit:l}){const t=e,a=ze(e,"show"),i=de(),o=T(()=>i.sub_flows.map(F=>({value:F.name,label:`${F.display_name} - ${F.description}`}))),s=S(o.value[0]||""),f=S(!1),p=l;function b(){console.debug("[Send to flow]: ",s.value);const F=i.sub_flows.find(x=>x.name===s.value.value&&x.display_name===s.value.label.split(" - ")[0]);if(console.debug("[Send to flow]: targetFlow",F),!F){Ne().add({title:`Target sub-flow "${s.value.value}" not found`,description:"Please, verify the target sub-flow is installed and available and try again",timeout:5e3});return}const P=F.input_params.reduce((x,R)=>{const O={};return R.type==="text"?O[R.name]={value:R.default||"",type:R.type}:R.type==="number"?O[R.name]={value:R.default||0,type:R.type}:R.type==="image"?O[R.name]={value:JSON.stringify({task_id:t.flowResult.task_id,node_id:t.flowResult.outputs.length>1?t.flowResult.outputs[t.outputParamIndex].comfy_node_id:t.flowResult.outputs[0].comfy_node_id})||"",type:R.type}:R.type==="list"?O[R.name]={value:R.default||Object.keys(R.options)[0]||"",type:R.type,options:R.options}:R.type==="bool"?O[R.name]={value:R.default||!1,type:R.type}:["range","range_scale"].includes(R.type)&&(O[R.name]={value:R.default||0,type:R.type}),x.push(O),x},[]);console.debug("[Send to flow]: input_params_map",P),f.value=!0,i.runFlow(F,P,1,t.translatePrompt,h.value,h.value?Number(t.flowResult.task_id):null).finally(()=>{f.value=!1,p("update:show",!1)})}const h=S(!1),$=T(()=>{var F;return t.flowResult.progress===100&&((F=t.flowResult)==null?void 0:F.error)===""});return Be(()=>{var P,x;const F=t.flowResult?((x=(P=t==null?void 0:t.flowResult)==null?void 0:P.outputs[t.outputParamIndex])==null?void 0:x.type)??"image":"image";i.fetchSubFlows(F).then(()=>{s.value=o.value[0]||""}),h.value=!1}),(F,P)=>{const x=ke,R=ht,O=nt,k=Ae,m=oe,d=Ce;return c(),I(d,{modelValue:a.value,"onUpdate:modelValue":P[2]||(P[2]=r=>a.value=r),class:"z-[90]",transition:!1},{default:M(()=>[y("div",Yl,[P[4]||(P[4]=y("h2",{class:"text-lg text-center mb-4"},"Send to flow",-1)),y("div",Zl,[n($)?(c(),I(x,{key:0,src:e.outputImgSrc,class:"w-1/2 rounded-lg",draggable:!1},null,8,["src"])):(c(),I(R,{key:1,color:"orange",icon:"i-heroicons-exclamation-circle-solid",title:`Task is still running (${Math.ceil(e.flowResult.progress)}%, ${e.flowResult.execution_time.toFixed(2)}s)`,description:e.flowResult.error!==""?e.flowResult.error:""},null,8,["title","description"]))]),e.inputParamsMapped?(c(),U("p",eo,W(["#"+e.flowResult.task_id,...Object.keys(e.inputParamsMapped).filter(r=>e.inputParamsMapped[r].value!=="").map(r=>`${e.inputParamsMapped[r].display_name}: ${e.inputParamsMapped[r].value}`)].join(" | ")),1)):C("",!0),y("p",to,[n(o).length>0?(c(),I(O,{key:0,modelValue:n(s),"onUpdate:modelValue":P[0]||(P[0]=r=>Q(s)?s.value=r:null),class:"w-full",size:"lg",options:n(o)},null,8,["modelValue","options"])):(c(),U("span",no,"No sub-flows available"))]),e.isChildTask?(c(),I(R,{key:1,class:"mb-4",icon:"i-heroicons-exclamation-circle-solid",title:"Child task",description:"The latest child task is always used as input for sub-flow"})):C("",!0),y("div",lo,[v(k,{modelValue:n(h),"onUpdate:modelValue":P[1]||(P[1]=r=>Q(h)?h.value=r:null),label:"Bind as child task"},null,8,["modelValue"]),v(m,{icon:"i-heroicons-arrow-uturn-up-solid",color:"violet",variant:"outline",loading:n(f),disabled:n(o).length===0||e.isChildTask&&!n($),onClick:b},{default:M(()=>P[3]||(P[3]=[N(" Send ")])),_:1},8,["loading","disabled"])])])]),_:1},8,["modelValue"])}}}),ao={class:"flex flex-col md:flex-row items-center justify-center mb-5 sticky top-1 z-[10]"},so={class:"flex items-center justify-center"},io={class:"p-4"},ro={class:"text-md text-center text-red-500 mb-4"},uo={class:"flex justify-center"},co={key:0,class:"results overflow-auto"},mo=["id"],fo={class:"text-sm text-slate-500 text-center mb-1"},po={class:"w-5/6 mx-auto flex flex-wrap items-center justify-center"},go={class:"w-full flex justify-center items-center"},vo={key:1,class:"text-center text-slate-500"},ho=Y({__name:"Output",emits:["copy-prompt-inputs"],setup(e,{emit:l}){const t=de(),a=T(()=>{var _;return t.flowResultsByName((_=t.currentFlow)==null?void 0:_.name).length>0||!1}),i=T(()=>{var _;return t.flowResultsByName((_=t.currentFlow)==null?void 0:_.name)||[]}),o=T(()=>t.$state.resultsPageSize);ce(i,()=>{i.value.length<=t.$state.resultsPageSize?t.$state.resultsPage=1:t.$state.resultsPage>Math.ceil(i.value.length/t.$state.resultsPageSize)&&(t.$state.resultsPage=Math.ceil(i.value.length/t.$state.resultsPageSize))}),ce(o,()=>{i.value.length<=t.$state.resultsPageSize?t.$state.resultsPage=1:t.$state.resultsPage>Math.ceil(i.value.length/t.$state.resultsPageSize)&&(t.$state.resultsPage=Math.ceil(i.value.length/t.$state.resultsPageSize)),t.saveUserOptions()}),et(()=>{t.$state.flow_results_filter="",t.$state.resultsPage=1});const s=l;function f(_){s("copy-prompt-inputs",_.input_params_mapped)}function p(_){x.value=_,P.value=!0}const b=S(null),h=S(!1);window.addEventListener("scroll",()=>{var _;h.value=window.scrollY>(((_=b.value)==null?void 0:_.offsetTop)+window.screen.height||0)});const $=T(()=>t.$state.resultsPage);ce($,()=>{const _=document.getElementById("output-container");_&&_.scrollIntoView({behavior:"smooth"})});const F=S(!1),P=S(!1),x=S(""),R=S(!1),O=S(!1),k=S(!1),m=S(""),d=S(null),r=S({}),g=S(0),V=S(!1);function u(_,z=0){if(_.child_tasks.length===0||!pt(_,z,_.outputs[z].comfy_node_id))d.value=_,m.value=ae({task_id:_.task_id,node_id:_.outputs[z].comfy_node_id}),r.value=_.input_params_mapped,V.value=!1;else{const E=ft(_,z,_.outputs[z].comfy_node_id);d.value=E,r.value=_.input_params_mapped,m.value=ae({task_id:E.task_id,node_id:E.outputs[0].comfy_node_id}),V.value=!0}g.value=z,k.value=!0}function w(_){var ne;const z=_.extra_flags!==null&&((ne=_==null?void 0:_.extra_flags)==null?void 0:ne.profiler_execution),E=[{label:"Comfy flow",labelClass:"text-blue-500 text-sm",icon:"i-heroicons-arrow-down-tray",iconClass:"bg-blue-500 h-4 w-4",click:()=>{var le;return t.downloadFlowComfy((le=t.currentFlow)==null?void 0:le.name,_.task_id)}}];z&&E.push({label:"Execution details",labelClass:"text-orange-500 text-sm",icon:"i-mdi-bug",iconClass:"bg-orange-500 h-4 w-4",click:()=>{_.execution_details?_.showExecutionDetailsModal=!0:t.fetchTaskHistoryItem(_.task_id).then(le=>{_.execution_details=le.execution_details,_.showExecutionDetailsModal=!0})}});const Z=[[{label:"Use params",labelClass:"text-cyan-500 text-sm",icon:"i-heroicons-document-duplicate-16-solid",iconClass:"bg-cyan-500 h-4 w-4",click:()=>f(_)}],E];return _.outputs.length===1&&_.outputs.every(le=>le.type==="image")&&Z.splice(1,0,[{label:"Send to flow",labelClass:"text-violet-500 text-sm",icon:"i-heroicons-arrow-uturn-up-solid",iconClass:"bg-violet-500 h-4 w-4",click:()=>{u(_)}}]),Z}return(_,z)=>{var H;const E=bl,Z=be,ne=Ee,le=Wt,ge=Xt,D=oe,A=qe,G=tt,ee=Ce,ie=Ul,ve=ql,L=Ll,se=Gl,xe=Kl,B=oo,q=ke;return c(),U("div",{id:"output-container",ref_key:"outputContainer",ref:b,class:"w-full p-4 ring-1 ring-gray-200 dark:ring-gray-800 rounded-lg shadow-md my-10"},[v(E,{show:n(h),class:"fixed bottom-5 right-5",target:"output-container"},null,8,["show"]),y("h2",{class:"text-lg font-bold cursor-pointer select-none flex items-center mb-3",onClick:z[0]||(z[0]=()=>{F.value=!n(F)})},[v(Z,{name:n(F)?"i-heroicons-chevron-down":"i-heroicons-chevron-up",class:"mr-2"},null,8,["name"]),N(" Output ("+W(n(i).filter(j=>j.parent_task_id===null).length)+") ",1)]),n(F)?C("",!0):(c(),U(te,{key:0},[y("div",ao,[v(ne,{modelValue:n(t).$state.flow_results_filter,"onUpdate:modelValue":z[1]||(z[1]=j=>n(t).$state.flow_results_filter=j),icon:"i-heroicons-magnifying-glass-20-solid",color:"white",class:"md:mr-3",label:"Filter by prompt",trailing:!0,placeholder:"Filter results by prompt"},null,8,["modelValue"]),n(i).filter(j=>j.parent_task_id===null).length>n(t).$state.resultsPageSize?(c(),I(le,{key:0,modelValue:n(t).$state.resultsPage,"onUpdate:modelValue":z[2]||(z[2]=j=>n(t).$state.resultsPage=j),class:"my-1 md:my-0","page-count":n(t).$state.resultsPageSize,total:n(i).filter(j=>j.parent_task_id===null).length,"show-first":"","show-last":""},null,8,["modelValue","page-count","total"])):C("",!0),y("div",so,[v(ge,{modelValue:n(t).resultsPageSize,"onUpdate:modelValue":z[3]||(z[3]=j=>n(t).resultsPageSize=j),class:"md:mx-3 w-fit mr-3",options:[5,10,20,50,100],label:"Results per page"},null,8,["modelValue"]),v(A,{items:[[{label:"Delete all results",labelClass:"text-red-500",icon:"i-heroicons-trash",iconClass:"dark:text-red-500 text-red-500",click:()=>R.value=!0}]],mode:"click",label:"Options",popper:{placement:"bottom-end"}},{default:M(()=>[v(D,{color:"white",icon:"i-heroicons-ellipsis-vertical-16-solid"})]),_:1},8,["items"])]),v(ee,{modelValue:n(R),"onUpdate:modelValue":z[6]||(z[6]=j=>Q(R)?R.value=j:null),class:"z-[90]",transition:!1},{default:M(()=>[y("div",io,[z[15]||(z[15]=y("p",{class:"text-lg text-center mb-4"},"Are you sure you want to delete all results?",-1)),y("p",ro,[z[11]||(z[11]=N(" All history and images of ")),v(G,{class:"mx-1",color:"orange",variant:"outline"},{default:M(()=>[N(W(n(t).currentFlow.display_name),1)]),_:1}),z[12]||(z[12]=N(" will be deleted. "))]),y("div",uo,[v(D,{class:"mr-2",color:"red",variant:"outline",loading:n(O),onClick:z[4]||(z[4]=()=>{var j;O.value=!0,n(t).deleteFlowResults((j=n(t).currentFlow)==null?void 0:j.name).then(()=>{O.value=!1,R.value=!1})})},{default:M(()=>z[13]||(z[13]=[N(" Yes ")])),_:1},8,["loading"]),v(D,{variant:"outline",onClick:z[5]||(z[5]=()=>R.value=!1)},{default:M(()=>z[14]||(z[14]=[N("No")])),_:1})])])]),_:1},8,["modelValue"])]),n(a)?(c(),U("div",co,[(c(!0),U(te,null,me(n(t).flowResultsByNamePaginated((H=n(t).currentFlow)==null?void 0:H.name),j=>(c(),U("div",{id:"task_id_"+j.task_id,key:j.task_id,class:"flex flex-col justify-center mx-auto mb-5"},[j.outputs.some(X=>["image","image-animated"].includes(X.type))?(c(),I(ie,{key:0,"flow-result":j,"handle-send-to-flow":u,"open-image-modal":p},null,8,["flow-result"])):j.outputs.some(X=>X.type==="video")?(c(),I(ve,{key:1,"flow-result":j,"handle-send-to-flow":u,"open-image-modal":p},null,8,["flow-result"])):j.outputs.some(X=>X.type==="audio")?(c(),I(L,{key:2,"flow-result":j},null,8,["flow-result"])):C("",!0),y("div",fo,[y("div",po,[v(se,{"flow-result":j},null,8,["flow-result"])])]),v(xe,{"flow-result":j},null,8,["flow-result"]),y("div",go,[v(D,{class:"mr-3",color:"red",icon:"i-heroicons-trash",variant:"outline",size:"xs",onClick:()=>n(t).deleteFlowHistory(j.task_id)},{default:M(()=>z[16]||(z[16]=[N(" Delete ")])),_:2},1032,["onClick"]),v(A,{items:w(j),mode:"click",popper:{placement:"bottom-start"}},{default:M(()=>[v(D,{color:"white",icon:"i-heroicons-ellipsis-vertical-16-solid",size:"xs"})]),_:2},1032,["items"])])],8,mo))),128)),v(B,{show:n(k),"onUpdate:show":z[7]||(z[7]=j=>Q(k)?k.value=j:null),"flow-result":n(d),"output-img-src":n(m),"output-param-index":n(g),"input-params-mapped":n(r),"is-child-task":n(V)},null,8,["show","flow-result","output-img-src","output-param-index","input-params-mapped","is-child-task"])])):(c(),U("p",vo," No output results available "))],64)),v(ee,{modelValue:n(P),"onUpdate:modelValue":z[10]||(z[10]=j=>Q(P)?P.value=j:null),class:"z-[90]",transition:!1,fullscreen:""},{default:M(()=>[v(D,{class:"absolute top-4 right-4",icon:"i-heroicons-x-mark",variant:"ghost",onClick:z[8]||(z[8]=()=>P.value=!1)}),y("div",{class:"flex items-center justify-center w-full h-full p-4",onClick:z[9]||(z[9]=Ve(()=>P.value=!1,["left"]))},[n(x)?(c(),I(q,{key:0,class:"lg:h-full",fit:"inside",loading:"lazy",src:n(x)},null,8,["src"])):C("",!0)])]),_:1},8,["modelValue"])],512)}}}),wo={class:"flex flex-col lg:flex-row flex-grow items-start w-full"},yo={class:"card-wrapper w-full lg:pr-5"},bo={key:0,class:"p-0 text-sm"},ko={class:"flex flex-row items-center text-slate-400 mb-2"},xo={class:"flex flex-row flex-wrap items-center text-md mb-2"},_o=["href"],$o={class:"flex flex-row items-center text-md mb-2"},Co=["href"],Io={key:1},So={class:"flex flex-row items-center text-md mb-2"},Ro={key:0},Mo={class:"flex flex-row items-center text-md mb-2"},Po={key:0,class:"flex flex-row flex-wrap items-center text-md mb-2"},zo=["href"],Fo={key:1},Uo={class:"flex flex-row items-center mb-2"},Oo={key:1,class:"flex flex-row flex-wrap items-center text-md"},jo={key:0,class:"flex justify-end"},Bo={class:"flex flex-row items-center justify-center text-sm mr-2"},Vo={key:1},To={class:"text-sm flex justify-end"},No={class:"flex flex-row items-center justify-center text-sm mr-3"},qo={key:0,class:"text-right"},Eo={class:"prompt-wrapper w-full"},Do={class:"flex items-center justify-between"},Ao={class:"pb-2"},Wo={class:"flex justify-end items-center"},Zo=Y({__name:"[name]",setup(e){const l=qt(),t=de();t.setCurrentFlow(l.params.name);const a=T(()=>t.flowInstallingByName(l.params.name)),i=T(()=>{var d;return a.value&&((d=a.value)==null?void 0:d.progress)<100||!1}),o=S(!1),s=T(()=>{var d;return a.value?"error"in a.value&&((d=a.value)==null?void 0:d.error)!==""?`${a.value.progress.toFixed(0)}% Error setting up`:`${a.value.progress.toFixed(0)}% Setting up`:"Setup flow"}),f=S(!1),p=S(!1),b=T(()=>{var r;const d=[[{label:"Delete flow",icon:"i-heroicons-trash",click:$}]];return((r=t==null?void 0:t.currentFlow)==null?void 0:r.new_version_available)!==""&&d[0].unshift({label:`Update to ${t.currentFlow.new_version_available}`,icon:"i-heroicons-arrow-path",click:()=>{t.updateFlow(t.currentFlow)}}),d});function h(d,r=!1){f.value=!0,t.deleteFlow(d).then(()=>{r&&Et().push("/")}).finally(()=>{f.value=!1,p.value=!1})}function $(){var r;const d=((r=t.currentFlow)==null?void 0:r.private)||!1;if(d){p.value=!0;return}h(t.currentFlow,d)}const F=S(!1),P=S(null),x=function(d){var r;(r=P.value)==null||r.copyPromptInputs(d)},R=Ze(),O=T(()=>{var d;return(d=t.currentFlow)==null?void 0:d.models.filter(r=>r.installed).reduce((r,g)=>r+(g==null?void 0:g.file_size)||0,0)}),k=T(()=>{var d;return(d=t.currentFlow)==null?void 0:d.models.reduce((r,g)=>r+(g==null?void 0:g.file_size)||0,0)}),m=T(()=>!O.value&&!k.value?"":O.value===k.value?` - ${Se(k.value)}`:` - ${Se(O.value)} / ${Se(k.value)}`);return(d,r)=>{const g=be,V=Te,u=tt,w=oe,_=qe,z=Lt,E=tl,Z=yl,ne=ho,le=vt,ge=Ce,D=At;return c(),I(D,null,{default:M(()=>[!n(t).loading.flows_available&&!n(t).loading.flows_installed&&n(t).currentFlow&&!n(t).$state.loading.tasks_history?(c(),U(te,{key:0},[y("div",wo,[y("div",yo,[v(z,{as:"div",class:"w-full mb-5"},Dt({header:M(()=>{var A,G;return[y("h2",{class:"text-xl font-bold cursor-pointer select-none flex items-center",onClick:r[0]||(r[0]=()=>{F.value=!n(F)})},[(A=n(t).currentFlow)!=null&&A.private?(c(),I(V,{key:0,text:"This flow is local, manually added"},{default:M(()=>{var ee;return[v(g,{name:"i-heroicons-lock-closed",class:K(["mr-2",{"text-stone-500":!((ee=n(t).currentFlow)!=null&&ee.is_supported_by_workers)}])},null,8,["class"])]}),_:1})):C("",!0),v(g,{name:n(F)?"i-heroicons-chevron-down":"i-heroicons-chevron-up",class:"mr-2"},null,8,["name"]),v(V,{text:(G=n(t).currentFlow)!=null&&G.is_supported_by_workers?"":"No workers capable of running this flow",popper:{placement:"top"}},{default:M(()=>{var ee,ie;return[y("span",{class:K({"text-stone-500":!((ee=n(t).currentFlow)!=null&&ee.is_supported_by_workers)})},W((ie=n(t).currentFlow)==null?void 0:ie.display_name),3)]}),_:1},8,["text"])])]}),default:M(()=>{var A,G,ee,ie,ve,L,se,xe,B,q,H,j,X,re,ue,fe,he;return[n(F)?C("",!0):(c(),U("div",bo,[y("p",ko,W((A=n(t).currentFlow)==null?void 0:A.description),1),y("p",xo,[v(g,{name:"i-heroicons-user-16-solid",class:"mr-1"}),r[8]||(r[8]=y("b",null,"Author:",-1)),r[9]||(r[9]=N("  ")),y("a",{class:"hover:underline text-md",href:(G=n(t).currentFlow)==null?void 0:G.homepage,rel:"noopener",target:"_blank"},W((ee=n(t).currentFlow)==null?void 0:ee.author),9,_o)]),y("p",$o,[v(g,{name:"i-heroicons-document-text",class:"mr-1"}),(ie=n(t).currentFlow)!=null&&ie.documentation?(c(),U("a",{key:0,class:"hover:underline",href:(ve=n(t).currentFlow)==null?void 0:ve.documentation,rel:"noopener",target:"_blank"}," Documentation ",8,Co)):(c(),U("span",Io,"No documentation"))]),y("p",So,[v(g,{name:"i-heroicons-clock",class:"mr-1"}),r[10]||(r[10]=y("b",null,"Version:",-1)),r[11]||(r[11]=N("  ")),y("span",null,W((L=n(t).currentFlow)==null?void 0:L.version),1),((se=n(t).currentFlow)==null?void 0:se.new_version_available)!==""?(c(),U("span",Ro,"  (new version available: "+W((xe=n(t).currentFlow)==null?void 0:xe.new_version_available)+") ",1)):C("",!0)]),y("p",Mo,[v(g,{name:"i-heroicons-tag",class:"mr-1"}),r[12]||(r[12]=y("b",null,"Tags:",-1)),r[13]||(r[13]=N("  ")),((B=n(t).currentFlow)==null?void 0:B.tags.length)>0?(c(!0),U(te,{key:0},me((q=n(t).currentFlow)==null?void 0:q.tags,J=>(c(),I(u,{key:J,label:J,color:"white",variant:"solid",class:"m-1"},null,8,["label"]))),128)):(c(),I(u,{key:1,label:"No tags",color:"white",variant:"solid",class:"m-1"}))]),((j=(H=n(t).currentFlow)==null?void 0:H.models)==null?void 0:j.length)>0?(c(),U("p",Po,[v(g,{name:"i-heroicons-arrow-down-on-square-stack",class:"mr-1"}),v(V,{text:n(k)-n(O)>0?`${("formatBytes"in d?d.formatBytes:n(Se))(n(k)-n(O))} to download`:"All models installed",popper:{placement:"top"}},{default:M(()=>{var J;return[y("b",null,"Models ("+W((J=n(t).currentFlow)==null?void 0:J.models.length)+W(n(m))+"):",1),r[14]||(r[14]=N("  "))]}),_:1},8,["text"]),(c(!0),U(te,null,me((X=n(t).currentFlow)==null?void 0:X.models,J=>(c(),I(u,{key:J.name,class:"m-1",color:"white",variant:"solid"},{default:M(()=>[v(V,{text:J.installed?"Model installed":"Model not installed"},{default:M(()=>[v(g,{name:J.installed?"i-heroicons-check-circle-20-solid":"i-heroicons-x-mark-20-solid",class:K(J.installed?"text-green-500":"text-orange-500")},null,8,["name","class"])]),_:2},1032,["text"]),J.gated?(c(),I(V,{key:0,text:"Gated model, requires auth token for download",popper:{placement:"top"}},{default:M(()=>[v(g,{name:"i-heroicons-key",class:"mr-1"})]),_:1})):C("",!0),y("a",{class:"hover:underline underline-offset-4",href:J.homepage,rel:"noopener",target:"_blank"},W(J.name),9,zo),J.file_size?(c(),U("span",Fo," ("+W(("formatBytes"in d?d.formatBytes:n(Se))(J.file_size))+") ",1)):C("",!0)]),_:2},1024))),128))])):C("",!0),y("p",Uo,[v(g,{name:"i-mdi-help-network-outline",class:"mr-1"}),r[17]||(r[17]=y("b",null,"Platforms:",-1)),r[18]||(r[18]=N("  ")),v(V,{text:"Linux"},{default:M(()=>[v(g,{name:"i-mdi-linux",class:"mr-1"})]),_:1}),v(V,{text:"Microsoft Windows"},{default:M(()=>[v(g,{name:"i-mdi-microsoft-windows",class:"mr-1"})]),_:1}),n(t).currentFlow.is_macos_supported?(c(),I(V,{key:0,text:"macOS"},{default:M(()=>[v(g,{name:"i-mdi-apple",class:"mr-1"})]),_:1})):C("",!0),(re=n(t).currentFlow)!=null&&re.required_memory_gb?(c(),I(V,{key:1,class:"flex flex-row items-center",text:"Required VRAM memory (GB)"},{default:M(()=>{var J;return[r[15]||(r[15]=N(" (")),v(g,{name:"i-mdi-memory",class:"mr-1"}),y("span",null,W((J=n(t).currentFlow)==null?void 0:J.required_memory_gb)+" GB",1),r[16]||(r[16]=N(") "))]}),_:1})):C("",!0)]),((fe=(ue=n(t).currentFlow)==null?void 0:ue.requires)==null?void 0:fe.length)>0?(c(),U("p",Oo,[r[19]||(r[19]=y("b",null,"Requires:",-1)),r[20]||(r[20]=N("  ")),(c(!0),U(te,null,me((he=n(t).currentFlow)==null?void 0:he.requires,J=>(c(),I(u,{key:J,class:"m-1",color:"yellow",variant:"outline"},{default:M(()=>[N(W(J),1)]),_:2},1024))),128))])):C("",!0)]))]}),_:2},[n(F)?void 0:{name:"footer",fn:M(()=>{var A,G;return[n(R).isAdmin?(c(),U("div",jo,[y("div",Bo,[v(g,{name:n(t).isFlowInstalled(n(l).params.name)?"i-heroicons-check-badge":"i-heroicons-x-mark",class:"mx-1"},null,8,["name"]),y("span",{class:K({"text-green-500":n(t).isFlowInstalled(n(l).params.name),"text-red-500":!n(t).isFlowInstalled(n(l).params.name),"text-stone-500":n(t).isFlowInstalled(n(l).params.name)&&!((A=n(t).currentFlow)!=null&&A.is_supported_by_workers)})},W(n(t).isFlowInstalled(n(l).params.name)?(G=n(t).currentFlow)!=null&&G.is_supported_by_workers?"Installed":"Installed (no workers)":"Not installed"),3)]),n(t).isFlowInstalled(n(l).params.name)?C("",!0):(c(),I(V,{key:0,text:"Setup flow dependencies and configure it in ComfyUI",popper:{placement:"top"},"open-delay":500},{default:M(()=>[v(w,{icon:"i-heroicons-arrow-down-tray",class:"mx-3",color:"primary",variant:"outline",loading:n(i),onClick:r[1]||(r[1]=()=>n(t).setupFlow(n(t).currentFlow))},{default:M(()=>[N(W(n(s)),1)]),_:1},8,["loading"])]),_:1})),!n(t).isFlowInstalled(n(l).params.name)&&n(i)?(c(),I(V,{key:1,text:"Cancel flow installation",popper:{placement:"top"},"open-delay":500},{default:M(()=>[v(w,{icon:"i-heroicons-stop",variant:"outline",color:"orange",loading:n(o),onClick:r[2]||(r[2]=()=>{o.value=!0,n(t).cancelFlowSetup(n(t).currentFlow).then(()=>{o.value=!1})})},{default:M(()=>r[21]||(r[21]=[N(" Cancel ")])),_:1},8,["loading"])]),_:1})):C("",!0),n(t).isFlowInstalled(n(l).params.name)?(c(),I(_,{key:2,items:n(b),mode:"click",label:"Actions",popper:{placement:"bottom-end"}},{default:M(()=>[v(w,{color:"white",label:"Actions","trailing-icon":"i-heroicons-chevron-down-20-solid"})]),_:1},8,["items"])):C("",!0)])):(c(),U("div",Vo,[y("div",To,[y("div",No,[v(g,{name:n(t).isFlowInstalled(n(l).params.name)?"i-heroicons-check-badge":"i-heroicons-x-mark",class:"mx-1"},null,8,["name"]),y("span",{class:K({"text-green-500":n(t).isFlowInstalled(n(l).params.name),"text-red-500":!n(t).isFlowInstalled(n(l).params.name)})},W(n(t).isFlowInstalled(n(l).params.name)?"Installed":"Not installed"),3)]),n(t).isFlowInstalled(n(l).params.name)?C("",!0):(c(),U("div",qo,r[22]||(r[22]=[y("p",{class:"text-orange-500"},"Only admin can manage workflows.",-1),y("span",{class:"text-slate-500"},"Ask your admin to setup this workflow",-1)])))])]))]}),key:"0"}]),1024)]),y("div",Eo,[!n(f)&&n(t).isFlowInstalled(n(l).params.name)?(c(),I(E,{key:0,ref_key:"workflowPrompt",ref:P},null,512)):C("",!0)])]),!n(f)&&n(t).isFlowInstalled(n(l).params.name)?(c(),I(Z,{key:0})):C("",!0),!n(f)&&n(t).isFlowInstalled(n(l).params.name)||n(t).flowResultsByName(n(l).params.name).length>0?(c(),I(ne,{key:1,onCopyPromptInputs:r[3]||(r[3]=A=>x(A))})):C("",!0)],64)):(c(),I(le,{key:1,class:"mb-3"})),v(ge,{modelValue:n(p),"onUpdate:modelValue":r[7]||(r[7]=A=>Q(p)?p.value=A:null),"prevent-close":""},{default:M(()=>[v(z,{ui:{ring:"",divide:"divide-y divide-gray-100 dark:divide-gray-800"}},{header:M(()=>[y("div",Do,[r[23]||(r[23]=y("h3",{class:"text-base font-semibold leading-6 text-gray-900 dark:text-white"}," Confirm workflow deletion ",-1)),v(w,{color:"gray",variant:"ghost",icon:"i-heroicons-x-mark-20-solid",class:"-my-1",onClick:r[4]||(r[4]=A=>p.value=!1)})])]),default:M(()=>{var A;return[y("p",Ao,[r[24]||(r[24]=N(" Are you sure you want to delete the ")),r[25]||(r[25]=y("b",null,"private",-1)),r[26]||(r[26]=N(" workflow ")),y("b",null,W((A=n(t).currentFlow)==null?void 0:A.display_name),1),r[27]||(r[27]=N("? "))]),y("div",Wo,[v(w,{icon:"i-heroicons-x-mark-16-solid",variant:"outline",color:"green",class:"mr-2",onClick:r[5]||(r[5]=G=>p.value=!1)},{default:M(()=>r[28]||(r[28]=[N(" Cancel ")])),_:1}),v(w,{icon:"i-heroicons-trash",variant:"outline",color:"red",onClick:r[6]||(r[6]=G=>{var ee;return h(n(t).currentFlow,((ee=n(t).currentFlow)==null?void 0:ee.private)||!1)})},{default:M(()=>r[29]||(r[29]=[N(" Delete ")])),_:1})])]}),_:1})]),_:1},8,["modelValue"])]),_:1})}}});export{Zo as default};
