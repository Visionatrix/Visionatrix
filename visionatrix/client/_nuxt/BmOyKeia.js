import{_ as ne}from"./CceQ2CKC.js";import{_ as ie}from"./LHNEU0ua.js";import{_ as re,o as r,c as y,a as m,F as N,r as de,q as B,b as d,w as i,s as P,i as $,h as H,l as p,t as _,v as R,x as K,f as q,y as ue,z as T,A as fe,B as J,C as ce,D as me,E as pe,u as ye,G as ve,H as ge,I as _e,J as u,K as G,m as o,L as F,k as be,d as v,j as Ce,M as Ue,p as ke}from"./Dq0jrfx7.js";import{_ as he}from"./B040z7Qo.js";import{_ as we}from"./xc5SGlJ_.js";import{_ as Ie}from"./DCI_nVWM.js";import{_ as Ve}from"./Cmh3cDjc.js";import"./B2j_fnh6.js";const xe={wrapper:"relative min-w-0",ol:"flex items-center gap-x-1.5",li:"flex items-center gap-x-1.5 text-gray-500 dark:text-gray-400 text-sm leading-6 min-w-0",base:"flex items-center gap-x-1.5 group font-semibold min-w-0",label:"block truncate",icon:{base:"flex-shrink-0 w-5 h-5",active:"",inactive:""},divider:{base:"flex-shrink-0 w-5 h-5 rtl:rotate-180"},active:"text-primary-500 dark:text-primary-400",inactive:" hover:text-gray-700 dark:hover:text-gray-200",default:{divider:"i-heroicons-chevron-right-20-solid"}},O=fe(J.ui.strategy,J.ui.breadcrumb,xe),Fe=q({components:{UIcon:H,ULink:K},inheritAttrs:!1,props:{links:{type:Array,default:()=>[]},divider:{type:String,default:()=>O.default.divider},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})}},setup(t){const{ui:L,attrs:f}=ue("breadcrumb",T(t,"ui"),O,T(t,"class"));return{ui:L,attrs:f,getULinkProps:pe,twMerge:me,twJoin:ce}}}),Be={key:1,role:"presentation"};function $e(t,L,f,k,h,j){const n=H,w=K;return r(),y("nav",R({"aria-label":"Breadcrumb",class:t.ui.wrapper},t.attrs),[m("ol",{class:B(t.ui.ol)},[(r(!0),y(N,null,de(t.links,(s,c)=>(r(),y("li",{key:c,class:B(t.ui.li)},[d(w,R({as:"span",class:[t.ui.base,c===t.links.length-1?t.ui.active:s.to?t.ui.inactive:""],"aria-current":c===t.links.length-1?"page":void 0,ref_for:!0},t.getULinkProps(s),{onClick:s.click}),{default:i(()=>[P(t.$slots,"icon",{link:s,index:c,isActive:c===t.links.length-1},()=>[s.icon?(r(),$(n,{key:0,name:s.icon,class:B(t.twMerge(t.twJoin(t.ui.icon.base,c===t.links.length-1?t.ui.icon.active:s.to?t.ui.icon.inactive:""),s.iconClass))},null,8,["name","class"])):p("",!0)]),P(t.$slots,"default",{link:s,index:c,isActive:c===t.links.length-1},()=>[s.label?(r(),y("span",{key:0,class:B(t.twMerge(t.ui.label,s.labelClass))},_(s.label),3)):p("",!0)])]),_:2},1040,["class","aria-current","onClick"]),c<t.links.length-1?P(t.$slots,"divider",{key:0},()=>[t.divider?(r(),y(N,{key:0},[t.divider.startsWith("i-")?(r(),$(n,{key:0,name:t.divider,class:B(t.ui.divider.base),role:"presentation"},null,8,["name","class"])):(r(),y("span",Be,_(t.divider),1))],64)):p("",!0)]):p("",!0)],2))),128))],2)],16)}const ze=re(Fe,[["render",$e]]),Ae={class:"flex flex-col md:flex-row"},Le={class:"px-5 pb-5 md:w-4/5"},Se={key:0,class:"admin-settings mb-3"},Me={class:"mt-3 mb-5"},De={key:0},Ee={key:1},Pe={class:"flex flex-row w-full md:flex-col"},Ge={class:"flex mt-3"},je={class:"p-4 max-h-screen"},Ne={key:0,class:"text-slate-500 truncate"},Re=["onClick"],Xe=q({__name:"comfyui",setup(t){ye({title:"ComfyUI settings - Visionatrix",meta:[{name:"description",content:"ComfyUI settings - Visionatrix"}]});const L=ve(),f=ge(),k=_e(),h=u(!1),j=u(!1),n=u([]),w=u("../vix_models"),s=u(""),c=G(()=>n.value.length===0?[]:s.value===""?Object.keys(n.value).map(a=>{let e=0;return n.value[a].length>0&&(e=n.value[a].reduce((b,g)=>b+(g.total_size??0),0)),{full_path:a,total_size:e,create_time:null,is_default:null,readonly:null}}):n.value[s.value]??[]),W=G(()=>{const a=[{label:"Root",to:""}];if(s.value==="")return a;const e=s.value.split("/");let b="";return e.forEach(g=>{b+=g,a.push({label:g,to:b}),b+="/"}),a}),I=u([]),Q=G(()=>{const a=[{key:"full_path",label:"Path",sortable:!0,class:""},{key:"total_size",label:"Size",sortable:!0,class:""},{key:"create_time",label:"Created time",sortable:!0,class:""}];return s.value!==""&&a.push({key:"actions",label:"Actions",sortable:!1,class:""}),a});function X(a){a.full_path in n.value&&(s.value=a.full_path)}const S=u(!1);function Y(){S.value=!0,f.performComfyUiAutoconfig(w.value).then(a=>{"folders"in a&&(console.debug("[DEBUG] ComfyUI folders: ",a.folders),n.value=a.folders,k.add({title:"Autoconfig performed",description:"Autoconfig performed successfully"}))}).catch(a=>{k.add({title:"Error performing autoconfig",description:a.details})}).finally(()=>{S.value=!1})}const M=u(null),D=u(!1),z=u(""),V=u(!1),x=u(""),A=u(!1),E=u(!1);return(a,e)=>{const b=ne,g=ie,C=be,Z=he,ee=we,oe=Ce,le=ze,te=Ie,se=Ve,ae=ke;return r(),$(ae,{class:"lg:h-dvh"},{default:i(()=>[m("div",Ae,[d(b,{links:o(f).links,class:"md:w-1/5"},null,8,["links"]),m("div",Le,[o(L).isAdmin?(r(),y("div",Se,[e[19]||(e[19]=m("h3",{class:"mb-3 text-xl font-bold"},"ComfyUI settings (global)",-1)),m("div",Me,[o(f).settingsMap.comfyui_folders.value!==""?(r(),$(ee,{key:0,size:"md",class:"py-3",label:"ComfyUI models folder",description:"Relative or absolute path to the models folders"},{default:i(()=>[o(f).settingsMap.comfyui_folders.value===""?(r(),y("div",De,[e[12]||(e[12]=m("p",{class:"text-gray-500"},"No ComfyUI folders initialized.",-1)),d(g,{modelValue:o(w),"onUpdate:modelValue":e[0]||(e[0]=l=>F(w)?w.value=l:null),placeholder:"ComfyUI folder path",class:"w-fit mt-3",type:"text",size:"sm",icon:"i-heroicons-folder-16-solid",disabled:o(S),autocomplete:"off"},null,8,["modelValue","disabled"]),d(C,{class:"mt-3",icon:"i-heroicons-cog-6-tooth-20-solid",color:"orange",loading:o(S),onClick:Y},{default:i(()=>e[11]||(e[11]=[v(" Perform autoconfig ")])),_:1},8,["loading"])])):p("",!0),o(D)?(r(),y("div",Ee,[m("div",Pe,[d(g,{modelValue:o(x),"onUpdate:modelValue":e[1]||(e[1]=l=>F(x)?x.value=l:null),ref_key:"newComfyUiFolderInput",ref:M,placeholder:"ComfyUI folder path (relative or absolute)",class:"w-fit mt-3",type:"text",size:"sm",icon:"i-heroicons-folder-16-solid",autocomplete:"off",disable:o(V)},null,8,["modelValue","disable"]),d(g,{modelValue:o(z),"onUpdate:modelValue":e[2]||(e[2]=l=>F(z)?z.value=l:null),placeholder:"ComfyUI folder key root path",class:"w-fit mt-3",type:"text",size:"sm",icon:"i-heroicons-folder-16-solid",autocomplete:"off",disable:o(V)},null,8,["modelValue","disable"]),d(Z,{modelValue:o(A),"onUpdate:modelValue":e[3]||(e[3]=l=>F(A)?A.value=l:null),class:"mt-3",label:"Is default"},null,8,["modelValue"])]),m("div",Ge,[d(C,{class:"mr-2",color:"white",icon:"i-heroicons-x-mark",variant:"outline",disabled:o(V),onClick:e[4]||(e[4]=()=>{D.value=!1,x.value="",z.value="",A.value=!1})},{default:i(()=>e[13]||(e[13]=[v(" Cancel ")])),_:1},8,["disabled"]),d(C,{icon:"i-heroicons-check-16-solid",loading:o(V),onClick:e[5]||(e[5]=()=>{o(x)!==""&&(V.value=!0,o(f).addComfyUiFolder(o(z),o(x),o(A)).then(l=>{"folders"in l&&(console.debug("[DEBUG] ComfyUI folders: ",l.folders),n.value=l.folders,o(k).add({title:"ComfyUI folder added",description:"ComfyUI folder added successfully"}))}).finally(()=>{V.value=!1}))})},{default:i(()=>e[14]||(e[14]=[v(" Add ")])),_:1},8,["loading"])])])):p("",!0),o(f).settingsMap.comfyui_folders.value!==""?(r(),$(C,{key:2,class:"mt-3",icon:"i-heroicons-folder-16-solid",color:"cyan",onClick:e[6]||(e[6]=()=>{o(f).getComfyUiFolderListing().then(l=>{console.debug("[DEBUG] ComfyUI folders: ",l),n.value=l.folders}),h.value=!0})},{default:i(()=>e[15]||(e[15]=[v(" Show ComfyUI folders ")])),_:1})):p("",!0),o(f).settingsMap.comfyui_folders.value!==""?(r(),$(C,{key:3,class:"mt-3 ml-2",color:"white",variant:"outline",icon:"i-heroicons-folder-plus-16-solid",onClick:e[7]||(e[7]=()=>{D.value=!0,a.$nextTick(()=>{o(M)&&o(M).$refs.input.focus()})})},{default:i(()=>e[16]||(e[16]=[v(" Add ComfyUI folder ")])),_:1})):p("",!0)]),_:1})):p("",!0),d(se,{modelValue:o(h),"onUpdate:modelValue":e[10]||(e[10]=l=>F(h)?h.value=l:null),class:"z-[90]",fullscreen:""},{default:i(()=>[d(C,{class:"absolute top-4 right-4",icon:"i-heroicons-x-mark",variant:"ghost",onClick:e[8]||(e[8]=()=>h.value=!1)}),m("div",je,[e[18]||(e[18]=m("h3",{class:"text-xl text-center"},"ComfyUI folders",-1)),o(I).length>0?(r(),y("p",Ne," Selected folders ("+_(o(I).length)+"): "+_(o(I).map(l=>l.full_path).join(", ")),1)):p("",!0),d(le,{links:o(W),class:"my-2"},{default:i(({link:l,isActive:U})=>[d(oe,{color:U?"primary":"gray",class:"rounded-full truncate cursor-pointer select-none",onClick:()=>{s.value=l.to}},{default:i(()=>[v(_(l.label),1)]),_:2},1032,["color","onClick"])]),_:1},8,["links"]),d(te,{modelValue:o(I),"onUpdate:modelValue":e[9]||(e[9]=l=>F(I)?I.value=l:null),loading:o(j),"loading-state":{icon:"i-heroicons-arrow-path-20-solid",label:"Loading..."},rows:o(c),columns:o(Q),style:{"max-height":"80vh"}},{"full_path-data":i(({row:l})=>[m("span",{class:B({"text-blue-500":l.full_path in o(n),"cursor-pointer":l.full_path in o(n)}),onClick:()=>X(l)},_(l.full_path),11,Re)]),"total_size-data":i(({row:l})=>[v(_(l.total_size?("formatBytes"in a?a.formatBytes:o(Ue))(l.total_size):"-"),1)]),"create_time-data":i(({row:l})=>[v(_(l.create_time?new Date(l.create_time).toLocaleString():"-"),1)]),"actions-data":i(({row:l})=>[d(C,{icon:"i-heroicons-trash-16-solid",variant:"outline",color:"red",loading:o(E),disabled:l.readonly===!0,onClick:()=>{E.value=!0,o(f).deleteComfyUiFolder(o(s),l.full_path).then(U=>{"folders"in U&&(console.debug("[DEBUG] ComfyUI folders: ",U.folders),n.value=U.folders,o(k).add({title:"ComfyUI folder removed",description:"ComfyUI folder removed successfully"}),o(n).value[o(s)]||(s.value=""))}).catch(U=>{o(k).add({title:"Error removing ComfyUI folder",description:U.details})}).finally(()=>{E.value=!1})}},{default:i(()=>e[17]||(e[17]=[v(" Remove ")])),_:2},1032,["loading","disabled","onClick"])]),_:1},8,["modelValue","loading","rows","columns"])])]),_:1},8,["modelValue"])])])):p("",!0)])])]),_:1})}}});export{Xe as default};
