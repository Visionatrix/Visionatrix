import{_ as T,a as W}from"./DUBF4uGr.js";import{_ as q}from"./CxOE70TE.js";import{_ as I,a as D,b as P}from"./yukO1VJJ.js";import{_ as E}from"./D5PrDcmw.js";import{f as A,g as F,c as m,o as n,b as l,w as i,a,t as p,d as $,h as R,i as c,F as z,r as L,j as G,k,l as H,m as M,n as N,p as t,u as J,q as K,s as Q,v as j,x as O,y as X,z as Y}from"./D6rcjpW4.js";import{_ as Z}from"./DlCB8Lx3.js";const ee={class:"p-4 w-full md:w-6/12 lg:w-4/12 z-[10]"},te={class:"flex flex-grow justify-between"},oe=["title"],se={class:"flex flex-col items-between text-sm"},le=["title"],ne={class:"flex flex-row flex-wrap items-center mb-2"},ae={class:"flex flex-row items-center"},ie=["href"],re={class:"flex flex-row items-center mb-2"},fe=["href"],de={key:1},me={class:"flex flex-row items-center mb-2"},ce={class:"flex flex-row items-center"},_e=A({__name:"ListItem",props:{flow:{type:Object,required:!0}},setup(o){const e=F();return(B,s)=>{const d=R,u=H,v=M,C=G,r=I;return n(),m("div",ee,[l(r,{as:"div",class:"hover:shadow-md"},{header:i(()=>{var _,h,x;return[a("div",te,[a("h2",{class:"text-xl font-bold truncate flex items-center",title:(_=o.flow)==null?void 0:_.display_name},[(h=o.flow)!=null&&h.private?(n(),c(u,{key:0,text:"This flow is local, manually added"},{default:i(()=>[l(d,{name:"i-heroicons-lock-closed",class:N(["mr-2",{"text-stone-500":!o.flow.is_supported_by_workers}])},null,8,["class"])]),_:1})):k("",!0),l(u,{text:o.flow.is_supported_by_workers?"":"No workers capable of running this flow",popper:{placement:"top"}},{default:i(()=>{var w;return[a("span",{class:N({"text-stone-500":!o.flow.is_supported_by_workers})},p((w=o.flow)==null?void 0:w.display_name),3)]}),_:1},8,["text"])],8,oe),t(e).isFlowInstalled((x=o.flow)==null?void 0:x.name)?(n(),c(u,{key:0,text:"Mark flow as favorite",class:"ml-3",popper:{placement:"top"},"open-delay":500},{default:i(()=>[l(v,{icon:t(e).isFlowFavorite(o.flow.name)?"i-heroicons-star-16-solid":"i-heroicons-star",variant:"outline",color:"yellow",onClick:s[0]||(s[0]=w=>t(e).markFlowFavorite(o.flow))},null,8,["icon"])]),_:1})):k("",!0)])]}),footer:i(()=>{var _;return[l(v,{to:`/workflows/${(_=o.flow)==null?void 0:_.name}`,icon:"i-heroicons-arrow-up-right-16-solid",class:"flex justify-center dark:bg-slate-500 bg-slate-500 dark:hover:bg-slate-700 hover:bg-slate-700 dark:text-white"},{default:i(()=>s[9]||(s[9]=[$(" Open ")])),_:1},8,["to"])]}),default:i(()=>{var _,h,x,w,y,b,S,V,U;return[a("div",se,[a("p",{class:"text-md text-slate-400 truncate text-ellipsis mb-2",title:(_=o.flow)==null?void 0:_.description},p((h=o.flow)==null?void 0:h.description),9,le),a("p",ne,[a("span",ae,[l(d,{name:"i-heroicons-user-16-solid",class:"mr-1"}),s[1]||(s[1]=a("b",null,"Author:",-1)),s[2]||(s[2]=$("  "))]),a("a",{class:"hover:underline flex flex-row items-center",href:(x=o.flow)==null?void 0:x.homepage,rel:"noopener",target:"_blank"},p((w=o.flow)==null?void 0:w.author),9,ie)]),a("p",re,[l(d,{name:"i-heroicons-document-text",class:"mr-1"}),(y=o.flow)!=null&&y.documentation?(n(),m("a",{key:0,class:"hover:underline",href:(b=o.flow)==null?void 0:b.documentation,rel:"noopener",target:"_blank"},"Documentation",8,fe)):(n(),m("span",de,"No documentation"))]),a("p",me,[l(d,{name:"i-heroicons-tag",class:"mr-1"}),s[3]||(s[3]=a("b",null,"Tags:",-1)),s[4]||(s[4]=$("  ")),((S=o.flow)==null?void 0:S.tags.length)>0?(n(!0),m(z,{key:0},L((V=o.flow)==null?void 0:V.tags,g=>(n(),c(C,{key:g,label:g,color:"white",variant:"solid",class:"m-1"},null,8,["label"]))),128)):(n(),c(C,{key:1,label:"No tags",color:"white",variant:"solid",class:"m-1"}))]),a("p",ce,[l(d,{name:"i-mdi-help-network-outline",class:"mr-1"}),s[7]||(s[7]=a("b",null,"Platforms:",-1)),s[8]||(s[8]=$("  ")),l(u,{text:"Linux"},{default:i(()=>[l(d,{name:"i-mdi-linux",class:"mr-1"})]),_:1}),l(u,{text:"Microsoft Windows"},{default:i(()=>[l(d,{name:"i-mdi-microsoft-windows",class:"mr-1"})]),_:1}),o.flow.is_macos_supported?(n(),c(u,{key:0,text:"macOS"},{default:i(()=>[l(d,{name:"i-mdi-apple",class:"mr-1"})]),_:1})):k("",!0),(U=o.flow)!=null&&U.required_memory_gb?(n(),c(u,{key:1,class:"flex flex-row items-center",text:"Required VRAM memory (GB)"},{default:i(()=>{var g;return[s[5]||(s[5]=$(" (")),l(d,{name:"i-mdi-memory",class:"mr-1"}),a("span",null,p((g=o.flow)==null?void 0:g.required_memory_gb)+" GB",1),s[6]||(s[6]=$(") "))]}),_:1})):k("",!0)])])]}),_:1})])}}}),ue={class:"w-full sticky z-[100] top-1 flex flex-col md:flex-row justify-center items-center my-1"},we={class:"flex"},pe={key:0,class:"truncate"},he={key:1},xe={key:0},ge={key:1,class:"flex flex-wrap justify-center items-center mb-10"},$e={key:2,class:"text-center text-slate-500 my-5"},Ue=A({__name:"index",setup(o){J({title:"Workflows - Visionatrix",meta:[{name:"description",content:"Workflows - Visionatrix"}]});const e=F(),B=K();Q(()=>e.paginatedFlows,()=>{e.flows.length<=e.$state.pageSize?e.$state.page=1:e.$state.page>Math.ceil(e.flows.length/e.$state.pageSize)&&(e.$state.page=Math.ceil(e.flows.length/e.$state.pageSize))});function s(){return[[{label:"Show unsupported flows",icon:e.$state.show_unsupported_flows?"i-mdi-filter-check":"i-mdi-filter-minus",slot:"show_unsupported_flows",click:()=>{e.$state.show_unsupported_flows=!e.$state.show_unsupported_flows,e.saveUserOptions()}}],[{label:"Show hidden flows",icon:e.$state.flows_hidden_filter?"i-mdi-filter-check":"i-mdi-filter-minus",slot:"show_hidden_flows",click:()=>{e.$state.flows_hidden_filter=!e.$state.flows_hidden_filter,e.saveUserOptions()}}],[{label:"Clear filters",labelClass:"text-xs",icon:"i-mdi-filter-off",iconClass:"w-4 h-4",click:()=>{e.$state.flows_search_filter="",e.$state.flows_tags_filter=[],e.$state.show_unsupported_flows=!1}}]]}const d=j(()=>e.$state.flows_search_filter||e.$state.flows_tags_filter.length>0||e.$state.show_unsupported_flows||e.$state.flows_hidden_filter),u=j(()=>(e.$state.flows_search_filter?1:0)+(e.$state.flows_tags_filter.length>0?1:0)+(e.$state.show_unsupported_flows?1:0)+(e.$state.flows_hidden_filter?1:0));function v(){B.clear(),O().loadLocalSettings(),O().fetchAllSettings(),F().fetchFlows(),X().loadWorkers()}return(C,r)=>{const _=T,h=q,x=D,w=E,y=M,b=W,S=P,V=Z,U=_e,g=Y;return n(),c(g,{class:"lg:h-dvh"},{default:i(()=>[t(e).$state.loading.flows_available||t(e).loading.flows_installed||t(e).$state.loading.tasks_history?(n(),c(_,{key:0})):(n(),m(z,{key:1},[a("div",ue,[l(h,{modelValue:t(e).$state.flows_search_filter,"onUpdate:modelValue":r[0]||(r[0]=f=>t(e).$state.flows_search_filter=f),icon:"i-heroicons-magnifying-glass-20-solid",color:"white",class:"mb-1 md:mr-3 md:mb-0",label:"Filter by prompt",trailing:!0,placeholder:"Search flows"},null,8,["modelValue"]),t(e).flows.length>t(e).$state.pageSize?(n(),c(x,{key:0,modelValue:t(e).$state.page,"onUpdate:modelValue":r[1]||(r[1]=f=>t(e).$state.page=f),class:"mb-1 md:mr-3 md:mb-0","page-count":t(e).$state.pageSize,total:t(e).flows.length},null,8,["modelValue","page-count","total"])):k("",!0),a("div",we,[l(w,{modelValue:t(e).$state.flows_tags_filter,"onUpdate:modelValue":r[2]||(r[2]=f=>t(e).$state.flows_tags_filter=f),options:t(e).flowsTags,multiple:"",searchable:""},{label:i(()=>[t(e).$state.flows_tags_filter.length>0?(n(),m("span",pe,p(t(e).$state.flows_tags_filter.join(",")),1)):(n(),m("span",he,"Select tags to filter"))]),_:1},8,["modelValue","options"]),l(S,{class:"ml-2",items:s(),mode:"click",label:"Options"},{show_unsupported_flows:i(()=>[l(b,{modelValue:t(e).$state.show_unsupported_flows,"onUpdate:modelValue":r[3]||(r[3]=f=>t(e).$state.show_unsupported_flows=f)},null,8,["modelValue"]),r[5]||(r[5]=a("span",{class:"text-xs"},"Show unsupported flows",-1))]),show_hidden_flows:i(()=>[l(b,{modelValue:t(e).$state.flows_hidden_filter,"onUpdate:modelValue":r[4]||(r[4]=f=>t(e).$state.flows_hidden_filter=f)},null,8,["modelValue"]),r[6]||(r[6]=a("span",{class:"text-xs"},"Show hidden flows",-1))]),default:i(()=>[l(y,{color:"white",icon:"i-mdi-filter"},{default:i(()=>[a("span",null,p(t(e).flows.length),1),t(d)?(n(),m("span",xe,"("+p(t(u))+")",1)):k("",!0)]),_:1})]),_:1},8,["items"])])]),t(e).$state.error.flows_available||t(e).$state.error.flows_installed?(n(),c(V,{key:0,class:"my-4",title:"Error fetching flows",icon:"i-mdi-alert-circle",description:"An error occurred while fetching flows. Please try again later.",variant:"soft",color:"red"},{actions:i(()=>[l(y,{icon:"i-heroicons-arrow-path-solid",variant:"outline",color:"white",onClick:v},{default:i(()=>r[7]||(r[7]=[$(" Retry ")])),_:1})]),_:1})):k("",!0),t(e).flows.length>0?(n(),m("div",ge,[(n(!0),m(z,null,L(t(e).paginatedFlows,f=>(n(),c(U,{key:f.name,flow:f},null,8,["flow"]))),128))])):(n(),m("p",$e,p(t(e).$state.flows_search_filter||t(e).$state.flows_tags_filter?"No flows found":"No flows available"),1))],64))]),_:1})}}});export{Ue as default};
