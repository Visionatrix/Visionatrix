import{_ as T,a as W}from"./DRlqyXe4.js";import{_ as q}from"./BZH_G1gz.js";import{_ as I,a as D,b as P}from"./BXGVhDkW.js";import{_ as E}from"./CXATgj09.js";import{f as A,g as F,c as _,o as a,b as o,w as r,a as i,t as p,d as $,h as R,i as m,F as z,r as L,j as G,k,l as H,m as M,n as N,p as t,u as J,q as K,s as Q,v as O,x as j,y as X,z as Y}from"./CJvaD_lh.js";import{_ as Z}from"./D920ja20.js";const ee={class:"p-4 w-full md:w-6/12 lg:w-4/12 z-[10]"},te={class:"flex flex-grow justify-between"},oe=["title"],se={class:"flex flex-col items-between text-sm"},le=["title"],ne={class:"flex flex-row flex-wrap items-center mb-2"},ae={class:"flex flex-row items-center"},ie=["href"],re={class:"flex flex-row items-center mb-2"},fe=["href"],de={key:1},_e={class:"flex flex-row items-center mb-2"},me={class:"flex flex-row items-center"},ce=A({__name:"ListItem",props:{flow:{type:Object,required:!0}},setup(s){const e=F();return(B,l)=>{const d=R,w=H,v=M,C=G,n=I;return a(),_("div",ee,[o(n,{as:"div",class:"hover:shadow-md"},{header:r(()=>{var c,h,x;return[i("div",te,[i("h2",{class:"text-xl font-bold truncate flex items-center",title:(c=s.flow)==null?void 0:c.display_name},[(h=s.flow)!=null&&h.private?(a(),m(w,{key:0,text:"This flow is local, manually added"},{default:r(()=>[o(d,{name:"i-heroicons-lock-closed",class:N(["mr-2",{"text-stone-500":!s.flow.is_supported_by_workers}])},null,8,["class"])]),_:1})):k("",!0),o(w,{text:s.flow.is_supported_by_workers?"":"No workers capable of running this flow",popper:{placement:"top"}},{default:r(()=>{var u;return[i("span",{class:N({"text-stone-500":!s.flow.is_supported_by_workers})},p((u=s.flow)==null?void 0:u.display_name),3)]}),_:1},8,["text"])],8,oe),t(e).isFlowInstalled((x=s.flow)==null?void 0:x.name)?(a(),m(w,{key:0,text:"Mark flow as favorite",class:"ml-3",popper:{placement:"top"},"open-delay":500},{default:r(()=>[o(v,{icon:t(e).isFlowFavorite(s.flow.name)?"i-heroicons-star-16-solid":"i-heroicons-star",variant:"outline",color:"yellow",onClick:l[0]||(l[0]=u=>t(e).markFlowFavorite(s.flow))},null,8,["icon"])]),_:1})):k("",!0)])]}),footer:r(()=>{var c;return[o(v,{to:`/workflows/${(c=s.flow)==null?void 0:c.name}`,icon:"i-heroicons-arrow-up-right-16-solid",class:"flex justify-center dark:bg-slate-500 bg-slate-500 dark:hover:bg-slate-700 hover:bg-slate-700 dark:text-white"},{default:r(()=>l[9]||(l[9]=[$(" Open ")])),_:1},8,["to"])]}),default:r(()=>{var c,h,x,u,y,b,V,S,U;return[i("div",se,[i("p",{class:"text-md text-slate-400 truncate text-ellipsis mb-2",title:(c=s.flow)==null?void 0:c.description},p((h=s.flow)==null?void 0:h.description),9,le),i("p",ne,[i("span",ae,[o(d,{name:"i-heroicons-user-16-solid",class:"mr-1"}),l[1]||(l[1]=i("b",null,"Author:",-1)),l[2]||(l[2]=$("  "))]),i("a",{class:"hover:underline flex flex-row items-center",href:(x=s.flow)==null?void 0:x.homepage,rel:"noopener",target:"_blank"},p((u=s.flow)==null?void 0:u.author),9,ie)]),i("p",re,[o(d,{name:"i-heroicons-document-text",class:"mr-1"}),(y=s.flow)!=null&&y.documentation?(a(),_("a",{key:0,class:"hover:underline",href:(b=s.flow)==null?void 0:b.documentation,rel:"noopener",target:"_blank"},"Documentation",8,fe)):(a(),_("span",de,"No documentation"))]),i("p",_e,[o(d,{name:"i-heroicons-tag",class:"mr-1"}),l[3]||(l[3]=i("b",null,"Tags:",-1)),l[4]||(l[4]=$("  ")),((V=s.flow)==null?void 0:V.tags.length)>0?(a(!0),_(z,{key:0},L((S=s.flow)==null?void 0:S.tags,g=>(a(),m(C,{key:g,label:g,color:"white",variant:"solid",class:"m-1"},null,8,["label"]))),128)):(a(),m(C,{key:1,label:"No tags",color:"white",variant:"solid",class:"m-1"}))]),i("p",me,[o(d,{name:"i-mdi-help-network-outline",class:"mr-1"}),l[7]||(l[7]=i("b",null,"Platforms:",-1)),l[8]||(l[8]=$("  ")),o(w,{text:"Linux"},{default:r(()=>[o(d,{name:"i-mdi-linux",class:"mr-1"})]),_:1}),o(w,{text:"Microsoft Windows"},{default:r(()=>[o(d,{name:"i-mdi-microsoft-windows",class:"mr-1"})]),_:1}),s.flow.is_macos_supported?(a(),m(w,{key:0,text:"macOS"},{default:r(()=>[o(d,{name:"i-mdi-apple",class:"mr-1"})]),_:1})):k("",!0),(U=s.flow)!=null&&U.required_memory_gb?(a(),m(w,{key:1,class:"flex flex-row items-center",text:"Required VRAM memory (GB)"},{default:r(()=>{var g;return[l[5]||(l[5]=$(" (")),o(d,{name:"i-mdi-memory",class:"mr-1"}),i("span",null,p((g=s.flow)==null?void 0:g.required_memory_gb)+" GB",1),l[6]||(l[6]=$(") "))]}),_:1})):k("",!0)])])]}),_:1})])}}}),we={class:"w-full sticky z-[100] top-1 flex flex-col md:flex-row justify-center items-center my-1"},ue={class:"flex"},pe={key:0,class:"truncate"},he={key:1},xe={key:0},ge={key:1,class:"flex flex-wrap justify-center items-center mb-10"},$e={key:2,class:"text-center text-slate-500 my-5"},Ue=A({__name:"index",setup(s){J({title:"Workflows - Visionatrix",meta:[{name:"description",content:"Workflows - Visionatrix"}]});const e=F(),B=K();Q(()=>e.paginatedFlows,()=>{e.flows.length<=e.$state.pageSize?e.$state.page=1:e.$state.page>Math.ceil(e.flows.length/e.$state.pageSize)&&(e.$state.page=Math.ceil(e.flows.length/e.$state.pageSize))});function l(){return[[{label:"Show unsupported flows",icon:e.$state.show_unsupported_flows?"i-mdi-filter-check":"i-mdi-filter-minus",slot:"show_unsupported_flows",click:()=>{e.$state.show_unsupported_flows=!e.$state.show_unsupported_flows,e.saveUserOptions()}}],[{label:"Show private flows",icon:e.$state.flows_private_filter?"i-mdi-filter-check":"i-mdi-filter-minus",slot:"show_private_flows",click:()=>{e.$state.flows_private_filter=!e.$state.flows_private_filter,e.saveUserOptions()}}],[{label:"Show hidden flows",icon:e.$state.flows_hidden_filter?"i-mdi-filter-check":"i-mdi-filter-minus",slot:"show_hidden_flows",click:()=>{e.$state.flows_hidden_filter=!e.$state.flows_hidden_filter,e.saveUserOptions()}}],[{label:"Clear filters",labelClass:"text-xs",icon:"i-mdi-filter-off",iconClass:"w-4 h-4",click:()=>{e.$state.flows_search_filter="",e.$state.flows_tags_filter=[],e.$state.show_unsupported_flows=!1}}]]}const d=O(()=>e.$state.flows_search_filter||e.$state.flows_tags_filter.length>0||e.$state.show_unsupported_flows||e.$state.flows_private_filter||e.$state.flows_hidden_filter),w=O(()=>(e.$state.flows_search_filter?1:0)+(e.$state.flows_tags_filter.length>0?1:0)+(e.$state.show_unsupported_flows?1:0)+(e.$state.flows_private_filter?1:0)+(e.$state.flows_hidden_filter?1:0));function v(){B.clear(),j().loadLocalSettings(),j().fetchAllSettings(),F().fetchFlows(),X().loadWorkers()}return(C,n)=>{const c=T,h=q,x=D,u=E,y=M,b=W,V=P,S=Z,U=ce,g=Y;return a(),m(g,{class:"lg:h-dvh"},{default:r(()=>[t(e).$state.loading.flows_available||t(e).loading.flows_installed||t(e).$state.loading.tasks_history?(a(),m(c,{key:0})):(a(),_(z,{key:1},[i("div",we,[o(h,{modelValue:t(e).$state.flows_search_filter,"onUpdate:modelValue":n[0]||(n[0]=f=>t(e).$state.flows_search_filter=f),icon:"i-heroicons-magnifying-glass-20-solid",color:"white",class:"mb-1 md:mr-3 md:mb-0",label:"Filter by prompt",trailing:!0,placeholder:"Search flows"},null,8,["modelValue"]),t(e).flows.length>t(e).$state.pageSize?(a(),m(x,{key:0,modelValue:t(e).$state.page,"onUpdate:modelValue":n[1]||(n[1]=f=>t(e).$state.page=f),class:"mb-1 md:mr-3 md:mb-0","page-count":t(e).$state.pageSize,total:t(e).flows.length},null,8,["modelValue","page-count","total"])):k("",!0),i("div",ue,[o(u,{modelValue:t(e).$state.flows_tags_filter,"onUpdate:modelValue":n[2]||(n[2]=f=>t(e).$state.flows_tags_filter=f),options:t(e).flowsTags,multiple:"",searchable:""},{label:r(()=>[t(e).$state.flows_tags_filter.length>0?(a(),_("span",pe,p(t(e).$state.flows_tags_filter.join(",")),1)):(a(),_("span",he,"Select tags to filter"))]),_:1},8,["modelValue","options"]),o(V,{class:"ml-2",items:l(),mode:"click",label:"Options"},{show_unsupported_flows:r(()=>[o(b,{modelValue:t(e).$state.show_unsupported_flows,"onUpdate:modelValue":n[3]||(n[3]=f=>t(e).$state.show_unsupported_flows=f)},null,8,["modelValue"]),n[6]||(n[6]=i("span",{class:"text-xs"},"Show unsupported flows",-1))]),show_private_flows:r(()=>[o(b,{modelValue:t(e).$state.flows_private_filter,"onUpdate:modelValue":n[4]||(n[4]=f=>t(e).$state.flows_private_filter=f)},null,8,["modelValue"]),n[7]||(n[7]=i("span",{class:"text-xs"},"Show private flows",-1))]),show_hidden_flows:r(()=>[o(b,{modelValue:t(e).$state.flows_hidden_filter,"onUpdate:modelValue":n[5]||(n[5]=f=>t(e).$state.flows_hidden_filter=f)},null,8,["modelValue"]),n[8]||(n[8]=i("span",{class:"text-xs"},"Show hidden flows",-1))]),default:r(()=>[o(y,{color:"white",icon:"i-mdi-filter"},{default:r(()=>[i("span",null,p(t(e).flows.length),1),t(d)?(a(),_("span",xe,"("+p(t(w))+")",1)):k("",!0)]),_:1})]),_:1},8,["items"])])]),t(e).$state.error.flows_available||t(e).$state.error.flows_installed?(a(),m(S,{key:0,class:"my-4",title:"Error fetching flows",icon:"i-mdi-alert-circle",description:"An error occurred while fetching flows. Please try again later.",variant:"soft",color:"red"},{actions:r(()=>[o(y,{icon:"i-heroicons-arrow-path-solid",variant:"outline",color:"white",onClick:v},{default:r(()=>n[9]||(n[9]=[$(" Retry ")])),_:1})]),_:1})):k("",!0),t(e).flows.length>0?(a(),_("div",ge,[(a(!0),_(z,null,L(t(e).paginatedFlows,f=>(a(),m(U,{key:f.name,flow:f},null,8,["flow"]))),128))])):(a(),_("p",$e,p(t(e).$state.flows_search_filter||t(e).$state.flows_tags_filter?"No flows found":"No flows available"),1))],64))]),_:1})}}});export{Ue as default};
