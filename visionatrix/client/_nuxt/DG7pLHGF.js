import{_ as ie}from"./BrGl84mO.js";import{_ as re}from"./_CLSwzSV.js";import{_ as de,o as u,c as v,a as m,F as j,r as ue,q as x,b as i,w as r,s as G,i as F,h as q,l as p,t as z,v as H,x as W,f as Q,y as fe,z as J,A as me,B as O,C as ce,D as pe,E as ye,u as ve,G as ge,H as _e,I as be,J as d,K as T,m as o,L as C,k as Ue,d as y,j as Ce,M as ke,p as he}from"./Dv6CTmPE.js";import{_ as we}from"./CxTBtvPY.js";import{_ as Ie}from"./CkL8WDHc.js";import{_ as Ve}from"./C4EZUeDe.js";import{_ as xe}from"./CG7N4Y80.js";import"./_UnmVCQS.js";const Fe={wrapper:"relative min-w-0",ol:"flex items-center gap-x-1.5",li:"flex items-center gap-x-1.5 text-gray-500 dark:text-gray-400 text-sm leading-6 min-w-0",base:"flex items-center gap-x-1.5 group font-semibold min-w-0",label:"block truncate",icon:{base:"flex-shrink-0 w-5 h-5",active:"",inactive:""},divider:{base:"flex-shrink-0 w-5 h-5 rtl:rotate-180"},active:"text-primary-500 dark:text-primary-400",inactive:" hover:text-gray-700 dark:hover:text-gray-200",default:{divider:"i-heroicons-chevron-right-20-solid"}},K=me(O.ui.strategy,O.ui.breadcrumb,Fe),ze=Q({components:{UIcon:q,ULink:W},inheritAttrs:!1,props:{links:{type:Array,default:()=>[]},divider:{type:String,default:()=>K.default.divider},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})}},setup(t){const{ui:$,attrs:f}=fe("breadcrumb",J(t,"ui"),K,J(t,"class"));return{ui:$,attrs:f,getULinkProps:ye,twMerge:pe,twJoin:ce}}}),Ae={key:1,role:"presentation"};function Be(t,$,f,k,h,N){const n=q,w=W;return u(),v("nav",H({"aria-label":"Breadcrumb",class:t.ui.wrapper},t.attrs),[m("ol",{class:x(t.ui.ol)},[(u(!0),v(j,null,ue(t.links,(a,c)=>(u(),v("li",{key:c,class:x(t.ui.li)},[i(w,H({as:"span",class:[t.ui.base,c===t.links.length-1?t.ui.active:a.to?t.ui.inactive:""],"aria-current":c===t.links.length-1?"page":void 0,ref_for:!0},t.getULinkProps(a),{onClick:a.click}),{default:r(()=>[G(t.$slots,"icon",{link:a,index:c,isActive:c===t.links.length-1},()=>[a.icon?(u(),F(n,{key:0,name:a.icon,class:x(t.twMerge(t.twJoin(t.ui.icon.base,c===t.links.length-1?t.ui.icon.active:a.to?t.ui.icon.inactive:""),a.iconClass))},null,8,["name","class"])):p("",!0)]),G(t.$slots,"default",{link:a,index:c,isActive:c===t.links.length-1},()=>[a.label?(u(),v("span",{key:0,class:x(t.twMerge(t.ui.label,a.labelClass))},z(a.label),3)):p("",!0)])]),_:2},1040,["class","aria-current","onClick"]),c<t.links.length-1?G(t.$slots,"divider",{key:0},()=>[t.divider?(u(),v(j,{key:0},[t.divider.startsWith("i-")?(u(),F(n,{key:0,name:t.divider,class:x(t.ui.divider.base),role:"presentation"},null,8,["name","class"])):(u(),v("span",Ae,z(t.divider),1))],64)):p("",!0)]):p("",!0)],2))),128))],2)],16)}const $e=de(ze,[["render",Be]]),Le={class:"flex flex-col md:flex-row"},Se={class:"px-5 pb-5 md:w-4/5"},De={key:0,class:"admin-settings mb-3"},Ee={class:"mt-3 mb-5"},Me={key:0},Pe={key:1},Ge={class:"flex flex-row w-full md:flex-col"},Te={class:"flex mt-3"},Ne={class:"p-4 max-h-screen"},Re=["onClick"],Xe=Q({__name:"comfyui",setup(t){ve({title:"ComfyUI settings - Visionatrix",meta:[{name:"description",content:"ComfyUI settings - Visionatrix"}]});const $=ge(),f=_e(),k=be(),h=d(!1),N=d(!1),n=d([]),w=d("../vix_models"),a=d(""),c=T(()=>n.value.length===0?[]:a.value===""?Object.keys(n.value).map(s=>{let e=0;return n.value[s].length>0&&(e=n.value[s].reduce((_,g)=>_+(g.total_size??0),0)),{full_path:s,total_size:e,create_time:null,is_default:null,readonly:null}}):n.value[a.value]??[]),X=T(()=>{const s=[{label:"Root",to:""}];if(a.value==="")return s;const e=a.value.split("/");let _="";return e.forEach(g=>{_+=g,s.push({label:g,to:_}),_+="/"}),s}),D=d([]),Y=T(()=>{const s=[{key:"full_path",label:"Path",sortable:!0,class:""},{key:"total_size",label:"Size",sortable:!0,class:""}];return a.value!==""&&(s.push({key:"create_time",label:"Created time",sortable:!0,class:""}),s.push({key:"actions",label:"Actions",sortable:!1,class:""})),s});function Z(s){s.full_path in n.value&&(a.value=s.full_path)}const L=d(!1);function ee(){L.value=!0,f.performComfyUiAutoconfig(w.value).then(s=>{"folders"in s&&(console.debug("[DEBUG] ComfyUI folders: ",s.folders),n.value=s.folders,f.loadAllSettings(),k.add({title:"Autoconfig performed",description:"Autoconfig performed successfully"}))}).catch(s=>{k.add({title:"Error performing autoconfig",description:s.details})}).finally(()=>{L.value=!1})}const E=d(null),M=d(!1),A=d(""),I=d(!1),V=d(""),B=d(!1),P=d(!1),S=d(!0);return(s,e)=>{const _=ie,g=re,b=Ue,R=we,oe=Ie,le=Ce,te=$e,se=Ve,ae=xe,ne=he;return u(),F(ne,{class:"lg:h-dvh"},{default:r(()=>[m("div",Le,[i(_,{links:o(f).links,class:"md:w-1/5"},null,8,["links"]),m("div",Se,[o($).isAdmin?(u(),v("div",De,[e[20]||(e[20]=m("h3",{class:"mb-3 text-xl font-bold"},"ComfyUI settings (global)",-1)),m("div",Ee,[i(oe,{size:"md",class:"py-3",label:"ComfyUI models folder",description:"Relative or absolute path to the models folders"},{default:r(()=>[o(f).settingsMap.comfyui_folders.value===""?(u(),v("div",Me,[e[13]||(e[13]=m("p",{class:"text-gray-500"},"No ComfyUI folders initialized.",-1)),i(g,{modelValue:o(w),"onUpdate:modelValue":e[0]||(e[0]=l=>C(w)?w.value=l:null),placeholder:"ComfyUI folder path",class:"w-fit mt-3",type:"text",size:"sm",icon:"i-heroicons-folder-16-solid",disabled:o(L),autocomplete:"off"},null,8,["modelValue","disabled"]),i(b,{class:"mt-3",icon:"i-heroicons-cog-6-tooth-20-solid",color:"orange",loading:o(L),onClick:ee},{default:r(()=>e[12]||(e[12]=[y(" Perform autoconfig ")])),_:1},8,["loading"])])):p("",!0),o(M)?(u(),v("div",Pe,[m("div",Ge,[i(g,{ref_key:"newComfyUiFolderInput",ref:E,modelValue:o(V),"onUpdate:modelValue":e[1]||(e[1]=l=>C(V)?V.value=l:null),placeholder:"ComfyUI folder path (relative or absolute)",class:"w-fit mt-3",type:"text",size:"sm",icon:"i-heroicons-folder-16-solid",autocomplete:"off",disable:o(I)},null,8,["modelValue","disable"]),i(g,{modelValue:o(A),"onUpdate:modelValue":e[2]||(e[2]=l=>C(A)?A.value=l:null),placeholder:"ComfyUI folder key root path",class:"w-fit mt-3",type:"text",size:"sm",icon:"i-heroicons-folder-16-solid",autocomplete:"off",disable:o(I)},null,8,["modelValue","disable"]),i(R,{modelValue:o(B),"onUpdate:modelValue":e[3]||(e[3]=l=>C(B)?B.value=l:null),class:"mt-3",label:"Is default"},null,8,["modelValue"])]),m("div",Te,[i(b,{class:"mr-2",color:"white",icon:"i-heroicons-x-mark",variant:"outline",disabled:o(I),onClick:e[4]||(e[4]=()=>{M.value=!1,V.value="",A.value="",B.value=!1})},{default:r(()=>e[14]||(e[14]=[y(" Cancel ")])),_:1},8,["disabled"]),i(b,{icon:"i-heroicons-check-16-solid",loading:o(I),onClick:e[5]||(e[5]=()=>{o(V)!==""&&(I.value=!0,o(f).addComfyUiFolder(o(A),o(V),o(B)).then(l=>{"folders"in l&&(console.debug("[DEBUG] ComfyUI folders: ",l.folders),n.value=l.folders,o(k).add({title:"ComfyUI folder added",description:"ComfyUI folder added successfully"}))}).finally(()=>{I.value=!1}))})},{default:r(()=>e[15]||(e[15]=[y(" Add ")])),_:1},8,["loading"])])])):p("",!0),o(f).settingsMap.comfyui_folders.value!==""?(u(),F(b,{key:2,class:"mt-3",icon:"i-heroicons-folder-16-solid",color:"cyan",onClick:e[6]||(e[6]=()=>{o(f).getComfyUiFolderListing().then(l=>{console.debug("[DEBUG] ComfyUI folders: ",l),n.value=l.folders}),h.value=!0})},{default:r(()=>e[16]||(e[16]=[y(" Show ComfyUI folders ")])),_:1})):p("",!0),o(f).settingsMap.comfyui_folders.value!==""?(u(),F(b,{key:3,class:"mt-3 ml-2",color:"white",variant:"outline",icon:"i-heroicons-folder-plus-16-solid",onClick:e[7]||(e[7]=()=>{M.value=!0,s.$nextTick(()=>{o(E)&&o(E).$refs.input.focus()})})},{default:r(()=>e[17]||(e[17]=[y(" Add ComfyUI folder ")])),_:1})):p("",!0)]),_:1}),o(f).settingsMap.comfyui_folders.value!==""?(u(),F(ae,{key:0,modelValue:o(h),"onUpdate:modelValue":e[11]||(e[11]=l=>C(h)?h.value=l:null),class:"z-[90]",fullscreen:""},{default:r(()=>[i(b,{class:"absolute top-4 right-4",icon:"i-heroicons-x-mark",variant:"ghost",onClick:e[8]||(e[8]=()=>h.value=!1)}),m("div",Ne,[e[19]||(e[19]=m("h3",{class:"text-xl text-center"},"ComfyUI folders",-1)),m("div",null,[i(R,{modelValue:o(S),"onUpdate:modelValue":e[9]||(e[9]=l=>C(S)?S.value=l:null),class:"mt-3",label:"Hide empty folders"},null,8,["modelValue"])]),i(te,{links:o(X),class:"my-2"},{default:r(({link:l,isActive:U})=>[i(le,{color:U?"primary":"gray",class:"rounded-full truncate cursor-pointer select-none",onClick:()=>{a.value=l.to}},{default:r(()=>[y(z(l.label),1)]),_:2},1032,["color","onClick"])]),_:1},8,["links"]),i(se,{modelValue:o(D),"onUpdate:modelValue":e[10]||(e[10]=l=>C(D)?D.value=l:null),loading:o(N),"loading-state":{icon:"i-heroicons-arrow-path-20-solid",label:"Loading..."},rows:o(c).filter(l=>o(S)?l.total_size>0:!0),columns:o(Y),style:{"max-height":"80vh"}},{"full_path-data":r(({row:l})=>[m("span",{class:x({"text-blue-500":l.full_path in o(n),"cursor-pointer":l.full_path in o(n)}),onClick:()=>Z(l)},z(l.full_path),11,Re)]),"total_size-data":r(({row:l})=>[y(z(l.total_size?("formatBytes"in s?s.formatBytes:o(ke))(l.total_size):"-"),1)]),"create_time-data":r(({row:l})=>[y(z(l.create_time&&new Date(l.create_time).getTime()!==0?new Date(l.create_time).toLocaleString():"-"),1)]),"actions-data":r(({row:l})=>[i(b,{icon:"i-heroicons-trash-16-solid",variant:"outline",color:"red",loading:o(P),disabled:l.readonly===!0,onClick:()=>{P.value=!0,o(f).deleteComfyUiFolder(o(a),l.full_path).then(U=>{"folders"in U&&(console.debug("[DEBUG] ComfyUI folders: ",U.folders),n.value=U.folders,o(k).add({title:"ComfyUI folder removed",description:"ComfyUI folder removed successfully"}),o(n)[o(a)]||(a.value=""))}).catch(U=>{o(k).add({title:"Error removing ComfyUI folder",description:U.details})}).finally(()=>{P.value=!1})}},{default:r(()=>e[18]||(e[18]=[y(" Remove ")])),_:2},1032,["loading","disabled","onClick"])]),_:1},8,["modelValue","loading","rows","columns"])])]),_:1},8,["modelValue"])):p("",!0)])])):p("",!0)])])]),_:1})}}});export{Xe as default};
