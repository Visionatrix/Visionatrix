import{A as lt,W as zt,B as Ce,_ as ot,f as le,c as j,o as d,a as h,C as ze,D as Ie,n as te,G as at,H as Ne,M as x,X as st,S as Re,s as he,Y as Vt,v as E,J as Ge,I as Pe,Z as Ot,$ as jt,a0 as ft,a1 as tt,a2 as Tt,a3 as Bt,a4 as pt,a5 as Xe,a6 as Nt,a7 as Lt,p as t,a8 as At,a9 as it,aa as qt,ab as Et,ac as Le,ad as Ve,g as ge,L as Je,T as wt,ae as Be,i as $,k as M,w,b as m,F as ie,r as pe,m as re,d as D,O as Q,af as Dt,q as Oe,t as X,ag as Qe,P as yt,j as Ae,Q as rt,y as Wt,N as Ue,h as ke,x as bt,ah as kt,l as qe,ai as ut,aj as Ht,ak as Gt,al as Xt,R as nt,am as xt,an as _t,ao as ce,ap as $t,aq as Jt,E as Qt,ar as Ct,as as Kt,z as Yt,at as Zt}from"./GdS5Yh2f.js";import{b as Ke,a as en,_ as St}from"./D8rqpPlp.js";import{u as It,_ as Ee}from"./gQDstX3g.js";import{_ as De}from"./CPxb5Ra9.js";import{_ as Se,a as tn}from"./MToCq9ss.js";import{_ as Ye}from"./DFP7mhT5.js";import{a as We,_ as Rt}from"./ByxlQLMr.js";import{_ as dt}from"./Cq39qZMT.js";import{_ as nn}from"./Di5z-QHg.js";import{_ as ln}from"./Dyc6tVIR.js";const on={wrapper:"relative",container:"relative w-full flex overflow-x-auto snap-x snap-mandatory scroll-smooth",item:"flex flex-none snap-center",arrows:{wrapper:"flex items-center justify-between"},indicators:{wrapper:"absolute flex items-center justify-center gap-3 bottom-4 inset-x-0",base:"rounded-full h-3 w-3",active:"bg-primary-500 dark:bg-primary-400",inactive:"bg-gray-100 dark:bg-gray-800"},default:{prevButton:{color:"black",class:"rtl:[&_span:first-child]:rotate-180 absolute start-4 top-1/2 transform -translate-y-1/2 rounded-full",icon:"i-heroicons-chevron-left-20-solid"},nextButton:{color:"black",class:"rtl:[&_span:last-child]:rotate-180 absolute end-4 top-1/2 transform -translate-y-1/2 rounded-full",icon:"i-heroicons-chevron-right-20-solid"}}},an={wrapper:"relative w-full flex items-center",base:"w-full absolute appearance-none cursor-pointer disabled:cursor-not-allowed disabled:bg-opacity-50 focus:outline-none peer group",rounded:"rounded-lg",background:"bg-transparent",ring:"focus-visible:ring-2 focus-visible:ring-{color}-500 dark:focus-visible:ring-{color}-400 focus-visible:ring-offset-2 focus-visible:ring-offset-white dark:focus-visible:ring-offset-gray-900",progress:{base:"absolute pointer-events-none peer-disabled:bg-opacity-50",rounded:"rounded-s-lg",background:"bg-{color}-500 dark:bg-{color}-400",size:{"2xs":"h-px",xs:"h-0.5",sm:"h-1",md:"h-2",lg:"h-3",xl:"h-4","2xl":"h-5"}},thumb:{base:"[&::-webkit-slider-thumb]:relative [&::-moz-range-thumb]:relative [&::-webkit-slider-thumb]:z-[1] [&::-moz-range-thumb]:z-[1] [&::-webkit-slider-thumb]:appearance-none [&::-moz-range-thumb]:appearance-none [&::-webkit-slider-thumb]:rounded-full [&::-moz-range-thumb]:rounded-full [&::-moz-range-thumb]:border-0",color:"text-{color}-500 dark:text-{color}-400",background:"[&::-webkit-slider-thumb]:bg-white [&::-webkit-slider-thumb]:dark:bg-gray-900 [&::-moz-range-thumb]:bg-current",ring:"[&::-webkit-slider-thumb]:ring-2 [&::-webkit-slider-thumb]:ring-current",size:{"2xs":"[&::-webkit-slider-thumb]:h-1.5 [&::-moz-range-thumb]:h-1.5 [&::-webkit-slider-thumb]:w-1.5 [&::-moz-range-thumb]:w-1.5 [&::-webkit-slider-thumb]:mt-[-2.5px] [&::-moz-range-thumb]:mt-[-2.5px]",xs:"[&::-webkit-slider-thumb]:h-2 [&::-moz-range-thumb]:h-2 [&::-webkit-slider-thumb]:w-2 [&::-moz-range-thumb]:w-2 [&::-webkit-slider-thumb]:mt-[-3px] [&::-moz-range-thumb]:mt-[-3px]",sm:"[&::-webkit-slider-thumb]:h-3 [&::-moz-range-thumb]:h-3 [&::-webkit-slider-thumb]:w-3 [&::-moz-range-thumb]:w-3 [&::-webkit-slider-thumb]:-mt-1 [&::-moz-range-thumb]:-mt-1",md:"[&::-webkit-slider-thumb]:h-4 [&::-moz-range-thumb]:h-4 [&::-webkit-slider-thumb]:w-4 [&::-moz-range-thumb]:w-4 [&::-webkit-slider-thumb]:-mt-1 [&::-moz-range-thumb]:-mt-1",lg:"[&::-webkit-slider-thumb]:h-5 [&::-moz-range-thumb]:h-5 [&::-webkit-slider-thumb]:w-5 [&::-moz-range-thumb]:w-5 [&::-webkit-slider-thumb]:-mt-1 [&::-moz-range-thumb]:-mt-1",xl:"[&::-webkit-slider-thumb]:h-6 [&::-moz-range-thumb]:h-6 [&::-webkit-slider-thumb]:w-6 [&::-moz-range-thumb]:w-6 [&::-webkit-slider-thumb]:-mt-1 [&::-moz-range-thumb]:-mt-1","2xl":"[&::-webkit-slider-thumb]:h-7 [&::-moz-range-thumb]:h-7 [&::-webkit-slider-thumb]:w-7 [&::-moz-range-thumb]:w-7 [&::-webkit-slider-thumb]:-mt-1 [&::-moz-range-thumb]:-mt-1"}},track:{base:"[&::-webkit-slider-runnable-track]:group-disabled:bg-opacity-50 [&::-moz-range-track]:group-disabled:bg-opacity-50",background:"[&::-webkit-slider-runnable-track]:bg-gray-200 [&::-moz-range-track]:bg-gray-200 [&::-webkit-slider-runnable-track]:dark:bg-gray-700 [&::-moz-range-track]:dark:bg-gray-700",rounded:"[&::-webkit-slider-runnable-track]:rounded-lg [&::-moz-range-track]:rounded-lg",size:{"2xs":"[&::-webkit-slider-runnable-track]:h-px [&::-moz-range-track]:h-px",xs:"[&::-webkit-slider-runnable-track]:h-0.5 [&::-moz-range-track]:h-0.5",sm:"[&::-webkit-slider-runnable-track]:h-1 [&::-moz-range-track]:h-1",md:"[&::-webkit-slider-runnable-track]:h-2 [&::-moz-range-track]:h-2",lg:"[&::-webkit-slider-runnable-track]:h-3 [&::-moz-range-track]:h-3",xl:"[&::-webkit-slider-runnable-track]:h-4 [&::-moz-range-track]:h-4","2xl":"[&::-webkit-slider-runnable-track]:h-5 [&::-moz-range-track]:h-5"}},size:{"2xs":"h-1.5",xs:"h-2",sm:"h-3",md:"h-4",lg:"h-5",xl:"h-6","2xl":"h-7"},default:{size:"md",color:"primary"}},$e=lt(Ce.ui.strategy,Ce.ui.textarea,zt),sn=le({inheritAttrs:!1,props:{modelValue:{type:[String,Number],default:""},id:{type:String,default:null},name:{type:String,default:null},placeholder:{type:String,default:null},required:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},rows:{type:Number,default:3},maxrows:{type:Number,default:0},autoresize:{type:Boolean,default:!1},autofocus:{type:Boolean,default:!1},autofocusDelay:{type:Number,default:100},resize:{type:Boolean,default:!1},padded:{type:Boolean,default:!0},size:{type:String,default:null,validator(e){return Object.keys($e.size).includes(e)}},color:{type:String,default:()=>$e.default.color,validator(e){return[...Ce.ui.colors,...Object.keys($e.color)].includes(e)}},variant:{type:String,default:()=>$e.default.variant,validator(e){return[...Object.keys($e.variant),...Object.values($e.color).flatMap(l=>Object.keys(l))].includes(e)}},textareaClass:{type:String,default:null},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})},modelModifiers:{type:Object,default:()=>({})}},emits:["update:modelValue","blur","change"],setup(e,{emit:l}){const{ui:n,attrs:a}=at("textarea",Ne(e,"ui"),$e,Ne(e,"class")),{emitFormBlur:r,emitFormInput:o,inputId:s,color:f,size:p,name:C}=It(e,$e),y=x(st({},e.modelModifiers,{trim:!1,lazy:!1,number:!1,nullify:!1})),F=x(null),P=()=>{var v;e.autofocus&&((v=F.value)==null||v.focus())},U=()=>{if(e.autoresize){if(!F.value)return;F.value.rows=e.rows;const v=F.value.style.overflow;F.value.style.overflow="hidden";const g=window.getComputedStyle(F.value),u=Number.parseInt(g.paddingTop),O=Number.parseInt(g.paddingBottom),i=u+O,b=Number.parseInt(g.lineHeight),{scrollHeight:S}=F.value,V=(S-i)/b;V>e.rows&&(F.value.rows=e.maxrows?Math.min(V,e.maxrows):V),F.value.style.overflow=v}},_=v=>{y.value.trim&&(v=v.trim()),y.value.number&&(v=Ot(v)),y.value.nullify&&(v||(v=null)),l("update:modelValue",v),o()},z=v=>{U(),y.value.lazy||_(v.target.value)},N=v=>{const g=v.target.value;l("change",g),y.value.lazy&&_(g),y.value.trim&&(v.target.value=g.trim())},k=v=>{l("blur",v),r()};Re(()=>{setTimeout(()=>{P()},e.autofocusDelay)}),he(()=>e.modelValue,()=>{Vt(U)}),Re(()=>{setTimeout(()=>{P(),U()},100)});const c=E(()=>{var g,u;const v=((u=(g=n.value.color)==null?void 0:g[f.value])==null?void 0:u[e.variant])||n.value.variant[e.variant];return Ge(Pe(n.value.base,n.value.form,n.value.rounded,n.value.placeholder,n.value.size[p.value],e.padded?n.value.padding[p.value]:"p-0",v==null?void 0:v.replaceAll("{color}",f.value),!e.resize&&"resize-none"),e.textareaClass)});return{ui:n,attrs:a,name:C,inputId:s,textarea:F,textareaClass:c,onInput:z,onChange:N,onBlur:k}}}),rn=["id","value","name","rows","required","disabled","placeholder"];function un(e,l,n,a,r,o){return d(),j("div",{class:te(e.ui.wrapper)},[h("textarea",Ie({id:e.inputId,ref:"textarea",value:e.modelValue,name:e.name,rows:e.rows,required:e.required,disabled:e.disabled,placeholder:e.placeholder,class:e.textareaClass},e.attrs,{onInput:l[0]||(l[0]=(...s)=>e.onInput&&e.onInput(...s)),onBlur:l[1]||(l[1]=(...s)=>e.onBlur&&e.onBlur(...s)),onChange:l[2]||(l[2]=(...s)=>e.onChange&&e.onChange(...s))}),null,16,rn),ze(e.$slots,"default")],2)}const dn=ot(sn,[["render",un]]);async function cn(e,l){return await mn(l).catch(a=>(console.error("Failed to get image meta for "+l,a+""),{width:0,height:0,ratio:0}))}async function mn(e){if(typeof Image>"u")throw new TypeError("Image not supported");return new Promise((l,n)=>{const a=new Image;a.onload=()=>{const r={width:a.width,height:a.height,ratio:a.width/a.height};l(r)},a.onerror=r=>n(r),a.src=e})}function gt(e){return l=>l?e[l]||l:e.missingValue}function fn({formatter:e,keyMap:l,joinWith:n="/",valueMap:a}={}){e||(e=(o,s)=>`${o}=${s}`),l&&typeof l!="function"&&(l=gt(l));const r=a||{};return Object.keys(r).forEach(o=>{typeof r[o]!="function"&&(r[o]=gt(r[o]))}),(o={})=>Object.entries(o).filter(([f,p])=>typeof p<"u").map(([f,p])=>{const C=r[f];return typeof C=="function"&&(p=C(o[f])),f=typeof l=="function"?l(f):f,e(f,p)}).join(n)}function be(e=""){if(typeof e=="number")return e;if(typeof e=="string"&&e.replace("px","").match(/^\d+$/g))return Number.parseInt(e,10)}function pn(e=""){if(e===void 0||!e.length)return[];const l=new Set;for(const n of e.split(" ")){const a=Number.parseInt(n.replace("x",""));a&&l.add(a)}return Array.from(l)}function gn(e){if(e.length===0)throw new Error("`densities` must not be empty, configure to `1` to render regular size only (DPR 1.0)")}function vn(e){const l={};if(typeof e=="string")for(const n of e.split(/[\s,]+/).filter(a=>a)){const a=n.split(":");a.length!==2?l["1px"]=a[0].trim():l[a[0].trim()]=a[1].trim()}else Object.assign(l,e);return l}function hn(e){const l={options:e},n=(r,o={})=>Mt(l,r,o),a=(r,o={},s={})=>n(r,{...s,modifiers:st(o,s.modifiers||{})}).url;for(const r in e.presets)a[r]=(o,s,f)=>a(o,s,{...e.presets[r],...f});return a.options=e,a.getImage=n,a.getMeta=(r,o)=>wn(l,r,o),a.getSizes=(r,o)=>kn(l,r,o),l.$img=a,a}async function wn(e,l,n){const a=Mt(e,l,{...n});return typeof a.getMeta=="function"?await a.getMeta():await cn(e,a.url)}function Mt(e,l,n){var C,y;if(l&&typeof l!="string")throw new TypeError(`input must be a string (received ${typeof l}: ${JSON.stringify(l)})`);if(!l||l.startsWith("data:"))return{url:l};const{provider:a,defaults:r}=yn(e,n.provider||e.options.provider),o=bn(e,n.preset);if(l=ft(l)?l:jt(l),!a.supportsAlias){for(const F in e.options.alias)if(l.startsWith(F)){const P=e.options.alias[F];P&&(l=tt(P,l.slice(F.length)))}}if(a.validateDomains&&ft(l)){const F=Tt(l).host;if(!e.options.domains.find(P=>P===F))return{url:l}}const s=st(n,o,r);s.modifiers={...s.modifiers};const f=s.modifiers.format;(C=s.modifiers)!=null&&C.width&&(s.modifiers.width=be(s.modifiers.width)),(y=s.modifiers)!=null&&y.height&&(s.modifiers.height=be(s.modifiers.height));const p=a.getImage(l,s,e);return p.format=p.format||f||"",p}function yn(e,l){const n=e.options.providers[l];if(!n)throw new Error("Unknown provider: "+l);return n}function bn(e,l){if(!l)return{};if(!e.options.presets[l])throw new Error("Unknown preset: "+l);return e.options.presets[l]}function kn(e,l,n){var _,z,N,k,c;const a=be((_=n.modifiers)==null?void 0:_.width),r=be((z=n.modifiers)==null?void 0:z.height),o=vn(n.sizes),s=(N=n.densities)!=null&&N.trim()?pn(n.densities.trim()):e.options.densities;gn(s);const f=a&&r?r/a:0,p=[],C=[];if(Object.keys(o).length>=1){for(const v in o){const g=vt(v,String(o[v]),r,f,e);if(g!==void 0){p.push({size:g.size,screenMaxWidth:g.screenMaxWidth,media:`(max-width: ${g.screenMaxWidth}px)`});for(const u of s)C.push({width:g._cWidth*u,src:ht(e,l,n,g,u)})}}xn(p)}else for(const v of s){const g=Object.keys(o)[0];let u=g?vt(g,String(o[g]),r,f,e):void 0;u===void 0&&(u={size:"",screenMaxWidth:0,_cWidth:(k=n.modifiers)==null?void 0:k.width,_cHeight:(c=n.modifiers)==null?void 0:c.height}),C.push({width:v,src:ht(e,l,n,u,v)})}_n(C);const y=C[C.length-1],F=p.length?p.map(v=>`${v.media?v.media+" ":""}${v.size}`).join(", "):void 0,P=F?"w":"x",U=C.map(v=>`${v.src} ${v.width}${P}`).join(", ");return{sizes:F,srcset:U,src:y==null?void 0:y.src}}function vt(e,l,n,a,r){const o=r.options.screens&&r.options.screens[e]||Number.parseInt(e),s=l.endsWith("vw");if(!s&&/^\d+$/.test(l)&&(l=l+"px"),!s&&!l.endsWith("px"))return;let f=Number.parseInt(l);if(!o||!f)return;s&&(f=Math.round(f/100*o));const p=a?Math.round(f*a):n;return{size:l,screenMaxWidth:o,_cWidth:f,_cHeight:p}}function ht(e,l,n,a,r){return e.$img(l,{...n.modifiers,width:a._cWidth?a._cWidth*r:void 0,height:a._cHeight?a._cHeight*r:void 0},n)}function xn(e){var n;e.sort((a,r)=>a.screenMaxWidth-r.screenMaxWidth);let l=null;for(let a=e.length-1;a>=0;a--){const r=e[a];r.media===l&&e.splice(a,1),l=r.media}for(let a=0;a<e.length;a++)e[a].media=((n=e[a+1])==null?void 0:n.media)||""}function _n(e){e.sort((n,a)=>n.width-a.width);let l=null;for(let n=e.length-1;n>=0;n--){const a=e[n];a.width===l&&e.splice(n,1),l=a.width}}const $n=fn({keyMap:{format:"f",fit:"fit",width:"w",height:"h",resize:"s",quality:"q",background:"b"},joinWith:"&",formatter:(e,l)=>pt(e)+"_"+pt(l)}),Cn=(e,{modifiers:l={},baseURL:n}={},a)=>{l.width&&l.height&&(l.resize=`${l.width}x${l.height}`,delete l.width,delete l.height);const r=$n(l)||"_";return n||(n=tt(a.options.nuxt.baseURL,"/_ipx")),{url:tt(n,r,Bt(e))}},Sn=!0,In=!0,Rn=Object.freeze(Object.defineProperty({__proto__:null,getImage:Cn,supportsAlias:In,validateDomains:Sn},Symbol.toStringTag,{value:"Module"})),Ft={screens:{xs:320,sm:640,md:768,lg:1024,xl:1280,xxl:1536,"2xl":1536},presets:{},provider:"ipxStatic",domains:[],alias:{},densities:[1,2],format:["webp"]};Ft.providers={ipxStatic:{provider:Rn,defaults:{}}};const ct=()=>{const e=Nt(),l=Xe();return l.$img||l._img||(l._img=hn({...Ft,nuxt:{baseURL:e.app.baseURL},runtimeConfig:e}))};function Mn(e){var l;(l=performance==null?void 0:performance.mark)==null||l.call(performance,"mark_feature_usage",{detail:{feature:e}})}const Fn={src:{type:String,required:!1},format:{type:String,required:!1},quality:{type:[Number,String],required:!1},background:{type:String,required:!1},fit:{type:String,required:!1},modifiers:{type:Object,required:!1},preset:{type:String,required:!1},provider:{type:String,required:!1},sizes:{type:[Object,String],required:!1},densities:{type:String,required:!1},preload:{type:[Boolean,Object],required:!1},width:{type:[String,Number],required:!1},height:{type:[String,Number],required:!1},alt:{type:String,required:!1},referrerpolicy:{type:String,required:!1},usemap:{type:String,required:!1},longdesc:{type:String,required:!1},ismap:{type:Boolean,required:!1},loading:{type:String,required:!1,validator:e=>["lazy","eager"].includes(e)},crossorigin:{type:[Boolean,String],required:!1,validator:e=>["anonymous","use-credentials","",!0,!1].includes(e)},decoding:{type:String,required:!1,validator:e=>["async","auto","sync"].includes(e)},nonce:{type:[String],required:!1}},Pn=e=>{const l=E(()=>({provider:e.provider,preset:e.preset})),n=E(()=>({width:be(e.width),height:be(e.height),alt:e.alt,referrerpolicy:e.referrerpolicy,usemap:e.usemap,longdesc:e.longdesc,ismap:e.ismap,crossorigin:e.crossorigin===!0?"anonymous":e.crossorigin||void 0,loading:e.loading,decoding:e.decoding,nonce:e.nonce})),a=ct(),r=E(()=>({...e.modifiers,width:be(e.width),height:be(e.height),format:e.format,quality:e.quality||a.options.quality,background:e.background,fit:e.fit}));return{options:l,attrs:n,modifiers:r}},Un={...Fn,placeholder:{type:[Boolean,String,Number,Array],required:!1},placeholderClass:{type:String,required:!1},custom:{type:Boolean,required:!1}},zn=["src"],xe=le({__name:"NuxtImg",props:Un,emits:["load","error"],setup(e,{emit:l}){const n=e,a=Lt(),r=l,o=!1,s=ct(),f=Pn(n),p=x(!1),C=x(),y=E(()=>s.getSizes(n.src,{...f.options.value,sizes:n.sizes,densities:n.densities,modifiers:{...f.modifiers.value,width:be(n.width),height:be(n.height)}})),F=E(()=>{const k={...f.attrs.value,"data-nuxt-img":""};return(!n.placeholder||p.value)&&(k.sizes=y.value.sizes,k.srcset=y.value.srcset),k}),P=E(()=>{let k=n.placeholder;if(k===""&&(k=!0),!k||p.value)return!1;if(typeof k=="string")return k;const c=Array.isArray(k)?k:typeof k=="number"?[k,k]:[10,10];return s(n.src,{...f.modifiers.value,width:c[0],height:c[1],quality:c[2]||50,blur:c[3]||3},f.options.value)}),U=E(()=>n.sizes?y.value.src:s(n.src,f.modifiers.value,f.options.value)),_=E(()=>P.value?P.value:U.value),N=Xe().isHydrating;return Re(()=>{if(P.value||n.custom){const k=new Image;U.value&&(k.src=U.value),n.sizes&&(k.sizes=y.value.sizes||"",k.srcset=y.value.srcset),k.onload=c=>{p.value=!0,r("load",c)},k.onerror=c=>{r("error",c)},Mn("nuxt-image");return}C.value&&(C.value.complete&&N&&(C.value.getAttribute("data-error")?r("error",new Event("error")):r("load",new Event("load"))),C.value.onload=k=>{r("load",k)},C.value.onerror=k=>{r("error",k)})}),(k,c)=>k.custom?ze(k.$slots,"default",At(Ie({key:1},{...t(o)?{onerror:"this.setAttribute('data-error', 1)"}:{},imgAttrs:{...F.value,...t(a)},isLoaded:p.value,src:_.value}))):(d(),j("img",Ie({key:0,ref_key:"imgEl",ref:C,class:n.placeholder&&!p.value?n.placeholderClass:void 0},{...t(o)?{onerror:"this.setAttribute('data-error', 1)"}:{},...F.value,...t(a)},{src:_.value}),null,16,zn))}}),He=lt(Ce.ui.strategy,Ce.ui.range,an),Vn=le({inheritAttrs:!1,props:{modelValue:{type:Number,default:0},id:{type:String,default:null},name:{type:String,default:null},disabled:{type:Boolean,default:!1},min:{type:Number,default:0},max:{type:Number,default:100},step:{type:Number,default:1},size:{type:String,default:null,validator(e){return Object.keys(He.size).includes(e)}},color:{type:String,default:()=>He.default.color,validator(e){return Ce.ui.colors.includes(e)}},inputClass:{type:String,default:null},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})}},emits:["update:modelValue","change"],setup(e,{emit:l}){const{ui:n,attrs:a}=at("range",Ne(e,"ui"),He),{emitFormChange:r,inputId:o,color:s,size:f,name:p}=It(e,He),C=E({get(){return e.modelValue},set(k){l("update:modelValue",k)}}),y=k=>{l("change",k.target.value),r()},F=E(()=>Ge(Pe(n.value.wrapper,n.value.size[f.value]),e.class)),P=E(()=>Ge(Pe(n.value.base,n.value.background,n.value.rounded,s.value&&n.value.ring.replaceAll("{color}",s.value),n.value.size[f.value]),e.inputClass)),U=E(()=>Pe(n.value.thumb.base,s.value&&n.value.thumb.color.replaceAll("{color}",s.value),n.value.thumb.ring,n.value.thumb.background,n.value.thumb.size[f.value])),_=E(()=>Pe(n.value.track.base,n.value.track.background,n.value.track.rounded,n.value.track.size[f.value])),z=E(()=>Pe(n.value.progress.base,n.value.progress.rounded,s.value&&n.value.progress.background.replaceAll("{color}",s.value),n.value.progress.size[f.value])),N=E(()=>{const{modelValue:k,min:c,max:v}=e;return{width:`${(Math.max(c,Math.min(k,v))-c)/(v-c)*100}%`}});return{ui:n,attrs:a,name:p,inputId:o,value:C,wrapperClass:F,inputClass:P,thumbClass:U,trackClass:_,progressClass:z,progressStyle:N,onChange:y}}}),On=["id","name","min","max","disabled","step"];function jn(e,l,n,a,r,o){return d(),j("div",{class:te(e.wrapperClass)},[it(h("input",Ie({id:e.inputId,ref:"input","onUpdate:modelValue":l[0]||(l[0]=s=>e.value=s),name:e.name,min:e.min,max:e.max,disabled:e.disabled,step:e.step,type:"range",class:[e.inputClass,e.thumbClass,e.trackClass]},e.attrs,{onChange:l[1]||(l[1]=(...s)=>e.onChange&&e.onChange(...s))}),null,16,On),[[qt,e.value,void 0,{number:!0}]]),h("span",{class:te(e.progressClass),style:Et(e.progressStyle)},null,6)],2)}const Pt=ot(Vn,[["render",jn]]),Tn={class:"image-mask flex flex-col w-full"},Bn={class:"canvas flex flex-col items-center justify-center mb-3 w-full"},Nn={class:"preview-over-original relative"},Ln={class:"actions flex items-center justify-center mb-3 mx-auto"},An={class:"options w-full max-w-[320px]"},qn=le({__name:"ImageInpaint",props:Le({imageSrc:{type:String,required:!0}},{imageInpaintMask:{default:"",type:String},imageInpaintMaskModifiers:{},imageInpaintMaskData:{default:{},type:Object},imageInpaintMaskDataModifiers:{}}),emits:["update:imageInpaintMask","update:imageInpaintMaskData"],setup(e){const l=e,n=Ve(e,"imageInpaintMask"),a=Ve(e,"imageInpaintMaskData"),r=ge(),o=x(null),s=x(null),f=x(null),p=x(null),C=x(30),y=x([]),F=x({width:r.$state.outputMaxSize,height:r.$state.outputMaxSize}),P=x(null),U=x({x:0,y:0}),_=x({x:0,y:0,radius:C.value,fill:"rgba(255, 255, 255, 0.5)",stroke:null,strokeWidth:0,visible:!1}),z=x(5),N=x(!1),k=x([]),c=x([]);function v(){if(!o.value||!f.value){console.error("Could not get stage, image layer, or mask layer");return}const R=o.value.getNode(),T=p.value?p.value.width:R.width(),H=p.value?p.value.height:R.height(),B=document.createElement("canvas");B.width=T,B.height=H;const G=B.getContext("2d");if(!G){console.error("Could not get 2d context for mask canvas");return}G.fillStyle="black",G.fillRect(0,0,T,H);const de=T/R.width(),me=H/R.height();G.fillStyle="white",y.value.forEach(ye=>{G.beginPath(),G.arc(ye.x*de,ye.y*me,ye.radius*Math.max(de,me),0,Math.PI*2,!0),G.closePath(),G.fill()});const fe=B.toDataURL("image/png",1);fe?(V(),n.value=fe,_.value.visible=!1,N.value=!1):console.error("Could not get data URI for masked image")}function g(R){const T=o.value.getNode();if(R.type.startsWith("touch")){const H=R.evt.touches[0]||R.evt.changedTouches[0];return{x:H.clientX-T.getContainer().offsetLeft,y:H.clientY-T.getContainer().offsetTop}}return T.getPointerPosition()}function u(R){R.type==="mousedown"&&R.evt.button!==0||(N.value=!0,U.value=g(R),S(),O(U.value))}function O(R){const T={x:R.x,y:R.y,radius:C.value,fill:"rgba(255, 255, 255, 1)"};y.value=y.value.filter(H=>!(i({x:H.x,y:H.y},R)+H.radius<=T.radius)),y.value.push(T)}function i(R,T){return Math.sqrt(Math.pow(T.x-R.x,2)+Math.pow(T.y-R.y,2))}function b(R){if(R.type.startsWith("touch")&&R.evt.preventDefault(),ve(R),!N.value)return;const T=g(R);i(U.value,g(R))>=z.value&&(O(T),U.value=T)}function S(){k.value.push([...y.value]),c.value=[]}function V(){a.value={circles:[...y.value],brushRadius:C.value,undoStack:k.value,redoStack:c.value}}function W(){a.value!==null&&(y.value=a.value.circles||[],C.value=a.value.brushRadius||30,k.value=a.value.undoStack||[],c.value=a.value.redoStack||[])}function ae(){k.value.length!==0&&(c.value.push([...y.value]),y.value=k.value.pop()||[])}function oe(){c.value.length!==0&&(k.value.push([...y.value]),y.value=c.value.pop()||[])}function ee(){N.value=!1}function we(){n.value=""}function J(){S(),y.value=[],n.value=""}const ue=E(()=>k.value.length>0),Z=E(()=>c.value.length>0);function ve(R){const T=g(R);_.value.x=T.x,_.value.y=T.y}function K(){_.value.visible=!1,N.value=!1}function A(){_.value.visible=!0,_.value.radius=C.value}function I(){const R=new Image;R.src=l.imageSrc,R.onload=()=>{p.value=R,q(),Y()}}function q(){if(!p.value)return;const R=window.innerWidth,T=window.innerHeight,H=p.value.width/p.value.height;let B,G;const de=Math.min(R*.9,1200),me=Math.min(T*.8,r.outputMaxSize);H>de/me?(B=de,G=B/H):(G=me,B=G*H),F.value={width:Math.floor(B),height:Math.floor(G)},Y()}function Y(){const R=F.value.width,T=F.value.height,H=p.value.width,B=p.value.height,G=R/H,de=T/B,me=Math.min(G,de);P.value={x:0,y:0,width:H*me,height:B*me}}return Je(()=>{I(),W()}),Re(()=>{if(o.value){const R=o.value.getNode();R.on("touchstart",u),R.on("touchmove",b),R.on("touchend",ee),R.on("touchcancel",K)}}),wt(()=>{if(o.value){const R=o.value.getNode();R.off("touchstart"),R.off("touchmove"),R.off("touchend"),R.off("touchcancel")}V()}),(R,T)=>{const H=xe,B=Be("v-image"),G=Be("v-layer"),de=Be("v-circle"),me=Be("v-stage"),fe=re,ye=Pt,Me=De;return d(),j("div",Tn,[h("div",Bn,[T[1]||(T[1]=h("p",{class:"text-sm my-2 text-slate-500"},"Select the target area for image inpaint",-1)),h("div",Nn,[e.imageSrc&&e.imageSrc!==""&&n.value!==""?(d(),$(H,{key:0,src:e.imageSrc,fit:"inside",width:t(F).width,height:t(F).height,draggable:"false",class:te({absolute:n.value!==""})},null,8,["src","width","height","class"])):M("",!0),n.value?(d(),$(H,{key:1,src:n.value,fit:"inside",width:t(F).width,height:t(F).height,draggable:"false",class:"opacity-50"},null,8,["src","width","height"])):M("",!0)]),n.value===""?(d(),$(me,{key:0,ref_key:"stageRef",ref:o,config:t(F),onMousedown:u,onMousemove:b,onMouseup:ee,onMouseleave:K,onMouseenter:A},{default:w(()=>[m(G,{ref_key:"imageLayerRef",ref:s},{default:w(()=>[m(B,{image:t(p),config:t(F)},null,8,["image","config"])]),_:1},512),m(G,{ref_key:"maskLayerRef",ref:f},{default:w(()=>[(d(!0),j(ie,null,pe(t(y),(_e,Fe)=>(d(),$(de,{key:Fe,config:_e},null,8,["config"]))),128)),t(_).visible?(d(),$(de,{key:0,config:t(_)},null,8,["config"])):M("",!0)]),_:1},512)]),_:1},8,["config"])):M("",!0)]),h("div",Ln,[m(fe,{class:"mr-2",size:"xs",icon:"i-heroicons-clipboard-document-check-16-solid",variant:"soft",disabled:t(y).length===0||n.value!=="",onClick:v},{default:w(()=>T[2]||(T[2]=[D(" Apply ")])),_:1},8,["disabled"]),m(fe,{class:"mr-2",size:"xs",icon:"i-heroicons-arrow-uturn-left-16-solid",variant:"soft",color:"cyan",disabled:!t(ue)||n.value!=="",onClick:ae},null,8,["disabled"]),m(fe,{class:"mr-2",size:"xs",icon:"i-heroicons-arrow-uturn-right-16-solid",variant:"soft",color:"cyan",disabled:!t(Z)||n.value!=="",onClick:oe},null,8,["disabled"]),m(fe,{class:"mr-2",size:"xs",icon:"i-heroicons-arrow-turn-up-left-20-solid",variant:"soft",disabled:t(y).length===0&&n.value==="",color:"red",onClick:J},{default:w(()=>T[3]||(T[3]=[D(" Reset ")])),_:1},8,["disabled"]),m(fe,{size:"xs",icon:"i-heroicons-pencil-solid",variant:"soft",disabled:n.value==="",color:"orange",onClick:we},{default:w(()=>T[4]||(T[4]=[D(" Edit ")])),_:1},8,["disabled"])]),h("div",An,[m(Me,{class:"mb-3 text-sm",hint:`value: ${t(C)}`,label:"Brush radius"},{default:w(()=>[m(ye,{modelValue:t(C),"onUpdate:modelValue":T[0]||(T[0]=_e=>Q(C)?C.value=_e:null),min:1,max:100,size:"sm",class:"my-2",disabled:n.value!==""},null,8,["modelValue","disabled"])]),_:1},8,["hint"])])])}}});function mt(e={}){const{copy:l,isSupported:n}=Dt(),a=Oe();function r(o,s={},f={}){n&&l(o).then(()=>{!s.title&&!s.description||a.add({...s,...e})},function(p){a.add({...f,description:f.description||p.message,...e})})}return{copy:r}}const En="0.05";function Dn(e,l){const n=parseFloat(e);if(isNaN(n))return e;const a=n+l;return a<0?"0":String(Number(a.toFixed(10)))}function Wn(e,l){let n=l,a=l,r=0,o=0;for(;n>=0&&(n--,!(e[n]==="("&&r===o));)e[n]==="("&&r++,e[n]===")"&&o++;if(n<0)return!1;for(r=0,o=0;a<e.length&&!(e[a]===")"&&r===o);)e[a]==="("&&r++,e[a]===")"&&o++,a++;return a===e.length?!1:{start:n+1,end:a}}function Hn(e){const l=/^\((.*)\)$/,n=e.match(l),a=/:([+-]?(\d*\.)?\d+([eE][+-]?\d+)?)/,r=e.match(a);return n&&!r?`(${n[1]}:1.0)`:e}function Gn(e){const l=e.composedPath()[0],n=parseFloat(En);if(l.tagName!=="TEXTAREA"||!(e.key==="ArrowUp"||e.key==="ArrowDown")||!e.ctrlKey&&!e.metaKey)return;e.preventDefault();let a=l.selectionStart,r=l.selectionEnd,o=l.value.substring(a,r);if(!o){const p=Wn(l.value,a);if(p)a=p.start,r=p.end,o=l.value.substring(a,r);else{const C=" .,\\/!?%^*;:{}=-_`~()\r\n	";for(;!C.includes(l.value[a-1])&&a>0;)a--;for(;!C.includes(l.value[r])&&r<l.value.length;)r++;if(o=l.value.substring(a,r),!o)return}}o[o.length-1]===" "&&(o=o.substring(0,o.length-1),r-=1),l.value[a-1]==="("&&l.value[r]===")"&&(a-=1,r+=1,o=l.value.substring(a,r)),(o[0]!=="("||o[o.length-1]!==")")&&(o=`(${o})`),o=Hn(o);const s=e.key==="ArrowUp"?n:-n,f=o.replace(/\((.*):(\d+(?:\.\d+)?)\)/,(p,C,y)=>(y=Dn(y,s),Number(y)==1?C:`(${C}:${y})`));return l.setRangeText(f,a,r,"select"),l.value}const Xn={key:0,class:"text-red-300"},Jn={class:"flex items-center"},Qn={class:"p-2 max-w-48 max-h-48 not-italic"},Kn={class:"block font-medium text-gray-700 dark:text-gray-200"},Yn={key:0,class:"flex items-center"},Zn={key:2,class:"flex flex-row flex-grow items-center justify-between"},el={key:3,class:"flex flex-row flex-grow items-center"},tl={class:"sm:inline"},nl={class:"preview-over-original relative"},ll={key:1,class:"text-red-300 text-sm"},ol=le({__name:"InputParam",props:{inputParam:{type:Object,required:!0},index:{type:Number,required:!0},inputParamsMap:{type:Array,required:!0},advanced:{type:Boolean,default:!1}},setup(e){const l=e,n=x(!1),a=x(null),r=x(""),o=x({width:0,height:0}),s=x(""),f=x({}),p=x(null),C=l.inputParamsMap[l.index][l.inputParam.name].source_input_name,y=l.inputParamsMap.findIndex(g=>{if(Object.keys(g)[0]===l.inputParamsMap[l.index][l.inputParam.name].source_input_name)return!0});function F(){try{const g=l.inputParamsMap.find(u=>{const O=Object.keys(u)[0];if(O===C)return u[O]});N(g[C].value)}catch{o.value.width=0,o.value.height=0}}Re(()=>{l.inputParam.type==="range_scale"&&F(),l.inputParam.type==="image-mask"&&he(s,g=>{const u=new File([s.value],`image-mask-${l.inputParam.name}.png`,{type:"image/png"});l.inputParamsMap[l.index][l.inputParam.name].value=u,l.inputParamsMap[l.index][l.inputParam.name].mask_applied=g!==""})}),l.inputParam.type==="range_scale"&&he(l.inputParamsMap,()=>{F()});function P(g){return g?URL.createObjectURL(g):""}function U(){URL.revokeObjectURL(r.value),r.value="",a.value&&(a.value.$refs.input.value=""),l.inputParamsMap[l.index][l.inputParam.name].value=null,l.inputParamsMap[l.index][l.inputParam.name].image_preview_url=""}function _(){URL.revokeObjectURL(s.value),s.value="",f.value={},l.inputParamsMap[l.index][l.inputParam.name].value=null,l.inputParamsMap[l.index][l.inputParam.name].mask_applied=!1}const z=E(()=>l.inputParam.type!=="bool"?l.inputParam.display_name:"");function N(g){if(!(g instanceof File)){o.value.width=0,o.value.height=0;return}const u=URL.createObjectURL(g),O=new Image;O.onload=function(){o.value.width=O.naturalWidth,o.value.height=O.naturalHeight,URL.revokeObjectURL(O.src)},O.src=u}const k=E(()=>{if(l.inputParam.type==="range_scale"){const g=l.inputParamsMap[l.index][l.inputParam.name].value;return`value: ${g}x (${o.value.width}x${o.value.height} -> ${(o.value.width*g).toFixed(0)}x${(o.value.height*g).toFixed(0)})`}return["range","range_scale"].includes(l.inputParam.type)?`value: ${l.inputParamsMap[l.index][l.inputParam.name].value}`:""}),c=x(null);function v(g){const u=Gn(g);u&&(l.inputParamsMap[l.index][l.inputParam.name].value=u)}return Re(()=>{l.inputParam.type==="text"&&c.value&&c.value.$refs.textarea.addEventListener("keydown",v),l.inputParam.type==="image-mask"&&(p.value=l.inputParamsMap[y][C],he(l.inputParamsMap[y][C],g=>{s.value="",f.value={},p.value=g}))}),wt(()=>{URL.revokeObjectURL(r.value),URL.revokeObjectURL(s.value),l.inputParam.type==="text"&&c.value&&c.value.$refs.textarea.removeEventListener("keydown",v)}),(g,u)=>{var Z,ve;const O=re,i=Ae,b=yt,S=dn,V=Ee,W=xe,ae=qn,oe=Se,ee=Ye,we=We,J=Pt,ue=De;return(((Z=e.inputParam)==null?void 0:Z.advanced)||!1)===e.advanced?(d(),$(ue,{key:0,class:te(["mb-3",{italic:(ve=e.inputParam)==null?void 0:ve.dynamic_lora}]),help:t(k)},{hint:w(()=>[e.inputParam.optional?M("",!0):(d(),j("span",Xn,"required"))]),label:w(()=>{var K;return[h("div",Jn,[(K=e.inputParam)!=null&&K.dynamic_lora&&e.inputParam.trigger_words.length>0?(d(),$(b,{key:0},{panel:w(()=>[h("div",Qn,[u[17]||(u[17]=h("h4",{class:"mb-2 text-center"},"Trigger words",-1)),(d(!0),j(ie,null,pe(e.inputParam.trigger_words,A=>(d(),$(i,{key:A,color:"violet",class:"mr-1 cursor-pointer",onClick:()=>{("useCopyToClipboard"in g?g.useCopyToClipboard:t(mt))().copy(A),("useToast"in g?g.useToast:t(Oe))().add({title:"Clipboard",description:"Trigger word copied to clipboard",timeout:2e3})}},{default:w(()=>[D(X(A),1)]),_:2},1032,["onClick"]))),128))])]),default:w(()=>[m(O,{icon:"i-heroicons-information-circle",variant:"ghost",size:"xs",color:"gray",class:"mr-2"})]),_:1})):M("",!0),h("label",Kn,X(t(z)),1)])]}),default:w(()=>{var K,A,I,q,Y;return[e.inputParam.type==="text"?(d(),$(S,{key:0,ref_key:"textareaInput",ref:c,size:"md",placeholder:e.inputParam.display_name,required:!e.inputParam.optional,resize:!0,label:e.inputParam.display_name,value:e.inputParamsMap[e.index][e.inputParam.name].value,autoresize:"",variant:"outline",onInput:u[0]||(u[0]=R=>{const T=R.target;e.inputParamsMap[e.index][e.inputParam.name].value=T.value})},null,8,["placeholder","required","label","value"])):M("",!0),e.inputParam.type==="number"?(d(),j(ie,{key:1},[e.inputParam.name==="seed"?(d(),j("div",Yn,[e.inputParam.type==="number"?(d(),$(V,{key:0,modelValue:e.inputParamsMap[e.index][e.inputParam.name].value,"onUpdate:modelValue":u[1]||(u[1]=R=>e.inputParamsMap[e.index][e.inputParam.name].value=R),type:"number",label:e.inputParam.display_name,required:!e.inputParam.optional,max:e.inputParam.max||100,min:e.inputParam.min||0,variant:"outline"},null,8,["modelValue","label","required","max","min"])):M("",!0),m(O,{icon:"i-heroicons-arrow-path",color:"violet",variant:"outline",size:"xs",class:"ml-2",onClick:u[2]||(u[2]=()=>{e.inputParamsMap[e.index][e.inputParam.name].value=Math.floor(Math.random()*1e7)})})])):(d(),$(V,{key:1,modelValue:e.inputParamsMap[e.index][e.inputParam.name].value,"onUpdate:modelValue":u[3]||(u[3]=R=>e.inputParamsMap[e.index][e.inputParam.name].value=R),type:"number",label:e.inputParam.display_name,required:!e.inputParam.optional,max:e.inputParam.max||100,min:e.inputParam.min||0,variant:"outline"},null,8,["modelValue","label","required","max","min"]))],64)):M("",!0),e.inputParam.type==="image"?(d(),j("div",Zn,[m(V,{ref_key:"imageInput",ref:a,type:"file",accept:"image/*",class:"w-full",variant:"outline",color:"gray",label:e.inputParam.display_name,onChange:u[4]||(u[4]=R=>{console.debug("files",R);const T=R==null?void 0:R[0];e.inputParamsMap[e.index][e.inputParam.name].value=T,r.value=P(T),e.inputParamsMap[e.index][e.inputParam.name].image_preview_url=t(r),console.debug("inputParamsMap",e.inputParamsMap)})},null,8,["label"]),t(r)!==""?(d(),$(W,{key:0,src:t(s)?t(s):t(r),class:"h-10 rounded-lg cursor-pointer ml-2",onClick:u[5]||(u[5]=()=>{n.value=!0})},null,8,["src"])):M("",!0),t(r)!==""?(d(),$(O,{key:1,icon:"i-heroicons-x-mark",variant:"outline",class:"ml-2",onClick:U})):M("",!0)])):M("",!0),e.inputParam.type==="image-mask"?(d(),j("div",el,[t(p)?(d(),$(O,{key:0,icon:"i-heroicons-paint-brush-16-solid",class:"mr-2",color:"violet",variant:"outline",size:"xs",disabled:!((K=t(p))!=null&&K.value),onClick:u[6]||(u[6]=()=>{n.value=!0})},{default:w(()=>[h("span",tl,X(t(s)!==""?"Edit mask":"Draw mask"),1)]),_:1},8,["disabled"])):M("",!0),h("div",nl,[t(p)&&((A=t(p))!=null&&A.value)?(d(),$(W,{key:0,src:(I=t(p))==null?void 0:I.image_preview_url,class:te(["h-10 rounded-lg cursor-pointer",{absolute:t(s)!==""}]),onClick:u[7]||(u[7]=()=>{n.value=!0})},null,8,["src","class"])):M("",!0),t(s)?(d(),$(W,{key:1,src:t(s),class:"h-10 rounded-lg cursor-pointer opacity-50",onClick:u[8]||(u[8]=()=>{n.value=!0})},null,8,["src"])):M("",!0)]),!t(p)||t(p)&&!((q=t(p))!=null&&q.value)?(d(),j("span",ll," Select source image ")):M("",!0),t(s)?(d(),$(O,{key:2,icon:"i-heroicons-x-mark",variant:"outline",color:"violet",class:"ml-2",onClick:_})):M("",!0)])):M("",!0),e.inputParam.type==="image"||e.inputParam.type==="image-mask"?(d(),$(oe,{key:4,modelValue:t(n),"onUpdate:modelValue":u[13]||(u[13]=R=>Q(n)?n.value=R:null),class:"z-[90] overflow-y-auto",transition:!1,fullscreen:""},{default:w(()=>{var R;return[m(O,{class:"absolute top-4 right-4 z-[100]",icon:"i-heroicons-x-mark",variant:"ghost",onClick:u[9]||(u[9]=()=>n.value=!1)}),e.inputParam.type==="image"?(d(),j("div",{key:0,class:"flex items-center justify-center w-full h-full p-4",onClick:u[10]||(u[10]=Qe(()=>n.value=!1,["left"]))},[m(W,{class:"lg:h-full",fit:"inside",src:t(r)},null,8,["src"])])):(d(),$(ae,{key:1,ref:"imageInpaint","image-inpaint-mask":t(s),"onUpdate:imageInpaintMask":u[11]||(u[11]=T=>Q(s)?s.value=T:null),"image-inpaint-mask-data":t(f),"onUpdate:imageInpaintMaskData":u[12]||(u[12]=T=>Q(f)?f.value=T:null),class:"flex items-center justify-center w-full h-full p-4","image-src":(R=t(p))==null?void 0:R.image_preview_url},null,8,["image-inpaint-mask","image-inpaint-mask-data","image-src"]))]}),_:1},8,["modelValue"])):M("",!0),e.inputParam.type==="list"?(d(),$(ee,{key:5,modelValue:e.inputParamsMap[e.index][e.inputParam.name].value,"onUpdate:modelValue":u[14]||(u[14]=R=>e.inputParamsMap[e.index][e.inputParam.name].value=R),placeholder:e.inputParam.display_name,options:Object.keys(e.inputParam.options)},null,8,["modelValue","placeholder","options"])):M("",!0),e.inputParam.type==="bool"?(d(),$(we,{key:6,modelValue:e.inputParamsMap[e.index][e.inputParam.name].value,"onUpdate:modelValue":u[15]||(u[15]=R=>e.inputParamsMap[e.index][e.inputParam.name].value=R),label:(Y=e.inputParam)==null?void 0:Y.display_name},null,8,["modelValue","label"])):M("",!0),["range","range_scale"].includes(e.inputParam.type)?(d(),$(J,{key:7,modelValue:e.inputParamsMap[e.index][e.inputParam.name].value,"onUpdate:modelValue":u[16]||(u[16]=R=>e.inputParamsMap[e.index][e.inputParam.name].value=R),label:e.inputParam.display_name,size:"sm",min:e.inputParam.min,max:e.inputParam.max,step:e.inputParam.step},null,8,["modelValue","label","min","max","step"])):M("",!0)]}),_:1},8,["class","help"])):M("",!0)}}}),al={key:0,class:"heading"},sl={key:1},il={key:0,class:"max-h-96 overflow-y-auto mt-5"},rl={class:"heading"},ul={key:0,class:"p-4"},dl={key:0,class:"flex items-center w-full max-w-xs"},cl=le({__name:"InputParams",props:Le({inputParamsMap:{type:Array,required:!0},additionalInputParamsMap:{type:Array,required:!1,default:[]},advanced:{type:Boolean,default:!1}},{profilingOptions:{default:{},type:Object},profilingOptionsModifiers:{},profilingEnabled:{default:!1,type:Boolean},profilingEnabledModifiers:{}}),emits:["update:profilingOptions","update:profilingEnabled"],setup(e){const l=e,n=ge(),a=rt(),r=Wt(),o=x(!l.advanced),s=Ve(e,"profilingOptions"),f=Ve(e,"profilingEnabled"),p=x(!0),C=E(()=>r.workers.map(y=>({value:y.worker_id,label:`${y.worker_id} (type: ${y.device_type}, vram_total: ${Ue(y.vram_total)})`})));return Je(()=>{var F;if(!a.isAdmin)return;const y=localStorage.getItem(`profilingOptions_${(F=n.currentFlow)==null?void 0:F.name}`);y&&(s.value=JSON.parse(y)),r.fetchWorkersInfo().then(()=>{r.workers.find(U=>{var _;return U.worker_id===((_=s.value["X-WORKER-ID"])==null?void 0:_.value)})||(s.value["X-WORKER-ID"]=null)})}),(y,F)=>{const P=ke,U=ol,_=We,z=Ye,N=re,k=Ee,c=De;return d(),j(ie,null,[e.advanced?(d(),j("div",al,[h("h4",{class:"text-md font-bold cursor-pointer select-none flex items-center mb-3",onClick:F[0]||(F[0]=()=>{o.value=!t(o)})},[m(P,{name:t(o)?"i-heroicons-chevron-up":"i-heroicons-chevron-down",class:"mr-2"},null,8,["name"]),F[3]||(F[3]=D(" Advanced options "))])])):M("",!0),t(o)?(d(),j("div",sl,[(d(!0),j(ie,null,pe(t(n).currentFlow.input_params,(v,g)=>(d(),$(U,{key:g,"input-params-map":e.inputParamsMap,index:g,"input-param":v,advanced:e.advanced},null,8,["input-params-map","index","input-param","advanced"]))),128)),(d(!0),j(ie,null,pe(e.additionalInputParamsMap,(v,g)=>(d(),$(U,{key:Object.keys(v)[0],"input-params-map":e.additionalInputParamsMap,index:g,"input-param":v[Object.keys(v)[0]],advanced:e.advanced},null,8,["input-params-map","index","input-param","advanced"]))),128)),t(a).isAdmin&&e.advanced?(d(),j("div",il,[h("div",rl,[h("h4",{class:"text-md font-bold cursor-pointer select-none flex items-center mb-3",onClick:F[1]||(F[1]=()=>{p.value=!t(p)})},[m(P,{name:t(p)?"i-heroicons-chevron-down":"i-heroicons-chevron-up",class:"mr-2"},null,8,["name"]),m(P,{name:"i-mdi-bug-outline",class:"mr-2"}),F[4]||(F[4]=D(" Execution settings "))])]),t(p)?M("",!0):(d(),j("div",ul,[m(_,{modelValue:f.value,"onUpdate:modelValue":F[2]||(F[2]=v=>f.value=v),label:"Enable Execution settings",class:"mb-3"},null,8,["modelValue"]),(d(!0),j(ie,null,pe(Object.keys(s.value),v=>(d(),$(c,{key:v,label:v},{default:w(()=>[v==="X-WORKER-ID"?(d(),j("div",dl,[m(z,{modelValue:s.value[v],"onUpdate:modelValue":g=>s.value[v]=g,options:t(C),placeholder:"Select worker",class:"w-full my-3"},null,8,["modelValue","onUpdate:modelValue","options"]),m(N,{icon:"i-heroicons-x-mark",variant:"outline",size:"sm",color:"orange",class:"ml-2",onClick:()=>s.value[v]=null},null,8,["onClick"]),m(N,{icon:"i-heroicons-arrow-path-solid",variant:"outline",size:"sm",color:"blue",class:"ml-2",onClick:()=>{t(r).fetchWorkersInfo().then(()=>{s.value[v]=t(C).find(g=>{var u;return g.value===((u=s.value[v])==null?void 0:u.value)})})}},null,8,["onClick"])])):(d(),$(k,{key:1,modelValue:s.value[v],"onUpdate:modelValue":g=>s.value[v]=g,placeholder:"Enter value",class:"my-3"},null,8,["modelValue","onUpdate:modelValue"]))]),_:2},1032,["label"]))),128))]))])):M("",!0)])):M("",!0)],64)}}}),ml={key:0,id:"prompt",class:"w-full my-10 lg:my-0 p-4 ring-1 ring-gray-200 dark:ring-gray-800 rounded-lg"},fl={class:"action flex items-center"},pl=le({__name:"Prompt",setup(e,{expose:l}){var v,g,u,O;const n=ge(),a=rt();let r=localStorage.getItem(`input_params_map_${(v=n.currentFlow)==null?void 0:v.name}`);if(r){const i=JSON.parse(r);"flow_version"in i&&i.flow_version.split(".")[0]===((g=n.currentFlow)==null?void 0:g.version.split(".")[0])?r=i:(r=null,localStorage.removeItem(`input_params_map_${(u=n.currentFlow)==null?void 0:u.name}`))}const o=x(((O=n.currentFlow)==null?void 0:O.input_params.map(i=>{var b;if(i.type==="text")return{[i.name]:{value:r!==null&&r[i.name]?r[i.name]:i.default||"",type:i.type,optional:i.optional,advanced:i.advanced||!1,default:i.default||"",translatable:i.translatable||!1,dynamic_lora:i.dynamic_lora||!1,trigger_words:i.trigger_words||[]}};if(i.type==="number")return{[i.name]:{value:r!==null&&r[i.name]?r[i.name]:i.default||0,type:i.type,optional:i.optional,advanced:i.advanced||!1,default:i.default||0,dynamic_lora:i.dynamic_lora||!1,trigger_words:i.trigger_words||[]}};if(i.type==="image")return{[i.name]:{value:null,type:i.type,optional:i.optional,advanced:i.advanced||!1,dynamic_lora:i.dynamic_lora||!1,trigger_words:i.trigger_words||[]}};if(i.type==="image-mask")return{[i.name]:{value:null,type:i.type,optional:i.optional,advanced:i.advanced||!1,source_input_name:i.source_input_name||null,dynamic_lora:i.dynamic_lora||!1,trigger_words:i.trigger_words||[]}};if(i.type==="list")return{[i.name]:{value:r!==null&&r[i.name]?r[i.name]:i.default||Object.keys(i.options)[0]||"",type:i.type,optional:i.optional,options:i.options,advanced:i.advanced||!1,default:Object.keys(i.options)[0]||"",dynamic_lora:i.dynamic_lora||!1,trigger_words:i.trigger_words||[]}};if(i.type==="bool")return{[i.name]:{value:r!==null&&r[i.name]?r[i.name]:i.default||!1,type:i.type,optional:i.optional,advanced:i.advanced||!1,default:i.default||!1,dynamic_lora:i.dynamic_lora||!1,trigger_words:i.trigger_words||[]}};if(["range","range_scale"].includes(i.type)){const S={value:r!==null&&r[i.name]?r[i.name]:i.default||0,type:i.type,optional:i.optional,advanced:i.advanced||!1,min:i.min||0,max:i.max||100,step:i.step||1,default:i.default||0,dynamic_lora:i.dynamic_lora||!1,trigger_words:i.trigger_words||[]};if(i.type==="range_scale"&&(S.source_input_name=i.source_input_name||null,S.source_input_name===null||S.source_input_name==="")){const V=(b=n.currentFlow)==null?void 0:b.input_params.find(W=>W.type==="image"&&!W.optional);V&&(S.source_input_name=V.name)}return{[i.name]:S}}}))||[]),s=x([]);n.currentFlow.is_seed_supported&&s.value.push({seed:{name:"seed",display_name:"Random seed",value:Math.floor(Math.random()*1e7),type:"number",optional:!0,advanced:!0,min:0,max:1e7}});const f=bt(),p=x(n.currentFlow.is_translations_supported&&f.settingsMap.translations_provider.value.trim()!==""),C=x(p.value);Je(()=>{const i=localStorage.getItem("translatePrompt");i&&(C.value=JSON.parse(i))}),he(C,i=>{localStorage.setItem("translatePrompt",JSON.stringify(i))});function y(i){console.debug("Copy prompt inputs",i),Object.keys(i).forEach(S=>{const V=o.value.findIndex(W=>Object.keys(W)[0]===S);V!==-1&&(o.value[V][S].value=i[S].value)});const b=document.getElementById("prompt");b&&b.scrollIntoView({behavior:"smooth"})}l({copyPromptInputs:y}),o.value.forEach(i=>{const b=Object.keys(i)[0];["image","image-mask"].includes(i[b].type)||he(()=>i[b].value,()=>{var V,W;const S={};o.value.forEach(ae=>{const oe=Object.keys(ae)[0];S[oe]=ae[oe].value}),localStorage.setItem(`input_params_map_${(V=n.currentFlow)==null?void 0:V.name}`,JSON.stringify({...S,flow_version:(W=n.currentFlow)==null?void 0:W.version}))})});const F=E(()=>o.value.filter(i=>{const b=Object.keys(i)[0];return!["image","image-mask"].includes(i[b].type)}).some(i=>{const b=Object.keys(i)[0];return i[b].value!==i[b].default}));function P(){o.value.forEach(i=>{const b=Object.keys(i)[0];i[b].type==="text"?i[b].value=i[b].default||"":i[b].type==="number"?i[b].value=i[b].default||i[b].min||0:i[b].type==="list"?i[b].value=Object.keys(i[b].options)[0]||"":i[b].type==="bool"?i[b].value=i[b].default||!1:["range","range_scale"].includes(i[b].type)&&(i[b].value=i[b].default||i[b].min||0)})}const U=x(!1),_=x(1),z=x(!1),N=E(()=>o.value.every(i=>{var V;const b=Object.keys(i)[0];if(i[b].optional)return!0;const S=i[b].value;if(i[b].type==="text")return S!=="";if(i[b].type==="number")return S>=i[b].min&&S<=i[b].max;if(i[b].type==="list")return S!==""&&Object.keys(i[b].options).includes(S);if(i[b].type==="bool")return!0;if(i[b].type==="range")return S>=i[b].min&&S<=i[b].max;if(i[b].type==="range_scale")return S>=i[b].min&&S<=i[b].max;if(i[b].type==="image")return S instanceof File&&S.size>0;if(i[b].type==="image-mask")return S instanceof File&&S.size>0&&(((V=i[b])==null?void 0:V.mask_applied)||!1)})),k=x({"X-WORKER-UNLOAD-MODELS":1,"X-WORKER-EXECUTION-PROFILER":1,"X-WORKER-ID":null}),c=x(!1);return he(()=>k.value,()=>{var i;a.isAdmin&&localStorage.setItem(`profilingOptions_${(i=n.currentFlow)==null?void 0:i.name}`,JSON.stringify(k.value))},{deep:!0}),(i,b)=>{const S=ke,V=cl,W=Ee,ae=De,oe=We,ee=re,we=qe;return t(n).currentFlow?(d(),j("div",ml,[h("h2",{class:"text-lg font-bold cursor-pointer select-none flex items-center mb-3",onClick:b[0]||(b[0]=()=>{z.value=!t(z)})},[m(S,{name:t(z)?"i-heroicons-chevron-down":"i-heroicons-chevron-up",class:"mr-2"},null,8,["name"]),b[10]||(b[10]=D(" Prompt "))]),it(h("div",null,[m(V,{"input-params-map":t(o),"onUpdate:inputParamsMap":b[1]||(b[1]=J=>Q(o)?o.value=J:null),"additional-input-params-map":t(s),"onUpdate:additionalInputParamsMap":b[2]||(b[2]=J=>Q(s)?s.value=J:null),advanced:!1},null,8,["input-params-map","additional-input-params-map"]),t(s).length>0?(d(),$(V,{key:0,"input-params-map":t(o),"onUpdate:inputParamsMap":b[3]||(b[3]=J=>Q(o)?o.value=J:null),"additional-input-params-map":t(s),"onUpdate:additionalInputParamsMap":b[4]||(b[4]=J=>Q(s)?s.value=J:null),"profiling-options":t(k),"onUpdate:profilingOptions":b[5]||(b[5]=J=>Q(k)?k.value=J:null),"profiling-enabled":t(c),"onUpdate:profilingEnabled":b[6]||(b[6]=J=>Q(c)?c.value=J:null),advanced:!0},null,8,["input-params-map","additional-input-params-map","profiling-options","profiling-enabled"])):M("",!0),t(n).currentFlow.is_count_supported?(d(),$(ae,{key:1,label:"Number of results"},{default:w(()=>[m(W,{modelValue:t(_),"onUpdate:modelValue":b[7]||(b[7]=J=>Q(_)?_.value=J:null),type:"number",min:"1",max:"50",label:"Batch size",class:"mb-3 max-w-fit flex justify-end"},null,8,["modelValue"])]),_:1})):M("",!0),t(p)?(d(),$(ae,{key:2,class:"my-3 flex justify-end"},{default:w(()=>[m(oe,{modelValue:t(C),"onUpdate:modelValue":b[8]||(b[8]=J=>Q(C)?C.value=J:null),label:"Translate prompt"},null,8,["modelValue"])]),_:1})):M("",!0),h("div",{class:te(["flex",{"justify-between":t(F),"justify-end":!t(F)}])},[t(F)?(d(),$(we,{key:0,text:"Reset input params values to defaults"},{default:w(()=>[m(ee,{icon:"i-heroicons-arrow-path-rounded-square",variant:"ghost",color:"amber",onClick:P},{default:w(()=>b[11]||(b[11]=[D(" Reset params ")])),_:1})]),_:1})):M("",!0),h("div",fl,[m(ee,{icon:"i-heroicons-sparkles-16-solid",variant:"outline",loading:t(U),disabled:!t(N),onClick:b[9]||(b[9]=()=>{U.value=!0;let J={};t(a).isAdmin&&t(c)&&(J=Object.fromEntries(Object.entries(t(k)).filter(([ue,Z])=>Z!==null).map(([ue,Z])=>ue==="X-WORKER-ID"?[ue,Z==null?void 0:Z.value]:[ue,Z]))),t(n).runFlow(t(n).currentFlow,[...t(o),...t(s)],t(_),t(p)&&t(C),!1,null,J).finally(()=>{U.value=!1;const ue=t(s).find(Z=>Object.keys(Z)[0]==="seed");ue.seed.value=Number(ue.seed.value)+t(_)+1})})},{default:w(()=>b[12]||(b[12]=[D(" Run prompt ")])),_:1},8,["loading","disabled"])])],2)],512),[[kt,!t(z)]])])):M("",!0)}}}),gl=e=>{const l=x(0);function n(o){e.value.style.scrollSnapType="none",e.value.style.scrollBehavior="auto",l.value=o.pageX,window.addEventListener("mousemove",r),window.addEventListener("mouseup",a)}function a(){e.value.style.removeProperty("scroll-behavior"),e.value.style.removeProperty("scroll-snap-type"),e.value.style.removeProperty("pointer-events"),window.removeEventListener("mousemove",r),window.removeEventListener("mouseup",a)}function r(o){o.preventDefault(),e.value.style.pointerEvents="none";const s=o.pageX-l.value;l.value=o.pageX,e.value.scrollBy(-s,0)}Re(()=>{e.value&&e.value.addEventListener("mousedown",n)}),ut(()=>{e.value&&e.value.removeEventListener("mousedown",n)})},et=lt(Ce.ui.strategy,Ce.ui.carousel,on),vl=le({components:{UButton:re},inheritAttrs:!1,props:{items:{type:Array,default:()=>[]},arrows:{type:Boolean,default:!1},indicators:{type:Boolean,default:!1},dir:{type:String,default:"ltr"},prevButton:{type:Object,default:()=>et.default.prevButton},nextButton:{type:Object,default:()=>et.default.nextButton},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:void 0}},setup(e,{expose:l}){const{ui:n,attrs:a}=at("carousel",Ne(e,"ui"),et,Ne(e,"class")),r=x(),o=x(0),{x:s}=Ht(r,{behavior:"smooth"}),{width:f}=Gt(r);gl(r),Xt(r,N=>{var c,v;const[k]=N;o.value=((v=(c=k==null?void 0:k.target)==null?void 0:c.firstElementChild)==null?void 0:v.clientWidth)||0});const p=E(()=>e.dir==="rtl"),C=E(()=>o.value?p.value?Math.round(-s.value/o.value)+1:Math.round(s.value/o.value)+1:0),y=E(()=>{if(!o.value)return 0;const N=Math.round(f.value/o.value);return e.items.length<=N?0:e.items.length-N+1}),F=E(()=>C.value<=1),P=E(()=>C.value===y.value);function U(){s.value+=p.value?-o.value:o.value}function _(){s.value-=p.value?-o.value:o.value}function z(N){s.value=(N-1)*o.value*(p.value?-1:1)}return l({pages:y,page:C,prev:_,next:U,select:z}),{ui:n,attrs:a,isFirst:F,isLast:P,carouselRef:r,pages:y,currentPage:C,onClickNext:U,onClickPrev:_,onClick:z,twMerge:Ge}}}),hl=["dir"],wl=["role"],yl=["aria-selected","aria-label","onClick"];function bl(e,l,n,a,r,o){const s=re;return d(),j("div",Ie({class:e.ui.wrapper},e.attrs,{dir:e.dir}),[h("div",{ref:"carouselRef",class:te([e.ui.container,"no-scrollbar"])},[(d(!0),j(ie,null,pe(e.items,(f,p)=>(d(),j("div",{key:p,class:te(e.ui.item),role:e.indicators?"tabpanel":null},[ze(e.$slots,"default",{item:f,index:p},void 0,!0)],10,wl))),128))],2),e.arrows?(d(),j("div",{key:0,class:te(e.ui.arrows.wrapper)},[ze(e.$slots,"prev",{onClick:e.onClickPrev,disabled:e.isFirst},()=>{var f;return[e.prevButton?(d(),$(s,Ie({key:0,disabled:e.isFirst},{...e.ui.default.prevButton,...e.prevButton},{class:e.twMerge(e.ui.default.prevButton.class,(f=e.prevButton)==null?void 0:f.class),"aria-label":"Prev",onClick:e.onClickPrev}),null,16,["disabled","class","onClick"])):M("",!0)]},!0),ze(e.$slots,"next",{onClick:e.onClickNext,disabled:e.isLast},()=>{var f;return[e.nextButton?(d(),$(s,Ie({key:0,disabled:e.isLast},{...e.ui.default.nextButton,...e.nextButton},{class:e.twMerge(e.ui.default.nextButton.class,(f=e.nextButton)==null?void 0:f.class),"aria-label":"Next",onClick:e.onClickNext}),null,16,["disabled","class","onClick"])):M("",!0)]},!0)],2)):M("",!0),e.indicators?(d(),j("div",{key:1,role:"tablist",class:te(e.ui.indicators.wrapper)},[(d(!0),j(ie,null,pe(e.pages,f=>ze(e.$slots,"indicator",{key:f,onClick:e.onClick,active:f===e.currentPage,page:f},()=>[h("button",{type:"button",role:"tab","aria-selected":f===e.currentPage,class:te([e.ui.indicators.base,f===e.currentPage?e.ui.indicators.active:e.ui.indicators.inactive]),"aria-label":`set slide ${f}`,onClick:p=>e.onClick(f)},null,10,yl)],!0)),128))],2)):M("",!0)],16,hl)}const je=ot(vl,[["render",bl],["__scopeId","data-v-a3da86ff"]]),kl={class:"flex flex-col basis-full"},xl=le({__name:"InputFiles",props:{running:{type:Object,required:!0}},setup(e){const l=ct(),n=function(f,p){return`${xt()}/tasks/inputs?task_id=${f}&input_index=${p}`},a=x(!1),r=x(""),o=x(0),s=x(!0);return(f,p)=>{var _,z,N,k,c;const C=ke,y=xe,F=je,P=re,U=Se;return e.running&&e.running.input_files&&((_=Object.keys(e.running.input_files))==null?void 0:_.length)>0?(d(),j("div",{key:0,class:te(["ml-2 mt-2 mb-5",{"mb-10":((z=Object.keys(e.running.input_files))==null?void 0:z.length)>1&&!t(s)}])},[h("h4",{class:"mb-3 font-bold cursor-pointer select-none flex items-center text-sm",onClick:p[0]||(p[0]=()=>s.value=!t(s))},[m(C,{name:t(s)?"i-heroicons-chevron-down":"i-heroicons-chevron-up",class:"mr-2"},null,8,["name"]),h("span",null," Input files ("+X((N=Object.keys(e.running.input_files))==null?void 0:N.length)+") ",1)]),t(s)?M("",!0):(d(),j(ie,{key:0},[((k=Object.keys(e.running.input_files))==null?void 0:k.length)===1?(d(),$(y,{key:0,class:"mb-5 rounded-lg cursor-pointer",fit:"outside",loading:"lazy",placeholder:t(l)(`${("buildBackendUrl"in f?f.buildBackendUrl:t(nt))()}/vix_logo.png`,{f:"png",blur:3,q:50}),src:n(e.running.task_id,0),onClick:p[1]||(p[1]=()=>{r.value=n(e.running.task_id,0),o.value=0,a.value=!0})},null,8,["placeholder","src"])):M("",!0),((c=Object.keys(e.running.input_files))==null?void 0:c.length)>1?(d(),$(F,{key:1,items:Object.keys(e.running.input_files).map(v=>({task_id:e.running.task_id,index:v})),ui:{item:"basis-full md:basis-1/2",indicators:{wrapper:"relative bottom-0 mt-4"}},page:1,indicators:""},{default:w(({item:v})=>[h("div",kl,[m(y,{class:"rounded-lg cursor-pointer",fit:"outside",loading:"lazy",placeholder:t(l)(`${("buildBackendUrl"in f?f.buildBackendUrl:t(nt))()}/vix_logo.png`,{f:"png",blur:3,q:50}),src:n(v.task_id,v.index),onClick:()=>{r.value=n(e.running.task_id,v.index),o.value=v.index,a.value=!0}},null,8,["placeholder","src","onClick"])])]),_:1},8,["items"])):M("",!0),m(U,{modelValue:t(a),"onUpdate:modelValue":p[4]||(p[4]=v=>Q(a)?a.value=v:null),class:"z-[90]",transition:!1,fullscreen:""},{default:w(()=>[m(P,{class:"absolute top-4 right-4",icon:"i-heroicons-x-mark",variant:"ghost",onClick:p[2]||(p[2]=()=>a.value=!1)}),h("div",{class:"flex items-center justify-center w-full h-full p-4",onClick:p[3]||(p[3]=Qe(()=>a.value=!1,["left"]))},[t(r)?(d(),$(y,{key:0,class:"lg:h-full",fit:"inside",loading:"lazy",placeholder:"/vix_logo.png",src:t(r)},null,8,["src"])):M("",!0)])]),_:1},8,["modelValue"])],64))],2)):M("",!0)}}}),_l=le({__name:"ErrorAlert",props:{running:{type:Object,required:!0}},setup(e){const l=ge(),n=x(!1);return(a,r)=>{const o=dt;return d(),$(o,{class:"mb-5",icon:"i-heroicons-exclamation-circle-16-solid",color:"red",variant:"soft",title:"Task failed",description:e.running.error,actions:[{variant:"outline",color:"yellow",label:"Restart",loading:t(n),icon:"i-heroicons-arrow-path",click:()=>{n.value=!0,t(l).restartFlow(e.running).finally(()=>{n.value=!1})}}]},null,8,["description","actions"])}}}),$l={class:"mb-5"},Cl={class:"text-sm mb-5 text-slate-500"},Sl={class:"flex justify-between"},Il=le({__name:"Item",props:{running:{type:Object,required:!0}},setup(e){const l=ge(),n=x(!1),a=x(!1);function r(o){return[[{label:"Comfy flow",labelClass:"text-blue-500",icon:"i-heroicons-arrow-down-tray",iconClass:"bg-blue-500",click:()=>{var s;return l.downloadFlowComfy((s=l.currentFlow)==null?void 0:s.name,o.task_id)}}],[{label:`Raise priority ${o.priority>0?`(${o.priority})`:""}`,labelClass:"text-gray-500",icon:"i-heroicons-arrow-up",iconClass:"bg-gray-500",disabled:o.priority===15||o.progress>0,click:()=>{a.value=!0,l.raiseQueuePriority(o).finally(()=>{a.value=!1})}},{label:`Lower priority ${o.priority>0?`(${o.priority})`:""}`,labelClass:"text-gray-500",icon:"i-heroicons-arrow-down",iconClass:"bg-gray-500",disabled:o.priority===0||o.progress>0,click:()=>{a.value=!0,l.lowerQueuePriority(o).finally(()=>{a.value=!1})}},{label:`Reset priority ${o.priority>0?`(${o.priority})`:""}`,labelClass:"text-gray-500",icon:"i-heroicons-arrow-path-rounded-square-solid",iconClass:"bg-gray-500",disabled:o.priority===0||o.progress>0,click:()=>{a.value=!0,l.resetQueuePriority(o).finally(()=>{a.value=!1})}}]]}return(o,s)=>{var P,U;const f=Rt,p=xl,C=_l,y=re,F=Ke;return d(),j("div",$l,[m(f,{class:"mb-3",value:(P=e.running)==null?void 0:P.progress,indicator:"",color:e.running.error?"red":"green"},null,8,["value","color"]),h("p",Cl,X([`${(U=e.running)!=null&&U.priority&&e.running.priority>0?"["+e.running.priority+"] ":""}#${e.running.task_id}`,...Object.keys(e.running.input_params_mapped).filter(_=>e.running.input_params_mapped[_].value&&e.running.input_params_mapped[_].value!=="").map(_=>`${e.running.input_params_mapped[_].display_name}: ${e.running.input_params_mapped[_].value}`)].join(" | ")+`${e.running.execution_time?" | execution_time: "+e.running.execution_time.toFixed(2)+"s":""}`),1),m(p,{running:e.running},null,8,["running"]),e.running.error?(d(),$(C,{key:0,running:e.running},null,8,["running"])):M("",!0),h("div",Sl,[m(y,{icon:e.running.progress>=0&&e.running.progress<100?"i-heroicons-stop":"i-heroicons-minus-circle",color:e.running.error?"red":"orange",variant:"outline",loading:t(n),onClick:s[0]||(s[0]=()=>{n.value=!0,t(l).cancelRunningFlow(e.running).finally(()=>{n.value=!1})})},{default:w(()=>[D(X(e.running.progress>=0&&e.running.progress<100?"Cancel":"Remove"),1)]),_:1},8,["icon","color","loading"]),m(F,{items:r(e.running),mode:"click",popper:{placement:"bottom-end"}},{default:w(()=>[m(y,{color:"blue",variant:"outline",icon:"i-heroicons-ellipsis-vertical-16-solid"})]),_:1},8,["items"])])])}}}),Rl={class:"w-full p-4 ring-1 ring-gray-200 dark:ring-gray-800 rounded-lg shadow-md mt-5 mb-10"},Ml={class:"flex items-center justify-between mb-2"},Fl={key:0},Pl={key:1,class:"text-red-400"},Ul=le({__name:"Queue",setup(e){const l=ge(),n=x(!0),a=x(!1);return(r,o)=>{var C,y,F,P,U,_,z,N,k;const s=ke,f=re,p=Il;return d(),j("div",Rl,[h("div",Ml,[h("h2",{class:"text-lg font-bold cursor-pointer select-none flex items-center",onClick:o[0]||(o[0]=()=>{n.value=!t(n)})},[m(s,{name:t(n)?"i-heroicons-chevron-down":"i-heroicons-chevron-up",class:"mr-2"},null,8,["name"]),h("span",null," Queue ("+X(t(l).flowsRunningByName((C=t(l).currentFlow)==null?void 0:C.name).length)+") ",1),t(l).flowsRunningByName((y=t(l).currentFlow)==null?void 0:y.name).length>0?(d(),j("span",Fl," - "+X(`${((P=t(l).flowsRunningByName((F=t(l).currentFlow)==null?void 0:F.name).filter(c=>c.progress>0)[0])==null?void 0:P.progress.toFixed(0))??0}%`),1)):M("",!0),t(l).flowsRunningByNameWithErrors((U=t(l))==null?void 0:U.currentFlow.name).length>0?(d(),j("span",Pl," ("+X(t(l).flowsRunningByNameWithErrors((_=t(l).currentFlow)==null?void 0:_.name).length)+") ",1)):M("",!0)]),(z=t(l).currentFlow)!=null&&z.name&&t(l).flowsRunningByName((N=t(l).currentFlow)==null?void 0:N.name).length>0?(d(),$(f,{key:0,icon:"i-heroicons-stop",color:"orange",variant:"outline",loading:t(a),onClick:o[1]||(o[1]=()=>{var c;a.value=!0,t(l).cancelRunningFlows((c=t(l).currentFlow)==null?void 0:c.name).finally(()=>{a.value=!1})})},{default:w(()=>o[2]||(o[2]=[D(" Cancel all ")])),_:1},8,["loading"])):M("",!0)]),t(n)?M("",!0):(d(!0),j(ie,{key:0},pe(t(l).flowsRunningByName((k=t(l).currentFlow)==null?void 0:k.name),c=>(d(),$(p,{key:c.task_id,running:c},null,8,["running"]))),128))])}}}),zl=le({__name:"ScrollToTop",props:{show:{type:Boolean,required:!0},target:{type:String,required:!0}},setup(e){const l=e;function n(){const a=document.getElementById(l.target);a&&a.scrollIntoView({behavior:"smooth"})}return(a,r)=>{const o=re;return e.show?(d(),$(o,{key:0,icon:"i-heroicons-arrow-small-up",color:"black",variant:"outline",onClick:n})):M("",!0)}}}),Vl={class:"flex flex-col items-center mb-2 max-w-fit mx-auto z-0"},Ol={class:"text-slate-500 text-center text-sm w-full mx-auto flex flex-wrap items-center justify-center md:justify-between"},jl={class:"toggles py-2"},Tl={class:"mr-2 inline-flex items-center text-sm"},Bl=["for"],Nl={class:"mr-2 inline-flex items-center text-sm"},Ll=["for"],Al={key:0,class:"flex items-center"},ql=["title"],El=le({__name:"Child",props:{flowResult:{type:Object,required:!0},outputsIndex:{type:Number,required:!1,default:()=>0},openImageModal:{type:Function,required:!0}},setup(e){const l=e,n=ge(),a=(c,v=null,g=!1)=>{if(c.child_tasks.length===0)return c;const u=c.child_tasks.findIndex(O=>O.parent_task_node_id===v);return u!==-1?(g||(o.value=c),a(c.child_tasks[u],c.child_tasks[u].outputs[0].comfy_node_id,g)):c};function r(c,v,g=null){if(g!==null&&c.parent_task_node_id===g||Number(c.task_id)===v)return c;for(let u=0;u<c.child_tasks.length;u++)for(let O=0;O<c.child_tasks[u].outputs.length;O++){const i=r(c.child_tasks[u],v,c.child_tasks[u].outputs[O].comfy_node_id);if(i!==null)return i}return null}const o=x(l.flowResult),s=x(a(l.flowResult,l.flowResult.outputs[l.outputsIndex].comfy_node_id,!1));function f(c){var v;return[[{label:`${(v=n.flowByName((c==null?void 0:c.flow_name)??(c==null?void 0:c.name)))==null?void 0:v.display_name}#${c.task_id}`,disabled:!0}],[{label:"View image",icon:"i-heroicons-eye",click:()=>{l.openImageModal(ce({task_id:c.task_id,node_id:c.outputs.length>1?c.outputs[l.outputsIndex].comfy_node_id:c.outputs[0].comfy_node_id}))}}]]}function p(c){var g;const v=[[{label:`${(g=n.flowByName((c==null?void 0:c.flow_name)??(c==null?void 0:c.name)))==null?void 0:g.display_name}#${c.task_id}`,disabled:!0}],[{label:"View image",icon:"i-heroicons-eye",disabled:c.progress<100||c.error!=="",click:()=>{l.openImageModal(ce({task_id:c.task_id,node_id:c.outputs.length>1?c.outputs[l.outputsIndex].comfy_node_id:c.outputs[0].comfy_node_id}))}},{label:c.progress<100?"Cancel":"Delete",labelClass:c.progress<100?"text-orange-500":"text-red-500",icon:c.progress<100?"i-heroicons-stop":"i-heroicons-trash",iconClass:c.progress<100?"bg-orange-500":"bg-red-500",click:()=>{n.deleteFlowHistory(c.task_id).then(()=>{const u=r(l.flowResult,c.parent_task_id,c.parent_task_node_id);u&&(u.child_tasks=u.child_tasks.filter(O=>Number(O.task_id)!==Number(c.task_id))),_(!1,l.flowResult)})}}]];return c.progress<100&&(v[0][1]={label:`Progress: ${Math.ceil(c.progress)}% (${c.execution_time.toFixed(2)}s)`,labelClass:"text-blue-500",disabled:!0}),c.error!==""&&v[0].push({label:`Error: ${c.error}`,labelClass:"text-red-500",slot:"error",click:()=>{mt().copy(c.error),Oe().add({title:"Clipboard",description:`Task #${c.task_id} error copied to clipboard`,timeout:2e3})}}),v}function C(){const c=o.value.parent_task_id;if(!c)return;const v=r(l.flowResult,c,o.value.parent_task_node_id);v&&(o.value=v)}function y(){if(o.value.child_tasks.length===0)return;const c=o.value.outputs.length>1?o.value.outputs[l.outputsIndex].comfy_node_id:o.value.outputs[0].comfy_node_id,v=o.value.child_tasks.find(g=>g.parent_task_node_id===c);v&&(o.value=v)}const F=E(()=>{if(o.value.child_tasks.length===0)return;const c=o.value.outputs.length>1?o.value.outputs[l.outputsIndex].comfy_node_id:o.value.outputs[0].comfy_node_id;return o.value.child_tasks.find(g=>g.parent_task_node_id===c).task_id!==s.value.task_id});function P(){const c=s.value.parent_task_id;if(!c)return;const v=r(l.flowResult,c,s.value.parent_task_node_id);v&&(s.value=v)}function U(){if(s.value.child_tasks.length===0)return;const c=Number(s.value.outputs[0].comfy_node_id),v=s.value.child_tasks.find(g=>Number(g.parent_task_node_id)===c);v&&(s.value=v)}function _(c=!1,v=null){c||(o.value=v),s.value=a(v,v==null?void 0:v.outputs[l.outputsIndex].comfy_node_id,c),z.value=!1}he(l.flowResult,c=>{_(!0,c)});const z=x(!1),N=x(!0),k=x(null);return he(z,c=>{c?(k.value=o.value,o.value=l.flowResult):k.value&&(o.value=k.value,s.value=_t(k.value,l.outputsIndex,o.value.outputs.length>1?o.value.outputs[l.outputsIndex].comfy_node_id:o.value.outputs[0].comfy_node_id))}),(c,v)=>{const g=xe,u=Be("ImgComparisonSlider"),O=tn,i=re,b=Ke,S=ke,V=qe;return d(),j("div",Vl,[it(m(g,{class:"mb-2 rounded-lg cursor-pointer",height:t(n).outputMaxSize,width:t(n).outputMaxSize,draggable:"false",fit:"cover",loading:"lazy",src:("outputResultSrc"in c?c.outputResultSrc:t(ce))({task_id:t(s).progress===100?t(s).task_id:e.flowResult.task_id,node_id:t(s).progress===100?t(s).outputs[0].comfy_node_id:e.flowResult.outputs[e.outputsIndex].comfy_node_id}),onClick:v[0]||(v[0]=W=>e.openImageModal(("outputResultSrc"in c?c.outputResultSrc:t(ce))({task_id:t(s).task_id??e.flowResult.task_id,node_id:t(s).outputs[0].comfy_node_id??e.flowResult.outputs[e.outputsIndex].comfy_node_id})))},null,8,["height","width","src"]),[[kt,!t(N)]]),t(N)?(d(),$(u,{key:0,class:"mb-2 mx-auto outline-none w-fit rounded-lg"},{default:w(()=>{var W,ae,oe;return[m(g,{slot:"first",height:t(n).outputMaxSize,width:t(n).outputMaxSize,fit:"cover",draggable:"false",src:("outputResultSrc"in c?c.outputResultSrc:t(ce))({task_id:t(z)?e.flowResult.task_id:t(o).task_id,node_id:t(z)?e.flowResult.outputs[e.outputsIndex].comfy_node_id:t(o).parent_task_node_id!==null?(W=t(o))==null?void 0:W.outputs[0].comfy_node_id:((ae=t(o))==null?void 0:ae.outputs[e.outputsIndex].comfy_node_id)??((oe=t(o))==null?void 0:oe.outputs[0].comfy_node_id)})},null,8,["height","width","src"]),t(s)&&t(s).progress===100?(d(),$(g,{key:0,slot:"second",height:t(n).outputMaxSize,width:t(n).outputMaxSize,fit:"cover",draggable:"false",src:("outputResultSrc"in c?c.outputResultSrc:t(ce))({task_id:t(s).task_id,node_id:t(s).outputs[0].comfy_node_id})},null,8,["height","width","src"])):(d(),$(g,{key:1,slot:"second",height:t(n).outputMaxSize,width:t(n).outputMaxSize,fit:"cover",draggable:"false",src:`${("buildBackendUrl"in c?c.buildBackendUrl:t(nt))()}/vix_logo.png`},null,8,["height","width","src"]))]}),_:1})):M("",!0),h("div",Ol,[h("div",jl,[h("div",Tl,[m(O,{id:`toggle-compare-${e.flowResult.task_id}-${e.outputsIndex}`,modelValue:t(N),"onUpdate:modelValue":v[1]||(v[1]=W=>Q(N)?N.value=W:null),size:"xs",class:"mr-2"},null,8,["id","modelValue"]),h("label",{class:"cursor-pointer select-none",for:`toggle-compare-${e.flowResult.task_id}-${e.outputsIndex}`}," Comparison ",8,Bl)]),h("div",Nl,[m(O,{id:`toggle-original-${e.flowResult.task_id}-${e.outputsIndex}`,modelValue:t(z),"onUpdate:modelValue":v[2]||(v[2]=W=>Q(z)?z.value=W:null),disabled:!t(N),size:"xs",class:"mr-2"},null,8,["id","modelValue","disabled"]),h("label",{class:"cursor-pointer select-none",for:`toggle-original-${e.flowResult.task_id}-${e.outputsIndex}`}," Original ",8,Ll)])]),t(N)?(d(),j("div",Al,[m(i,{icon:"i-heroicons-arrow-small-left-20-solid",size:"2xs",variant:"soft",color:"cyan",disabled:t(z)||t(o).parent_task_id===null,onClick:C},null,8,["disabled"]),m(b,{items:f(t(o)),mode:"click",popper:{placement:"top"}},{default:w(()=>[m(i,{variant:"link",color:"white",size:"xs"},{default:w(()=>[D(" #"+X(t(z)?e.flowResult.task_id:t(o).task_id),1)]),_:1})]),_:1},8,["items"]),m(i,{icon:"i-heroicons-arrow-small-right-20-solid",size:"2xs",variant:"soft",color:"cyan",disabled:t(z)||!t(F),onClick:y},null,8,["disabled"]),m(S,{class:"mx-3",name:"i-heroicons-arrows-right-left-16-solid"}),m(i,{icon:"i-heroicons-arrow-small-left-20-solid",size:"2xs",variant:"soft",color:"cyan",disabled:!r(l.flowResult,t(s).parent_task_id,t(s).parent_task_node_id)||t(s).parent_task_id===Number(t(o).task_id)||t(s).parent_task_id===null,onClick:P},null,8,["disabled"]),m(b,{items:p(t(s)),mode:"click",popper:{placement:"top"}},{error:w(({item:W})=>[h("div",{class:"text-red-500 truncate",title:W.label},X(W.label),9,ql)]),default:w(()=>[m(i,{class:te({"text-blue-500":t(s).progress!==100&&t(s).error==="","text-red-500":t(s).error!==""}),variant:"link",color:"white",size:"xs"},{default:w(()=>[D(X(t(s).progress===100?"#"+t(s).task_id:Math.ceil(t(s).progress)+"%"),1)]),_:1},8,["class"])]),_:1},8,["items"]),m(i,{icon:"i-heroicons-arrow-small-right-20-solid",size:"2xs",variant:"soft",color:"cyan",disabled:t(s).child_tasks.length===0,onClick:U},null,8,["disabled"]),m(V,{class:"ml-3",text:"Reset comparison",popper:{placement:"top"}},{default:w(()=>[m(i,{icon:"i-heroicons-arrow-path-rounded-square-solid",size:"2xs",variant:"outline",color:"white",onClick:v[3]||(v[3]=()=>_(!1,e.flowResult))})]),_:1})])):M("",!0)])])}}}),Dl={class:"image-output"},Wl={class:"flex flex-col basis-full justify-between mx-2"},Hl=le({__name:"Image",props:{flowResult:{type:Object,required:!0},handleSendToFlow:{type:Function,required:!0},openImageModal:{type:Function,required:!0}},setup(e){const l=ge();return(n,a)=>{var p,C;const r=El,o=xe,s=re,f=je;return d(),j("div",Dl,[e.flowResult.outputs.length===1?(d(),j(ie,{key:0},[(p=e.flowResult)!=null&&p.child_tasks&&((C=e.flowResult)==null?void 0:C.child_tasks.length)>0?(d(),$(r,{key:0,"flow-result":e.flowResult,"open-image-modal":e.openImageModal},null,8,["flow-result","open-image-modal"])):e.flowResult.outputs.length===1?(d(),$(o,{key:1,class:"mb-2 mx-auto rounded-lg cursor-pointer",height:t(l).$state.outputMaxSize,width:t(l).$state.outputMaxSize,draggable:"false",fit:"cover",loading:"lazy",src:("outputResultSrc"in n?n.outputResultSrc:t(ce))({task_id:e.flowResult.task_id,node_id:e.flowResult.outputs[0].comfy_node_id}),onClick:a[0]||(a[0]=y=>e.openImageModal(("outputResultSrc"in n?n.outputResultSrc:t(ce))({task_id:e.flowResult.task_id,node_id:e.flowResult.outputs[0].comfy_node_id})))},null,8,["height","width","src"])):M("",!0)],64)):e.flowResult.outputs.length>1?(d(),$(f,{key:1,class:"mb-3 rounded-lg overflow-hidden",items:e.flowResult.outputs.map((y,F)=>({task_id:e.flowResult.task_id,node_id:y.comfy_node_id,index:F})),ui:{item:"basis-full md:basis-1/2",indicators:{wrapper:"relative bottom-0 mt-4 md:hidden"}},page:1,indicators:""},{default:w(({item:y})=>{var F;return[h("div",Wl,[(F=e.flowResult)!=null&&F.child_tasks&&("hasChildTaskByParentTaskNodeId"in n?n.hasChildTaskByParentTaskNodeId:t($t))(e.flowResult,y.index,y.node_id)?(d(),$(r,{key:0,"flow-result":e.flowResult,"outputs-index":y.index,"open-image-modal":e.openImageModal},null,8,["flow-result","outputs-index","open-image-modal"])):(d(),$(o,{key:1,class:te(`mb-2 h-100 max-h-[${t(l).$state.outputMaxSize}px] mx-auto rounded-lg cursor-pointer`),draggable:"false",height:t(l).$state.outputMaxSize,width:t(l).$state.outputMaxSize,fit:"cover",loading:"lazy",src:("outputResultSrc"in n?n.outputResultSrc:t(ce))(y),onClick:P=>e.openImageModal(("outputResultSrc"in n?n.outputResultSrc:t(ce))(y))},null,8,["class","height","width","src","onClick"])),m(s,{class:"mt-2 w-fit mx-auto",icon:"i-heroicons-arrow-uturn-up-solid",color:"violet",size:"xs",variant:"outline",onClick:()=>{e.handleSendToFlow(e.flowResult,y.index)}},{default:w(()=>a[1]||(a[1]=[D(" Send to flow ")])),_:2},1032,["onClick"])])]}),_:1},8,["items"])):M("",!0)])}}}),Gl={class:"image-output"},Xl=["width","height"],Jl=["src"],Ql={class:"flex flex-col basis-full justify-between mx-2"},Kl=["width","height"],Yl=["src"],Zl=le({__name:"Video",props:{flowResult:{type:Object,required:!0},handleSendToFlow:{type:Function,required:!0},openImageModal:{type:Function,required:!0}},setup(e){const l=ge();return(n,a)=>{const r=re,o=je;return d(),j("div",Gl,[e.flowResult.outputs.length===1?(d(),j("video",{key:0,controls:"",class:"mb-2 mx-auto rounded-lg",style:{"max-height":"80vh"},width:t(l).$state.outputMaxSize,height:t(l).$state.outputMaxSize},[h("source",{src:("outputResultSrc"in n?n.outputResultSrc:t(ce))({task_id:e.flowResult.task_id,node_id:e.flowResult.outputs[0].comfy_node_id})},null,8,Jl)],8,Xl)):e.flowResult.outputs.length>1?(d(),$(o,{key:1,class:"mb-3 rounded-lg overflow-hidden",items:e.flowResult.outputs.map((s,f)=>({task_id:e.flowResult.task_id,node_id:s.comfy_node_id,index:f})),ui:{item:"basis-full md:basis-1/2",indicators:{wrapper:"relative bottom-0 mt-4 md:hidden"}},page:1,indicators:""},{default:w(({item:s})=>[h("div",Ql,[h("video",{controls:"",class:"mb-2 mx-auto rounded-lg",width:t(l).$state.outputMaxSize,height:t(l).$state.outputMaxSize},[h("source",{src:("outputResultSrc"in n?n.outputResultSrc:t(ce))({task_id:e.flowResult.task_id,node_id:e.flowResult.outputs[0].comfy_node_id})},null,8,Yl)],8,Kl),m(r,{class:"mt-2 w-fit mx-auto",icon:"i-heroicons-arrow-uturn-up-solid",color:"violet",size:"xs",variant:"outline",onClick:()=>{e.handleSendToFlow(e.flowResult,s.index)}},{default:w(()=>a[0]||(a[0]=[D(" Send to flow ")])),_:2},1032,["onClick"])])]),_:1},8,["items"])):M("",!0)])}}}),eo={class:"image-output"},to=["src"],no={class:"flex flex-col basis-full justify-between mx-2"},lo=["src"],oo=le({__name:"Audio",props:{flowResult:{type:Object,required:!0}},setup(e){return(l,n)=>{const a=je;return d(),j("div",eo,[e.flowResult.outputs.length===1?(d(),j("audio",{key:0,controls:"",class:"mb-2 mx-auto rounded-lg",src:("outputResultSrc"in l?l.outputResultSrc:t(ce))({task_id:e.flowResult.task_id,node_id:e.flowResult.outputs[0].comfy_node_id})},null,8,to)):e.flowResult.outputs.length>1?(d(),$(a,{key:1,class:"mb-3 rounded-lg overflow-hidden",items:e.flowResult.outputs.map((r,o)=>({task_id:e.flowResult.task_id,node_id:r.comfy_node_id,index:o})),ui:{item:"basis-full md:basis-1/2",indicators:{wrapper:"relative bottom-0 mt-4 md:hidden"}},page:1,indicators:""},{default:w(()=>[h("div",no,[h("audio",{controls:"",class:"mb-2 mx-auto rounded-lg",src:("outputResultSrc"in l?l.outputResultSrc:t(ce))({task_id:e.flowResult.task_id,node_id:e.flowResult.outputs[0].comfy_node_id})},null,8,lo)])]),_:1},8,["items"])):M("",!0)])}}}),ao={class:"w-full h-full p-4"},so={class:"mt-4 max-h-96 overflow-y-auto text-sm whitespace-pre-wrap"},io=le({__name:"Params",props:{flowResult:{type:Object,required:!0}},setup(e){const l=e,n=x(!1),a=E(()=>["#"+l.flowResult.task_id,...Object.keys(l.flowResult.input_params_mapped).filter(f=>l.flowResult.input_params_mapped[f].value&&l.flowResult.input_params_mapped[f].value!=="").map(f=>n.value&&l.flowResult.translated_input_params_mapped&&l.flowResult.translated_input_params_mapped[f]?`${l.flowResult.input_params_mapped[f].display_name}: ${l.flowResult.translated_input_params_mapped[f].value}`:`${l.flowResult.input_params_mapped[f].display_name}: ${l.flowResult.input_params_mapped[f].value}`)].join(" | ")+`${l.flowResult.execution_time?" | execution_time: "+l.flowResult.execution_time.toFixed(2)+"s":""}`);ut(()=>{l.flowResult.showInputFiles=!1,l.flowResult.showExecutionDetailsModal=!1});const r=E(()=>l.flowResult.execution_details&&l.flowResult.extra_flags!==null),o=E(()=>{const f={unload_models:l.flowResult.extra_flags.unload_models,max_memory_usage:l.flowResult.execution_details.max_memory_usage,disable_smart_memory:l.flowResult.execution_details.disable_smart_memory,vram_state:l.flowResult.execution_details.vram_state};return JSON.stringify(f,null,"	")});function s(){const f={extra_flags:l.flowResult.extra_flags,execution_details:l.flowResult.execution_details},p=new Blob([JSON.stringify(f,null,"	")],{type:"application/json"}),C=URL.createObjectURL(p),y=document.createElement("a");y.href=C,y.download=`${l.flowResult.task_id}_execution_details.json`,y.click(),window.URL.revokeObjectURL(C)}return(f,p)=>{const C=re,y=Se,F=qe,P=Ae,U=ke;return d(),j(ie,null,[t(r)?(d(),$(y,{key:0,modelValue:e.flowResult.showExecutionDetailsModal,"onUpdate:modelValue":p[2]||(p[2]=_=>e.flowResult.showExecutionDetailsModal=_)},{default:w(()=>[m(C,{class:"absolute top-4 right-4",icon:"i-heroicons-x-mark",variant:"ghost",onClick:p[0]||(p[0]=()=>e.flowResult.showExecutionDetailsModal=!1)}),h("div",ao,[p[6]||(p[6]=h("h3",{class:"text-center font-bold"}," Execution details ",-1)),h("div",so,X(t(o)),1),m(C,{class:"mt-3",icon:"i-heroicons-arrow-down-tray-20-solid",variant:"outline",size:"xs",color:"gray",onClick:p[1]||(p[1]=()=>s())},{default:w(()=>p[5]||(p[5]=[D(" Download raw details ")])),_:1})])]),_:1},8,["modelValue"])):M("",!0),e.flowResult.translated_input_params_mapped&&Object.keys(e.flowResult.translated_input_params_mapped).length>0?(d(),$(F,{key:1,text:t(n)?"Hide translated input params":"Show translated input params",popper:{placement:"top"}},{default:w(()=>[m(C,{class:"mb-2 mr-2",color:"white",size:"xs",variant:"outline",icon:"i-heroicons-language-solid",onClick:p[3]||(p[3]=()=>{n.value=!t(n)})})]),_:1},8,["text"])):M("",!0),(d(!0),j(ie,null,pe(t(a).split("|"),_=>(d(),$(P,{key:_,class:"mr-2 mb-2 last:mr-0 hover:cursor-pointer",variant:"soft",color:"gray",onClick:()=>{("useCopyToClipboard"in f?f.useCopyToClipboard:t(mt))().copy(_.split(":")[1].trim()),("useToast"in f?f.useToast:t(Oe))().add({title:"Clipboard",description:`${_.split(":")[0].trim()} copied to clipboard`,timeout:2e3})}},{default:w(()=>[D(X(_),1)]),_:2},1032,["onClick"]))),128)),e.flowResult.input_files.length>0?(d(),$(P,{key:2,class:"mr-2 mb-2 last:mr-0 hover:cursor-pointer select-none",variant:"subtle",color:"sky",onClick:p[4]||(p[4]=()=>{e.flowResult.showInputFiles=!e.flowResult.showInputFiles})},{default:w(()=>[m(U,{name:e.flowResult.showInputFiles?"i-heroicons-chevron-down":"i-heroicons-chevron-up",class:"mr-1"},null,8,["name"]),m(U,{name:"i-heroicons-document-solid",class:"mr-1"}),D(" "+X(`input_files: ${e.flowResult.input_files.length}`),1)]),_:1})):M("",!0)],64)}}}),ro={key:0,class:te("w-full p-1")},uo={class:"flex flex-col basis-full justify-between mx-2"},co=le({__name:"InputFiles",props:{flowResult:{type:Object,required:!0}},setup(e){const l=ge(),n=(s,f)=>`${xt()}/tasks/inputs?task_id=${s}&input_index=${f}`,a=x(!1),r=x(""),o=x(0);return(s,f)=>{var P,U;const p=xe,C=je,y=re,F=Se;return e.flowResult.showInputFiles?(d(),j("div",ro,[((P=Object.keys(e.flowResult.input_files))==null?void 0:P.length)===1?(d(),$(p,{key:0,class:te(`mb-5 mx-auto rounded-lg cursor-pointer max-h-[${t(l).$state.outputMaxSize}px] w-auto`),fit:"outside",loading:"lazy",src:n(e.flowResult.task_id,0),onClick:f[0]||(f[0]=()=>{r.value=n(e.flowResult.task_id,0),o.value=0,a.value=!0})},null,8,["class","src"])):M("",!0),((U=Object.keys(e.flowResult.input_files))==null?void 0:U.length)>1?(d(),$(C,{key:1,items:Object.keys(e.flowResult.input_files).map(_=>({task_id:e.flowResult.task_id,index:_})),ui:{item:"basis-full md:basis-1/2",indicators:{wrapper:"relative bottom-0 my-2"}},page:1,indicators:""},{default:w(({item:_})=>[h("div",uo,[m(p,{class:te(`mb-5 mx-auto rounded-lg cursor-pointer max-h-[${t(l).$state.outputMaxSize}px] w-auto`),fit:"outside",loading:"lazy",draggable:"false",src:n(_.task_id,_.index),onClick:()=>{r.value=n(e.flowResult.task_id,_.index),o.value=_.index,a.value=!0}},null,8,["class","src","onClick"])])]),_:1},8,["items"])):M("",!0),m(F,{modelValue:t(a),"onUpdate:modelValue":f[3]||(f[3]=_=>Q(a)?a.value=_:null),class:"z-[90]",transition:!1,fullscreen:""},{default:w(()=>[m(y,{class:"absolute top-4 right-4",icon:"i-heroicons-x-mark",variant:"ghost",onClick:f[1]||(f[1]=()=>a.value=!1)}),h("div",{class:"flex items-center justify-center w-full h-full p-4",onClick:f[2]||(f[2]=Qe(()=>a.value=!1,["left"]))},[t(r)?(d(),$(p,{key:0,class:"lg:h-full",fit:"inside",loading:"lazy",placeholder:"/vix_logo.png",src:t(r)},null,8,["src"])):M("",!0)])]),_:1},8,["modelValue"])])):M("",!0)}}}),mo={class:"p-4"},fo={class:"flex justify-center mb-4"},po={key:0,class:"text-sm text-slate-500 text-center mb-4"},go={class:"text-md text-center text-red-500 mb-4"},vo={key:1},ho={class:"flex items-center justify-between"},wo=le({__name:"SendToFlowModal",props:Le({flowResult:{type:Object,required:!1,default:()=>null},outputImgSrc:{type:String,required:!0},outputParamIndex:{type:Number,required:!0},inputParamsMapped:{type:Object,required:!0},isChildTask:{type:Boolean,required:!1,default:!1},translatePrompt:{type:Boolean,required:!1,default:!1}},{show:{default:!1,type:Boolean},showModifiers:{}}),emits:Le(["update:show"],["update:show"]),setup(e,{emit:l}){const n=e,a=Ve(e,"show"),r=ge(),o=E(()=>r.sub_flows.map(P=>({value:P.name,label:`${P.display_name} - ${P.description}`}))),s=x(o.value[0]||""),f=x(!1),p=l;function C(){console.debug("[Send to flow]: ",s.value);const P=r.sub_flows.find(_=>_.name===s.value.value&&_.display_name===s.value.label.split(" - ")[0]);if(console.debug("[Send to flow]: targetFlow",P),!P){Oe().add({title:`Target sub-flow "${s.value.value}" not found`,description:"Please, verify the target sub-flow is installed and available and try again",timeout:5e3});return}const U=P.input_params.reduce((_,z)=>{const N={};return z.type==="text"?N[z.name]={value:z.default||"",type:z.type}:z.type==="number"?N[z.name]={value:z.default||0,type:z.type}:z.type==="image"?N[z.name]={value:JSON.stringify({task_id:n.flowResult.task_id,node_id:n.flowResult.outputs.length>1?n.flowResult.outputs[n.outputParamIndex].comfy_node_id:n.flowResult.outputs[0].comfy_node_id})||"",type:z.type}:z.type==="list"?N[z.name]={value:z.default||Object.keys(z.options)[0]||"",type:z.type,options:z.options}:z.type==="bool"?N[z.name]={value:z.default||!1,type:z.type}:["range","range_scale"].includes(z.type)&&(N[z.name]={value:z.default||0,type:z.type}),_.push(N),_},[]);console.debug("[Send to flow]: input_params_map",U),f.value=!0,r.runFlow(P,U,1,n.translatePrompt,y.value,y.value?Number(n.flowResult.task_id):null).finally(()=>{f.value=!1,p("update:show",!1)})}const y=x(!1),F=E(()=>{var P;return n.flowResult.progress===100&&((P=n.flowResult)==null?void 0:P.error)===""});return Je(()=>{var U,_;const P=n.flowResult?((_=(U=n==null?void 0:n.flowResult)==null?void 0:U.outputs[n.outputParamIndex])==null?void 0:_.type)??"image":"image";r.fetchSubFlows(P).then(()=>{s.value=o.value[0]||""}),y.value=!1}),(P,U)=>{const _=xe,z=dt,N=Ye,k=We,c=re,v=Se;return d(),$(v,{modelValue:a.value,"onUpdate:modelValue":U[2]||(U[2]=g=>a.value=g),class:"z-[90]",transition:!1},{default:w(()=>[h("div",mo,[U[4]||(U[4]=h("h2",{class:"text-lg text-center mb-4"},"Send to flow",-1)),h("div",fo,[t(F)?(d(),$(_,{key:0,src:e.outputImgSrc,class:"w-1/2 rounded-lg",draggable:!1},null,8,["src"])):(d(),$(z,{key:1,color:"orange",icon:"i-heroicons-exclamation-circle-solid",title:`Task is still running (${Math.ceil(e.flowResult.progress)}%, ${e.flowResult.execution_time.toFixed(2)}s)`,description:e.flowResult.error!==""?e.flowResult.error:""},null,8,["title","description"]))]),e.inputParamsMapped?(d(),j("p",po,X(["#"+e.flowResult.task_id,...Object.keys(e.inputParamsMapped).filter(g=>e.inputParamsMapped[g].value!=="").map(g=>`${e.inputParamsMapped[g].display_name}: ${e.inputParamsMapped[g].value}`)].join(" | ")),1)):M("",!0),h("p",go,[t(o).length>0?(d(),$(N,{key:0,modelValue:t(s),"onUpdate:modelValue":U[0]||(U[0]=g=>Q(s)?s.value=g:null),class:"w-full",size:"lg",options:t(o)},null,8,["modelValue","options"])):(d(),j("span",vo,"No sub-flows available"))]),e.isChildTask?(d(),$(z,{key:1,class:"mb-4",icon:"i-heroicons-exclamation-circle-solid",title:"Child task",description:"The latest child task is always used as input for sub-flow"})):M("",!0),h("div",ho,[m(k,{modelValue:t(y),"onUpdate:modelValue":U[1]||(U[1]=g=>Q(y)?y.value=g:null),label:"Bind as child task"},null,8,["modelValue"]),m(c,{icon:"i-heroicons-arrow-uturn-up-solid",color:"violet",variant:"outline",loading:t(f),disabled:t(o).length===0||e.isChildTask&&!t(F),onClick:C},{default:w(()=>U[3]||(U[3]=[D(" Send ")])),_:1},8,["loading","disabled"])])])]),_:1},8,["modelValue"])}}}),yo={class:"flex flex-col md:flex-row items-center justify-center mb-5 sticky top-1 z-[10]"},bo={class:"flex items-center justify-center"},ko={class:"p-4"},xo={class:"text-md text-center text-red-500 mb-4"},_o={class:"flex justify-center"},$o={key:0,class:"results overflow-auto"},Co=["id"],So={class:"text-sm text-slate-500 text-center mb-1"},Io={class:"w-5/6 mx-auto flex flex-wrap items-center justify-center"},Ro={class:"w-full flex justify-center items-center"},Mo={key:1,class:"text-center text-slate-500"},Fo=le({__name:"Output",emits:["copy-prompt-inputs"],setup(e,{emit:l}){const n=ge(),a=E(()=>{var S;return n.flowResultsByName((S=n.currentFlow)==null?void 0:S.name).length>0||!1}),r=E(()=>{var S;return n.flowResultsByName((S=n.currentFlow)==null?void 0:S.name)||[]}),o=E(()=>n.$state.resultsPageSize);he(r,()=>{r.value.length<=n.$state.resultsPageSize?n.$state.resultsPage=1:n.$state.resultsPage>Math.ceil(r.value.length/n.$state.resultsPageSize)&&(n.$state.resultsPage=Math.ceil(r.value.length/n.$state.resultsPageSize))}),he(o,()=>{r.value.length<=n.$state.resultsPageSize?n.$state.resultsPage=1:n.$state.resultsPage>Math.ceil(r.value.length/n.$state.resultsPageSize)&&(n.$state.resultsPage=Math.ceil(r.value.length/n.$state.resultsPageSize)),n.saveUserOptions()}),ut(()=>{n.$state.flow_results_filter="",n.$state.resultsPage=1});const s=l;function f(S){s("copy-prompt-inputs",S.input_params_mapped)}function p(S){_.value=S,U.value=!0}const C=x(null),y=x(!1);window.addEventListener("scroll",()=>{var S;y.value=window.scrollY>(((S=C.value)==null?void 0:S.offsetTop)+window.screen.height||0)});const F=E(()=>n.$state.resultsPage);he(F,()=>{const S=document.getElementById("output-container");S&&S.scrollIntoView({behavior:"smooth"})});const P=x(!1),U=x(!1),_=x(""),z=x(!1),N=x(!1),k=x(!1),c=x(""),v=x(null),g=x({}),u=x(0),O=x(!1);function i(S,V=0){if(S.child_tasks.length===0||!$t(S,V,S.outputs[V].comfy_node_id))v.value=S,c.value=ce({task_id:S.task_id,node_id:S.outputs[V].comfy_node_id}),g.value=S.input_params_mapped,O.value=!1;else{const W=_t(S,V,S.outputs[V].comfy_node_id);v.value=W,g.value=S.input_params_mapped,c.value=ce({task_id:W.task_id,node_id:W.outputs[0].comfy_node_id}),O.value=!0}u.value=V,k.value=!0}function b(S){var oe;const V=S.extra_flags!==null&&((oe=S==null?void 0:S.extra_flags)==null?void 0:oe.profiler_execution),W=[{label:"Comfy flow",labelClass:"text-blue-500 text-sm",icon:"i-heroicons-arrow-down-tray",iconClass:"bg-blue-500 h-4 w-4",click:()=>{var ee;return n.downloadFlowComfy((ee=n.currentFlow)==null?void 0:ee.name,S.task_id)}}];V&&W.push({label:"Execution details",labelClass:"text-orange-500 text-sm",icon:"i-mdi-bug",iconClass:"bg-orange-500 h-4 w-4",click:()=>{S.execution_details?S.showExecutionDetailsModal=!0:n.fetchTaskHistoryItem(S.task_id).then(ee=>{S.execution_details=ee.execution_details,S.showExecutionDetailsModal=!0})}});const ae=[[{label:"Use params",labelClass:"text-cyan-500 text-sm",icon:"i-heroicons-document-duplicate-16-solid",iconClass:"bg-cyan-500 h-4 w-4",click:()=>f(S)}],W];return S.outputs.length===1&&S.outputs.every(ee=>ee.type==="image")&&ae.splice(1,0,[{label:"Send to flow",labelClass:"text-violet-500 text-sm",icon:"i-heroicons-arrow-uturn-up-solid",iconClass:"bg-violet-500 h-4 w-4",click:()=>{i(S)}}]),ae}return(S,V)=>{var H;const W=zl,ae=ke,oe=Ee,ee=en,we=nn,J=re,ue=Ke,Z=Ae,ve=Se,K=Hl,A=Zl,I=oo,q=io,Y=co,R=wo,T=xe;return d(),j("div",{id:"output-container",ref_key:"outputContainer",ref:C,class:"w-full p-4 ring-1 ring-gray-200 dark:ring-gray-800 rounded-lg shadow-md my-10"},[m(W,{show:t(y),class:"fixed bottom-5 right-5",target:"output-container"},null,8,["show"]),h("h2",{class:"text-lg font-bold cursor-pointer select-none flex items-center mb-3",onClick:V[0]||(V[0]=()=>{P.value=!t(P)})},[m(ae,{name:t(P)?"i-heroicons-chevron-down":"i-heroicons-chevron-up",class:"mr-2"},null,8,["name"]),D(" Output ("+X(t(r).filter(B=>B.parent_task_id===null).length)+") ",1)]),t(P)?M("",!0):(d(),j(ie,{key:0},[h("div",yo,[m(oe,{modelValue:t(n).$state.flow_results_filter,"onUpdate:modelValue":V[1]||(V[1]=B=>t(n).$state.flow_results_filter=B),icon:"i-heroicons-magnifying-glass-20-solid",color:"white",class:"md:mr-3",label:"Filter by prompt",trailing:!0,placeholder:"Filter results by prompt"},null,8,["modelValue"]),t(r).filter(B=>B.parent_task_id===null).length>t(n).$state.resultsPageSize?(d(),$(ee,{key:0,modelValue:t(n).$state.resultsPage,"onUpdate:modelValue":V[2]||(V[2]=B=>t(n).$state.resultsPage=B),class:"my-1 md:my-0","page-count":t(n).$state.resultsPageSize,total:t(r).filter(B=>B.parent_task_id===null).length,"show-first":"","show-last":""},null,8,["modelValue","page-count","total"])):M("",!0),h("div",bo,[m(we,{modelValue:t(n).resultsPageSize,"onUpdate:modelValue":V[3]||(V[3]=B=>t(n).resultsPageSize=B),class:"md:mx-3 w-fit mr-3",options:[5,10,20,50,100],label:"Results per page"},null,8,["modelValue"]),m(ue,{items:[[{label:"Delete all results",labelClass:"text-red-500",icon:"i-heroicons-trash",iconClass:"dark:text-red-500 text-red-500",click:()=>z.value=!0}]],mode:"click",label:"Options",popper:{placement:"bottom-end"}},{default:w(()=>[m(J,{color:"white",icon:"i-heroicons-ellipsis-vertical-16-solid"})]),_:1},8,["items"])]),m(ve,{modelValue:t(z),"onUpdate:modelValue":V[6]||(V[6]=B=>Q(z)?z.value=B:null),class:"z-[90]",transition:!1},{default:w(()=>[h("div",ko,[V[15]||(V[15]=h("p",{class:"text-lg text-center mb-4"},"Are you sure you want to delete all results?",-1)),h("p",xo,[V[11]||(V[11]=D(" All history and images of ")),m(Z,{class:"mx-1",color:"orange",variant:"outline"},{default:w(()=>[D(X(t(n).currentFlow.display_name),1)]),_:1}),V[12]||(V[12]=D(" will be deleted. "))]),h("div",_o,[m(J,{class:"mr-2",color:"red",variant:"outline",loading:t(N),onClick:V[4]||(V[4]=()=>{var B;N.value=!0,t(n).deleteFlowResults((B=t(n).currentFlow)==null?void 0:B.name).then(()=>{N.value=!1,z.value=!1})})},{default:w(()=>V[13]||(V[13]=[D(" Yes ")])),_:1},8,["loading"]),m(J,{variant:"outline",onClick:V[5]||(V[5]=()=>z.value=!1)},{default:w(()=>V[14]||(V[14]=[D("No")])),_:1})])])]),_:1},8,["modelValue"])]),t(a)?(d(),j("div",$o,[(d(!0),j(ie,null,pe(t(n).flowResultsByNamePaginated((H=t(n).currentFlow)==null?void 0:H.name),B=>(d(),j("div",{id:"task_id_"+B.task_id,key:B.task_id,class:"flex flex-col justify-center mx-auto mb-5"},[B.outputs.some(G=>["image","image-animated"].includes(G.type))?(d(),$(K,{key:0,"flow-result":B,"handle-send-to-flow":i,"open-image-modal":p},null,8,["flow-result"])):B.outputs.some(G=>G.type==="video")?(d(),$(A,{key:1,"flow-result":B,"handle-send-to-flow":i,"open-image-modal":p},null,8,["flow-result"])):B.outputs.some(G=>G.type==="audio")?(d(),$(I,{key:2,"flow-result":B},null,8,["flow-result"])):M("",!0),h("div",So,[h("div",Io,[m(q,{"flow-result":B},null,8,["flow-result"])])]),m(Y,{"flow-result":B},null,8,["flow-result"]),h("div",Ro,[m(J,{class:"mr-3",color:"red",icon:"i-heroicons-trash",variant:"outline",size:"xs",onClick:()=>t(n).deleteFlowHistory(B.task_id)},{default:w(()=>V[16]||(V[16]=[D(" Delete ")])),_:2},1032,["onClick"]),m(ue,{items:b(B),mode:"click",popper:{placement:"bottom-start"}},{default:w(()=>[m(J,{color:"white",icon:"i-heroicons-ellipsis-vertical-16-solid",size:"xs"})]),_:2},1032,["items"])])],8,Co))),128)),m(R,{show:t(k),"onUpdate:show":V[7]||(V[7]=B=>Q(k)?k.value=B:null),"flow-result":t(v),"output-img-src":t(c),"output-param-index":t(u),"input-params-mapped":t(g),"is-child-task":t(O)},null,8,["show","flow-result","output-img-src","output-param-index","input-params-mapped","is-child-task"])])):(d(),j("p",Mo," No output results available "))],64)),m(ve,{modelValue:t(U),"onUpdate:modelValue":V[10]||(V[10]=B=>Q(U)?U.value=B:null),class:"z-[90]",transition:!1,fullscreen:""},{default:w(()=>[m(J,{class:"absolute top-4 right-4",icon:"i-heroicons-x-mark",variant:"ghost",onClick:V[8]||(V[8]=()=>U.value=!1)}),h("div",{class:"flex items-center justify-center w-full h-full p-4",onClick:V[9]||(V[9]=Qe(()=>U.value=!1,["left"]))},[t(_)?(d(),$(T,{key:0,class:"lg:h-full",fit:"inside",loading:"lazy",src:t(_)},null,8,["src"])):M("",!0)])]),_:1},8,["modelValue"])],512)}}}),Po=Jt("civitAiStore",{actions:{fetchFlowLoras(e,l,n=50,a=null){if(!e.lora_connect_points||Object.keys(e.lora_connect_points).length!==1){console.debug("Flow does not have lora_connect_points or has more than one, skipping fetching loras");return}const{$apiFetch:r}=Xe();let s=`https://civitai.com/api/v1/models?baseModels=${e.lora_connect_points[Object.keys(e.lora_connect_points)[0]].base_model_type}&types=LORA&limit=${n}`;a&&(s=a);const f=`/other/proxy?target=${encodeURIComponent(s)}`;return r(f,{method:"GET",headers:{Authentication:"Bearer "+l,Accept:"application/json"}})},fetchFlowLorasByHash(e,l,n){if(!e.lora_connect_points||Object.keys(e.lora_connect_points).length!==1){console.debug("Flow does not have lora_connect_points or has more than one, skipping fetching loras");return}const{$apiFetch:a}=Xe(),r=`https://civitai.com/api/v1/model-versions/by-hash/${n}`,o=`/other/proxy?target=${encodeURIComponent(r)}`;return a(o,{method:"GET",headers:{Authentication:"Bearer "+l,Accept:"application/json"}})}}}),Uo={class:"p-4 overflow-y-auto relative"},zo={key:1},Vo={class:"flex flex-col justify-between w-full md:flex-row md:gap-4 md:items-center lg:items-start"},Oo={class:"flex flex-col gap-2 lg:flex-row md:justify-end items-start w-full"},jo={class:"flex flex-col md:flex-row flex-wrap gap-2 justify-between items-center w-full px-4 py-3"},To={class:"flex items-center gap-1.5"},Bo={class:"flex gap-1.5 items-center"},No={class:"flex items-center h-5"},Lo=["checked","indeterminate","onChange"],Ao={key:0,class:"flex items-center h-5"},qo=["checked","onChange"],Eo=["href"],Do=["innerHTML"],Wo={class:"p-4 max-h-64 max-w-xl overflow-y-auto"},Ho={key:0},Go={class:"flex items-center"},Xo={class:"flex items-center"},Jo={key:0,class:"flex justify-center space-x-2 w-full"},Qo={key:1,controls:"",width:256,height:256},Ko=["src"],Yo={class:"flex justify-end"},Zo=le({__name:"LoraSelectorModal",props:Le({flow:{}},{show:{default:!1,type:Boolean},showModifiers:{}}),emits:["update:show"],setup(e){const l=e,n=Ve(e,"show"),a=Oe(),r=ge(),o=bt(),s=Po(),f=x(!1),p=x({items:[],metadata:{}}),C=E(()=>o.settingsMap.civitai_auth_token.value!==""),y=E(()=>o.settingsMap.civitai_auth_token.value||""),F=[{key:"name",label:"Name",sortable:!0,class:""},{key:"description",label:"Description",sortable:!1,class:""},{key:"trigger_words",label:"Trigger words",sortable:!1,class:""},{key:"nsfw",label:"NSFW",sortable:!1,class:""},{key:"statsDownloadCount",label:"Download count",sortable:!1,class:""},{key:"statsThumbsUpCount",label:"Thumbs up",sortable:!1,class:""},{key:"modelVersion",label:"Model version",sortable:!1,class:""},{key:"actions",label:"Actions",sortable:!1,class:""}],P=x([]),U=x({openedRows:[],row:{}}),_=x(""),z=()=>{_.value=""},N=E(()=>{var I;let A=((I=p.value)==null?void 0:I.items)||[];return _.value&&(A=A.filter(q=>q.name.toLowerCase().includes(_.value.toLowerCase()))),A.forEach(q=>{!k.value[q.id]&&(q==null?void 0:q.modelVersions.length)>0&&(k.value[q.id]=q==null?void 0:q.modelVersions[0].name);const Y=Object.keys(Z.value);q.modelVersions.forEach(R=>{Y.includes(R.files[0].hashes.SHA256.toLowerCase())&&Z.value[R.files[0].hashes.SHA256.toLowerCase()]!==null&&(k.value[q.id]=R.name,q.currentFlowLora=!0,P.value.includes(q)||P.value.push(q))})}),A}),k=x({});function c(A){var I;return((I=A.modelVersions.find(q=>q.name===k.value[A.id]))==null?void 0:I.images)||A.modelVersions[0].images||[]}function v(A){var I;return((I=A.modelVersions.find(q=>q.name===k.value[A.id]))==null?void 0:I.trainedWords)||A.modelVersions[0].trainedWords||[]}const g=x(!0),u=x(""),O=x(l.flow.display_name),i=x(l.flow.description),b=x(l.flow.license),S=x(l.flow.required_memory_gb||0),V=x(l.flow.version);function W(){const A=Object.keys(l.flow.lora_connect_points)[0],q=l.flow.lora_connect_points[A].connected_loras.filter(T=>Z.value[T.hash]!==null).map(T=>({display_name:T.display_name,model_url:T.url,strength_model:T.strength_model})),Y={[A]:[]};g.value&&Y[A].push(...q);const R=P.value.reduce((T,H)=>{const B=H.modelVersions.find(de=>de.name===k.value[H.id]);if(!B||Z.value[B.files[0].hashes.SHA256.toLowerCase()])return T;const G={strength_model:1,model_url:B.downloadUrl,display_name:H.name};return T.push(G),T},[]);return Y[A].push(...R),console.debug("[DEBUG] newFlowConnectionPoints: ",Y),Y}function ae(A){const I=A.modelVersions.find(R=>R.name===k.value[A.id]);if(!I)return;const q=I.files[0].hashes.SHA256.toLowerCase();Z.value[q]&&(Z.value[q]=null);const Y=P.value.indexOf(A);Y!==-1&&P.value.splice(Y,1),A.currentFlowLora=!1}const oe=E(()=>u.value!==""&&r.flows_installed.findIndex(A=>A.name===u.value)===-1),ee=E(()=>P.value.filter(A=>!Z.value[A.modelVersions[0].files[0].hashes.SHA256.toLowerCase()]).length!==0),we=E(()=>ee.value&&oe.value&&O.value!==""&&i.value!==""),J=E(()=>ee.value?oe.value?O.value===""?"Please provide a display name.":i.value===""?"Please provide a description.":"":"Please provide a valid flow name.":"No LoRAs selected");function ue(){if(P.value.length===0){a.add({title:"No LoRAs selected",description:"Please select at least one LoRA to apply and install."});return}const A={new_name:u.value,new_display_name:O.value,new_description:i.value,new_license:b.value,new_required_memory_gb:S.value,new_version:V.value,new_lora_connection_points:W()};console.debug("[DEBUG] Clone flow params: ",A),f.value=!0,r.cloneFlow(l.flow,A).then(()=>{r.fetchFlows();const I=Ct();a.add({title:"Flow clone applied",actions:[{label:"View flow",click:()=>{I.push("/workflows/"+u.value)}}]})}).catch(I=>{console.error("Error applying and installing flow: ",I.message||"Unknown error"),a.add({title:"Error applying and installing flow",description:"An error occurred while applying and installing the flow. See the console for more details."})}).finally(()=>{f.value=!1})}const Z=x({});function ve(){const A=l.flow.lora_connect_points[Object.keys(l.flow.lora_connect_points)[0]].connected_loras;console.debug("Flow LORAs: ",A),Promise.all(A.map(I=>{var q;return(q=s.fetchFlowLorasByHash(l.flow,y.value,I.hash))==null?void 0:q.then(Y=>(I.hash in Z.value||(Z.value[I.hash]=Y),Y))})).then(()=>{console.debug("Fetched flow LORAs info: ",Z.value)}).catch(I=>{console.error("Error fetching flow LORAs info: ",I),a.add({title:"Error fetching flow LORAs info",description:"An error occurred while fetching LoRAs info for the flow. See the console for more details."})})}function K(A=!1){var q;if(!l.flow||!y.value)return;f.value=!0,A||ve();let I=null;return A&&((q=p.value.metadata)!=null&&q.nextPage)&&(I=p.value.metadata.nextPage),s.fetchFlowLoras(l.flow,y.value,50,I).then(Y=>{console.debug('Fetched flow "'+l.flow.name+'" loras: ',Y);const R=l.flow.lora_connect_points[Object.keys(l.flow.lora_connect_points)[0]].base_model_type,T=Y.items.reduce((H,B)=>(B.modelVersions=B.modelVersions.filter(G=>G.baseModel===R),B.modelVersions.length>0&&(p.value.items.find(G=>G.id===B.id)||H.push(B)),H),[]);return T.length===0&&a.add({title:"No more supported LoRAs",description:"No supported LoRAs available for the flow."}),p.value.items.push(...T),p.value.metadata=Y.metadata,Y}).catch(Y=>{console.error('Error fetching flow "'+l.flow.name+'" loras: ',Y),a.add({title:'Error fetching flow "'+l.flow.name+'" loras',description:"An error occurred while fetching LoRAs for the flow. See the console for more details."})}).finally(()=>{f.value=!1})}return(A,I)=>{const q=re,Y=Qt,R=dt,T=Ee,H=De,B=We,G=qe,de=yt,me=Ae,fe=ke,ye=Ye,Me=xe,_e=je,Fe=ln,ne=St,Ut=Se;return d(),$(Ut,{modelValue:n.value,"onUpdate:modelValue":I[14]||(I[14]=L=>n.value=L),fullscreen:""},{default:w(()=>[h("div",Uo,[m(q,{class:"absolute top-3 right-3",icon:"i-heroicons-x-mark",variant:"ghost",onClick:I[0]||(I[0]=()=>n.value=!1)}),I[21]||(I[21]=h("h2",{class:"text-xl font-bold"},"Modify flow",-1)),I[22]||(I[22]=h("p",{class:"text-sm text-slate-500 my-2"}," Select LoRAs to modify the flow. New Flow will be created and installed with selected LoRAs. ",-1)),t(C)?(d(),j("div",zo,[h("div",Vo,[m(q,{class:"my-1",variant:"outline",icon:"i-heroicons-arrow-down-on-square-stack",loading:t(f),onClick:I[1]||(I[1]=()=>{p.value={items:[],metadata:{}},Z.value={},z(),K()})},{default:w(()=>I[16]||(I[16]=[D(" Fetch LoRAs models from CivitAI ")])),_:1},8,["loading"]),h("div",Oo,[m(H,{label:"New flow name",class:"flex justify-center flex-col w-full",error:t(oe)?"":"Flow name is required and must be unique."},{default:w(()=>[m(T,{modelValue:t(u),"onUpdate:modelValue":I[2]||(I[2]=L=>Q(u)?u.value=L:null),placeholder:"unique_flow_name"},null,8,["modelValue"])]),_:1},8,["error"]),m(H,{label:"New display name",class:"flex justify-center flex-col w-full",error:t(O)!==""?"":"Display name is required."},{default:w(()=>[m(T,{modelValue:t(O),"onUpdate:modelValue":I[3]||(I[3]=L=>Q(O)?O.value=L:null),placeholder:"Display name"},null,8,["modelValue"])]),_:1},8,["error"]),m(H,{label:"New flow description",class:"flex justify-center flex-col w-full"},{default:w(()=>[m(T,{modelValue:t(i),"onUpdate:modelValue":I[4]||(I[4]=L=>Q(i)?i.value=L:null),placeholder:"Description"},null,8,["modelValue"])]),_:1}),m(H,{label:"License (optional)",class:"flex justify-center flex-col w-full"},{default:w(()=>[m(T,{modelValue:t(b),"onUpdate:modelValue":I[5]||(I[5]=L=>Q(b)?b.value=L:null),placeholder:"License"},null,8,["modelValue"])]),_:1}),m(H,{label:"Required memory (GB)",class:"flex justify-center flex-col w-full"},{default:w(()=>[m(T,{modelValue:t(S),"onUpdate:modelValue":I[6]||(I[6]=L=>Q(S)?S.value=L:null),placeholder:"Required memory (GB)"},null,8,["modelValue"])]),_:1}),m(H,{label:"Version",class:"flex justify-center flex-col w-full"},{default:w(()=>[m(T,{modelValue:t(V),"onUpdate:modelValue":I[7]||(I[7]=L=>Q(V)?V.value=L:null),placeholder:"Version"},null,8,["modelValue"])]),_:1})])]),m(ne,{class:"w-full",ui:{base:"",ring:"",divide:"divide-y divide-gray-200 dark:divide-gray-700",header:{padding:"px-4 py-5"},body:{padding:"",base:"divide-y divide-gray-200 dark:divide-gray-700"},footer:{padding:"p-4"}}},{footer:w(()=>[h("div",Yo,[m(q,{class:"mr-2",variant:"outline",icon:"i-heroicons-arrow-down-on-square-stack",color:"blue",disabled:t(p).items.length===0||t(p).items.length>0&&!t(p).metadata.nextPage,loading:t(f),onClick:I[13]||(I[13]=()=>{K(!0)})},{default:w(()=>I[20]||(I[20]=[D(" Load more ")])),_:1},8,["disabled","loading"])])]),default:w(()=>[h("div",jo,[h("div",To,[m(T,{modelValue:t(_),"onUpdate:modelValue":I[8]||(I[8]=L=>Q(_)?_.value=L:null),icon:"i-heroicons-magnifying-glass-20-solid",placeholder:"Filter by name..."},null,8,["modelValue"])]),h("div",Bo,[t(ee)?(d(),$(B,{key:0,modelValue:t(g),"onUpdate:modelValue":I[9]||(I[9]=L=>Q(g)?g.value=L:null),label:"Keep previous LoRAs",class:"mr-2"},null,8,["modelValue"])):M("",!0),t(ee)?(d(),$(q,{key:1,variant:"outline",icon:"i-heroicons-x-circle",color:"orange",class:"mr-2",onClick:I[10]||(I[10]=()=>t(P).splice(0))},{default:w(()=>I[17]||(I[17]=[D(" Clear selection ")])),_:1})):M("",!0),m(G,{text:t(J)},{default:w(()=>[m(q,{variant:"outline",icon:"i-heroicons-check-16-solid",disabled:!t(we),loading:t(f),onClick:ue},{default:w(()=>I[18]||(I[18]=[D(" Apply and install ")])),_:1},8,["disabled","loading"])]),_:1},8,["text"])])]),m(Fe,{modelValue:t(P),"onUpdate:modelValue":I[11]||(I[11]=L=>Q(P)?P.value=L:null),expand:t(U),"onUpdate:expand":I[12]||(I[12]=L=>Q(U)?U.value=L:null),columns:F,rows:t(N),loading:t(f),ui:{thead:"sticky top-0 dark:bg-gray-800 bg-white z-10",tr:{base:"dark:hover:bg-slate-800"}}},{caption:w(()=>I[19]||(I[19]=[h("caption",{class:"text-slate-500 text-sm py-1"},"Only supported LORAs for the basic model type are listed",-1)])),"select-header":w(({indeterminate:L,checked:se,change:Te})=>[h("div",No,[h("input",{type:"checkbox",class:"h-4 w-4 dark:checked:bg-current dark:checked:border-transparent dark:indeterminate:bg-current dark:indeterminate:border-transparent disabled:opacity-50 disabled:cursor-not-allowed focus:ring-0 focus:ring-transparent focus:ring-offset-transparent form-checkbox rounded bg-white dark:bg-gray-900 border border-gray-300 dark:border-gray-700 focus-visible:ring-2 focus-visible:ring-primary-500 dark:focus-visible:ring-primary-400 focus-visible:ring-offset-2 focus-visible:ring-offset-white dark:focus-visible:ring-offset-gray-900 text-primary-500 dark:text-primary-400","aria-label":"Select row",checked:se,indeterminate:L&&t(ee),onChange:Ze=>Te(Ze.target.checked)},null,40,Lo)])]),"select-data":w(({checked:L,change:se,row:Te})=>[Te!=null&&Te.currentFlowLora?M("",!0):(d(),j("div",Ao,[h("input",{type:"checkbox",class:"h-4 w-4 dark:checked:bg-current dark:checked:border-transparent dark:indeterminate:bg-current dark:indeterminate:border-transparent disabled:opacity-50 disabled:cursor-not-allowed focus:ring-0 focus:ring-transparent focus:ring-offset-transparent form-checkbox rounded bg-white dark:bg-gray-900 border border-gray-300 dark:border-gray-700 focus-visible:ring-2 focus-visible:ring-primary-500 dark:focus-visible:ring-primary-400 focus-visible:ring-offset-2 focus-visible:ring-offset-white dark:focus-visible:ring-offset-gray-900 text-primary-500 dark:text-primary-400","aria-label":"Select row",checked:L,onChange:Ze=>se(Ze.target.checked)},null,40,qo)]))]),"name-data":w(({row:L})=>[h("a",{href:`https://civitai.com/models/${L.id}`,target:"_blank",class:"text-blue-500 underline"},X(L.name),9,Eo)]),"description-data":w(({row:L})=>[m(de,null,{panel:w(()=>[h("div",{class:"model-description p-4 max-h-64 max-w-xl overflow-y-auto",innerHTML:L.description},null,8,Do)]),default:w(()=>[m(q,{color:"white",label:"Description","trailing-icon":"i-heroicons-chevron-down-20-solid"})]),_:2},1024)]),"trigger_words-data":w(({row:L})=>[m(de,null,{panel:w(()=>[h("div",Wo,[v(L).length===0?(d(),j("p",Ho,"No trigger words available for this model version.")):(d(!0),j(ie,{key:1},pe(v(L),se=>(d(),$(me,{key:se,class:"flex flex-wrap gap-3 my-1 whitespace-normal",label:se,color:"white",variant:"outline"},null,8,["label"]))),128))])]),default:w(()=>[m(q,{color:"white",label:`Trigger words (${v(L).length})`,"trailing-icon":"i-heroicons-chevron-down-20-solid"},null,8,["label"])]),_:2},1024)]),"nsfw-data":w(({row:L})=>[m(G,{text:`NSFW level: ${L.nsfwLevel}`,class:"pl-4"},{default:w(()=>[m(fe,{name:L.nsfw?"i-heroicons-x-circle":"i-heroicons-check-circle",class:te({"text-red-500":L.nsfw,"text-green-500":!L.nsfw})},null,8,["name","class"])]),_:2},1032,["text"])]),"statsThumbsUpCount-data":w(({row:L})=>[h("div",Go,[m(fe,{name:"i-heroicons-hand-thumb-up-solid",class:"text-green-500 mr-1"}),h("span",null,X(L.stats.thumbsUpCount),1)])]),"statsDownloadCount-data":w(({row:L})=>[h("div",Xo,[m(fe,{name:"i-heroicons-arrow-down-circle",class:"text-blue-500 mr-1"}),h("span",null,X(L.stats.downloadCount),1)])]),"modelVersion-data":w(({row:L})=>[m(ye,{modelValue:t(k)[L.id],"onUpdate:modelValue":se=>t(k)[L.id]=se,options:L.modelVersions.map(se=>se.name)},null,8,["modelValue","onUpdate:modelValue","options"])]),"actions-data":w(({row:L})=>[L!=null&&L.currentFlowLora?(d(),$(G,{key:1,text:"Remove previously selected LoRA"},{default:w(()=>[m(q,{icon:"i-heroicons-minus-16-solid",variant:"outline",color:"orange",onClick:se=>ae(L)},null,8,["onClick"])]),_:2},1024)):(d(),$(q,{key:0,icon:t(P).includes(L)?"i-heroicons-check-16-solid":"i-heroicons-plus-16-solid",variant:"outline",color:t(P).includes(L)?"green":"white",onClick:()=>{if(t(P).includes(L)){t(P).splice(t(P).indexOf(L),1);return}t(P).push(L)}},null,8,["icon","color","onClick"]))]),expand:w(({row:L})=>[c(L).length>0?(d(),j("div",Jo,[m(_e,{class:"my-3",items:c(L).map(se=>({id:se.id,url:se.url,type:(se==null?void 0:se.type)||"image"})),ui:{item:"mx-1"}},{default:w(({item:se})=>[se.type==="image"?(d(),$(Me,{key:0,src:se.url,height:256,width:256,loading:"lazy",draggable:"false"},null,8,["src"])):(d(),j("video",Qo,[h("source",{src:se.url},null,8,Ko)]))]),_:2},1032,["items"])])):(d(),$(R,{key:1,title:"No images",description:"No images available for this model version.",variant:"soft",color:"amber"}))]),_:1},8,["modelValue","expand","rows","loading"])]),_:1})])):(d(),$(R,{key:0,class:"my-4",title:"CivitAI token missing",description:"Please add a CivitAI token in the settings to use this feature.",variant:"soft",color:"red"},{actions:w(()=>[m(Y,{to:"/settings"},{default:w(()=>[m(q,{class:"lg:px-3 py-2",icon:"i-heroicons-arrow-top-right-on-square-16-solid",variant:"link",color:"white"},{default:w(()=>I[15]||(I[15]=[D(" Go to Settings ")])),_:1})]),_:1})]),_:1}))])]),_:1},8,["modelValue"])}}}),ea={class:"flex flex-col lg:flex-row flex-grow items-start w-full"},ta={class:"card-wrapper w-full lg:pr-5"},na={key:0,class:"p-0 text-sm"},la={class:"flex flex-row items-center text-slate-400 mb-2"},oa={class:"flex flex-row flex-wrap items-center text-md mb-2"},aa=["href"],sa={class:"flex flex-row items-center text-md mb-2"},ia=["href"],ra={key:1},ua={class:"flex flex-row items-center text-md mb-2"},da={key:0},ca={class:"flex flex-row items-center text-md mb-2"},ma={key:0,class:"flex flex-row flex-wrap items-center text-md mb-2"},fa=["href"],pa={key:1},ga={class:"flex flex-row items-center mb-2"},va={key:1,class:"flex flex-row flex-wrap items-center text-md"},ha={key:0,class:"flex justify-end"},wa={class:"flex flex-row items-center justify-center text-sm mr-2"},ya={key:1},ba={class:"text-sm flex justify-end"},ka={class:"flex flex-row items-center justify-center text-sm mr-3"},xa={key:0,class:"text-right"},_a={class:"prompt-wrapper w-full"},$a={class:"flex items-center justify-between"},Ca={class:"pb-2"},Sa={class:"flex justify-end items-center"},Ta=le({__name:"[name]",setup(e){const l=Kt(),n=ge();n.setCurrentFlow(l.params.name);const a=E(()=>n.flowInstallingByName(l.params.name)),r=E(()=>{var g;return a.value&&((g=a.value)==null?void 0:g.progress)<100||!1}),o=x(!1),s=E(()=>{var g;return a.value?"error"in a.value&&((g=a.value)==null?void 0:g.error)!==""?`${a.value.progress.toFixed(0)}% Error setting up`:`${a.value.progress.toFixed(0)}% Setting up`:"Setup flow"}),f=x(!1),p=x(!1),C=x(!1),y=E(()=>{var u,O;const g=[[{label:"Delete flow",icon:"i-heroicons-trash",click:P}]];return((u=n==null?void 0:n.currentFlow)==null?void 0:u.new_version_available)!==""&&g[0].unshift({label:`Update to ${n.currentFlow.new_version_available}`,icon:"i-heroicons-arrow-path",click:()=>{n.updateFlow(n.currentFlow)}}),(O=n==null?void 0:n.currentFlow)!=null&&O.lora_connect_points&&Object.keys(n.currentFlow.lora_connect_points).length>0&&g[0].unshift({label:"Modify flow",icon:"i-heroicons-plus-circle",click:()=>{C.value=!0}}),g});function F(g,u=!1){f.value=!0,n.deleteFlow(g).then(()=>{u&&Ct().push("/")}).finally(()=>{f.value=!1,p.value=!1})}function P(){var u;const g=((u=n.currentFlow)==null?void 0:u.private)||!1;if(g){p.value=!0;return}F(n.currentFlow,g)}const U=x(!1),_=x(null),z=function(g){var u;(u=_.value)==null||u.copyPromptInputs(g)},N=rt(),k=E(()=>{var g;return(g=n.currentFlow)==null?void 0:g.models.filter(u=>u.installed).reduce((u,O)=>u+(O==null?void 0:O.file_size)||0,0)}),c=E(()=>{var g;return(g=n.currentFlow)==null?void 0:g.models.reduce((u,O)=>u+(O==null?void 0:O.file_size)||0,0)}),v=E(()=>!k.value&&!c.value?"":k.value===c.value?` - ${Ue(c.value)}`:` - ${Ue(k.value)} / ${Ue(c.value)}`);return(g,u)=>{const O=ke,i=qe,b=Ae,S=re,V=Ke,W=St,ae=pl,oe=Ul,ee=Fo,we=Rt,J=Se,ue=Zo,Z=Yt;return d(),$(Z,null,{default:w(()=>{var ve;return[!t(n).loading.flows_available&&!t(n).loading.flows_installed&&t(n).currentFlow&&!t(n).$state.loading.tasks_history?(d(),j(ie,{key:0},[h("div",ea,[h("div",ta,[m(W,{as:"div",class:"w-full mb-5"},Zt({header:w(()=>{var K,A;return[h("h2",{class:"text-xl font-bold cursor-pointer select-none flex items-center",onClick:u[0]||(u[0]=()=>{U.value=!t(U)})},[(K=t(n).currentFlow)!=null&&K.private?(d(),$(i,{key:0,text:"This flow is local, manually added"},{default:w(()=>{var I;return[m(O,{name:"i-heroicons-lock-closed",class:te(["mr-2",{"text-stone-500":!((I=t(n).currentFlow)!=null&&I.is_supported_by_workers)}])},null,8,["class"])]}),_:1})):M("",!0),m(O,{name:t(U)?"i-heroicons-chevron-down":"i-heroicons-chevron-up",class:"mr-2"},null,8,["name"]),m(i,{text:(A=t(n).currentFlow)!=null&&A.is_supported_by_workers?"":"No workers capable of running this flow",popper:{placement:"top"}},{default:w(()=>{var I,q;return[h("span",{class:te({"text-stone-500":!((I=t(n).currentFlow)!=null&&I.is_supported_by_workers)})},X((q=t(n).currentFlow)==null?void 0:q.display_name),3)]}),_:1},8,["text"])])]}),default:w(()=>{var K,A,I,q,Y,R,T,H,B,G,de,me,fe,ye,Me,_e,Fe;return[t(U)?M("",!0):(d(),j("div",na,[h("p",la,X((K=t(n).currentFlow)==null?void 0:K.description),1),h("p",oa,[m(O,{name:"i-heroicons-user-16-solid",class:"mr-1"}),u[9]||(u[9]=h("b",null,"Author:",-1)),u[10]||(u[10]=D(" ")),h("a",{class:"hover:underline text-md",href:(A=t(n).currentFlow)==null?void 0:A.homepage,rel:"noopener",target:"_blank"},X((I=t(n).currentFlow)==null?void 0:I.author),9,aa)]),h("p",sa,[m(O,{name:"i-heroicons-document-text",class:"mr-1"}),(q=t(n).currentFlow)!=null&&q.documentation?(d(),j("a",{key:0,class:"hover:underline",href:(Y=t(n).currentFlow)==null?void 0:Y.documentation,rel:"noopener",target:"_blank"}," Documentation ",8,ia)):(d(),j("span",ra,"No documentation"))]),h("p",ua,[m(O,{name:"i-heroicons-clock",class:"mr-1"}),u[11]||(u[11]=h("b",null,"Version:",-1)),u[12]||(u[12]=D(" ")),h("span",null,X((R=t(n).currentFlow)==null?void 0:R.version),1),((T=t(n).currentFlow)==null?void 0:T.new_version_available)!==""?(d(),j("span",da," (new version available: "+X((H=t(n).currentFlow)==null?void 0:H.new_version_available)+") ",1)):M("",!0)]),h("p",ca,[m(O,{name:"i-heroicons-tag",class:"mr-1"}),u[13]||(u[13]=h("b",null,"Tags:",-1)),u[14]||(u[14]=D(" ")),((B=t(n).currentFlow)==null?void 0:B.tags.length)>0?(d(!0),j(ie,{key:0},pe((G=t(n).currentFlow)==null?void 0:G.tags,ne=>(d(),$(b,{key:ne,label:ne,color:"white",variant:"solid",class:"m-1"},null,8,["label"]))),128)):(d(),$(b,{key:1,label:"No tags",color:"white",variant:"solid",class:"m-1"}))]),((me=(de=t(n).currentFlow)==null?void 0:de.models)==null?void 0:me.length)>0?(d(),j("p",ma,[m(O,{name:"i-heroicons-arrow-down-on-square-stack",class:"mr-1"}),m(i,{text:t(c)-t(k)>0?`${("formatBytes"in g?g.formatBytes:t(Ue))(t(c)-t(k))} to download`:"All models installed",popper:{placement:"top"}},{default:w(()=>{var ne;return[h("b",null,"Models ("+X((ne=t(n).currentFlow)==null?void 0:ne.models.length)+X(t(v))+"):",1),u[15]||(u[15]=D(" "))]}),_:1},8,["text"]),(d(!0),j(ie,null,pe((fe=t(n).currentFlow)==null?void 0:fe.models,ne=>(d(),$(b,{key:ne.name,class:"m-1",color:"white",variant:"solid"},{default:w(()=>[m(i,{text:ne.installed?"Model installed":"Model not installed"},{default:w(()=>[m(O,{name:ne.installed?"i-heroicons-check-circle-20-solid":"i-heroicons-x-mark-20-solid",class:te(ne.installed?"text-green-500":"text-orange-500")},null,8,["name","class"])]),_:2},1032,["text"]),ne.gated?(d(),$(i,{key:0,text:"Gated model, requires auth token for download",popper:{placement:"top"}},{default:w(()=>[m(O,{name:"i-heroicons-key",class:"mr-1"})]),_:1})):M("",!0),h("a",{class:"hover:underline underline-offset-4",href:ne.homepage,rel:"noopener",target:"_blank"},X(ne.name),9,fa),ne.file_size?(d(),j("span",pa," ("+X(("formatBytes"in g?g.formatBytes:t(Ue))(ne.file_size))+") ",1)):M("",!0)]),_:2},1024))),128))])):M("",!0),h("p",ga,[m(O,{name:"i-mdi-help-network-outline",class:"mr-1"}),u[18]||(u[18]=h("b",null,"Platforms:",-1)),u[19]||(u[19]=D(" ")),m(i,{text:"Linux"},{default:w(()=>[m(O,{name:"i-mdi-linux",class:"mr-1"})]),_:1}),m(i,{text:"Microsoft Windows"},{default:w(()=>[m(O,{name:"i-mdi-microsoft-windows",class:"mr-1"})]),_:1}),t(n).currentFlow.is_macos_supported?(d(),$(i,{key:0,text:"macOS"},{default:w(()=>[m(O,{name:"i-mdi-apple",class:"mr-1"})]),_:1})):M("",!0),(ye=t(n).currentFlow)!=null&&ye.required_memory_gb?(d(),$(i,{key:1,class:"flex flex-row items-center",text:"Required VRAM memory (GB)"},{default:w(()=>{var ne;return[u[16]||(u[16]=D(" (")),m(O,{name:"i-mdi-memory",class:"mr-1"}),h("span",null,X((ne=t(n).currentFlow)==null?void 0:ne.required_memory_gb)+" GB",1),u[17]||(u[17]=D(") "))]}),_:1})):M("",!0)]),((_e=(Me=t(n).currentFlow)==null?void 0:Me.requires)==null?void 0:_e.length)>0?(d(),j("p",va,[u[20]||(u[20]=h("b",null,"Requires:",-1)),u[21]||(u[21]=D(" ")),(d(!0),j(ie,null,pe((Fe=t(n).currentFlow)==null?void 0:Fe.requires,ne=>(d(),$(b,{key:ne,class:"m-1",color:"yellow",variant:"outline"},{default:w(()=>[D(X(ne),1)]),_:2},1024))),128))])):M("",!0)]))]}),_:2},[t(U)?void 0:{name:"footer",fn:w(()=>{var K,A;return[t(N).isAdmin?(d(),j("div",ha,[h("div",wa,[m(O,{name:t(n).isFlowInstalled(t(l).params.name)?"i-heroicons-check-badge":"i-heroicons-x-mark",class:"mx-1"},null,8,["name"]),h("span",{class:te({"text-green-500":t(n).isFlowInstalled(t(l).params.name),"text-red-500":!t(n).isFlowInstalled(t(l).params.name),"text-stone-500":t(n).isFlowInstalled(t(l).params.name)&&!((K=t(n).currentFlow)!=null&&K.is_supported_by_workers)})},X(t(n).isFlowInstalled(t(l).params.name)?(A=t(n).currentFlow)!=null&&A.is_supported_by_workers?"Installed":"Installed (no workers)":"Not installed"),3)]),t(n).isFlowInstalled(t(l).params.name)?M("",!0):(d(),$(i,{key:0,text:"Setup flow dependencies and configure it in ComfyUI",popper:{placement:"top"},"open-delay":500},{default:w(()=>[m(S,{icon:"i-heroicons-arrow-down-tray",class:"mx-3",color:"primary",variant:"outline",loading:t(r),onClick:u[1]||(u[1]=()=>t(n).setupFlow(t(n).currentFlow))},{default:w(()=>[D(X(t(s)),1)]),_:1},8,["loading"])]),_:1})),!t(n).isFlowInstalled(t(l).params.name)&&t(r)?(d(),$(i,{key:1,text:"Cancel flow installation",popper:{placement:"top"},"open-delay":500},{default:w(()=>[m(S,{icon:"i-heroicons-stop",variant:"outline",color:"orange",loading:t(o),onClick:u[2]||(u[2]=()=>{o.value=!0,t(n).cancelFlowSetup(t(n).currentFlow).then(()=>{o.value=!1})})},{default:w(()=>u[22]||(u[22]=[D(" Cancel ")])),_:1},8,["loading"])]),_:1})):M("",!0),t(n).isFlowInstalled(t(l).params.name)?(d(),$(V,{key:2,items:t(y),mode:"click",label:"Actions",popper:{placement:"bottom-end"}},{default:w(()=>[m(S,{color:"white",label:"Actions","trailing-icon":"i-heroicons-chevron-down-20-solid"})]),_:1},8,["items"])):M("",!0)])):(d(),j("div",ya,[h("div",ba,[h("div",ka,[m(O,{name:t(n).isFlowInstalled(t(l).params.name)?"i-heroicons-check-badge":"i-heroicons-x-mark",class:"mx-1"},null,8,["name"]),h("span",{class:te({"text-green-500":t(n).isFlowInstalled(t(l).params.name),"text-red-500":!t(n).isFlowInstalled(t(l).params.name)})},X(t(n).isFlowInstalled(t(l).params.name)?"Installed":"Not installed"),3)]),t(n).isFlowInstalled(t(l).params.name)?M("",!0):(d(),j("div",xa,u[23]||(u[23]=[h("p",{class:"text-orange-500"},"Only admin can manage workflows.",-1),h("span",{class:"text-slate-500"},"Ask your admin to setup this workflow",-1)])))])]))]}),key:"0"}]),1024)]),h("div",_a,[!t(f)&&t(n).isFlowInstalled(t(l).params.name)?(d(),$(ae,{key:0,ref_key:"workflowPrompt",ref:_},null,512)):M("",!0)])]),!t(f)&&t(n).isFlowInstalled(t(l).params.name)?(d(),$(oe,{key:0})):M("",!0),!t(f)&&t(n).isFlowInstalled(t(l).params.name)||t(n).flowResultsByName(t(l).params.name).length>0?(d(),$(ee,{key:1,onCopyPromptInputs:u[3]||(u[3]=K=>z(K))})):M("",!0)],64)):(d(),$(we,{key:1,class:"mb-3"})),m(J,{modelValue:t(p),"onUpdate:modelValue":u[7]||(u[7]=K=>Q(p)?p.value=K:null),"prevent-close":""},{default:w(()=>[m(W,{ui:{ring:"",divide:"divide-y divide-gray-100 dark:divide-gray-800"}},{header:w(()=>[h("div",$a,[u[24]||(u[24]=h("h3",{class:"text-base font-semibold leading-6 text-gray-900 dark:text-white"}," Confirm workflow deletion ",-1)),m(S,{color:"gray",variant:"ghost",icon:"i-heroicons-x-mark-20-solid",class:"-my-1",onClick:u[4]||(u[4]=K=>p.value=!1)})])]),default:w(()=>{var K;return[h("p",Ca,[u[25]||(u[25]=D(" Are you sure you want to delete the ")),u[26]||(u[26]=h("b",null,"private",-1)),u[27]||(u[27]=D(" workflow ")),h("b",null,X((K=t(n).currentFlow)==null?void 0:K.display_name),1),u[28]||(u[28]=D("? "))]),h("div",Sa,[m(S,{icon:"i-heroicons-x-mark-16-solid",variant:"outline",color:"green",class:"mr-2",onClick:u[5]||(u[5]=A=>p.value=!1)},{default:w(()=>u[29]||(u[29]=[D(" Cancel ")])),_:1}),m(S,{icon:"i-heroicons-trash",variant:"outline",color:"red",onClick:u[6]||(u[6]=A=>{var I;return F(t(n).currentFlow,((I=t(n).currentFlow)==null?void 0:I.private)||!1)})},{default:w(()=>u[30]||(u[30]=[D(" Delete ")])),_:1})])]}),_:1})]),_:1},8,["modelValue"]),t(N).isAdmin&&((ve=t(n))!=null&&ve.currentFlow)?(d(),$(ue,{key:2,show:t(C),"onUpdate:show":u[8]||(u[8]=K=>Q(C)?C.value=K:null),flow:t(n).currentFlow},null,8,["show","flow"])):M("",!0)]}),_:1})}}});export{Ta as default};
