import{f as Z,U as il,S as ge,V as rl,W as ul,c as O,X as ht,B as S,Y as dt,Z as dl,$ as Lt,a0 as At,a1 as et,a2 as _t,x as B,a3 as ye,a4 as tt,a5 as zt,a6 as cl,a7 as Ce,a8 as it,v as pe,a9 as ml,aa as Ke,ab as fl,F as te,ac as pl,ad as ut,ae as Ee,af as Ie,E as mt,ag as vl,G as Me,_ as ft,o as u,a as b,H as Fe,I as Te,n as le,K as pt,L as Be,ah as $t,N as ct,M as De,ai as gl,aj as bt,ak as wl,al as Tt,am as kt,an as yl,ao as hl,ap as Ot,aq as Ye,ar as qt,as as bl,p as t,at as kl,au as Ct,av as xl,aw as Ze,ax as He,ay as Le,g as we,C as It,T as St,az as Se,i as $,k as F,w as h,b as f,r as ve,m as de,d as X,P as K,aA as _l,s as ke,aB as $l,t as Q,aC as vt,Q as Pt,j as Xe,q as Mt,z as Cl,D as We,h as xe,y as Et,aD as Dt,l as Je,aE as Il,aF as Sl,aG as Wt,R as xt,aH as Ht,aI as fe,aJ as Gt,aK as Xt,aL as Pl,aM as Ml,aN as Rl,aO as Fl,J as Ul,aP as Jt,aQ as Vl,A as zl,aR as Tl}from"./FxB7fYMO.js";import{b as gt,a as Ol,_ as Qt}from"./Ceu8OUSq.js";import{t as jl,u as Kt,_ as Oe,a as Qe}from"./X6vJFgsE.js";import{_ as je,a as Nl}from"./CT6QiWf4.js";import{a as Ue,_ as Bl}from"./CY2D5Ww4.js";import{_ as lt,a as wt}from"./BT_qM-G2.js";import{_ as Yt}from"./DhAkBrAT.js";import{_ as Ll}from"./wJJDR9sf.js";import{_ as Al}from"./DE-JA0N7.js";const ql=Symbol.for("nuxt:client-only"),El=Z({name:"ClientOnly",inheritAttrs:!1,props:["fallback","placeholder","placeholderTag","fallbackTag"],setup(e,{slots:l,attrs:n}){const o=il(!1);ge(()=>{o.value=!0});const i=rl();return i&&(i._nuxtClientOnly=!0),ht(ql,!0),()=>{var m;if(o.value){const k=(m=l.default)==null?void 0:m.call(l);return k&&k.length===1?[ul(k[0],n)]:k}const a=l.fallback||l.placeholder;if(a)return a();const s=e.fallback||e.placeholder||"",r=e.fallbackTag||e.placeholderTag||"span";return O(r,n,s)}}}),Dl={wrapper:"relative",container:"relative w-full flex overflow-x-auto snap-x snap-mandatory scroll-smooth",item:"flex flex-none snap-center",arrows:{wrapper:"flex items-center justify-between"},indicators:{wrapper:"absolute flex items-center justify-center gap-3 bottom-4 inset-x-0",base:"rounded-full h-3 w-3",active:"bg-primary-500 dark:bg-primary-400",inactive:"bg-gray-100 dark:bg-gray-800"},default:{prevButton:{color:"black",class:"rtl:[&_span:first-child]:rotate-180 absolute start-4 top-1/2 transform -translate-y-1/2 rounded-full",icon:"i-heroicons-chevron-left-20-solid"},nextButton:{color:"black",class:"rtl:[&_span:last-child]:rotate-180 absolute end-4 top-1/2 transform -translate-y-1/2 rounded-full",icon:"i-heroicons-chevron-right-20-solid"}}},Wl={wrapper:"relative w-full flex items-center",base:"w-full absolute appearance-none cursor-pointer disabled:cursor-not-allowed disabled:bg-opacity-50 focus:outline-none peer group",rounded:"rounded-lg",background:"bg-transparent",ring:"focus-visible:ring-2 focus-visible:ring-{color}-500 dark:focus-visible:ring-{color}-400 focus-visible:ring-offset-2 focus-visible:ring-offset-white dark:focus-visible:ring-offset-gray-900",progress:{base:"absolute pointer-events-none peer-disabled:bg-opacity-50",rounded:"rounded-s-lg",background:"bg-{color}-500 dark:bg-{color}-400",size:{"2xs":"h-px",xs:"h-0.5",sm:"h-1",md:"h-2",lg:"h-3",xl:"h-4","2xl":"h-5"}},thumb:{base:"[&::-webkit-slider-thumb]:relative [&::-moz-range-thumb]:relative [&::-webkit-slider-thumb]:z-[1] [&::-moz-range-thumb]:z-[1] [&::-webkit-slider-thumb]:appearance-none [&::-moz-range-thumb]:appearance-none [&::-webkit-slider-thumb]:rounded-full [&::-moz-range-thumb]:rounded-full [&::-moz-range-thumb]:border-0",color:"text-{color}-500 dark:text-{color}-400",background:"[&::-webkit-slider-thumb]:bg-white [&::-webkit-slider-thumb]:dark:bg-gray-900 [&::-moz-range-thumb]:bg-current",ring:"[&::-webkit-slider-thumb]:ring-2 [&::-webkit-slider-thumb]:ring-current",size:{"2xs":"[&::-webkit-slider-thumb]:h-1.5 [&::-moz-range-thumb]:h-1.5 [&::-webkit-slider-thumb]:w-1.5 [&::-moz-range-thumb]:w-1.5 [&::-webkit-slider-thumb]:mt-[-2.5px] [&::-moz-range-thumb]:mt-[-2.5px]",xs:"[&::-webkit-slider-thumb]:h-2 [&::-moz-range-thumb]:h-2 [&::-webkit-slider-thumb]:w-2 [&::-moz-range-thumb]:w-2 [&::-webkit-slider-thumb]:mt-[-3px] [&::-moz-range-thumb]:mt-[-3px]",sm:"[&::-webkit-slider-thumb]:h-3 [&::-moz-range-thumb]:h-3 [&::-webkit-slider-thumb]:w-3 [&::-moz-range-thumb]:w-3 [&::-webkit-slider-thumb]:-mt-1 [&::-moz-range-thumb]:-mt-1",md:"[&::-webkit-slider-thumb]:h-4 [&::-moz-range-thumb]:h-4 [&::-webkit-slider-thumb]:w-4 [&::-moz-range-thumb]:w-4 [&::-webkit-slider-thumb]:-mt-1 [&::-moz-range-thumb]:-mt-1",lg:"[&::-webkit-slider-thumb]:h-5 [&::-moz-range-thumb]:h-5 [&::-webkit-slider-thumb]:w-5 [&::-moz-range-thumb]:w-5 [&::-webkit-slider-thumb]:-mt-1 [&::-moz-range-thumb]:-mt-1",xl:"[&::-webkit-slider-thumb]:h-6 [&::-moz-range-thumb]:h-6 [&::-webkit-slider-thumb]:w-6 [&::-moz-range-thumb]:w-6 [&::-webkit-slider-thumb]:-mt-1 [&::-moz-range-thumb]:-mt-1","2xl":"[&::-webkit-slider-thumb]:h-7 [&::-moz-range-thumb]:h-7 [&::-webkit-slider-thumb]:w-7 [&::-moz-range-thumb]:w-7 [&::-webkit-slider-thumb]:-mt-1 [&::-moz-range-thumb]:-mt-1"}},track:{base:"[&::-webkit-slider-runnable-track]:group-disabled:bg-opacity-50 [&::-moz-range-track]:group-disabled:bg-opacity-50",background:"[&::-webkit-slider-runnable-track]:bg-gray-200 [&::-moz-range-track]:bg-gray-200 [&::-webkit-slider-runnable-track]:dark:bg-gray-700 [&::-moz-range-track]:dark:bg-gray-700",rounded:"[&::-webkit-slider-runnable-track]:rounded-lg [&::-moz-range-track]:rounded-lg",size:{"2xs":"[&::-webkit-slider-runnable-track]:h-px [&::-moz-range-track]:h-px",xs:"[&::-webkit-slider-runnable-track]:h-0.5 [&::-moz-range-track]:h-0.5",sm:"[&::-webkit-slider-runnable-track]:h-1 [&::-moz-range-track]:h-1",md:"[&::-webkit-slider-runnable-track]:h-2 [&::-moz-range-track]:h-2",lg:"[&::-webkit-slider-runnable-track]:h-3 [&::-moz-range-track]:h-3",xl:"[&::-webkit-slider-runnable-track]:h-4 [&::-moz-range-track]:h-4","2xl":"[&::-webkit-slider-runnable-track]:h-5 [&::-moz-range-track]:h-5"}},size:{"2xs":"h-1.5",xs:"h-2",sm:"h-3",md:"h-4",lg:"h-5",xl:"h-6","2xl":"h-7"},default:{size:"md",color:"primary"}},Hl={wrapper:"relative space-y-2",container:"relative w-full",base:"focus:outline-none",list:{base:"relative",background:"bg-gray-100 dark:bg-gray-800",rounded:"rounded-lg",shadow:"",padding:"p-1",height:"h-10",width:"w-full",marker:{wrapper:"absolute top-[4px] left-[4px] duration-200 ease-out focus:outline-none",base:"w-full h-full",background:"bg-white dark:bg-gray-900",rounded:"rounded-md",shadow:"shadow-sm"},tab:{base:"relative inline-flex items-center justify-center flex-shrink-0 w-full ui-focus-visible:outline-0 ui-focus-visible:ring-2 ui-focus-visible:ring-primary-500 dark:ui-focus-visible:ring-primary-400 ui-not-focus-visible:outline-none focus:outline-none disabled:cursor-not-allowed disabled:opacity-75 transition-colors duration-200 ease-out",background:"",active:"text-gray-900 dark:text-white",inactive:"text-gray-500 dark:text-gray-400",height:"h-8",padding:"px-3",size:"text-sm",font:"font-medium",rounded:"rounded-md",shadow:"",icon:"w-4 h-4 flex-shrink-0 me-2"}}};let Gl=Z({props:{onFocus:{type:Function,required:!0}},setup(e){let l=S(!0);return()=>l.value?dt(Lt,{as:"button",type:"button",features:dl.Focusable,onFocus(n){n.preventDefault();let o,i=50;function a(){var s;if(i--<=0){o&&cancelAnimationFrame(o);return}if((s=e.onFocus)!=null&&s.call(e)){l.value=!1,cancelAnimationFrame(o);return}o=requestAnimationFrame(a)}o=requestAnimationFrame(a)}}):null}});var Xl=(e=>(e[e.Forwards=0]="Forwards",e[e.Backwards=1]="Backwards",e))(Xl||{}),Jl=(e=>(e[e.Less=-1]="Less",e[e.Equal=0]="Equal",e[e.Greater=1]="Greater",e))(Jl||{});let Zt=Symbol("TabsContext");function nt(e){let l=_t(Zt,null);if(l===null){let n=new Error(`<${e} /> is missing a parent <TabGroup /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(n,nt),n}return l}let Rt=Symbol("TabsSSRContext"),Ql=Z({name:"TabGroup",emits:{change:e=>!0},props:{as:{type:[Object,String],default:"template"},selectedIndex:{type:[Number],default:null},defaultIndex:{type:[Number],default:0},vertical:{type:[Boolean],default:!1},manual:{type:[Boolean],default:!1}},inheritAttrs:!1,setup(e,{slots:l,attrs:n,emit:o}){var i;let a=S((i=e.selectedIndex)!=null?i:e.defaultIndex),s=S([]),r=S([]),m=B(()=>e.selectedIndex!==null),k=B(()=>m.value?e.selectedIndex:a.value);function w(z){var N;let C=Ke(g.tabs.value,ye),c=Ke(g.panels.value,ye),v=C.filter(y=>{var V;return!((V=ye(y))!=null&&V.hasAttribute("disabled"))});if(z<0||z>C.length-1){let y=ut(a.value===null?0:Math.sign(z-a.value),{[-1]:()=>1,0:()=>ut(Math.sign(z),{[-1]:()=>0,0:()=>0,1:()=>1}),1:()=>0}),V=ut(y,{0:()=>C.indexOf(v[0]),1:()=>C.indexOf(v[v.length-1])});V!==-1&&(a.value=V),g.tabs.value=C,g.panels.value=c}else{let y=C.slice(0,z),V=[...C.slice(z),...y].find(p=>v.includes(p));if(!V)return;let _=(N=C.indexOf(V))!=null?N:g.selectedIndex.value;_===-1&&(_=g.selectedIndex.value),a.value=_,g.tabs.value=C,g.panels.value=c}}let g={selectedIndex:B(()=>{var z,N;return(N=(z=a.value)!=null?z:e.defaultIndex)!=null?N:null}),orientation:B(()=>e.vertical?"vertical":"horizontal"),activation:B(()=>e.manual?"manual":"auto"),tabs:s,panels:r,setSelectedIndex(z){k.value!==z&&o("change",z),m.value||w(z)},registerTab(z){var N;if(s.value.includes(z))return;let C=s.value[a.value];if(s.value.push(z),s.value=Ke(s.value,ye),!m.value){let c=(N=s.value.indexOf(C))!=null?N:a.value;c!==-1&&(a.value=c)}},unregisterTab(z){let N=s.value.indexOf(z);N!==-1&&s.value.splice(N,1)},registerPanel(z){r.value.includes(z)||(r.value.push(z),r.value=Ke(r.value,ye))},unregisterPanel(z){let N=r.value.indexOf(z);N!==-1&&r.value.splice(N,1)}};ht(Zt,g);let P=S({tabs:[],panels:[]}),j=S(!1);ge(()=>{j.value=!0}),ht(Rt,B(()=>j.value?null:P.value));let I=B(()=>e.selectedIndex);return ge(()=>{pe([I],()=>{var z;return w((z=e.selectedIndex)!=null?z:e.defaultIndex)},{immediate:!0})}),ml(()=>{if(!m.value||k.value==null||g.tabs.value.length<=0)return;let z=Ke(g.tabs.value,ye);z.some((N,C)=>ye(g.tabs.value[C])!==ye(N))&&g.setSelectedIndex(z.findIndex(N=>ye(N)===ye(g.tabs.value[k.value])))}),()=>{let z={selectedIndex:a.value};return dt(te,[s.value.length<=0&&dt(Gl,{onFocus:()=>{for(let N of s.value){let C=ye(N);if((C==null?void 0:C.tabIndex)===0)return C.focus(),!0}return!1}}),tt({theirProps:{...n,...fl(e,["selectedIndex","defaultIndex","manual","vertical","onChange"])},ourProps:{},slot:z,slots:l,attrs:n,name:"TabGroup"})])}}}),Kl=Z({name:"TabList",props:{as:{type:[Object,String],default:"div"}},setup(e,{attrs:l,slots:n}){let o=nt("TabList");return()=>{let i={selectedIndex:o.selectedIndex.value},a={role:"tablist","aria-orientation":o.orientation.value};return tt({ourProps:a,theirProps:e,slot:i,attrs:l,slots:n,name:"TabList"})}}}),Yl=Z({name:"Tab",props:{as:{type:[Object,String],default:"button"},disabled:{type:[Boolean],default:!1},id:{type:String,default:null}},setup(e,{attrs:l,slots:n,expose:o}){var i;let a=(i=e.id)!=null?i:`headlessui-tabs-tab-${At()}`,s=nt("Tab"),r=S(null);o({el:r,$el:r}),ge(()=>s.registerTab(r)),et(()=>s.unregisterTab(r));let m=_t(Rt),k=B(()=>{if(m.value){let c=m.value.tabs.indexOf(a);return c===-1?m.value.tabs.push(a)-1:c}return-1}),w=B(()=>{let c=s.tabs.value.indexOf(r);return c===-1?k.value:c}),g=B(()=>w.value===s.selectedIndex.value);function P(c){var v;let y=c();if(y===it.Success&&s.activation.value==="auto"){let V=(v=pl(r))==null?void 0:v.activeElement,_=s.tabs.value.findIndex(p=>ye(p)===V);_!==-1&&s.setSelectedIndex(_)}return y}function j(c){let v=s.tabs.value.map(y=>ye(y)).filter(Boolean);if(c.key===Ce.Space||c.key===Ce.Enter){c.preventDefault(),c.stopPropagation(),s.setSelectedIndex(w.value);return}switch(c.key){case Ce.Home:case Ce.PageUp:return c.preventDefault(),c.stopPropagation(),P(()=>Ee(v,Ie.First));case Ce.End:case Ce.PageDown:return c.preventDefault(),c.stopPropagation(),P(()=>Ee(v,Ie.Last))}if(P(()=>ut(s.orientation.value,{vertical(){return c.key===Ce.ArrowUp?Ee(v,Ie.Previous|Ie.WrapAround):c.key===Ce.ArrowDown?Ee(v,Ie.Next|Ie.WrapAround):it.Error},horizontal(){return c.key===Ce.ArrowLeft?Ee(v,Ie.Previous|Ie.WrapAround):c.key===Ce.ArrowRight?Ee(v,Ie.Next|Ie.WrapAround):it.Error}}))===it.Success)return c.preventDefault()}let I=S(!1);function z(){var c;I.value||(I.value=!0,!e.disabled&&((c=ye(r))==null||c.focus({preventScroll:!0}),s.setSelectedIndex(w.value),jl(()=>{I.value=!1})))}function N(c){c.preventDefault()}let C=cl(B(()=>({as:e.as,type:l.type})),r);return()=>{var c,v;let y={selected:g.value,disabled:(c=e.disabled)!=null?c:!1},{...V}=e,_={ref:r,onKeydown:j,onMousedown:N,onClick:z,id:a,role:"tab",type:C.value,"aria-controls":(v=ye(s.panels.value[w.value]))==null?void 0:v.id,"aria-selected":g.value,tabIndex:g.value?0:-1,disabled:e.disabled?!0:void 0};return tt({ourProps:_,theirProps:V,slot:y,attrs:l,slots:n,name:"Tab"})}}}),Zl=Z({name:"TabPanels",props:{as:{type:[Object,String],default:"div"}},setup(e,{slots:l,attrs:n}){let o=nt("TabPanels");return()=>{let i={selectedIndex:o.selectedIndex.value};return tt({theirProps:e,ourProps:{},slot:i,attrs:n,slots:l,name:"TabPanels"})}}}),en=Z({name:"TabPanel",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},id:{type:String,default:null},tabIndex:{type:Number,default:0}},setup(e,{attrs:l,slots:n,expose:o}){var i;let a=(i=e.id)!=null?i:`headlessui-tabs-panel-${At()}`,s=nt("TabPanel"),r=S(null);o({el:r,$el:r}),ge(()=>s.registerPanel(r)),et(()=>s.unregisterPanel(r));let m=_t(Rt),k=B(()=>{if(m.value){let P=m.value.panels.indexOf(a);return P===-1?m.value.panels.push(a)-1:P}return-1}),w=B(()=>{let P=s.panels.value.indexOf(r);return P===-1?k.value:P}),g=B(()=>w.value===s.selectedIndex.value);return()=>{var P;let j={selected:g.value},{tabIndex:I,...z}=e,N={ref:r,id:a,role:"tabpanel","aria-labelledby":(P=ye(s.tabs.value[w.value]))==null?void 0:P.id,tabIndex:g.value?I:-1};return!g.value&&e.unmount&&!e.static?dt(Lt,{as:"span","aria-hidden":!0,...N}):tt({ourProps:N,theirProps:z,slot:j,attrs:l,slots:n,features:zt.Static|zt.RenderStrategy,visible:g.value,name:"TabPanel"})}}});const ze=mt(Me.ui.strategy,Me.ui.textarea,vl),tn=Z({inheritAttrs:!1,props:{modelValue:{type:[String,Number],default:""},id:{type:String,default:null},name:{type:String,default:null},placeholder:{type:String,default:null},required:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},rows:{type:Number,default:3},maxrows:{type:Number,default:0},autoresize:{type:Boolean,default:!1},autofocus:{type:Boolean,default:!1},autofocusDelay:{type:Number,default:100},resize:{type:Boolean,default:!1},padded:{type:Boolean,default:!0},size:{type:String,default:null,validator(e){return Object.keys(ze.size).includes(e)}},color:{type:String,default:()=>ze.default.color,validator(e){return[...Me.ui.colors,...Object.keys(ze.color)].includes(e)}},variant:{type:String,default:()=>ze.default.variant,validator(e){return[...Object.keys(ze.variant),...Object.values(ze.color).flatMap(l=>Object.keys(l))].includes(e)}},textareaClass:{type:String,default:null},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})},modelModifiers:{type:Object,default:()=>({})}},emits:["update:modelValue","blur","change"],setup(e,{emit:l}){const{ui:n,attrs:o}=pt("textarea",Be(e,"ui"),ze,Be(e,"class")),{emitFormBlur:i,emitFormInput:a,inputId:s,color:r,size:m,name:k}=Kt(e,ze),w=S($t({},e.modelModifiers,{trim:!1,lazy:!1,number:!1,nullify:!1})),g=S(null),P=()=>{var v;e.autofocus&&((v=g.value)==null||v.focus())},j=()=>{if(e.autoresize){if(!g.value)return;g.value.rows=e.rows;const v=g.value.style.overflow;g.value.style.overflow="hidden";const y=window.getComputedStyle(g.value),V=Number.parseInt(y.paddingTop),_=Number.parseInt(y.paddingBottom),p=V+_,W=Number.parseInt(y.lineHeight),{scrollHeight:M}=g.value,x=(M-p)/W;x>e.rows&&(g.value.rows=e.maxrows?Math.min(x,e.maxrows):x),g.value.style.overflow=v}},I=v=>{w.value.trim&&(v=v.trim()),w.value.number&&(v=gl(v)),w.value.nullify&&(v||(v=null)),l("update:modelValue",v),a()},z=v=>{j(),w.value.lazy||I(v.target.value)},N=v=>{const y=v.target.value;l("change",y),w.value.lazy&&I(y),w.value.trim&&(v.target.value=y.trim())},C=v=>{l("blur",v),i()};ge(()=>{setTimeout(()=>{P()},e.autofocusDelay)}),pe(()=>e.modelValue,()=>{bt(j)}),ge(()=>{setTimeout(()=>{P(),j()},100)});const c=B(()=>{var y,V;const v=((V=(y=n.value.color)==null?void 0:y[r.value])==null?void 0:V[e.variant])||n.value.variant[e.variant];return ct(De(n.value.base,n.value.form,n.value.rounded,n.value.placeholder,n.value.size[m.value],e.padded?n.value.padding[m.value]:"p-0",v==null?void 0:v.replaceAll("{color}",r.value),!e.resize&&"resize-none"),e.textareaClass)});return{ui:n,attrs:o,name:k,inputId:s,textarea:g,textareaClass:c,onInput:z,onChange:N,onBlur:C}}}),ln=["id","value","name","rows","required","disabled","placeholder"];function nn(e,l,n,o,i,a){return u(),O("div",{class:le(e.ui.wrapper)},[b("textarea",Te({id:e.inputId,ref:"textarea",value:e.modelValue,name:e.name,rows:e.rows,required:e.required,disabled:e.disabled,placeholder:e.placeholder,class:e.textareaClass},e.attrs,{onInput:l[0]||(l[0]=(...s)=>e.onInput&&e.onInput(...s)),onBlur:l[1]||(l[1]=(...s)=>e.onBlur&&e.onBlur(...s)),onChange:l[2]||(l[2]=(...s)=>e.onChange&&e.onChange(...s))}),null,16,ln),Fe(e.$slots,"default")],2)}const Ft=ft(tn,[["render",nn]]);async function an(e,l){return await on(l).catch(o=>(console.error("Failed to get image meta for "+l,o+""),{width:0,height:0,ratio:0}))}async function on(e){if(typeof Image>"u")throw new TypeError("Image not supported");return new Promise((l,n)=>{const o=new Image;o.onload=()=>{const i={width:o.width,height:o.height,ratio:o.width/o.height};l(i)},o.onerror=i=>n(i),o.src=e})}function jt(e){return l=>l?e[l]||l:e.missingValue}function sn({formatter:e,keyMap:l,joinWith:n="/",valueMap:o}={}){e||(e=(a,s)=>`${a}=${s}`),l&&typeof l!="function"&&(l=jt(l));const i=o||{};return Object.keys(i).forEach(a=>{typeof i[a]!="function"&&(i[a]=jt(i[a]))}),(a={})=>Object.entries(a).filter(([r,m])=>typeof m<"u").map(([r,m])=>{const k=i[r];return typeof k=="function"&&(m=k(a[r])),r=typeof l=="function"?l(r):r,e(r,m)}).join(n)}function Pe(e=""){if(typeof e=="number")return e;if(typeof e=="string"&&e.replace("px","").match(/^\d+$/g))return Number.parseInt(e,10)}function rn(e=""){if(e===void 0||!e.length)return[];const l=new Set;for(const n of e.split(" ")){const o=Number.parseInt(n.replace("x",""));o&&l.add(o)}return Array.from(l)}function un(e){if(e.length===0)throw new Error("`densities` must not be empty, configure to `1` to render regular size only (DPR 1.0)")}function dn(e){const l={};if(typeof e=="string")for(const n of e.split(/[\s,]+/).filter(o=>o)){const o=n.split(":");o.length!==2?l["1px"]=o[0].trim():l[o[0].trim()]=o[1].trim()}else Object.assign(l,e);return l}function cn(e){const l={options:e},n=(i,a={})=>el(l,i,a),o=(i,a={},s={})=>n(i,{...s,modifiers:$t(a,s.modifiers||{})}).url;for(const i in e.presets)o[i]=(a,s,r)=>o(a,s,{...e.presets[i],...r});return o.options=e,o.getImage=n,o.getMeta=(i,a)=>mn(l,i,a),o.getSizes=(i,a)=>vn(l,i,a),l.$img=o,o}async function mn(e,l,n){const o=el(e,l,{...n});return typeof o.getMeta=="function"?await o.getMeta():await an(e,o.url)}function el(e,l,n){var k,w;if(l&&typeof l!="string")throw new TypeError(`input must be a string (received ${typeof l}: ${JSON.stringify(l)})`);if(!l||l.startsWith("data:"))return{url:l};const{provider:o,defaults:i}=fn(e,n.provider||e.options.provider),a=pn(e,n.preset);if(l=Tt(l)?l:wl(l),!o.supportsAlias){for(const g in e.options.alias)if(l.startsWith(g)){const P=e.options.alias[g];P&&(l=kt(P,l.slice(g.length)))}}if(o.validateDomains&&Tt(l)){const g=yl(l).host;if(!e.options.domains.find(P=>P===g))return{url:l}}const s=$t(n,a,i);s.modifiers={...s.modifiers};const r=s.modifiers.format;(k=s.modifiers)!=null&&k.width&&(s.modifiers.width=Pe(s.modifiers.width)),(w=s.modifiers)!=null&&w.height&&(s.modifiers.height=Pe(s.modifiers.height));const m=o.getImage(l,s,e);return m.format=m.format||r||"",m}function fn(e,l){const n=e.options.providers[l];if(!n)throw new Error("Unknown provider: "+l);return n}function pn(e,l){if(!l)return{};if(!e.options.presets[l])throw new Error("Unknown preset: "+l);return e.options.presets[l]}function vn(e,l,n){var I,z,N,C,c;const o=Pe((I=n.modifiers)==null?void 0:I.width),i=Pe((z=n.modifiers)==null?void 0:z.height),a=dn(n.sizes),s=(N=n.densities)!=null&&N.trim()?rn(n.densities.trim()):e.options.densities;un(s);const r=o&&i?i/o:0,m=[],k=[];if(Object.keys(a).length>=1){for(const v in a){const y=Nt(v,String(a[v]),i,r,e);if(y!==void 0){m.push({size:y.size,screenMaxWidth:y.screenMaxWidth,media:`(max-width: ${y.screenMaxWidth}px)`});for(const V of s)k.push({width:y._cWidth*V,src:Bt(e,l,n,y,V)})}}gn(m)}else for(const v of s){const y=Object.keys(a)[0];let V=y?Nt(y,String(a[y]),i,r,e):void 0;V===void 0&&(V={size:"",screenMaxWidth:0,_cWidth:(C=n.modifiers)==null?void 0:C.width,_cHeight:(c=n.modifiers)==null?void 0:c.height}),k.push({width:v,src:Bt(e,l,n,V,v)})}wn(k);const w=k[k.length-1],g=m.length?m.map(v=>`${v.media?v.media+" ":""}${v.size}`).join(", "):void 0,P=g?"w":"x",j=k.map(v=>`${v.src} ${v.width}${P}`).join(", ");return{sizes:g,srcset:j,src:w==null?void 0:w.src}}function Nt(e,l,n,o,i){const a=i.options.screens&&i.options.screens[e]||Number.parseInt(e),s=l.endsWith("vw");if(!s&&/^\d+$/.test(l)&&(l=l+"px"),!s&&!l.endsWith("px"))return;let r=Number.parseInt(l);if(!a||!r)return;s&&(r=Math.round(r/100*a));const m=o?Math.round(r*o):n;return{size:l,screenMaxWidth:a,_cWidth:r,_cHeight:m}}function Bt(e,l,n,o,i){return e.$img(l,{...n.modifiers,width:o._cWidth?o._cWidth*i:void 0,height:o._cHeight?o._cHeight*i:void 0},n)}function gn(e){var n;e.sort((o,i)=>o.screenMaxWidth-i.screenMaxWidth);let l=null;for(let o=e.length-1;o>=0;o--){const i=e[o];i.media===l&&e.splice(o,1),l=i.media}for(let o=0;o<e.length;o++)e[o].media=((n=e[o+1])==null?void 0:n.media)||""}function wn(e){e.sort((n,o)=>n.width-o.width);let l=null;for(let n=e.length-1;n>=0;n--){const o=e[n];o.width===l&&e.splice(n,1),l=o.width}}const yn=sn({keyMap:{format:"f",fit:"fit",width:"w",height:"h",resize:"s",quality:"q",background:"b"},joinWith:"&",formatter:(e,l)=>Ot(e)+"_"+Ot(l)}),hn=(e,{modifiers:l={},baseURL:n}={},o)=>{l.width&&l.height&&(l.resize=`${l.width}x${l.height}`,delete l.width,delete l.height);const i=yn(l)||"_";return n||(n=kt(o.options.nuxt.baseURL,"/_ipx")),{url:kt(n,i,hl(e))}},bn=!0,kn=!0,xn=Object.freeze(Object.defineProperty({__proto__:null,getImage:hn,supportsAlias:kn,validateDomains:bn},Symbol.toStringTag,{value:"Module"})),tl={screens:{xs:320,sm:640,md:768,lg:1024,xl:1280,xxl:1536,"2xl":1536},presets:{},provider:"ipxStatic",domains:[],alias:{},densities:[1,2],format:["webp"]};tl.providers={ipxStatic:{provider:xn,defaults:{}}};const Ut=()=>{const e=qt(),l=Ye();return l.$img||l._img||(l._img=cn({...tl,nuxt:{baseURL:e.app.baseURL},runtimeConfig:e}))};function _n(e){var l;(l=performance==null?void 0:performance.mark)==null||l.call(performance,"mark_feature_usage",{detail:{feature:e}})}const $n={src:{type:String,required:!1},format:{type:String,required:!1},quality:{type:[Number,String],required:!1},background:{type:String,required:!1},fit:{type:String,required:!1},modifiers:{type:Object,required:!1},preset:{type:String,required:!1},provider:{type:String,required:!1},sizes:{type:[Object,String],required:!1},densities:{type:String,required:!1},preload:{type:[Boolean,Object],required:!1},width:{type:[String,Number],required:!1},height:{type:[String,Number],required:!1},alt:{type:String,required:!1},referrerpolicy:{type:String,required:!1},usemap:{type:String,required:!1},longdesc:{type:String,required:!1},ismap:{type:Boolean,required:!1},loading:{type:String,required:!1,validator:e=>["lazy","eager"].includes(e)},crossorigin:{type:[Boolean,String],required:!1,validator:e=>["anonymous","use-credentials","",!0,!1].includes(e)},decoding:{type:String,required:!1,validator:e=>["async","auto","sync"].includes(e)},nonce:{type:[String],required:!1}},Cn=e=>{const l=B(()=>({provider:e.provider,preset:e.preset})),n=B(()=>({width:Pe(e.width),height:Pe(e.height),alt:e.alt,referrerpolicy:e.referrerpolicy,usemap:e.usemap,longdesc:e.longdesc,ismap:e.ismap,crossorigin:e.crossorigin===!0?"anonymous":e.crossorigin||void 0,loading:e.loading,decoding:e.decoding,nonce:e.nonce})),o=Ut(),i=B(()=>({...e.modifiers,width:Pe(e.width),height:Pe(e.height),format:e.format,quality:e.quality||o.options.quality,background:e.background,fit:e.fit}));return{options:l,attrs:n,modifiers:i}},In={...$n,placeholder:{type:[Boolean,String,Number,Array],required:!1},placeholderClass:{type:String,required:!1},custom:{type:Boolean,required:!1}},Sn=["src"],Ve=Z({__name:"NuxtImg",props:In,emits:["load","error"],setup(e,{emit:l}){const n=e,o=bl(),i=l,a=!1,s=Ut(),r=Cn(n),m=S(!1),k=S(),w=B(()=>s.getSizes(n.src,{...r.options.value,sizes:n.sizes,densities:n.densities,modifiers:{...r.modifiers.value,width:Pe(n.width),height:Pe(n.height)}})),g=B(()=>{const C={...r.attrs.value,"data-nuxt-img":""};return(!n.placeholder||m.value)&&(C.sizes=w.value.sizes,C.srcset=w.value.srcset),C}),P=B(()=>{let C=n.placeholder;if(C===""&&(C=!0),!C||m.value)return!1;if(typeof C=="string")return C;const c=Array.isArray(C)?C:typeof C=="number"?[C,C]:[10,10];return s(n.src,{...r.modifiers.value,width:c[0],height:c[1],quality:c[2]||50,blur:c[3]||3},r.options.value)}),j=B(()=>n.sizes?w.value.src:s(n.src,r.modifiers.value,r.options.value)),I=B(()=>P.value?P.value:j.value),N=Ye().isHydrating;return ge(()=>{if(P.value||n.custom){const C=new Image;j.value&&(C.src=j.value),n.sizes&&(C.sizes=w.value.sizes||"",C.srcset=w.value.srcset),C.onload=c=>{m.value=!0,i("load",c)},C.onerror=c=>{i("error",c)},_n("nuxt-image");return}k.value&&(k.value.complete&&N&&(k.value.getAttribute("data-error")?i("error",new Event("error")):i("load",new Event("load"))),k.value.onload=C=>{i("load",C)},k.value.onerror=C=>{i("error",C)})}),(C,c)=>C.custom?Fe(C.$slots,"default",kl(Te({key:1},{...t(a)?{onerror:"this.setAttribute('data-error', 1)"}:{},imgAttrs:{...g.value,...t(o)},isLoaded:m.value,src:I.value}))):(u(),O("img",Te({key:0,ref_key:"imgEl",ref:k,class:P.value&&!m.value?C.placeholderClass:void 0},{...t(a)?{onerror:"this.setAttribute('data-error', 1)"}:{},...g.value,...t(o)},{src:I.value}),null,16,Sn))}}),rt=mt(Me.ui.strategy,Me.ui.range,Wl),Pn=Z({inheritAttrs:!1,props:{modelValue:{type:Number,default:0},id:{type:String,default:null},name:{type:String,default:null},disabled:{type:Boolean,default:!1},min:{type:Number,default:0},max:{type:Number,default:100},step:{type:Number,default:1},size:{type:String,default:null,validator(e){return Object.keys(rt.size).includes(e)}},color:{type:String,default:()=>rt.default.color,validator(e){return Me.ui.colors.includes(e)}},inputClass:{type:String,default:null},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})}},emits:["update:modelValue","change"],setup(e,{emit:l}){const{ui:n,attrs:o}=pt("range",Be(e,"ui"),rt),{emitFormChange:i,inputId:a,color:s,size:r,name:m}=Kt(e,rt),k=B({get(){return e.modelValue},set(C){l("update:modelValue",C)}}),w=C=>{l("change",C.target.value),i()},g=B(()=>ct(De(n.value.wrapper,n.value.size[r.value]),e.class)),P=B(()=>ct(De(n.value.base,n.value.background,n.value.rounded,s.value&&n.value.ring.replaceAll("{color}",s.value),n.value.size[r.value]),e.inputClass)),j=B(()=>De(n.value.thumb.base,s.value&&n.value.thumb.color.replaceAll("{color}",s.value),n.value.thumb.ring,n.value.thumb.background,n.value.thumb.size[r.value])),I=B(()=>De(n.value.track.base,n.value.track.background,n.value.track.rounded,n.value.track.size[r.value])),z=B(()=>De(n.value.progress.base,n.value.progress.rounded,s.value&&n.value.progress.background.replaceAll("{color}",s.value),n.value.progress.size[r.value])),N=B(()=>{const{modelValue:C,min:c,max:v}=e;return{width:`${(Math.max(c,Math.min(C,v))-c)/(v-c)*100}%`}});return{ui:n,attrs:o,name:m,inputId:a,value:k,wrapperClass:g,inputClass:P,thumbClass:j,trackClass:I,progressClass:z,progressStyle:N,onChange:w}}}),Mn=["id","name","min","max","disabled","step"];function Rn(e,l,n,o,i,a){return u(),O("div",{class:le(e.wrapperClass)},[Ct(b("input",Te({id:e.inputId,ref:"input","onUpdate:modelValue":l[0]||(l[0]=s=>e.value=s),name:e.name,min:e.min,max:e.max,disabled:e.disabled,step:e.step,type:"range",class:[e.inputClass,e.thumbClass,e.trackClass]},e.attrs,{onChange:l[1]||(l[1]=(...s)=>e.onChange&&e.onChange(...s))}),null,16,Mn),[[xl,e.value,void 0,{number:!0}]]),b("span",{class:le(e.progressClass),style:Ze(e.progressStyle)},null,6)],2)}const Vt=ft(Pn,[["render",Rn]]),Fn={class:"image-mask flex flex-col w-full"},Un={class:"canvas flex flex-col items-center justify-center mb-3 w-full"},Vn={class:"preview-over-original relative"},zn={class:"actions flex items-center justify-center mb-3 mx-auto"},Tn={class:"options w-full max-w-[320px]"},On=Z({__name:"ImageInpaint",props:He({imageSrc:{type:String,required:!0}},{imageInpaintMask:{default:"",type:String},imageInpaintMaskModifiers:{},imageInpaintMaskData:{default:{},type:Object},imageInpaintMaskDataModifiers:{}}),emits:["update:imageInpaintMask","update:imageInpaintMaskData"],setup(e){const l=e,n=Le(e,"imageInpaintMask"),o=Le(e,"imageInpaintMaskData"),i=we(),a=S(null),s=S(null),r=S(null),m=S(null),k=S(30),w=S([]),g=S({width:i.$state.outputMaxSize,height:i.$state.outputMaxSize}),P=S(null),j=S({x:0,y:0}),I=S({x:0,y:0,radius:k.value,fill:"rgba(255, 255, 255, 0.5)",stroke:null,strokeWidth:0,visible:!1}),z=S(5),N=S(!1),C=S([]),c=S([]);function v(){if(!a.value||!r.value){console.error("Could not get stage, image layer, or mask layer");return}const E=a.value.getNode(),T=m.value?m.value.width:E.width(),U=m.value?m.value.height:E.height(),L=document.createElement("canvas");L.width=T,L.height=U;const G=L.getContext("2d");if(!G){console.error("Could not get 2d context for mask canvas");return}G.fillStyle="black",G.fillRect(0,0,T,U);const A=T/E.width(),q=U/E.height();G.fillStyle="white",w.value.forEach(ce=>{G.beginPath(),G.arc(ce.x*A,ce.y*q,ce.radius*Math.max(A,q),0,Math.PI*2,!0),G.closePath(),G.fill()});const ee=L.toDataURL("image/png",1);ee?(x(),n.value=ee,I.value.visible=!1,N.value=!1):console.error("Could not get data URI for masked image")}function y(E){const T=a.value.getNode();if(E.type.startsWith("touch")){const U=E.evt.touches[0]||E.evt.changedTouches[0];return{x:U.clientX-T.getContainer().offsetLeft,y:U.clientY-T.getContainer().offsetTop}}return T.getPointerPosition()}function V(E){E.type==="mousedown"&&E.evt.button!==0||(N.value=!0,j.value=y(E),M(),_(j.value))}function _(E){const T={x:E.x,y:E.y,radius:k.value,fill:"rgba(255, 255, 255, 1)"};w.value=w.value.filter(U=>!(p({x:U.x,y:U.y},E)+U.radius<=T.radius)),w.value.push(T)}function p(E,T){return Math.sqrt(Math.pow(T.x-E.x,2)+Math.pow(T.y-E.y,2))}function W(E){if(E.type.startsWith("touch")&&E.evt.preventDefault(),be(E),!N.value)return;const T=y(E);p(j.value,y(E))>=z.value&&(_(T),j.value=T)}function M(){C.value.push([...w.value]),c.value=[]}function x(){o.value={circles:[...w.value],brushRadius:k.value,undoStack:C.value,redoStack:c.value}}function d(){o.value!==null&&(w.value=o.value.circles||[],k.value=o.value.brushRadius||30,C.value=o.value.undoStack||[],c.value=o.value.redoStack||[])}function R(){C.value.length!==0&&(c.value.push([...w.value]),w.value=C.value.pop()||[])}function H(){c.value.length!==0&&(C.value.push([...w.value]),w.value=c.value.pop()||[])}function J(){N.value=!1}function oe(){n.value=""}function se(){M(),w.value=[],n.value=""}const ae=B(()=>C.value.length>0),Y=B(()=>c.value.length>0);function be(E){const T=y(E);I.value.x=T.x,I.value.y=T.y}function ie(){I.value.visible=!1,N.value=!1}function Re(){I.value.visible=!0,I.value.radius=k.value}function $e(){const E=new Image;E.src=l.imageSrc,E.onload=()=>{m.value=E,ue(),ne()}}function ue(){if(!m.value)return;const E=window.innerWidth,T=window.innerHeight,U=m.value.width/m.value.height;let L,G;const A=Math.min(E*.9,1200),q=Math.min(T*.8,i.outputMaxSize);U>A/q?(L=A,G=L/U):(G=q,L=G*U),g.value={width:Math.floor(L),height:Math.floor(G)},ne()}function ne(){const E=g.value.width,T=g.value.height,U=m.value.width,L=m.value.height,G=E/U,A=T/L,q=Math.min(G,A);P.value={x:0,y:0,width:U*q,height:L*q}}return It(()=>{$e(),d()}),ge(()=>{if(a.value){const E=a.value.getNode();E.on("touchstart",V),E.on("touchmove",W),E.on("touchend",J),E.on("touchcancel",ie)}}),St(()=>{if(a.value){const E=a.value.getNode();E.off("touchstart"),E.off("touchmove"),E.off("touchend"),E.off("touchcancel")}x()}),(E,T)=>{const U=Ve,L=Se("v-image"),G=Se("v-layer"),A=Se("v-circle"),q=Se("v-stage"),ee=de,ce=Vt,he=je;return u(),O("div",Fn,[b("div",Un,[T[1]||(T[1]=b("p",{class:"text-sm my-2 text-slate-500"},"Select the target area for image inpaint",-1)),b("div",Vn,[e.imageSrc&&e.imageSrc!==""&&n.value!==""?(u(),$(U,{key:0,src:e.imageSrc,fit:"inside",width:t(g).width,height:t(g).height,draggable:"false",class:le({absolute:n.value!==""})},null,8,["src","width","height","class"])):F("",!0),n.value?(u(),$(U,{key:1,src:n.value,fit:"inside",width:t(g).width,height:t(g).height,draggable:"false",class:"opacity-50"},null,8,["src","width","height"])):F("",!0)]),n.value===""?(u(),$(q,{key:0,ref_key:"stageRef",ref:a,config:t(g),onMousedown:V,onMousemove:W,onMouseup:J,onMouseleave:ie,onMouseenter:Re},{default:h(()=>[f(G,{ref_key:"imageLayerRef",ref:s},{default:h(()=>[f(L,{image:t(m),config:t(g)},null,8,["image","config"])]),_:1},512),f(G,{ref_key:"maskLayerRef",ref:r},{default:h(()=>[(u(!0),O(te,null,ve(t(w),(_e,Ae)=>(u(),$(A,{key:Ae,config:_e},null,8,["config"]))),128)),t(I).visible?(u(),$(A,{key:0,config:t(I)},null,8,["config"])):F("",!0)]),_:1},512)]),_:1},8,["config"])):F("",!0)]),b("div",zn,[f(ee,{class:"mr-2",size:"xs",icon:"i-heroicons-clipboard-document-check-16-solid",variant:"soft",disabled:t(w).length===0||n.value!=="",onClick:v},{default:h(()=>T[2]||(T[2]=[X(" Apply ")])),_:1,__:[2]},8,["disabled"]),f(ee,{class:"mr-2",size:"xs",icon:"i-heroicons-arrow-uturn-left-16-solid",variant:"soft",color:"cyan",disabled:!t(ae)||n.value!=="",onClick:R},null,8,["disabled"]),f(ee,{class:"mr-2",size:"xs",icon:"i-heroicons-arrow-uturn-right-16-solid",variant:"soft",color:"cyan",disabled:!t(Y)||n.value!=="",onClick:H},null,8,["disabled"]),f(ee,{class:"mr-2",size:"xs",icon:"i-heroicons-arrow-turn-up-left-20-solid",variant:"soft",disabled:t(w).length===0&&n.value==="",color:"red",onClick:se},{default:h(()=>T[3]||(T[3]=[X(" Reset ")])),_:1,__:[3]},8,["disabled"]),f(ee,{size:"xs",icon:"i-heroicons-pencil-solid",variant:"soft",disabled:n.value==="",color:"orange",onClick:oe},{default:h(()=>T[4]||(T[4]=[X(" Edit ")])),_:1,__:[4]},8,["disabled"])]),b("div",Tn,[f(he,{class:"mb-3 text-sm",hint:`value: ${t(k)}`,label:"Brush radius"},{default:h(()=>[f(ce,{modelValue:t(k),"onUpdate:modelValue":T[0]||(T[0]=_e=>K(k)?k.value=_e:null),min:1,max:100,size:"sm",class:"my-2",disabled:n.value!==""},null,8,["modelValue","disabled"])]),_:1},8,["hint"])])])}}});function Ge(e={}){const{copy:l,isSupported:n}=_l(),o=ke();function i(a,s={},r={}){n&&l(a).then(()=>{!s.title&&!s.description||o.add({...s,...e})},function(m){o.add({...r,description:r.description||m.message,...e})})}return{copy:i}}const jn="0.05";function Nn(e,l){const n=parseFloat(e);if(isNaN(n))return e;const o=n+l;return o<0?"0":String(Number(o.toFixed(10)))}function Bn(e,l){let n=l,o=l,i=0,a=0;for(;n>=0&&(n--,!(e[n]==="("&&i===a));)e[n]==="("&&i++,e[n]===")"&&a++;if(n<0)return!1;for(i=0,a=0;o<e.length&&!(e[o]===")"&&i===a);)e[o]==="("&&i++,e[o]===")"&&a++,o++;return o===e.length?!1:{start:n+1,end:o}}function Ln(e){const l=/^\((.*)\)$/,n=e.match(l),o=/:([+-]?(\d*\.)?\d+([eE][+-]?\d+)?)/,i=e.match(o);return n&&!i?`(${n[1]}:1.0)`:e}function ll(e){const l=e.composedPath()[0],n=parseFloat(jn);if(l.tagName!=="TEXTAREA"||!(e.key==="ArrowUp"||e.key==="ArrowDown")||!e.ctrlKey&&!e.metaKey)return;e.preventDefault();let o=l.selectionStart,i=l.selectionEnd,a=l.value.substring(o,i);if(!a){const m=Bn(l.value,o);if(m)o=m.start,i=m.end,a=l.value.substring(o,i);else{const k=" .,\\/!?%^*;:{}=-_`~()\r\n	";for(;!k.includes(l.value[o-1])&&o>0;)o--;for(;!k.includes(l.value[i])&&i<l.value.length;)i++;if(a=l.value.substring(o,i),!a)return}}a[a.length-1]===" "&&(a=a.substring(0,a.length-1),i-=1),l.value[o-1]==="("&&l.value[i]===")"&&(o-=1,i+=1,a=l.value.substring(o,i)),(a[0]!=="("||a[a.length-1]!==")")&&(a=`(${a})`),a=Ln(a);const s=e.key==="ArrowUp"?n:-n,r=a.replace(/\((.*):(\d+(?:\.\d+)?)\)/,(m,k,w)=>(w=Nn(w,s),Number(w)==1?k:`(${k}:${w})`));return l.setRangeText(r,o,i,"select"),l.value}const An={key:0,class:"text-red-300"},qn={class:"flex items-center"},En={class:"p-2 max-w-48 max-h-48 not-italic"},Dn={class:"block font-medium text-gray-700 dark:text-gray-200"},Wn={key:0,class:"flex w-full items-center justify-between"},Hn={class:"flex items-center"},Gn={key:2,class:"flex flex-row flex-grow items-center justify-between"},Xn={key:3,class:"flex flex-row flex-grow items-center"},Jn={class:"sm:inline"},Qn={class:"preview-over-original relative"},Kn={key:1,class:"text-red-300 text-sm"},Yn=Z({__name:"InputParam",props:{inputParam:{type:Object,required:!0},index:{type:Number,required:!0},inputParamsMap:{type:Array,required:!0},advanced:{type:Boolean,default:!1}},setup(e){const l=e,n=qt(),o=$l(),i=B(()=>o.selectedFiles[l.inputParam.name]?o.selectedFiles[l.inputParam.name]:null),a=B(()=>{var x;return i.value?`${window.location.origin}/index.php/core/preview?fileId=${(x=i.value)==null?void 0:x.id}&mimeFallback=true&a=1`:""}),s=B(()=>i.value?i.value.source:"");pe(i,M=>{M?(l.inputParamsMap[l.index][l.inputParam.name].value=M,l.inputParamsMap[l.index][l.inputParam.name].image_preview_url=s.value,l.inputParamsMap[l.index][l.inputParam.name].nc_file=!0):(l.inputParamsMap[l.index][l.inputParam.name].value=null,l.inputParamsMap[l.index][l.inputParam.name].image_preview_url="",l.inputParamsMap[l.index][l.inputParam.name].nc_file=!1)});const r=S(!1),m=S(null),k=S(""),w=S({width:0,height:0}),g=S(""),P=S({}),j=S(null),I=l.inputParamsMap[l.index][l.inputParam.name].source_input_name??"",z=l.inputParamsMap.findIndex(M=>{if(Object.keys(M)[0]===l.inputParamsMap[l.index][l.inputParam.name].source_input_name)return!0});function N(){try{const M=l.inputParamsMap.find(x=>{const d=Object.keys(x)[0];if(d===I)return x[d]});V(M[I].value)}catch{w.value.width=0,w.value.height=0}}ge(()=>{l.inputParam.type==="range_scale"&&N(),l.inputParam.type==="image-mask"&&pe(g,M=>{const x=new File([g.value],`image-mask-${l.inputParam.name}.png`,{type:"image/png"});l.inputParamsMap[l.index][l.inputParam.name].value=x,l.inputParamsMap[l.index][l.inputParam.name].mask_applied=M!==""})}),l.inputParam.type==="range_scale"&&pe(l.inputParamsMap,()=>{N()});function C(M){return M?URL.createObjectURL(M):""}function c(){URL.revokeObjectURL(k.value),k.value="",m.value&&(m.value.$refs.input.value=""),l.inputParamsMap[l.index][l.inputParam.name].value=null,l.inputParamsMap[l.index][l.inputParam.name].image_preview_url=""}function v(){URL.revokeObjectURL(g.value),g.value="",P.value={},l.inputParamsMap[l.index][l.inputParam.name].value=null,l.inputParamsMap[l.index][l.inputParam.name].mask_applied=!1}const y=B(()=>l.inputParam.type!=="bool"?l.inputParam.display_name:"");function V(M){if(!(M instanceof File)){w.value.width=0,w.value.height=0;return}const x=URL.createObjectURL(M),d=new Image;d.onload=function(){w.value.width=d.naturalWidth,w.value.height=d.naturalHeight,URL.revokeObjectURL(d.src)},d.src=x}const _=B(()=>{if(l.inputParam.type==="range_scale"){const M=l.inputParamsMap[l.index][l.inputParam.name].value;return`value: ${M}x (${w.value.width}x${w.value.height} -> ${(w.value.width*M).toFixed(0)}x${(w.value.height*M).toFixed(0)})`}return["range","range_scale"].includes(l.inputParam.type)?`value: ${l.inputParamsMap[l.index][l.inputParam.name].value}`:""}),p=S(null);function W(M){const x=ll(M);x&&(l.inputParamsMap[l.index][l.inputParam.name].value=x)}return ge(()=>{l.inputParam.type==="text"&&p.value&&p.value.$refs.textarea.addEventListener("keydown",W),l.inputParam.type==="image-mask"&&(j.value=l.inputParamsMap[z][I],pe(l.inputParamsMap[z][I],M=>{g.value="",P.value={},j.value=M}))}),St(()=>{URL.revokeObjectURL(k.value),URL.revokeObjectURL(g.value),o.removeSelectedFile(l.inputParam.name),l.inputParam.type==="text"&&p.value&&p.value.$refs.textarea.removeEventListener("keydown",W)}),(M,x)=>{var ne,E;const d=de,R=Xe,H=Pt,J=Ft,oe=Oe,se=Qe,ae=Nl,Y=Ve,be=On,ie=Ue,Re=lt,$e=Vt,ue=je;return(((ne=e.inputParam)==null?void 0:ne.advanced)||!1)===e.advanced?(u(),$(ue,{key:0,class:le(["mb-3",{italic:(E=e.inputParam)==null?void 0:E.dynamic_lora}]),help:t(_)},{hint:h(()=>[e.inputParam.optional?F("",!0):(u(),O("span",An,"required"))]),label:h(()=>{var T;return[b("div",qn,[(T=e.inputParam)!=null&&T.dynamic_lora&&e.inputParam.trigger_words.length>0?(u(),$(H,{key:0},{panel:h(()=>[b("div",En,[x[21]||(x[21]=b("h4",{class:"mb-2 text-center"},"Trigger words",-1)),(u(!0),O(te,null,ve(e.inputParam.trigger_words,U=>(u(),$(R,{key:U,color:"violet",class:"mr-1 cursor-pointer",onClick:()=>{("useCopyToClipboard"in M?M.useCopyToClipboard:t(Ge))().copy(U),("useToast"in M?M.useToast:t(ke))().add({title:"Clipboard",description:"Trigger word copied to clipboard",timeout:2e3})}},{default:h(()=>[X(Q(U),1)]),_:2},1032,["onClick"]))),128))])]),default:h(()=>[f(d,{icon:"i-heroicons-information-circle",variant:"ghost",size:"xs",color:"gray",class:"mr-2"})]),_:1})):F("",!0),b("label",Dn,Q(t(y)),1)])]}),default:h(()=>{var T,U,L,G,A;return[e.inputParam.type==="text"?(u(),$(J,{key:0,ref_key:"textareaInput",ref:p,size:"md",placeholder:e.inputParam.display_name,required:!e.inputParam.optional,resize:!0,label:e.inputParam.display_name,value:e.inputParamsMap[e.index][e.inputParam.name].value,autoresize:"",variant:"outline",onInput:x[0]||(x[0]=q=>{const ee=q.target;e.inputParamsMap[e.index][e.inputParam.name].value=ee.value})},null,8,["placeholder","required","label","value"])):F("",!0),e.inputParam.type==="number"?(u(),O(te,{key:1},[e.inputParam.name==="seed"?(u(),O("div",Wn,[b("div",Hn,[e.inputParam.type==="number"?(u(),$(oe,{key:0,modelValue:e.inputParamsMap[e.index][e.inputParam.name].value,"onUpdate:modelValue":x[1]||(x[1]=q=>e.inputParamsMap[e.index][e.inputParam.name].value=q),type:"number",label:e.inputParam.display_name,required:!e.inputParam.optional,max:e.inputParam.max||100,min:e.inputParam.min||0,variant:"outline"},null,8,["modelValue","label","required","max","min"])):F("",!0),f(d,{icon:"i-heroicons-arrow-path",color:"violet",variant:"outline",size:"xs",class:"ml-2",onClick:x[2]||(x[2]=()=>{e.inputParamsMap[e.index][e.inputParam.name].value=Math.floor(Math.random()*1e7)})})]),f(se,{modelValue:e.inputParamsMap[e.index][e.inputParam.name].auto_increment,"onUpdate:modelValue":x[3]||(x[3]=q=>e.inputParamsMap[e.index][e.inputParam.name].auto_increment=q),label:"Auto-increment seed"},null,8,["modelValue"])])):(u(),$(oe,{key:1,modelValue:e.inputParamsMap[e.index][e.inputParam.name].value,"onUpdate:modelValue":x[4]||(x[4]=q=>e.inputParamsMap[e.index][e.inputParam.name].value=q),type:"number",label:e.inputParam.display_name,required:!e.inputParam.optional,max:e.inputParam.max||100,min:e.inputParam.min||0,variant:"outline"},null,8,["modelValue","label","required","max","min"]))],64)):F("",!0),e.inputParam.type==="image"?(u(),O("div",Gn,[f(oe,{ref_key:"imageInput",ref:m,type:"file",accept:"image/*",class:"w-full",variant:"outline",color:"gray",disabled:t(i)!==null,label:e.inputParam.display_name,onChange:x[5]||(x[5]=q=>{console.debug("files",q);const ee=q==null?void 0:q[0];e.inputParamsMap[e.index][e.inputParam.name].value=ee,k.value=C(ee),e.inputParamsMap[e.index][e.inputParam.name].image_preview_url=t(k),t(i)!==null&&t(o).removeSelectedFile(e.inputParam.name),console.debug("inputParamsMap",e.inputParamsMap)})},null,8,["disabled","label"]),t(n).app.isNextcloudIntegration?(u(),$(ae,{key:0,class:"mx-2",orientation:"vertical",label:"OR"})):F("",!0),t(n).app.isNextcloudIntegration?(u(),$(d,{key:1,icon:"i-heroicons-cloud-arrow-down",variant:"outline",color:"blue",disabled:t(i)!==null||t(k)!=="",title:t(i)!==null?t(i).attributes.filename:"Choose from Nextcloud",onClick:x[6]||(x[6]=()=>{t(o).openNextcloudFilePicker(e.inputParam.name)})},{default:h(()=>x[22]||(x[22]=[X(" Choose from Nextcloud ")])),_:1,__:[22]},8,["disabled","title"])):F("",!0),t(a)!==""?(u(),O(te,{key:2},[f(Y,{src:t(a),class:"h-10 rounded-lg cursor-pointer ml-2",onClick:x[7]||(x[7]=()=>{r.value=!0})},null,8,["src"]),f(d,{icon:"i-heroicons-x-mark",variant:"outline",class:"ml-2",onClick:x[8]||(x[8]=()=>{t(o).removeSelectedFile(e.inputParam.name),t(k)!==""&&c()})})],64)):t(k)!==""?(u(),O(te,{key:3},[f(Y,{src:t(g)?t(g):t(k),class:"h-10 rounded-lg cursor-pointer ml-2",onClick:x[9]||(x[9]=()=>{r.value=!0})},null,8,["src"]),f(d,{icon:"i-heroicons-x-mark",variant:"outline",class:"ml-2",onClick:c})],64)):F("",!0)])):F("",!0),e.inputParam.type==="image-mask"?(u(),O("div",Xn,[t(j)?(u(),$(d,{key:0,icon:"i-heroicons-paint-brush-16-solid",class:"mr-2",color:"violet",variant:"outline",size:"xs",disabled:!((T=t(j))!=null&&T.value),onClick:x[10]||(x[10]=()=>{r.value=!0})},{default:h(()=>[b("span",Jn,Q(t(g)!==""?"Edit mask":"Draw mask"),1)]),_:1},8,["disabled"])):F("",!0),b("div",Qn,[t(j)&&((U=t(j))!=null&&U.value)?(u(),$(Y,{key:0,src:(L=t(j))==null?void 0:L.image_preview_url,class:le(["h-10 rounded-lg cursor-pointer",{absolute:t(g)!==""}]),onClick:x[11]||(x[11]=()=>{r.value=!0})},null,8,["src","class"])):F("",!0),t(g)?(u(),$(Y,{key:1,src:t(g),class:"h-10 rounded-lg cursor-pointer opacity-50",onClick:x[12]||(x[12]=()=>{r.value=!0})},null,8,["src"])):F("",!0)]),!t(j)||t(j)&&!((G=t(j))!=null&&G.value)?(u(),O("span",Kn," Select source image ")):F("",!0),t(g)?(u(),$(d,{key:2,icon:"i-heroicons-x-mark",variant:"outline",color:"violet",class:"ml-2",onClick:v})):F("",!0)])):F("",!0),e.inputParam.type==="image"||e.inputParam.type==="image-mask"?(u(),$(ie,{key:4,modelValue:t(r),"onUpdate:modelValue":x[17]||(x[17]=q=>K(r)?r.value=q:null),class:"z-[90] overflow-y-auto",transition:!1,fullscreen:""},{default:h(()=>{var q;return[f(d,{class:"absolute top-4 right-4 z-[100]",icon:"i-heroicons-x-mark",variant:"ghost",onClick:x[13]||(x[13]=()=>r.value=!1)}),e.inputParam.type==="image"?(u(),O("div",{key:0,class:"flex items-center justify-center w-full h-full p-4",onClick:x[14]||(x[14]=vt(()=>r.value=!1,["left"]))},[t(k)!==""?(u(),$(Y,{key:0,class:"lg:h-full",fit:"contain",src:t(k)},null,8,["src"])):F("",!0),t(a)!==""?(u(),$(Y,{key:1,class:"lg:h-full",fit:"inside",src:t(s)},null,8,["src"])):F("",!0)])):(u(),$(be,{key:1,ref:"imageInpaint","image-inpaint-mask":t(g),"onUpdate:imageInpaintMask":x[15]||(x[15]=ee=>K(g)?g.value=ee:null),"image-inpaint-mask-data":t(P),"onUpdate:imageInpaintMaskData":x[16]||(x[16]=ee=>K(P)?P.value=ee:null),class:"flex items-center justify-center w-full h-full p-4","image-src":(q=t(j))==null?void 0:q.image_preview_url},null,8,["image-inpaint-mask","image-inpaint-mask-data","image-src"]))]}),_:1},8,["modelValue"])):F("",!0),e.inputParam.type==="list"?(u(),$(Re,{key:5,modelValue:e.inputParamsMap[e.index][e.inputParam.name].value,"onUpdate:modelValue":x[18]||(x[18]=q=>e.inputParamsMap[e.index][e.inputParam.name].value=q),placeholder:e.inputParam.display_name,options:Object.keys(e.inputParam.options)},null,8,["modelValue","placeholder","options"])):F("",!0),e.inputParam.type==="bool"?(u(),$(se,{key:6,modelValue:e.inputParamsMap[e.index][e.inputParam.name].value,"onUpdate:modelValue":x[19]||(x[19]=q=>e.inputParamsMap[e.index][e.inputParam.name].value=q),label:(A=e.inputParam)==null?void 0:A.display_name},null,8,["modelValue","label"])):F("",!0),["range","range_scale"].includes(e.inputParam.type)?(u(),$($e,{key:7,modelValue:e.inputParamsMap[e.index][e.inputParam.name].value,"onUpdate:modelValue":x[20]||(x[20]=q=>e.inputParamsMap[e.index][e.inputParam.name].value=q),label:e.inputParam.display_name,size:"sm",min:e.inputParam.min,max:e.inputParam.max,step:e.inputParam.step},null,8,["modelValue","label","min","max","step"])):F("",!0)]}),_:1},8,["class","help"])):F("",!0)}}}),Zn={key:0,class:"heading"},ea={key:1},ta={key:0,class:"max-h-96 overflow-y-auto mt-5"},la={class:"heading"},na={key:0,class:"p-4"},aa={key:0,class:"flex items-center w-full max-w-xs"},oa=Z({__name:"InputParams",props:He({inputParamsMap:{type:Array,required:!0},additionalInputParamsMap:{type:Array,required:!1,default:[]},advanced:{type:Boolean,default:!1}},{profilingOptions:{default:{},type:Object},profilingOptionsModifiers:{},profilingEnabled:{default:!1,type:Boolean},profilingEnabledModifiers:{}}),emits:["update:profilingOptions","update:profilingEnabled"],setup(e){const l=e,n=we(),o=Mt(),i=Cl(),a=S(!l.advanced),s=Le(e,"profilingOptions"),r=Le(e,"profilingEnabled"),m=S(!0),k=B(()=>i.workers.map(w=>({value:w.worker_id,label:`${w.worker_id} (type: ${w.device_type}, vram_total: ${We(w.vram_total)})`})));return It(()=>{var g;if(!o.isAdmin)return;const w=localStorage.getItem(`profilingOptions_${(g=n.currentFlow)==null?void 0:g.name}`);w&&(s.value=JSON.parse(w)),i.fetchWorkersInfo().then(()=>{i.workers.find(j=>{var I;return j.worker_id===((I=s.value["X-WORKER-ID"])==null?void 0:I.value)})||(s.value["X-WORKER-ID"]=null)})}),(w,g)=>{const P=xe,j=Yn,I=Qe,z=lt,N=de,C=Oe,c=je;return u(),O(te,null,[e.advanced?(u(),O("div",Zn,[b("h4",{class:"text-md font-bold cursor-pointer select-none flex items-center mb-3",onClick:g[0]||(g[0]=()=>{a.value=!t(a)})},[f(P,{name:t(a)?"i-heroicons-chevron-up":"i-heroicons-chevron-down",class:"mr-2"},null,8,["name"]),g[3]||(g[3]=X(" Advanced options "))])])):F("",!0),t(a)?(u(),O("div",ea,[(u(!0),O(te,null,ve(t(n).currentFlow.input_params,(v,y)=>(u(),$(j,{key:y,"input-params-map":e.inputParamsMap,index:y,"input-param":v,advanced:e.advanced},null,8,["input-params-map","index","input-param","advanced"]))),128)),(u(!0),O(te,null,ve(e.additionalInputParamsMap,(v,y)=>(u(),$(j,{key:Object.keys(v)[0],"input-params-map":e.additionalInputParamsMap,index:y,"input-param":v[Object.keys(v)[0]],advanced:e.advanced},null,8,["input-params-map","index","input-param","advanced"]))),128)),t(o).isAdmin&&e.advanced?(u(),O("div",ta,[b("div",la,[b("h4",{class:"text-md font-bold cursor-pointer select-none flex items-center mb-3",onClick:g[1]||(g[1]=()=>{m.value=!t(m)})},[f(P,{name:t(m)?"i-heroicons-chevron-down":"i-heroicons-chevron-up",class:"mr-2"},null,8,["name"]),f(P,{name:"i-mdi-bug-outline",class:"mr-2"}),g[4]||(g[4]=X(" Execution settings "))])]),t(m)?F("",!0):(u(),O("div",na,[f(I,{modelValue:r.value,"onUpdate:modelValue":g[2]||(g[2]=v=>r.value=v),label:"Enable Execution settings",class:"mb-3"},null,8,["modelValue"]),(u(!0),O(te,null,ve(Object.keys(s.value),v=>(u(),$(c,{key:v,label:v},{default:h(()=>[v==="X-WORKER-ID"?(u(),O("div",aa,[f(z,{modelValue:s.value[v],"onUpdate:modelValue":y=>s.value[v]=y,options:t(k),placeholder:"Select worker",class:"w-full my-3"},null,8,["modelValue","onUpdate:modelValue","options"]),f(N,{icon:"i-heroicons-x-mark",variant:"outline",size:"sm",color:"orange",class:"ml-2",onClick:()=>s.value[v]=null},null,8,["onClick"]),f(N,{icon:"i-heroicons-arrow-path-solid",variant:"outline",size:"sm",color:"blue",class:"ml-2",onClick:()=>{t(i).fetchWorkersInfo().then(()=>{s.value[v]=t(k).find(y=>{var V;return y.value===((V=s.value[v])==null?void 0:V.value)})})}},null,8,["onClick"])])):(u(),$(C,{key:1,modelValue:s.value[v],"onUpdate:modelValue":y=>s.value[v]=y,placeholder:"Enter value",class:"my-3"},null,8,["modelValue","onUpdate:modelValue"]))]),_:2},1032,["label"]))),128))]))])):F("",!0)])):F("",!0)],64)}}}),sa={key:0,id:"prompt",class:"w-full my-10 lg:my-0 p-4 ring-1 ring-gray-200 dark:ring-gray-800 rounded-lg"},ia={class:"action flex items-center justify-end"},ra=Z({__name:"Prompt",setup(e,{expose:l}){var p,W,M,x;const n=we(),o=Mt();let i=localStorage.getItem(`input_params_map_${(p=n.currentFlow)==null?void 0:p.name}`);if(i){const d=JSON.parse(i);"flow_version"in d&&d.flow_version.split(".")[0]===((W=n.currentFlow)==null?void 0:W.version.split(".")[0])?i=d:(i=null,localStorage.removeItem(`input_params_map_${(M=n.currentFlow)==null?void 0:M.name}`))}const a=S(((x=n.currentFlow)==null?void 0:x.input_params.map(d=>{var R;if(d.type==="text")return{[d.name]:{value:i!==null&&i[d.name]?i[d.name]:d.default||"",type:d.type,optional:d.optional,advanced:d.advanced||!1,default:d.default||"",translatable:d.translatable||!1,dynamic_lora:d.dynamic_lora||!1,trigger_words:d.trigger_words||[]}};if(d.type==="number")return{[d.name]:{value:i!==null&&i[d.name]?i[d.name]:d.default||0,type:d.type,optional:d.optional,advanced:d.advanced||!1,default:d.default||0,dynamic_lora:d.dynamic_lora||!1,trigger_words:d.trigger_words||[]}};if(d.type==="image")return{[d.name]:{value:null,type:d.type,optional:d.optional,advanced:d.advanced||!1,dynamic_lora:d.dynamic_lora||!1,trigger_words:d.trigger_words||[]}};if(d.type==="image-mask")return{[d.name]:{value:null,type:d.type,optional:d.optional,advanced:d.advanced||!1,source_input_name:d.source_input_name||null,dynamic_lora:d.dynamic_lora||!1,trigger_words:d.trigger_words||[]}};if(d.type==="list")return{[d.name]:{value:i!==null&&i[d.name]?i[d.name]:d.default||Object.keys(d.options)[0]||"",type:d.type,optional:d.optional,options:d.options,advanced:d.advanced||!1,default:d.default||Object.keys(d.options)[0]||"",dynamic_lora:d.dynamic_lora||!1,trigger_words:d.trigger_words||[]}};if(d.type==="bool")return{[d.name]:{value:i!==null&&i[d.name]?i[d.name]:d.default||!1,type:d.type,optional:d.optional,advanced:d.advanced||!1,default:d.default||!1,dynamic_lora:d.dynamic_lora||!1,trigger_words:d.trigger_words||[]}};if(["range","range_scale"].includes(d.type)){const H={value:i!==null&&i[d.name]?i[d.name]:d.default||0,type:d.type,optional:d.optional,advanced:d.advanced||!1,min:d.min||0,max:d.max||100,step:d.step||1,default:d.default||0,dynamic_lora:d.dynamic_lora||!1,trigger_words:d.trigger_words||[]};if(d.type==="range_scale"&&(H.source_input_name=d.source_input_name||null,H.source_input_name===null||H.source_input_name==="")){const J=(R=n.currentFlow)==null?void 0:R.input_params.find(oe=>oe.type==="image"&&!oe.optional);J&&(H.source_input_name=J.name)}return{[d.name]:H}}}))||[]),s=S([]);n.currentFlow.is_seed_supported&&s.value.push({seed:{name:"seed",display_name:"Random seed",value:Math.floor(Math.random()*1e7),type:"number",optional:!0,advanced:!0,min:0,max:1e7,auto_increment:!0}});const r=B(()=>s.value.length>0||a.value.some(d=>{const R=Object.keys(d)[0];return d[R].advanced})),m=B(()=>{var d;return((d=s.value.find(R=>Object.keys(R)[0]==="seed"))==null?void 0:d.seed.auto_increment)||!1}),k=Et(),w=S(n.currentFlow.is_translations_supported&&k.settingsMap.translations_provider.value.trim()!==""),g=S(n.currentFlow.is_surprise_me_supported&&k.settingsMap.llm_provider.value.trim()!==""),P=S(w.value);It(()=>{const d=localStorage.getItem("translatePrompt");d&&(P.value=JSON.parse(d))}),pe(P,d=>{localStorage.setItem("translatePrompt",JSON.stringify(d))});function j(d){console.debug("Copy prompt inputs",d),Object.keys(d).forEach(H=>{const J=a.value.findIndex(oe=>Object.keys(oe)[0]===H);J!==-1&&(a.value[J][H].value=d[H].value)});const R=document.getElementById("prompt");R&&R.scrollIntoView({behavior:"smooth"})}l({copyPromptInputs:j}),a.value.forEach(d=>{const R=Object.keys(d)[0];["image","image-mask"].includes(d[R].type)||pe(()=>d[R].value,()=>{var J,oe;const H={};a.value.forEach(se=>{const ae=Object.keys(se)[0];H[ae]=se[ae].value}),localStorage.setItem(`input_params_map_${(J=n.currentFlow)==null?void 0:J.name}`,JSON.stringify({...H,flow_version:(oe=n.currentFlow)==null?void 0:oe.version}))})});const I=B(()=>a.value.filter(d=>{const R=Object.keys(d)[0];return!["image","image-mask"].includes(d[R].type)}).some(d=>{const R=Object.keys(d)[0];return d[R].value!==d[R].default}));function z(){a.value.forEach(d=>{const R=Object.keys(d)[0];d[R].type==="text"?d[R].value=d[R].default||"":d[R].type==="number"?d[R].value=d[R].default||d[R].min||0:d[R].type==="list"?d[R].value=d[R].default||Object.keys(d[R].options)[0]||"":d[R].type==="bool"?d[R].value=d[R].default||!1:["range","range_scale"].includes(d[R].type)&&(d[R].value=d[R].default||d[R].min||0)})}const N=S(!1),C=S(1),c=S(!1),v=B(()=>a.value.every(d=>{var J,oe,se,ae;const R=Object.keys(d)[0];if(d[R].optional)return!0;const H=d[R].value;if(d[R].type==="text")return H!=="";if(d[R].type==="number")return H>=d[R].min&&H<=d[R].max;if(d[R].type==="list")return H!==""&&Object.keys(d[R].options).includes(H);if(d[R].type==="bool")return!0;if(d[R].type==="range")return H>=d[R].min&&H<=d[R].max;if(d[R].type==="range_scale")return H>=d[R].min&&H<=d[R].max;if(d[R].type==="image")return(J=d[R])!=null&&J.nc_file?!0:H instanceof File&&H.size>0;if(d[R].type==="image-mask")return(oe=d[R])!=null&&oe.nc_file?((se=d[R])==null?void 0:se.mask_applied)||!1:H instanceof File&&H.size>0&&(((ae=d[R])==null?void 0:ae.mask_applied)||!1)})),y=S({"X-WORKER-UNLOAD-MODELS":1,"X-WORKER-EXECUTION-PROFILER":1,"X-WORKER-ID":null}),V=S(!1);pe(()=>y.value,()=>{var d;o.isAdmin&&localStorage.setItem(`profilingOptions_${(d=n.currentFlow)==null?void 0:d.name}`,JSON.stringify(y.value))},{deep:!0});function _(d=!1){N.value=!0;let R={};o.isAdmin&&V&&(R=Object.fromEntries(Object.entries(y).filter(([H,J])=>J!==null).map(([H,J])=>H==="X-WORKER-ID"?[H,J==null?void 0:J.value]:[H,J]))),n.runFlow(n.currentFlow,[...a.value,...s.value],m.value?C.value:1,w.value&&P.value,!1,null,d,R).finally(()=>{if(N.value=!1,m.value){const H=s.value.find(J=>Object.keys(J)[0]==="seed");H.seed.value=Number(H.seed.value)+C.value+1}})}return(d,R)=>{const H=xe,J=oa,oe=Oe,se=je,ae=Qe,Y=de,be=Je;return t(n).currentFlow?(u(),O("div",sa,[b("h2",{class:"text-lg font-bold cursor-pointer select-none flex items-center mb-3",onClick:R[0]||(R[0]=()=>{c.value=!t(c)})},[f(H,{name:t(c)?"i-heroicons-chevron-down":"i-heroicons-chevron-up",class:"mr-2"},null,8,["name"]),R[11]||(R[11]=X(" Prompt "))]),Ct(b("div",null,[f(J,{"input-params-map":t(a),"onUpdate:inputParamsMap":R[1]||(R[1]=ie=>K(a)?a.value=ie:null),"additional-input-params-map":t(s),"onUpdate:additionalInputParamsMap":R[2]||(R[2]=ie=>K(s)?s.value=ie:null),advanced:!1},null,8,["input-params-map","additional-input-params-map"]),t(r)?(u(),$(J,{key:0,"input-params-map":t(a),"onUpdate:inputParamsMap":R[3]||(R[3]=ie=>K(a)?a.value=ie:null),"additional-input-params-map":t(s),"onUpdate:additionalInputParamsMap":R[4]||(R[4]=ie=>K(s)?s.value=ie:null),"profiling-options":t(y),"onUpdate:profilingOptions":R[5]||(R[5]=ie=>K(y)?y.value=ie:null),"profiling-enabled":t(V),"onUpdate:profilingEnabled":R[6]||(R[6]=ie=>K(V)?V.value=ie:null),advanced:!0},null,8,["input-params-map","additional-input-params-map","profiling-options","profiling-enabled"])):F("",!0),t(n).currentFlow.is_count_supported?(u(),$(se,{key:1,label:"Number of results"},{default:h(()=>[f(oe,{modelValue:t(C),"onUpdate:modelValue":R[7]||(R[7]=ie=>K(C)?C.value=ie:null),type:"number",min:"1",max:"50",label:"Batch size",disabled:!t(m),class:"mb-3 max-w-fit flex justify-end"},null,8,["modelValue","disabled"])]),_:1})):F("",!0),t(w)?(u(),$(se,{key:2,class:"my-3 flex justify-end"},{default:h(()=>[f(ae,{modelValue:t(P),"onUpdate:modelValue":R[8]||(R[8]=ie=>K(P)?P.value=ie:null),label:"Translate prompt"},null,8,["modelValue"])]),_:1})):F("",!0),b("div",{class:le(["flex flex-col md:flex-row",{"justify-between":t(I),"justify-end":!t(I)}])},[t(I)?(u(),$(be,{key:0,text:"Reset input params values to defaults"},{default:h(()=>[f(Y,{icon:"i-heroicons-arrow-path-rounded-square",variant:"ghost",color:"amber",onClick:z},{default:h(()=>R[12]||(R[12]=[X(" Reset params ")])),_:1,__:[12]})]),_:1})):F("",!0),b("div",ia,[t(g)?(u(),$(be,{key:0,text:"Randomize prompt based on your input"},{default:h(()=>[f(Y,{class:"mr-2",icon:"i-heroicons-gift",variant:"soft",color:"blue",loading:t(N),onClick:R[9]||(R[9]=()=>_(!0))},{default:h(()=>R[13]||(R[13]=[X(" Surprise me ")])),_:1,__:[13]},8,["loading"])]),_:1})):F("",!0),f(Y,{icon:"i-heroicons-sparkles-16-solid",variant:"outline",loading:t(N),disabled:!t(v),onClick:R[10]||(R[10]=()=>_(!1))},{default:h(()=>R[14]||(R[14]=[X(" Run prompt ")])),_:1,__:[14]},8,["loading","disabled"])])],2)],512),[[Dt,!t(c)]])])):F("",!0)}}}),ua=e=>{const l=S(0);function n(a){e.value.style.scrollSnapType="none",e.value.style.scrollBehavior="auto",l.value=a.pageX,window.addEventListener("mousemove",i),window.addEventListener("mouseup",o)}function o(){e.value.style.removeProperty("scroll-behavior"),e.value.style.removeProperty("scroll-snap-type"),e.value.style.removeProperty("pointer-events"),window.removeEventListener("mousemove",i),window.removeEventListener("mouseup",o)}function i(a){a.preventDefault(),e.value.style.pointerEvents="none";const s=a.pageX-l.value;l.value=a.pageX,e.value.scrollBy(-s,0)}ge(()=>{e.value&&e.value.addEventListener("mousedown",n)}),et(()=>{e.value&&e.value.removeEventListener("mousedown",n)})},yt=mt(Me.ui.strategy,Me.ui.carousel,Dl),da=Z({components:{UButton:de},inheritAttrs:!1,props:{items:{type:Array,default:()=>[]},arrows:{type:Boolean,default:!1},indicators:{type:Boolean,default:!1},dir:{type:String,default:"ltr"},prevButton:{type:Object,default:()=>yt.default.prevButton},nextButton:{type:Object,default:()=>yt.default.nextButton},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:void 0}},setup(e,{expose:l}){const{ui:n,attrs:o}=pt("carousel",Be(e,"ui"),yt,Be(e,"class")),i=S(),a=S(0),{x:s}=Il(i,{behavior:"smooth"}),{width:r}=Sl(i);ua(i),Wt(i,N=>{var c,v;const[C]=N;a.value=((v=(c=C==null?void 0:C.target)==null?void 0:c.firstElementChild)==null?void 0:v.clientWidth)||0});const m=B(()=>e.dir==="rtl"),k=B(()=>a.value?m.value?Math.round(-s.value/a.value)+1:Math.round(s.value/a.value)+1:0),w=B(()=>{if(!a.value)return 0;const N=Math.round(r.value/a.value);return e.items.length<=N?0:e.items.length-N+1}),g=B(()=>k.value<=1),P=B(()=>k.value===w.value);function j(){s.value+=m.value?-a.value:a.value}function I(){s.value-=m.value?-a.value:a.value}function z(N){s.value=(N-1)*a.value*(m.value?-1:1)}return l({pages:w,page:k,prev:I,next:j,select:z}),{ui:n,attrs:o,isFirst:g,isLast:P,carouselRef:i,pages:w,currentPage:k,onClickNext:j,onClickPrev:I,onClick:z,twMerge:ct}}}),ca=["dir"],ma=["role"],fa=["aria-selected","aria-label","onClick"];function pa(e,l,n,o,i,a){const s=de;return u(),O("div",Te({class:e.ui.wrapper},e.attrs,{dir:e.dir}),[b("div",{ref:"carouselRef",class:le([e.ui.container,"no-scrollbar"])},[(u(!0),O(te,null,ve(e.items,(r,m)=>(u(),O("div",{key:m,class:le(e.ui.item),role:e.indicators?"tabpanel":null},[Fe(e.$slots,"default",{item:r,index:m},void 0,!0)],10,ma))),128))],2),e.arrows?(u(),O("div",{key:0,class:le(e.ui.arrows.wrapper)},[Fe(e.$slots,"prev",{onClick:e.onClickPrev,disabled:e.isFirst},()=>{var r;return[e.prevButton?(u(),$(s,Te({key:0,disabled:e.isFirst},{...e.ui.default.prevButton,...e.prevButton},{class:e.twMerge(e.ui.default.prevButton.class,(r=e.prevButton)==null?void 0:r.class),"aria-label":"Prev",onClick:e.onClickPrev}),null,16,["disabled","class","onClick"])):F("",!0)]},!0),Fe(e.$slots,"next",{onClick:e.onClickNext,disabled:e.isLast},()=>{var r;return[e.nextButton?(u(),$(s,Te({key:0,disabled:e.isLast},{...e.ui.default.nextButton,...e.nextButton},{class:e.twMerge(e.ui.default.nextButton.class,(r=e.nextButton)==null?void 0:r.class),"aria-label":"Next",onClick:e.onClickNext}),null,16,["disabled","class","onClick"])):F("",!0)]},!0)],2)):F("",!0),e.indicators?(u(),O("div",{key:1,role:"tablist",class:le(e.ui.indicators.wrapper)},[(u(!0),O(te,null,ve(e.pages,r=>Fe(e.$slots,"indicator",{key:r,onClick:e.onClick,active:r===e.currentPage,page:r},()=>[b("button",{type:"button",role:"tab","aria-selected":r===e.currentPage,class:le([e.ui.indicators.base,r===e.currentPage?e.ui.indicators.active:e.ui.indicators.inactive]),"aria-label":`set slide ${r}`,onClick:m=>e.onClick(r)},null,10,fa)],!0)),128))],2)):F("",!0)],16,ca)}const Ne=ft(da,[["render",pa],["__scopeId","data-v-a3da86ff"]]),va={class:"flex flex-col basis-full"},ga=Z({__name:"InputFiles",props:{running:{type:Object,required:!0}},setup(e){const l=Ut(),n=function(r,m){return`${Ht()}/tasks/inputs?task_id=${r}&input_index=${m}`},o=S(!1),i=S(""),a=S(0),s=S(!0);return(r,m)=>{var I,z,N,C,c;const k=xe,w=Ve,g=Ne,P=de,j=Ue;return e.running&&e.running.input_files&&((I=Object.keys(e.running.input_files))==null?void 0:I.length)>0?(u(),O("div",{key:0,class:le(["ml-2 mt-2 mb-5",{"mb-10":((z=Object.keys(e.running.input_files))==null?void 0:z.length)>1&&!t(s)}])},[b("h4",{class:"mb-3 font-bold cursor-pointer select-none flex items-center text-sm",onClick:m[0]||(m[0]=()=>s.value=!t(s))},[f(k,{name:t(s)?"i-heroicons-chevron-down":"i-heroicons-chevron-up",class:"mr-2"},null,8,["name"]),b("span",null," Input files ("+Q((N=Object.keys(e.running.input_files))==null?void 0:N.length)+") ",1)]),t(s)?F("",!0):(u(),O(te,{key:0},[((C=Object.keys(e.running.input_files))==null?void 0:C.length)===1?(u(),$(w,{key:0,class:"mb-5 rounded-lg cursor-pointer",fit:"outside",loading:"lazy",placeholder:t(l)(`${("buildBackendUrl"in r?r.buildBackendUrl:t(xt))()}/vix_logo.png`,{f:"png",blur:3,q:50}),src:n(e.running.task_id,0),onClick:m[1]||(m[1]=()=>{i.value=n(e.running.task_id,0),a.value=0,o.value=!0})},null,8,["placeholder","src"])):F("",!0),((c=Object.keys(e.running.input_files))==null?void 0:c.length)>1?(u(),$(g,{key:1,items:Object.keys(e.running.input_files).map(v=>({task_id:e.running.task_id,index:v})),ui:{item:"basis-full md:basis-1/2",indicators:{wrapper:"relative bottom-0 mt-4"}},page:1,indicators:""},{default:h(({item:v})=>[b("div",va,[f(w,{class:"rounded-lg cursor-pointer",fit:"outside",loading:"lazy",placeholder:t(l)(`${("buildBackendUrl"in r?r.buildBackendUrl:t(xt))()}/vix_logo.png`,{f:"png",blur:3,q:50}),src:n(v.task_id,v.index),onClick:()=>{i.value=n(e.running.task_id,v.index),a.value=v.index,o.value=!0}},null,8,["placeholder","src","onClick"])])]),_:1},8,["items"])):F("",!0),f(j,{modelValue:t(o),"onUpdate:modelValue":m[4]||(m[4]=v=>K(o)?o.value=v:null),class:"z-[90]",transition:!1,fullscreen:""},{default:h(()=>[f(P,{class:"absolute top-4 right-4",icon:"i-heroicons-x-mark",variant:"ghost",onClick:m[2]||(m[2]=()=>o.value=!1)}),b("div",{class:"flex items-center justify-center w-full h-full p-4",onClick:m[3]||(m[3]=vt(()=>o.value=!1,["left"]))},[t(i)?(u(),$(w,{key:0,class:"lg:h-full",fit:"inside",loading:"lazy",placeholder:"/vix_logo.png",src:t(i)},null,8,["src"])):F("",!0)])]),_:1},8,["modelValue"])],64))],2)):F("",!0)}}}),wa=Z({__name:"ErrorAlert",props:{running:{type:Object,required:!0}},setup(e){const l=we(),n=S(!1);return(o,i)=>{const a=wt;return u(),$(a,{class:"mb-5",icon:"i-heroicons-exclamation-circle-16-solid",color:"red",variant:"soft",title:"Task failed",description:e.running.error,actions:[{variant:"outline",color:"yellow",label:"Restart",loading:t(n),icon:"i-heroicons-arrow-path",click:()=>{n.value=!0,t(l).restartFlow(e.running).finally(()=>{n.value=!1})}}]},null,8,["description","actions"])}}}),ya={class:"mb-5"},ha={class:"text-sm mb-5 text-slate-500"},ba={class:"flex justify-between"},ka=Z({__name:"Item",props:{running:{type:Object,required:!0}},setup(e){const l=we(),n=S(!1),o=S(!1);function i(a){return[[{label:"Comfy flow",labelClass:"text-blue-500",icon:"i-heroicons-arrow-down-tray",iconClass:"bg-blue-500",click:()=>{var s;return l.downloadFlowComfy((s=l.currentFlow)==null?void 0:s.name,a.task_id)}}],[{label:`Raise priority ${a.priority>0?`(${a.priority})`:""}`,labelClass:"text-gray-500",icon:"i-heroicons-arrow-up",iconClass:"bg-gray-500",disabled:a.priority===15||a.progress>0,click:()=>{o.value=!0,l.raiseQueuePriority(a).finally(()=>{o.value=!1})}},{label:`Lower priority ${a.priority>0?`(${a.priority})`:""}`,labelClass:"text-gray-500",icon:"i-heroicons-arrow-down",iconClass:"bg-gray-500",disabled:a.priority===0||a.progress>0,click:()=>{o.value=!0,l.lowerQueuePriority(a).finally(()=>{o.value=!1})}},{label:`Reset priority ${a.priority>0?`(${a.priority})`:""}`,labelClass:"text-gray-500",icon:"i-heroicons-arrow-path-rounded-square-solid",iconClass:"bg-gray-500",disabled:a.priority===0||a.progress>0,click:()=>{o.value=!0,l.resetQueuePriority(a).finally(()=>{o.value=!1})}}]]}return(a,s)=>{var P,j;const r=Yt,m=ga,k=wa,w=de,g=gt;return u(),O("div",ya,[f(r,{class:"mb-3",value:(P=e.running)==null?void 0:P.progress,indicator:"",color:e.running.error?"red":"green"},null,8,["value","color"]),b("p",ha,Q([`${(j=e.running)!=null&&j.priority&&e.running.priority>0?"["+e.running.priority+"] ":""}#${e.running.task_id}`,...Object.keys(e.running.input_params_mapped).filter(I=>e.running.input_params_mapped[I].value&&e.running.input_params_mapped[I].value!=="").map(I=>`${e.running.input_params_mapped[I].display_name}: ${e.running.input_params_mapped[I].value}`)].join(" | ")+`${e.running.execution_time?" | execution_time: "+e.running.execution_time.toFixed(2)+"s":""}`),1),f(m,{running:e.running},null,8,["running"]),e.running.error?(u(),$(k,{key:0,running:e.running},null,8,["running"])):F("",!0),b("div",ba,[f(w,{icon:e.running.progress>=0&&e.running.progress<100?"i-heroicons-stop":"i-heroicons-minus-circle",color:e.running.error?"red":"orange",variant:"outline",loading:t(n),onClick:s[0]||(s[0]=()=>{n.value=!0,t(l).cancelRunningFlow(e.running).finally(()=>{n.value=!1})})},{default:h(()=>[X(Q(e.running.progress>=0&&e.running.progress<100?"Cancel":"Remove"),1)]),_:1},8,["icon","color","loading"]),f(g,{items:i(e.running),mode:"click",popper:{placement:"bottom-end"}},{default:h(()=>[f(w,{color:"blue",variant:"outline",icon:"i-heroicons-ellipsis-vertical-16-solid"})]),_:1},8,["items"])])])}}}),xa={class:"w-full p-4 ring-1 ring-gray-200 dark:ring-gray-800 rounded-lg shadow-md mt-5 mb-10"},_a={class:"flex items-center justify-between mb-2"},$a={key:0},Ca={key:1,class:"text-red-400"},Ia=Z({__name:"Queue",setup(e){const l=we(),n=S(!0),o=S(!1);return(i,a)=>{var k,w,g,P,j,I,z,N,C;const s=xe,r=de,m=ka;return u(),O("div",xa,[b("div",_a,[b("h2",{class:"text-lg font-bold cursor-pointer select-none flex items-center",onClick:a[0]||(a[0]=()=>{n.value=!t(n)})},[f(s,{name:t(n)?"i-heroicons-chevron-down":"i-heroicons-chevron-up",class:"mr-2"},null,8,["name"]),b("span",null," Queue ("+Q(t(l).flowsRunningByName((k=t(l).currentFlow)==null?void 0:k.name).length)+") ",1),t(l).flowsRunningByName((w=t(l).currentFlow)==null?void 0:w.name).length>0?(u(),O("span",$a," - "+Q(`${((P=t(l).flowsRunningByName((g=t(l).currentFlow)==null?void 0:g.name).filter(c=>c.progress>0)[0])==null?void 0:P.progress.toFixed(0))??0}%`),1)):F("",!0),t(l).flowsRunningByNameWithErrors((j=t(l))==null?void 0:j.currentFlow.name).length>0?(u(),O("span",Ca," ("+Q(t(l).flowsRunningByNameWithErrors((I=t(l).currentFlow)==null?void 0:I.name).length)+") ",1)):F("",!0)]),(z=t(l).currentFlow)!=null&&z.name&&t(l).flowsRunningByName((N=t(l).currentFlow)==null?void 0:N.name).length>0?(u(),$(r,{key:0,icon:"i-heroicons-stop",color:"orange",variant:"outline",loading:t(o),onClick:a[1]||(a[1]=()=>{var c;o.value=!0,t(l).cancelRunningFlows((c=t(l).currentFlow)==null?void 0:c.name).finally(()=>{o.value=!1})})},{default:h(()=>a[2]||(a[2]=[X(" Cancel all ")])),_:1,__:[2]},8,["loading"])):F("",!0)]),t(n)?F("",!0):(u(!0),O(te,{key:0},ve(t(l).flowsRunningByName((C=t(l).currentFlow)==null?void 0:C.name),c=>(u(),$(m,{key:c.task_id,running:c},null,8,["running"]))),128))])}}}),Sa=Z({__name:"ScrollToTop",props:{show:{type:Boolean,required:!0},target:{type:String,required:!0}},setup(e){const l=e;function n(){const o=document.getElementById(l.target);o&&o.scrollIntoView({behavior:"smooth"})}return(o,i)=>{const a=de;return e.show?(u(),$(a,{key:0,icon:"i-heroicons-arrow-small-up",color:"black",variant:"outline",onClick:n})):F("",!0)}}}),Pa={class:"flex flex-col items-center mb-2 max-w-fit mx-auto z-0"},Ma={class:"text-slate-500 text-center text-sm w-full mx-auto flex flex-wrap items-center justify-center md:justify-between"},Ra={class:"toggles py-2"},Fa={class:"mr-2 inline-flex items-center text-sm"},Ua=["for"],Va={class:"mr-2 inline-flex items-center text-sm"},za=["for"],Ta={key:0,class:"flex items-center"},Oa=["title"],ja=Z({__name:"Child",props:{flowResult:{type:Object,required:!0},outputsIndex:{type:Number,required:!1,default:()=>0},openImageModal:{type:Function,required:!0}},setup(e){const l=e,n=we(),o=(c,v=null,y=!1)=>{if(c.child_tasks.length===0)return c;const V=c.child_tasks.findIndex(_=>_.parent_task_node_id===v);return V!==-1?(y||(a.value=c),o(c.child_tasks[V],c.child_tasks[V].outputs[0].comfy_node_id,y)):c};function i(c,v,y=null){if(y!==null&&c.parent_task_node_id===y||Number(c.task_id)===v)return c;for(let V=0;V<c.child_tasks.length;V++)for(let _=0;_<c.child_tasks[V].outputs.length;_++){const p=i(c.child_tasks[V],v,c.child_tasks[V].outputs[_].comfy_node_id);if(p!==null)return p}return null}const a=S(l.flowResult),s=S(o(l.flowResult,l.flowResult.outputs[l.outputsIndex].comfy_node_id,!1));function r(c){var v;return[[{label:`${(v=n.flowByName((c==null?void 0:c.flow_name)??(c==null?void 0:c.name)))==null?void 0:v.display_name}#${c.task_id}`,disabled:!0}],[{label:"View image",icon:"i-heroicons-eye",click:()=>{l.openImageModal(fe({task_id:c.task_id,node_id:c.outputs.length>1?c.outputs[l.outputsIndex].comfy_node_id:c.outputs[0].comfy_node_id}))}}]]}function m(c){var y;const v=[[{label:`${(y=n.flowByName((c==null?void 0:c.flow_name)??(c==null?void 0:c.name)))==null?void 0:y.display_name}#${c.task_id}`,disabled:!0}],[{label:"View image",icon:"i-heroicons-eye",disabled:c.progress<100||c.error!=="",click:()=>{l.openImageModal(fe({task_id:c.task_id,node_id:c.outputs.length>1?c.outputs[l.outputsIndex].comfy_node_id:c.outputs[0].comfy_node_id}))}},{label:c.progress<100?"Cancel":"Delete",labelClass:c.progress<100?"text-orange-500":"text-red-500",icon:c.progress<100?"i-heroicons-stop":"i-heroicons-trash",iconClass:c.progress<100?"bg-orange-500":"bg-red-500",click:()=>{n.deleteFlowHistory(c.task_id).then(()=>{const V=i(l.flowResult,c.parent_task_id,c.parent_task_node_id);V&&(V.child_tasks=V.child_tasks.filter(_=>Number(_.task_id)!==Number(c.task_id))),I(!1,l.flowResult)})}}]];return c.progress<100&&(v[0][1]={label:`Progress: ${Math.ceil(c.progress)}% (${c.execution_time.toFixed(2)}s)`,labelClass:"text-blue-500",disabled:!0}),c.error!==""&&v[0].push({label:`Error: ${c.error}`,labelClass:"text-red-500",slot:"error",click:()=>{Ge().copy(c.error),ke().add({title:"Clipboard",description:`Task #${c.task_id} error copied to clipboard`,timeout:2e3})}}),v}function k(){const c=a.value.parent_task_id;if(!c)return;const v=i(l.flowResult,c,a.value.parent_task_node_id);v&&(a.value=v)}function w(){if(a.value.child_tasks.length===0)return;const c=a.value.outputs.length>1?a.value.outputs[l.outputsIndex].comfy_node_id:a.value.outputs[0].comfy_node_id,v=a.value.child_tasks.find(y=>y.parent_task_node_id===c);v&&(a.value=v)}const g=B(()=>{if(a.value.child_tasks.length===0)return;const c=a.value.outputs.length>1?a.value.outputs[l.outputsIndex].comfy_node_id:a.value.outputs[0].comfy_node_id;return a.value.child_tasks.find(y=>y.parent_task_node_id===c).task_id!==s.value.task_id});function P(){const c=s.value.parent_task_id;if(!c)return;const v=i(l.flowResult,c,s.value.parent_task_node_id);v&&(s.value=v)}function j(){if(s.value.child_tasks.length===0)return;const c=Number(s.value.outputs[0].comfy_node_id),v=s.value.child_tasks.find(y=>Number(y.parent_task_node_id)===c);v&&(s.value=v)}function I(c=!1,v=null){c||(a.value=v),s.value=o(v,v==null?void 0:v.outputs[l.outputsIndex].comfy_node_id,c),z.value=!1}pe(l.flowResult,c=>{I(!0,c)});const z=S(!1),N=S(!0),C=S(null);return pe(z,c=>{c?(C.value=a.value,a.value=l.flowResult):C.value&&(a.value=C.value,s.value=Gt(C.value,l.outputsIndex,a.value.outputs.length>1?a.value.outputs[l.outputsIndex].comfy_node_id:a.value.outputs[0].comfy_node_id))}),(c,v)=>{const y=Ve,V=Se("ImgComparisonSlider"),_=Al,p=de,W=gt,M=xe,x=Je;return u(),O("div",Pa,[Ct(f(y,{class:"mb-2 rounded-lg cursor-pointer",height:t(n).outputMaxSize,width:t(n).outputMaxSize,draggable:"false",fit:"cover",loading:"lazy",src:("outputResultSrc"in c?c.outputResultSrc:t(fe))({task_id:t(s).progress===100?t(s).task_id:e.flowResult.task_id,node_id:t(s).progress===100?t(s).outputs[0].comfy_node_id:e.flowResult.outputs[e.outputsIndex].comfy_node_id}),onClick:v[0]||(v[0]=d=>e.openImageModal(("outputResultSrc"in c?c.outputResultSrc:t(fe))({task_id:t(s).task_id??e.flowResult.task_id,node_id:t(s).outputs[0].comfy_node_id??e.flowResult.outputs[e.outputsIndex].comfy_node_id})))},null,8,["height","width","src"]),[[Dt,!t(N)]]),t(N)?(u(),$(V,{key:0,class:"mb-2 mx-auto outline-none w-fit rounded-lg"},{default:h(()=>{var d,R,H;return[f(y,{slot:"first",height:t(n).outputMaxSize,width:t(n).outputMaxSize,fit:"cover",draggable:"false",src:("outputResultSrc"in c?c.outputResultSrc:t(fe))({task_id:t(z)?e.flowResult.task_id:t(a).task_id,node_id:t(z)?e.flowResult.outputs[e.outputsIndex].comfy_node_id:t(a).parent_task_node_id!==null?(d=t(a))==null?void 0:d.outputs[0].comfy_node_id:((R=t(a))==null?void 0:R.outputs[e.outputsIndex].comfy_node_id)??((H=t(a))==null?void 0:H.outputs[0].comfy_node_id)})},null,8,["height","width","src"]),t(s)&&t(s).progress===100?(u(),$(y,{key:0,slot:"second",height:t(n).outputMaxSize,width:t(n).outputMaxSize,fit:"cover",draggable:"false",src:("outputResultSrc"in c?c.outputResultSrc:t(fe))({task_id:t(s).task_id,node_id:t(s).outputs[0].comfy_node_id})},null,8,["height","width","src"])):(u(),$(y,{key:1,slot:"second",height:t(n).outputMaxSize,width:t(n).outputMaxSize,fit:"cover",draggable:"false",src:`${("buildBackendUrl"in c?c.buildBackendUrl:t(xt))()}/vix_logo.png`},null,8,["height","width","src"]))]}),_:1})):F("",!0),b("div",Ma,[b("div",Ra,[b("div",Fa,[f(_,{id:`toggle-compare-${e.flowResult.task_id}-${e.outputsIndex}`,modelValue:t(N),"onUpdate:modelValue":v[1]||(v[1]=d=>K(N)?N.value=d:null),size:"xs",class:"mr-2"},null,8,["id","modelValue"]),b("label",{class:"cursor-pointer select-none",for:`toggle-compare-${e.flowResult.task_id}-${e.outputsIndex}`}," Comparison ",8,Ua)]),b("div",Va,[f(_,{id:`toggle-original-${e.flowResult.task_id}-${e.outputsIndex}`,modelValue:t(z),"onUpdate:modelValue":v[2]||(v[2]=d=>K(z)?z.value=d:null),disabled:!t(N),size:"xs",class:"mr-2"},null,8,["id","modelValue","disabled"]),b("label",{class:"cursor-pointer select-none",for:`toggle-original-${e.flowResult.task_id}-${e.outputsIndex}`}," Original ",8,za)])]),t(N)?(u(),O("div",Ta,[f(p,{icon:"i-heroicons-arrow-small-left-20-solid",size:"2xs",variant:"soft",color:"cyan",disabled:t(z)||t(a).parent_task_id===null,onClick:k},null,8,["disabled"]),f(W,{items:r(t(a)),mode:"click",popper:{placement:"top"}},{default:h(()=>[f(p,{variant:"link",color:"white",size:"xs"},{default:h(()=>[X(" #"+Q(t(z)?e.flowResult.task_id:t(a).task_id),1)]),_:1})]),_:1},8,["items"]),f(p,{icon:"i-heroicons-arrow-small-right-20-solid",size:"2xs",variant:"soft",color:"cyan",disabled:t(z)||!t(g),onClick:w},null,8,["disabled"]),f(M,{class:"mx-3",name:"i-heroicons-arrows-right-left-16-solid"}),f(p,{icon:"i-heroicons-arrow-small-left-20-solid",size:"2xs",variant:"soft",color:"cyan",disabled:!i(l.flowResult,t(s).parent_task_id,t(s).parent_task_node_id)||t(s).parent_task_id===Number(t(a).task_id)||t(s).parent_task_id===null,onClick:P},null,8,["disabled"]),f(W,{items:m(t(s)),mode:"click",popper:{placement:"top"}},{error:h(({item:d})=>[b("div",{class:"text-red-500 truncate",title:d.label},Q(d.label),9,Oa)]),default:h(()=>[f(p,{class:le({"text-blue-500":t(s).progress!==100&&t(s).error==="","text-red-500":t(s).error!==""}),variant:"link",color:"white",size:"xs"},{default:h(()=>[X(Q(t(s).progress===100?"#"+t(s).task_id:Math.ceil(t(s).progress)+"%"),1)]),_:1},8,["class"])]),_:1},8,["items"]),f(p,{icon:"i-heroicons-arrow-small-right-20-solid",size:"2xs",variant:"soft",color:"cyan",disabled:t(s).child_tasks.length===0,onClick:j},null,8,["disabled"]),f(x,{class:"ml-3",text:"Reset comparison",popper:{placement:"top"}},{default:h(()=>[f(p,{icon:"i-heroicons-arrow-path-rounded-square-solid",size:"2xs",variant:"outline",color:"white",onClick:v[3]||(v[3]=()=>I(!1,e.flowResult))})]),_:1})])):F("",!0)])])}}}),Na={class:"image-output"},Ba={class:"flex flex-col basis-full justify-between mx-2"},La=Z({__name:"Image",props:{flowResult:{type:Object,required:!0},handleSendToFlow:{type:Function,required:!0},openImageModal:{type:Function,required:!0}},setup(e){const l=we();return(n,o)=>{var m,k;const i=ja,a=Ve,s=de,r=Ne;return u(),O("div",Na,[e.flowResult.outputs.length===1?(u(),O(te,{key:0},[(m=e.flowResult)!=null&&m.child_tasks&&((k=e.flowResult)==null?void 0:k.child_tasks.length)>0?(u(),$(i,{key:0,"flow-result":e.flowResult,"open-image-modal":e.openImageModal},null,8,["flow-result","open-image-modal"])):e.flowResult.outputs.length===1?(u(),$(a,{key:1,class:"mb-2 mx-auto rounded-lg cursor-pointer",height:t(l).$state.outputMaxSize,width:t(l).$state.outputMaxSize,draggable:"false",fit:"cover",loading:"lazy",src:("outputResultSrc"in n?n.outputResultSrc:t(fe))({task_id:e.flowResult.task_id,node_id:e.flowResult.outputs[0].comfy_node_id}),onClick:o[0]||(o[0]=w=>e.openImageModal(("outputResultSrc"in n?n.outputResultSrc:t(fe))({task_id:e.flowResult.task_id,node_id:e.flowResult.outputs[0].comfy_node_id})))},null,8,["height","width","src"])):F("",!0)],64)):e.flowResult.outputs.length>1?(u(),$(r,{key:1,class:"mb-3 rounded-lg overflow-hidden",items:e.flowResult.outputs.map((w,g)=>({task_id:e.flowResult.task_id,node_id:w.comfy_node_id,index:g})),ui:{item:"basis-full md:basis-1/2",indicators:{wrapper:"relative bottom-0 mt-4 md:hidden"}},page:1,indicators:""},{default:h(({item:w})=>{var g;return[b("div",Ba,[(g=e.flowResult)!=null&&g.child_tasks&&("hasChildTaskByParentTaskNodeId"in n?n.hasChildTaskByParentTaskNodeId:t(Xt))(e.flowResult,w.index,w.node_id)?(u(),$(i,{key:0,"flow-result":e.flowResult,"outputs-index":w.index,"open-image-modal":e.openImageModal},null,8,["flow-result","outputs-index","open-image-modal"])):(u(),$(a,{key:1,class:le(`mb-2 h-100 max-h-[${t(l).$state.outputMaxSize}px] mx-auto rounded-lg cursor-pointer`),draggable:"false",height:t(l).$state.outputMaxSize,width:t(l).$state.outputMaxSize,fit:"cover",loading:"lazy",src:("outputResultSrc"in n?n.outputResultSrc:t(fe))(w),onClick:P=>e.openImageModal(("outputResultSrc"in n?n.outputResultSrc:t(fe))(w))},null,8,["class","height","width","src","onClick"])),f(s,{class:"mt-2 w-fit mx-auto",icon:"i-heroicons-arrow-uturn-up-solid",color:"violet",size:"xs",variant:"outline",onClick:()=>{e.handleSendToFlow(e.flowResult,w.index)}},{default:h(()=>o[1]||(o[1]=[X(" Send to flow ")])),_:2,__:[1]},1032,["onClick"])])]}),_:1},8,["items"])):F("",!0)])}}}),Aa={class:"video-output"},qa=["width","height"],Ea=["src"],Da={class:"flex flex-col basis-full justify-between mx-2"},Wa=["width","height"],Ha=["src"],Ga=Z({__name:"Video",props:{flowResult:{type:Object,required:!0}},setup(e){const l=we();return(n,o)=>{const i=Ne;return u(),O("div",Aa,[e.flowResult.outputs.length===1?(u(),O("video",{key:0,controls:"",class:"mb-2 mx-auto rounded-lg",style:{"max-height":"80vh"},width:t(l).$state.outputMaxSize,height:t(l).$state.outputMaxSize},[b("source",{src:("outputResultSrc"in n?n.outputResultSrc:t(fe))({task_id:e.flowResult.task_id,node_id:e.flowResult.outputs[0].comfy_node_id})},null,8,Ea)],8,qa)):e.flowResult.outputs.length>1?(u(),$(i,{key:1,class:"mb-3 rounded-lg overflow-hidden",items:e.flowResult.outputs.map((a,s)=>({task_id:e.flowResult.task_id,node_id:a.comfy_node_id,index:s})),ui:{item:"basis-full md:basis-1/2",indicators:{wrapper:"relative bottom-0 mt-4 md:hidden"}},page:1,indicators:""},{default:h(()=>[b("div",Da,[b("video",{controls:"",class:"mb-2 mx-auto rounded-lg",width:t(l).$state.outputMaxSize,height:t(l).$state.outputMaxSize},[b("source",{src:("outputResultSrc"in n?n.outputResultSrc:t(fe))({task_id:e.flowResult.task_id,node_id:e.flowResult.outputs[0].comfy_node_id})},null,8,Ha)],8,Wa)])]),_:1},8,["items"])):F("",!0)])}}}),Xa={class:"audio-output"},Ja=["src"],Qa={class:"flex flex-col basis-full justify-between mx-2"},Ka=["src"],Ya=Z({__name:"Audio",props:{flowResult:{type:Object,required:!0}},setup(e){return(l,n)=>{const o=Ne;return u(),O("div",Xa,[e.flowResult.outputs.length===1?(u(),O("audio",{key:0,controls:"",class:"mb-2 mx-auto rounded-lg",src:("outputResultSrc"in l?l.outputResultSrc:t(fe))({task_id:e.flowResult.task_id,node_id:e.flowResult.outputs[0].comfy_node_id})},null,8,Ja)):e.flowResult.outputs.length>1?(u(),$(o,{key:1,class:"mb-3 rounded-lg overflow-hidden",items:e.flowResult.outputs.map((i,a)=>({task_id:e.flowResult.task_id,node_id:i.comfy_node_id,index:a})),ui:{item:"basis-full md:basis-1/2",indicators:{wrapper:"relative bottom-0 mt-4 md:hidden"}},page:1,indicators:""},{default:h(()=>[b("div",Qa,[b("audio",{controls:"",class:"mb-2 mx-auto rounded-lg",src:("outputResultSrc"in l?l.outputResultSrc:t(fe))({task_id:e.flowResult.task_id,node_id:e.flowResult.outputs[0].comfy_node_id})},null,8,Ka)])]),_:1},8,["items"])):F("",!0)])}}}),Za={class:"text-output"},eo={key:0,class:"mb-2 mx-auto rounded-lg text-md p-4 pr-8 border border-slate-500 relative"},to=Z({__name:"Text",props:{flowResult:{type:Object,required:!0}},setup(e){const l=e,n=we(),o=ke(),i=S(!1),a=S({});function s(r,m){const{$apiFetch:k}=Ye(),w=fe({task_id:r.task_id,node_id:m.comfy_node_id});return k(w).then(g=>{a.value[m.comfy_node_id]=g}).catch(g=>{console.error(g)}).finally(()=>{i.value=!1})}return ge(()=>{Promise.all(l.flowResult.outputs.filter(r=>r.type==="text").map(r=>s(l.flowResult,r)))}),(r,m)=>{const k=de,w=Ne;return u(),O("div",Za,[e.flowResult.outputs.length===1?(u(),O("div",eo,[t(i)?F("",!0):(u(),$(k,{key:0,variant:"outline",class:"absolute top-2 right-2 z-10",icon:"i-mdi-content-copy",size:"xs",color:"white",onClick:m[0]||(m[0]=()=>{("useCopyToClipboard"in r?r.useCopyToClipboard:t(Ge))().copy(t(a)[e.flowResult.outputs[0].comfy_node_id]),t(o).add({title:"Clipboard",description:"Text copied to clipboard"})})})),b("p",null,Q(t(i)?"Loading...":t(a)[e.flowResult.outputs[0].comfy_node_id]),1)])):e.flowResult.outputs.length>1?(u(),$(w,{key:1,class:"mb-3 rounded-lg overflow-hidden",items:e.flowResult.outputs.map((g,P)=>({task_id:e.flowResult.task_id,node_id:g.comfy_node_id,index:P})),ui:{item:"basis-full md:basis-1/2",indicators:{wrapper:"relative bottom-0 mt-4"}},page:1,indicators:"",arrows:""},{default:h(({item:g})=>[b("div",{class:"mb-2 mx-2 rounded-lg text-md p-4 border border-slate-500 shadow-sm overflow-y-auto relative",style:Ze({"max-height":Math.ceil(t(n).$state.outputMaxSize/2)+"px"})},[t(i)?F("",!0):(u(),$(k,{key:0,variant:"outline",class:"absolute top-2 right-2 z-10",icon:"i-mdi-content-copy",size:"xs",color:"white",onClick:()=>{("useCopyToClipboard"in r?r.useCopyToClipboard:t(Ge))().copy(t(a)[g.node_id]),t(o).add({title:"Clipboard",description:"Text copied to clipboard"})}},null,8,["onClick"])),b("p",null,Q(t(i)?"Loading...":t(a)[g.node_id]),1)],4)]),_:1},8,["items"])):F("",!0)])}}}),lo={class:"3d-model-output"},no=["src"],ao={class:"flex flex-col basis-full justify-between mx-2"},oo=["src"],so=Z({__name:"3dModel",props:{flowResult:{type:Object,required:!0}},setup(e){ge(()=>{Pl(()=>import("./BGclL-wn.js"),[],import.meta.url)});const l=we();return(n,o)=>{const i=El,a=Ne;return u(),O("div",lo,[e.flowResult.outputs.length===1?(u(),$(i,{key:0},{default:h(()=>[b("model-viewer",{"auto-rotate":"","camera-controls":"",class:"border border-slate-500 rounded-lg mx-auto mb-3",style:Ze({width:"100%",height:t(l).$state.outputMaxSize+"px"}),src:("outputResultSrc"in n?n.outputResultSrc:t(fe))({task_id:e.flowResult.task_id,node_id:e.flowResult.outputs[0].comfy_node_id})},null,12,no)]),_:1})):e.flowResult.outputs.length>1?(u(),$(a,{key:1,class:"mb-3 rounded-lg overflow-hidden",items:e.flowResult.outputs.map((s,r)=>({task_id:e.flowResult.task_id,node_id:s.comfy_node_id,index:r})),ui:{item:"basis-full",indicators:{wrapper:"relative bottom-0 mt-4 md:hidden"}},page:1,indicators:""},{default:h(()=>[b("div",ao,[f(i,null,{default:h(()=>[b("model-viewer",{"auto-rotate":"","camera-controls":"",style:Ze({width:t(l).$state.outputMaxSize+"px",height:t(l).$state.outputMaxSize+"px"}),src:("outputResultSrc"in n?n.outputResultSrc:t(fe))({task_id:e.flowResult.task_id,node_id:e.flowResult.outputs[0].comfy_node_id})},null,12,oo)]),_:1})])]),_:1},8,["items"])):F("",!0)])}}}),io={class:"w-full h-full p-4"},ro={class:"mt-4 max-h-96 overflow-y-auto text-sm whitespace-pre-wrap"},uo=Z({__name:"Params",props:{flowResult:{type:Object,required:!0}},setup(e){const l=e,n=S(!1),o=B(()=>["#"+l.flowResult.task_id,...Object.keys(l.flowResult.input_params_mapped).filter(r=>l.flowResult.input_params_mapped[r].value&&l.flowResult.input_params_mapped[r].value!=="").map(r=>n.value&&l.flowResult.translated_input_params_mapped&&l.flowResult.translated_input_params_mapped[r]?`${l.flowResult.input_params_mapped[r].display_name}: ${l.flowResult.translated_input_params_mapped[r].value}`:`${l.flowResult.input_params_mapped[r].display_name}: ${l.flowResult.input_params_mapped[r].value}`)].join(" | ")+`${l.flowResult.execution_time?" | execution_time: "+l.flowResult.execution_time.toFixed(2)+"s":""}`);et(()=>{l.flowResult.showInputFiles=!1,l.flowResult.showExecutionDetailsModal=!1});const i=B(()=>l.flowResult.execution_details&&l.flowResult.extra_flags!==null),a=B(()=>{const r={unload_models:l.flowResult.extra_flags.unload_models,max_memory_usage:l.flowResult.execution_details.max_memory_usage,disable_smart_memory:l.flowResult.execution_details.disable_smart_memory,vram_state:l.flowResult.execution_details.vram_state};return JSON.stringify(r,null,"	")});function s(){const r={extra_flags:l.flowResult.extra_flags,execution_details:l.flowResult.execution_details},m=new Blob([JSON.stringify(r,null,"	")],{type:"application/json"}),k=URL.createObjectURL(m),w=document.createElement("a");w.href=k,w.download=`${l.flowResult.task_id}_execution_details.json`,w.click(),window.URL.revokeObjectURL(k)}return(r,m)=>{const k=de,w=Ue,g=Je,P=Xe,j=xe;return u(),O(te,null,[t(i)?(u(),$(w,{key:0,modelValue:e.flowResult.showExecutionDetailsModal,"onUpdate:modelValue":m[2]||(m[2]=I=>e.flowResult.showExecutionDetailsModal=I)},{default:h(()=>[f(k,{class:"absolute top-4 right-4",icon:"i-heroicons-x-mark",variant:"ghost",onClick:m[0]||(m[0]=()=>e.flowResult.showExecutionDetailsModal=!1)}),b("div",io,[m[6]||(m[6]=b("h3",{class:"text-center font-bold"}," Execution details ",-1)),b("div",ro,Q(t(a)),1),f(k,{class:"mt-3",icon:"i-heroicons-arrow-down-tray-20-solid",variant:"outline",size:"xs",color:"gray",onClick:m[1]||(m[1]=()=>s())},{default:h(()=>m[5]||(m[5]=[X(" Download raw details ")])),_:1,__:[5]})])]),_:1},8,["modelValue"])):F("",!0),e.flowResult.translated_input_params_mapped&&Object.keys(e.flowResult.translated_input_params_mapped).length>0?(u(),$(g,{key:1,text:t(n)?"Hide translated input params":"Show translated input params",popper:{placement:"top"}},{default:h(()=>[f(k,{class:"mb-2 mr-2",color:"white",size:"xs",variant:"outline",icon:"i-heroicons-language-solid",onClick:m[3]||(m[3]=()=>{n.value=!t(n)})})]),_:1},8,["text"])):F("",!0),(u(!0),O(te,null,ve(t(o).split("|"),I=>(u(),$(P,{key:I,class:"mr-2 mb-2 last:mr-0 hover:cursor-pointer",variant:"soft",color:"gray",onClick:()=>{const z=("useCopyToClipboard"in r?r.useCopyToClipboard:t(Ge))(),N=I.indexOf(":"),C=I.substring(N+1).trim();z.copy(C),("useToast"in r?r.useToast:t(ke))().add({title:"Clipboard",description:`${I.split(":")[0].trim()} copied to clipboard`,timeout:2e3})}},{default:h(()=>[X(Q(I),1)]),_:2},1032,["onClick"]))),128)),e.flowResult.input_files.length>0?(u(),$(P,{key:2,class:"mr-2 mb-2 last:mr-0 hover:cursor-pointer select-none",variant:"subtle",color:"sky",onClick:m[4]||(m[4]=()=>{e.flowResult.showInputFiles=!e.flowResult.showInputFiles})},{default:h(()=>[f(j,{name:e.flowResult.showInputFiles?"i-heroicons-chevron-down":"i-heroicons-chevron-up",class:"mr-1"},null,8,["name"]),f(j,{name:"i-heroicons-document-solid",class:"mr-1"}),X(" "+Q(`input_files: ${e.flowResult.input_files.length}`),1)]),_:1})):F("",!0)],64)}}}),co={key:0,class:le("w-full p-1")},mo={class:"flex flex-col basis-full justify-between mx-2"},fo=Z({__name:"InputFiles",props:{flowResult:{type:Object,required:!0}},setup(e){const l=we(),n=(s,r)=>`${Ht()}/tasks/inputs?task_id=${s}&input_index=${r}`,o=S(!1),i=S(""),a=S(0);return(s,r)=>{var P,j;const m=Ve,k=Ne,w=de,g=Ue;return e.flowResult.showInputFiles?(u(),O("div",co,[((P=Object.keys(e.flowResult.input_files))==null?void 0:P.length)===1?(u(),$(m,{key:0,class:le(`mb-5 mx-auto rounded-lg cursor-pointer max-h-[${t(l).$state.outputMaxSize}px] w-auto`),fit:"outside",loading:"lazy",src:n(e.flowResult.task_id,0),onClick:r[0]||(r[0]=()=>{i.value=n(e.flowResult.task_id,0),a.value=0,o.value=!0})},null,8,["class","src"])):F("",!0),((j=Object.keys(e.flowResult.input_files))==null?void 0:j.length)>1?(u(),$(k,{key:1,items:Object.keys(e.flowResult.input_files).map(I=>({task_id:e.flowResult.task_id,index:I})),ui:{item:"basis-full md:basis-1/2",indicators:{wrapper:"relative bottom-0 my-2"}},page:1,indicators:""},{default:h(({item:I})=>[b("div",mo,[f(m,{class:le(`mb-5 mx-auto rounded-lg cursor-pointer max-h-[${t(l).$state.outputMaxSize}px] w-auto`),fit:"outside",loading:"lazy",draggable:"false",src:n(I.task_id,I.index),onClick:()=>{i.value=n(e.flowResult.task_id,I.index),a.value=I.index,o.value=!0}},null,8,["class","src","onClick"])])]),_:1},8,["items"])):F("",!0),f(g,{modelValue:t(o),"onUpdate:modelValue":r[3]||(r[3]=I=>K(o)?o.value=I:null),class:"z-[90]",transition:!1,fullscreen:""},{default:h(()=>[f(w,{class:"absolute top-4 right-4",icon:"i-heroicons-x-mark",variant:"ghost",onClick:r[1]||(r[1]=()=>o.value=!1)}),b("div",{class:"flex items-center justify-center w-full h-full p-4",onClick:r[2]||(r[2]=vt(()=>o.value=!1,["left"]))},[t(i)?(u(),$(m,{key:0,class:"lg:h-full",fit:"inside",loading:"lazy",placeholder:"/vix_logo.png",src:t(i)},null,8,["src"])):F("",!0)])]),_:1},8,["modelValue"])])):F("",!0)}}}),po={key:0,class:"text-red-300"},vo={class:"flex items-center"},go={class:"p-2 max-w-48 max-h-48 not-italic"},wo={class:"block font-medium text-gray-700 dark:text-gray-200"},yo={key:0,class:"flex items-center"},ho=Z({__name:"InputParam",props:{inputParam:{type:Object,required:!0},index:{type:Number,required:!0},inputParamsMap:{type:Array,required:!0},advanced:{type:Boolean,default:!1}},setup(e){const l=e,n=B(()=>l.inputParam.type!=="bool"?l.inputParam.display_name:""),o=B(()=>["range"].includes(l.inputParam.type)?`value: ${l.inputParamsMap[l.index][l.inputParam.name].value}`:""),i=S(null);function a(s){const r=ll(s);r&&(l.inputParamsMap[l.index][l.inputParam.name].value=r)}return ge(()=>{l.inputParam.type==="text"&&i.value&&i.value.$refs.textarea.addEventListener("keydown",a)}),St(()=>{l.inputParam.type==="text"&&i.value&&i.value.$refs.textarea.removeEventListener("keydown",a)}),(s,r)=>{var C,c;const m=de,k=Xe,w=Pt,g=Ft,P=Oe,j=lt,I=Qe,z=Vt,N=je;return(((C=e.inputParam)==null?void 0:C.advanced)||!1)===e.advanced&&!["image","image-mask","range_scale"].includes(e.inputParam.type)?(u(),$(N,{key:0,class:le(["mb-3",{italic:(c=e.inputParam)==null?void 0:c.dynamic_lora}]),help:t(o)},{hint:h(()=>[e.inputParam.optional?F("",!0):(u(),O("span",po,"required"))]),label:h(()=>{var v;return[b("div",vo,[(v=e.inputParam)!=null&&v.dynamic_lora&&e.inputParam.trigger_words.length>0?(u(),$(w,{key:0},{panel:h(()=>[b("div",go,[r[7]||(r[7]=b("h4",{class:"mb-2 text-center"},"Trigger words",-1)),(u(!0),O(te,null,ve(e.inputParam.trigger_words,y=>(u(),$(k,{key:y,color:"violet",class:"mr-1 cursor-pointer",onClick:()=>{("useCopyToClipboard"in s?s.useCopyToClipboard:t(Ge))().copy(y),("useToast"in s?s.useToast:t(ke))().add({title:"Clipboard",description:"Trigger word copied to clipboard",timeout:2e3})}},{default:h(()=>[X(Q(y),1)]),_:2},1032,["onClick"]))),128))])]),default:h(()=>[f(m,{icon:"i-heroicons-information-circle",variant:"ghost",size:"xs",color:"gray",class:"mr-2"})]),_:1})):F("",!0),b("label",wo,Q(t(n)),1)])]}),default:h(()=>{var v;return[e.inputParam.type==="text"?(u(),$(g,{key:0,ref_key:"textareaInput",ref:i,size:"md",placeholder:e.inputParam.display_name,required:!e.inputParam.optional,resize:!0,label:e.inputParam.display_name,value:e.inputParamsMap[e.index][e.inputParam.name].value,autoresize:"",variant:"outline",onInput:r[0]||(r[0]=y=>{const V=y.target;e.inputParamsMap[e.index][e.inputParam.name].value=V.value})},null,8,["placeholder","required","label","value"])):F("",!0),e.inputParam.type==="number"?(u(),O(te,{key:1},[e.inputParam.name==="seed"?(u(),O("div",yo,[e.inputParam.type==="number"?(u(),$(P,{key:0,modelValue:e.inputParamsMap[e.index][e.inputParam.name].value,"onUpdate:modelValue":r[1]||(r[1]=y=>e.inputParamsMap[e.index][e.inputParam.name].value=y),type:"number",label:e.inputParam.display_name,required:!e.inputParam.optional,max:e.inputParam.max||100,min:e.inputParam.min||0,variant:"outline"},null,8,["modelValue","label","required","max","min"])):F("",!0),f(m,{icon:"i-heroicons-arrow-path",color:"violet",variant:"outline",size:"xs",class:"ml-2",onClick:r[2]||(r[2]=()=>{e.inputParamsMap[e.index][e.inputParam.name].value=Math.floor(Math.random()*1e7)})})])):(u(),$(P,{key:1,modelValue:e.inputParamsMap[e.index][e.inputParam.name].value,"onUpdate:modelValue":r[3]||(r[3]=y=>e.inputParamsMap[e.index][e.inputParam.name].value=y),type:"number",label:e.inputParam.display_name,required:!e.inputParam.optional,max:e.inputParam.max||100,min:e.inputParam.min||0,variant:"outline"},null,8,["modelValue","label","required","max","min"]))],64)):F("",!0),e.inputParam.type==="list"?(u(),$(j,{key:2,modelValue:e.inputParamsMap[e.index][e.inputParam.name].value,"onUpdate:modelValue":r[4]||(r[4]=y=>e.inputParamsMap[e.index][e.inputParam.name].value=y),placeholder:e.inputParam.display_name,options:Object.keys(e.inputParam.options)},null,8,["modelValue","placeholder","options"])):F("",!0),e.inputParam.type==="bool"?(u(),$(I,{key:3,modelValue:e.inputParamsMap[e.index][e.inputParam.name].value,"onUpdate:modelValue":r[5]||(r[5]=y=>e.inputParamsMap[e.index][e.inputParam.name].value=y),label:(v=e.inputParam)==null?void 0:v.display_name},null,8,["modelValue","label"])):F("",!0),["range","range_scale"].includes(e.inputParam.type)?(u(),$(z,{key:4,modelValue:e.inputParamsMap[e.index][e.inputParam.name].value,"onUpdate:modelValue":r[6]||(r[6]=y=>e.inputParamsMap[e.index][e.inputParam.name].value=y),label:e.inputParam.display_name,size:"sm",min:e.inputParam.min,max:e.inputParam.max,step:e.inputParam.step},null,8,["modelValue","label","min","max","step"])):F("",!0)]}),_:1},8,["class","help"])):F("",!0)}}}),bo={key:0,class:"heading"},ko={key:1},xo=Z({__name:"Params",props:{inputParamsMap:{type:Array,required:!0},additionalInputParamsMap:{type:Array,required:!1,default:[]},advanced:{type:Boolean,default:!1},flow:{type:Object,required:!0}},setup(e){const l=S(!0);return(n,o)=>{const i=xe,a=wt,s=ho;return u(),O(te,null,[e.advanced?(u(),O("div",bo,[b("h4",{class:"text-md font-bold cursor-pointer select-none flex items-center mb-3",onClick:o[0]||(o[0]=()=>{l.value=!t(l)})},[f(i,{name:t(l)?"i-heroicons-chevron-up":"i-heroicons-chevron-down",class:"mr-2"},null,8,["name"]),o[1]||(o[1]=X(" Advanced options "))])])):F("",!0),t(l)?(u(),O("div",ko,[e.flow.input_params.filter(r=>(r.advanced||!1)===e.advanced&&!["image","image-mask","range_scale"].includes(r.type)).length===0?(u(),$(a,{key:0,type:"info",class:"mb-3",variant:"soft",color:"cyan",title:e.advanced?"No advanced input params to adjust":"No input params to adjust"},null,8,["title"])):F("",!0),(u(!0),O(te,null,ve(e.flow.input_params,(r,m)=>(u(),$(s,{key:m,"input-params-map":e.inputParamsMap,index:m,"input-param":r,advanced:e.advanced},null,8,["input-params-map","index","input-param","advanced"]))),128)),(u(!0),O(te,null,ve(e.additionalInputParamsMap,(r,m)=>(u(),$(s,{key:Object.keys(r)[0],"input-params-map":e.additionalInputParamsMap,index:m,"input-param":r[Object.keys(r)[0]],advanced:e.advanced},null,8,["input-params-map","index","input-param","advanced"]))),128))])):F("",!0)],64)}}}),_o=mt(Me.ui.strategy,Me.ui.tabs,Hl),$o=Z({components:{UIcon:xe,HTabGroup:Ql,HTabList:Kl,HTab:Yl,HTabPanels:Zl,HTabPanel:en},inheritAttrs:!1,props:{modelValue:{type:Number,default:void 0},orientation:{type:String,default:"horizontal",validator:e=>["horizontal","vertical"].includes(e)},defaultIndex:{type:Number,default:0},items:{type:Array,default:()=>[]},unmount:{type:Boolean,default:!1},content:{type:Boolean,default:!0},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})}},emits:["update:modelValue","change"],setup(e,{emit:l}){const{ui:n,attrs:o}=pt("tabs",Be(e,"ui"),_o,Be(e,"class")),i=S(),a=S([]),s=S(),r=S(e.modelValue||e.defaultIndex);function m(w){var P;const g=(P=a.value[w])==null?void 0:P.$el;g&&s.value&&(s.value.style.top=`${g.offsetTop}px`,s.value.style.left=`${g.offsetLeft}px`,s.value.style.width=`${g.offsetWidth}px`,s.value.style.height=`${g.offsetHeight}px`)}function k(w){r.value=w,l("change",w),e.modelValue!==void 0&&l("update:modelValue",r.value),m(r.value)}return Wt(i,()=>{m(r.value)}),pe(()=>e.modelValue,w=>{r.value=w,m(r.value)}),pe(()=>e.items,async()=>{await bt(),m(r.value)},{deep:!0}),ge(async()=>{await bt(),m(r.value)}),Ml(()=>Rl()),{ui:n,attrs:o,listRef:i,itemRefs:a,markerRef:s,selectedIndex:r,onChange:k}}}),Co=["aria-label"],Io={class:"truncate"};function So(e,l,n,o,i,a){const s=xe,r=Se("HTab"),m=Se("HTabList"),k=Se("HTabPanel"),w=Se("HTabPanels"),g=Se("HTabGroup");return u(),$(g,Te({vertical:e.orientation==="vertical","selected-index":e.selectedIndex,as:"div",class:e.ui.wrapper},e.attrs,{onChange:e.onChange}),{default:h(()=>[f(m,{ref:"listRef",class:le([e.ui.list.base,e.ui.list.background,e.ui.list.rounded,e.ui.list.shadow,e.ui.list.padding,e.ui.list.width,e.orientation==="horizontal"&&e.ui.list.height,e.orientation==="horizontal"&&"inline-grid items-center"]),style:Ze([e.orientation==="horizontal"&&`grid-template-columns: repeat(${e.items.length}, minmax(0, 1fr))`])},{default:h(()=>[b("div",{ref:"markerRef",class:le(e.ui.list.marker.wrapper)},[b("div",{class:le([e.ui.list.marker.base,e.ui.list.marker.background,e.ui.list.marker.rounded,e.ui.list.marker.shadow])},null,2)],2),(u(!0),O(te,null,ve(e.items,(P,j)=>(u(),$(r,{key:j,ref_for:!0,ref:"itemRefs",disabled:P.disabled,as:"template"},{default:h(({selected:I,disabled:z})=>[b("button",{"aria-label":P.ariaLabel,class:le([e.ui.list.tab.base,e.ui.list.tab.background,e.ui.list.tab.height,e.ui.list.tab.padding,e.ui.list.tab.size,e.ui.list.tab.font,e.ui.list.tab.rounded,e.ui.list.tab.shadow,I?e.ui.list.tab.active:e.ui.list.tab.inactive])},[Fe(e.$slots,"icon",{item:P,index:j,selected:I,disabled:z},()=>[P.icon?(u(),$(s,{key:0,name:P.icon,class:le(e.ui.list.tab.icon)},null,8,["name","class"])):F("",!0)]),Fe(e.$slots,"default",{item:P,index:j,selected:I,disabled:z},()=>[b("span",Io,Q(P.label),1)])],10,Co)]),_:2},1032,["disabled"]))),128))]),_:3},8,["class","style"]),e.content?(u(),$(w,{key:0,class:le(e.ui.container)},{default:h(()=>[(u(!0),O(te,null,ve(e.items,(P,j)=>(u(),$(k,{key:j,class:le(e.ui.base),unmount:e.unmount},{default:h(({selected:I})=>[Fe(e.$slots,P.slot||"item",{item:P,index:j,selected:I},()=>[X(Q(P.content),1)])]),_:2},1032,["class","unmount"]))),128))]),_:3},8,["class"])):F("",!0)]),_:3},16,["vertical","selected-index","class","onChange"])}const Po=ft($o,[["render",So]]),Mo={class:"p-4"},Ro={class:"text-center mb-4"},Fo={class:"text-lg"},Uo={key:0,class:"text-sm text-slate-500"},Vo={class:"text-md text-center text-red-500 mb-4"},zo={key:1},To={class:"flex justify-center mb-4"},Oo={key:0,class:"text-sm text-slate-500 text-center mb-4"},jo={class:"flex items-center justify-between"},No=Z({__name:"Modal",props:He({flowResult:{type:Object,required:!1,default:()=>null},outputImgSrc:{type:String,required:!0},outputParamIndex:{type:Number,required:!0},inputParamsMapped:{type:Object,required:!0},isChildTask:{type:Boolean,required:!1,default:!1},translatePrompt:{type:Boolean,required:!1,default:!1}},{show:{default:!1,type:Boolean},showModifiers:{}}),emits:He(["update:show"],["update:show"]),setup(e,{emit:l}){const n=e,o=Le(e,"show"),i=[{key:"send-to-flow-output",label:"Send to flow"},{key:"send-to-flow-params",label:"Edit params",description:"Edit prompt params before sending to sub-flow"}],a=S(0),s=we(),r=ke(),m=B(()=>s.sub_flows.map(y=>({value:y.name,label:`${y.display_name} - ${y.description}`}))),k=S(m.value[0]||""),w=S({}),g=S([]),P=B(()=>g.value.every(y=>{if(!y||Object.keys(y).length===0)return!0;const V=Object.keys(y)[0],_=y[V];return _.optional?!0:_.type==="text"?_.value!=="":!0}));pe(()=>k.value,y=>{j(y)});function j(y){w.value=s.sub_flows.find(V=>V.name===y.value),w.value&&(g.value=w.value.input_params.reduce((V,_)=>{if(["image","image-mask","range_scale"].includes(_.type))return V.push({}),V;const p={[_.name]:{value:null,display_name:_.display_name,type:_.type,optional:_.optional,advanced:_.advanced||!1,default:_.default||"",dynamic_lora:_.dynamic_lora||!1,trigger_words:_.trigger_words||[]}};return _.type==="text"?(p[_.name].value=_.default||"",p[_.name].translatable=_.translatable||!1):_.type==="number"||_.type==="range"?(p[_.name].value=_.default||0,p[_.name].min=_.min||0,p[_.name].max=_.max||100,p[_.name].step=_.step||1):_.type==="list"?(p[_.name].value=Object.keys(_.options)[0]||"",p[_.name].default=Object.keys(_.options)[0]||""):_.type==="bool"&&(p[_.name].default=_.default||!1),V.push(p),V},[]),c.value=1)}const I=S(!1),z=l;function N(){console.debug("[Send to flow]: ",k.value);const y=s.sub_flows.find(_=>_.name===k.value.value&&_.display_name===k.value.label.split(" - ")[0]);if(console.debug("[Send to flow]: targetFlow",y),!y){ke().add({title:`Target sub-flow "${k.value.value}" not found`,description:"Please, verify the target sub-flow is installed and available and try again",timeout:5e3});return}if(!P.value){ke().add({title:"Missing required input params",description:"Please, fill in all required input params before sending to sub-flow",timeout:5e3}),a.value=1;return}const V=y.input_params.reduce((_,p)=>{const W={};let M=g.value.find(x=>Object.keys(x)[0]===p.name);return M=M?M[p.name].value:null,p.type==="text"?W[p.name]={value:M??(p.default||""),type:p.type}:p.type==="number"?W[p.name]={value:M??(p.default||0),type:p.type}:p.type==="image"?W[p.name]={value:JSON.stringify({task_id:n.flowResult.task_id,node_id:n.flowResult.outputs.length>1?n.flowResult.outputs[n.outputParamIndex].comfy_node_id:n.flowResult.outputs[0].comfy_node_id})||"",type:p.type}:p.type==="list"?W[p.name]={value:M??(p.default||Object.keys(p.options)[0]||""),type:p.type,options:p.options}:p.type==="bool"?W[p.name]={value:M??(p.default||!1),type:p.type}:["range","range_scale"].includes(p.type)&&(W[p.name]={value:M??(p.default||0),type:p.type}),_.push(W),_},[]);console.debug("[Send to flow]: input_params_map",V),I.value=!0,s.runFlow(y,V,c.value,n.translatePrompt,C.value,C.value?Number(n.flowResult.task_id):null).then(()=>{r.add({title:"Task sent to sub-flow",description:`Task ${n.flowResult.task_id} sent to sub-flow ${k.value.value}`,timeout:5e3})}).finally(()=>{I.value=!1,z("update:show",!1)})}const C=S(!1),c=S(1),v=B(()=>{var y;return n.flowResult.progress===100&&((y=n.flowResult)==null?void 0:y.error)===""});return pe(()=>c.value,y=>{y>1&&C.value&&(C.value=!1)}),ge(()=>{var V,_;const y=n.flowResult?((_=(V=n==null?void 0:n.flowResult)==null?void 0:V.outputs[n.outputParamIndex])==null?void 0:_.type)??"image":"image";s.fetchSubFlows(y).then(()=>{k.value=m.value[0]||"",j(k.value)}),C.value=!1}),(y,V)=>{const _=lt,p=Ve,W=wt,M=xo,x=Oe,d=je,R=Qe,H=Je,J=de,oe=Po,se=Ue;return u(),$(se,{modelValue:o.value,"onUpdate:modelValue":V[6]||(V[6]=ae=>o.value=ae),transition:!1},{default:h(()=>[b("div",Mo,[f(oe,{modelValue:t(a),"onUpdate:modelValue":V[5]||(V[5]=ae=>K(a)?a.value=ae:null),items:i,class:"w-full"},{item:h(({item:ae})=>[b("div",Ro,[b("h2",Fo,Q(ae.label),1),ae.description?(u(),O("p",Uo,Q(ae.description),1)):F("",!0)]),b("p",Vo,[t(m).length>0?(u(),$(_,{key:0,modelValue:t(k),"onUpdate:modelValue":V[0]||(V[0]=Y=>K(k)?k.value=Y:null),class:"w-full",searchable:"",size:"lg",options:t(m)},null,8,["modelValue","options"])):(u(),O("span",zo,"No sub-flows available"))]),ae.key==="send-to-flow-output"?(u(),O(te,{key:0},[b("div",To,[t(v)?(u(),$(p,{key:0,src:e.outputImgSrc,class:"w-1/2 rounded-lg",draggable:!1},null,8,["src"])):(u(),$(W,{key:1,color:"orange",icon:"i-heroicons-exclamation-circle-solid",title:`Task is still running (${Math.ceil(e.flowResult.progress)}%, ${e.flowResult.execution_time.toFixed(2)}s)`,description:e.flowResult.error!==""?e.flowResult.error:""},null,8,["title","description"]))]),e.inputParamsMapped?(u(),O("p",Oo,Q(["#"+e.flowResult.task_id,...Object.keys(e.inputParamsMapped).filter(Y=>e.inputParamsMapped[Y].value!=="").map(Y=>`${e.inputParamsMapped[Y].display_name}: ${e.inputParamsMapped[Y].value}`)].join(" | ")),1)):F("",!0)],64)):F("",!0),ae.key==="send-to-flow-params"?(u(),O(te,{key:1},[t(g).length>0?(u(),$(M,{key:0,"input-params-map":t(g),"onUpdate:inputParamsMap":V[1]||(V[1]=Y=>K(g)?g.value=Y:null),flow:t(w),advanced:!1},null,8,["input-params-map","flow"])):F("",!0),t(g).length>0?(u(),$(M,{key:1,"input-params-map":t(g),"onUpdate:inputParamsMap":V[2]||(V[2]=Y=>K(g)?g.value=Y:null),flow:t(w),advanced:!0},null,8,["input-params-map","flow"])):F("",!0),t(g).length===0?(u(),$(W,{key:2,class:"mb-4",title:"No input params",description:"No input params available for selected sub-flow",variant:"soft",color:"primary"})):F("",!0)],64)):F("",!0),e.isChildTask?(u(),$(W,{key:2,class:"mb-4",icon:"i-heroicons-exclamation-circle-solid",title:"Child task",description:"The latest child task is always used as input for sub-flow"})):F("",!0),t(w)&&t(w).is_count_supported?(u(),$(d,{key:3,label:"Number of results"},{default:h(()=>[f(x,{modelValue:t(c),"onUpdate:modelValue":V[3]||(V[3]=Y=>K(c)?c.value=Y:null),type:"number",min:"1",max:"50",label:"Batch size",class:"mb-3 max-w-fit flex justify-end"},null,8,["modelValue"])]),_:1})):F("",!0),b("div",jo,[f(H,{text:t(c)>1?"Multiple number of results is not supported for child tasks":""},{default:h(()=>[f(R,{modelValue:t(C),"onUpdate:modelValue":V[4]||(V[4]=Y=>K(C)?C.value=Y:null),label:"Bind as child task",disabled:t(c)>1},null,8,["modelValue","disabled"])]),_:1},8,["text"]),f(J,{icon:"i-heroicons-arrow-uturn-up-solid",color:"violet",variant:"outline",loading:t(I),disabled:t(m).length===0||e.isChildTask&&!t(v),onClick:N},{default:h(()=>V[7]||(V[7]=[X(" Send ")])),_:1,__:[7]},8,["loading","disabled"])])]),_:1},8,["modelValue"])])]),_:1},8,["modelValue"])}}}),Bo={class:"flex flex-col md:flex-row items-center justify-center mb-5 sticky top-1 z-[10]"},Lo={class:"flex items-center justify-center"},Ao={class:"p-4"},qo={class:"text-md text-center text-red-500 mb-4"},Eo={class:"flex justify-center"},Do={key:0,class:"results overflow-auto"},Wo=["id"],Ho={class:"text-sm text-slate-500 text-center mb-1"},Go={class:"w-5/6 mx-auto flex flex-wrap items-center justify-center"},Xo={class:"w-full flex justify-center items-center"},Jo={key:1,class:"text-center text-slate-500"},Qo=Z({__name:"Output",emits:["copy-prompt-inputs"],setup(e,{emit:l}){const n=we(),o=B(()=>{var M;return n.flowResultsByName((M=n.currentFlow)==null?void 0:M.name).length>0||!1}),i=B(()=>{var M;return n.flowResultsByName((M=n.currentFlow)==null?void 0:M.name)||[]}),a=B(()=>n.$state.resultsPageSize);pe(i,()=>{i.value.length<=n.$state.resultsPageSize?n.$state.resultsPage=1:n.$state.resultsPage>Math.ceil(i.value.length/n.$state.resultsPageSize)&&(n.$state.resultsPage=Math.ceil(i.value.length/n.$state.resultsPageSize))}),pe(a,()=>{i.value.length<=n.$state.resultsPageSize?n.$state.resultsPage=1:n.$state.resultsPage>Math.ceil(i.value.length/n.$state.resultsPageSize)&&(n.$state.resultsPage=Math.ceil(i.value.length/n.$state.resultsPageSize)),n.saveUserOptions()}),et(()=>{n.$state.flow_results_filter="",n.$state.resultsPage=1});const s=l;function r(M){s("copy-prompt-inputs",M.input_params_mapped)}function m(M){I.value=M,j.value=!0}const k=S(null),w=S(!1);window.addEventListener("scroll",()=>{var M;w.value=window.scrollY>(((M=k.value)==null?void 0:M.offsetTop)+window.screen.height||0)});const g=B(()=>n.$state.resultsPage);pe(g,()=>{const M=document.getElementById("output-container");M&&M.scrollIntoView({behavior:"smooth"})});const P=S(!1),j=S(!1),I=S(""),z=S(!1),N=S(!1),C=S(!1),c=S(""),v=S(null),y=S({}),V=S(0),_=S(!1);function p(M,x=0){if(M.child_tasks.length===0||!Xt(M,x,M.outputs[x].comfy_node_id))v.value=M,c.value=fe({task_id:M.task_id,node_id:M.outputs[x].comfy_node_id}),y.value=M.input_params_mapped,_.value=!1;else{const d=Gt(M,x,M.outputs[x].comfy_node_id);v.value=d,y.value=M.input_params_mapped,c.value=fe({task_id:d.task_id,node_id:d.outputs[0].comfy_node_id}),_.value=!0}V.value=x,C.value=!0}function W(M){var H;const x=M.extra_flags!==null&&((H=M==null?void 0:M.extra_flags)==null?void 0:H.profiler_execution),d=[{label:"Comfy flow",labelClass:"text-blue-500 text-sm",icon:"i-heroicons-arrow-down-tray",iconClass:"bg-blue-500 h-4 w-4",click:()=>{var J;return n.downloadFlowComfy((J=n.currentFlow)==null?void 0:J.name,M.task_id)}}];x&&d.push({label:"Execution details",labelClass:"text-orange-500 text-sm",icon:"i-mdi-bug",iconClass:"bg-orange-500 h-4 w-4",click:()=>{M.execution_details?M.showExecutionDetailsModal=!0:n.fetchTaskHistoryItem(M.task_id).then(J=>{M.execution_details=J.execution_details,M.showExecutionDetailsModal=!0})}});const R=[[{label:"Use params",labelClass:"text-cyan-500 text-sm",icon:"i-heroicons-document-duplicate-16-solid",iconClass:"bg-cyan-500 h-4 w-4",click:()=>r(M)}],d];return M.outputs.length===1&&M.outputs.every(J=>J.type==="image")&&R.splice(1,0,[{label:"Send to flow",labelClass:"text-violet-500 text-sm",icon:"i-heroicons-arrow-uturn-up-solid",iconClass:"bg-violet-500 h-4 w-4",click:()=>{p(M)}}]),R}return(M,x)=>{var G;const d=Sa,R=xe,H=Oe,J=Ol,oe=Ll,se=de,ae=gt,Y=Xe,be=Ue,ie=La,Re=Ga,$e=Ya,ue=to,ne=so,E=uo,T=fo,U=No,L=Ve;return u(),O("div",{id:"output-container",ref_key:"outputContainer",ref:k,class:"w-full p-4 ring-1 ring-gray-200 dark:ring-gray-800 rounded-lg shadow-md my-10"},[f(d,{show:t(w),class:"fixed bottom-5 right-5",target:"output-container"},null,8,["show"]),b("h2",{class:"text-lg font-bold cursor-pointer select-none flex items-center mb-3",onClick:x[0]||(x[0]=()=>{P.value=!t(P)})},[f(R,{name:t(P)?"i-heroicons-chevron-down":"i-heroicons-chevron-up",class:"mr-2"},null,8,["name"]),X(" Output ("+Q(t(i).filter(A=>A.parent_task_id===null).length)+") ",1)]),t(P)?F("",!0):(u(),O(te,{key:0},[b("div",Bo,[f(H,{modelValue:t(n).$state.flow_results_filter,"onUpdate:modelValue":x[1]||(x[1]=A=>t(n).$state.flow_results_filter=A),icon:"i-heroicons-magnifying-glass-20-solid",color:"white",class:"md:mr-3",label:"Filter by prompt",trailing:!0,placeholder:"Filter results by prompt"},null,8,["modelValue"]),t(i).filter(A=>A.parent_task_id===null).length>t(n).$state.resultsPageSize?(u(),$(J,{key:0,modelValue:t(n).$state.resultsPage,"onUpdate:modelValue":x[2]||(x[2]=A=>t(n).$state.resultsPage=A),class:"my-1 md:my-0","page-count":t(n).$state.resultsPageSize,total:t(i).filter(A=>A.parent_task_id===null).length,"show-first":"","show-last":""},null,8,["modelValue","page-count","total"])):F("",!0),b("div",Lo,[f(oe,{modelValue:t(n).resultsPageSize,"onUpdate:modelValue":x[3]||(x[3]=A=>t(n).resultsPageSize=A),class:"md:mx-3 w-fit mr-3",options:[5,10,20,50,100],label:"Results per page"},null,8,["modelValue"]),f(ae,{items:[[{label:"Delete all results",labelClass:"text-red-500",icon:"i-heroicons-trash",iconClass:"dark:text-red-500 text-red-500",click:()=>z.value=!0}]],mode:"click",label:"Options",popper:{placement:"bottom-end"}},{default:h(()=>[f(se,{color:"white",icon:"i-heroicons-ellipsis-vertical-16-solid"})]),_:1},8,["items"])]),f(be,{modelValue:t(z),"onUpdate:modelValue":x[6]||(x[6]=A=>K(z)?z.value=A:null),class:"z-[90]",transition:!1},{default:h(()=>[b("div",Ao,[x[15]||(x[15]=b("p",{class:"text-lg text-center mb-4"},"Are you sure you want to delete all results?",-1)),b("p",qo,[x[11]||(x[11]=X(" All history and images of ")),f(Y,{class:"mx-1",color:"orange",variant:"outline"},{default:h(()=>[X(Q(t(n).currentFlow.display_name),1)]),_:1}),x[12]||(x[12]=X(" will be deleted. "))]),b("div",Eo,[f(se,{class:"mr-2",color:"red",variant:"outline",loading:t(N),onClick:x[4]||(x[4]=()=>{var A;N.value=!0,t(n).deleteFlowResults((A=t(n).currentFlow)==null?void 0:A.name).then(()=>{N.value=!1,z.value=!1})})},{default:h(()=>x[13]||(x[13]=[X(" Yes ")])),_:1,__:[13]},8,["loading"]),f(se,{variant:"outline",onClick:x[5]||(x[5]=()=>z.value=!1)},{default:h(()=>x[14]||(x[14]=[X("No")])),_:1,__:[14]})])])]),_:1},8,["modelValue"])]),t(o)?(u(),O("div",Do,[(u(!0),O(te,null,ve(t(n).flowResultsByNamePaginated((G=t(n).currentFlow)==null?void 0:G.name),A=>(u(),O("div",{id:"task_id_"+A.task_id,key:A.task_id,class:"flex flex-col justify-center mx-auto mb-5"},[A.outputs.some(q=>["image","image-animated"].includes(q.type))?(u(),$(ie,{key:0,"flow-result":A,"handle-send-to-flow":p,"open-image-modal":m},null,8,["flow-result"])):A.outputs.some(q=>q.type==="video")?(u(),$(Re,{key:1,"flow-result":A},null,8,["flow-result"])):A.outputs.some(q=>q.type==="audio")?(u(),$($e,{key:2,"flow-result":A},null,8,["flow-result"])):A.outputs.some(q=>q.type==="text")?(u(),$(ue,{key:3,"flow-result":A},null,8,["flow-result"])):A.outputs.some(q=>q.type==="3d-model")?(u(),$(ne,{key:4,"flow-result":A},null,8,["flow-result"])):F("",!0),b("div",Ho,[b("div",Go,[f(E,{"flow-result":A},null,8,["flow-result"])])]),f(T,{"flow-result":A},null,8,["flow-result"]),b("div",Xo,[f(se,{class:"mr-3",color:"red",icon:"i-heroicons-trash",variant:"outline",size:"xs",onClick:()=>t(n).deleteFlowHistory(A.task_id)},{default:h(()=>x[16]||(x[16]=[X(" Delete ")])),_:2,__:[16]},1032,["onClick"]),f(ae,{items:W(A),mode:"click",popper:{placement:"bottom-start"}},{default:h(()=>[f(se,{color:"white",icon:"i-heroicons-ellipsis-vertical-16-solid",size:"xs"})]),_:2},1032,["items"])])],8,Wo))),128)),f(U,{show:t(C),"onUpdate:show":x[7]||(x[7]=A=>K(C)?C.value=A:null),"flow-result":t(v),"output-img-src":t(c),"output-param-index":t(V),"input-params-mapped":t(y),"is-child-task":t(_)},null,8,["show","flow-result","output-img-src","output-param-index","input-params-mapped","is-child-task"])])):(u(),O("p",Jo," No output results available "))],64)),f(be,{modelValue:t(j),"onUpdate:modelValue":x[10]||(x[10]=A=>K(j)?j.value=A:null),class:"z-[90]",transition:!1,fullscreen:""},{default:h(()=>[f(se,{class:"absolute top-4 right-4",icon:"i-heroicons-x-mark",variant:"ghost",onClick:x[8]||(x[8]=()=>j.value=!1)}),b("div",{class:"flex items-center justify-center w-full h-full p-4",onClick:x[9]||(x[9]=vt(()=>j.value=!1,["left"]))},[t(I)?(u(),$(L,{key:0,class:"lg:h-full",fit:"inside",loading:"lazy",src:t(I)},null,8,["src"])):F("",!0)])]),_:1},8,["modelValue"])],512)}}}),Ko=Fl("civitAiStore",{actions:{fetchFlowLoras(e,l,n=50,o=null){if(!e.lora_connect_points||Object.keys(e.lora_connect_points).length!==1){console.debug("Flow does not have lora_connect_points or has more than one, skipping fetching loras");return}const{$apiFetch:i}=Ye();let s=`https://civitai.com/api/v1/models?baseModels=${e.lora_connect_points[Object.keys(e.lora_connect_points)[0]].base_model_type}&types=LORA&limit=${n}`;o&&(o.includes(window.location.hostname)&&(o=o.replace(window.location.hostname,"civitai.com")),s=o);const r=`/other/proxy?target=${encodeURIComponent(s)}`;return i(r,{method:"GET",headers:{Authentication:"Bearer "+l,Accept:"application/json"}})},fetchFlowLorasByHash(e,l,n){if(!e.lora_connect_points||Object.keys(e.lora_connect_points).length!==1){console.debug("Flow does not have lora_connect_points or has more than one, skipping fetching loras");return}const{$apiFetch:o}=Ye(),i=`https://civitai.com/api/v1/model-versions/by-hash/${n}`,a=`/other/proxy?target=${encodeURIComponent(i)}`;return o(a,{method:"GET",headers:{Authentication:"Bearer "+l,Accept:"application/json"}})}}}),Yo={class:"p-4 overflow-y-auto relative"},Zo={key:1},es={class:"flex flex-col justify-between w-full md:flex-row md:gap-4 md:items-center lg:items-start"},ts={class:"flex flex-col gap-2 lg:flex-row md:justify-end items-start w-full"},ls={class:"flex flex-col md:flex-row flex-wrap gap-2 justify-between items-center w-full px-4 py-3"},ns={class:"flex items-center gap-1.5"},as={class:"flex gap-1.5 items-center"},os={class:"flex items-center h-5"},ss=["checked","indeterminate","onChange"],is=["href"],rs=["innerHTML"],us={class:"p-4 max-h-64 max-w-xl overflow-y-auto"},ds={key:0},cs={class:"flex items-center"},ms={class:"flex items-center"},fs={key:0,class:"flex justify-center space-x-2 w-full"},ps={key:1,controls:"",width:256,height:256},vs=["src"],gs={class:"flex justify-end"},ws=Z({__name:"LoraSelectorModal",props:He({flow:{}},{show:{default:!1,type:Boolean},showModifiers:{}}),emits:["update:show"],setup(e){const l=e,n=Le(e,"show"),o=ke(),i=we(),a=Et(),s=Ko(),r=S(!1),m=S({items:[],metadata:{}}),k=B(()=>a.settingsMap.civitai_auth_token.value!==""),w=B(()=>a.settingsMap.civitai_auth_token.value||""),g=[{key:"name",label:"Name",sortable:!0,class:""},{key:"description",label:"Description",sortable:!1,class:""},{key:"trigger_words",label:"Trigger words",sortable:!1,class:""},{key:"nsfw",label:"NSFW",sortable:!1,class:""},{key:"statsDownloadCount",label:"Download count",sortable:!1,class:""},{key:"statsThumbsUpCount",label:"Thumbs up",sortable:!1,class:""},{key:"modelVersion",label:"Model version",sortable:!1,class:""},{key:"actions",label:"Actions",sortable:!1,class:""}],P=S([]);pe(P,(T,U)=>{U.filter(G=>!T.includes(G)).forEach(G=>{G.currentFlowLora&&R(G)})});const j=S({openedRows:[],row:{}}),I=S(""),z=()=>{I.value=""},N=B(()=>{var U;let T=((U=m.value)==null?void 0:U.items)||[];return I.value&&(T=T.filter(L=>L.name.toLowerCase().includes(I.value.toLowerCase()))),T.forEach(L=>{!C.value[L.id]&&(L==null?void 0:L.modelVersions.length)>0&&(C.value[L.id]=L==null?void 0:L.modelVersions[0].name);const G=Object.keys(ue.value);L.modelVersions.forEach(A=>{G.includes(A.files[0].hashes.SHA256.toLowerCase())&&ue.value[A.files[0].hashes.SHA256.toLowerCase()]!==null&&(C.value[L.id]=A.name,L.currentFlowLora=!0,P.value.includes(L)||P.value.push(L))})}),T}),C=S({});function c(T){var U;return((U=T.modelVersions.find(L=>L.name===C.value[T.id]))==null?void 0:U.images)||T.modelVersions[0].images||[]}function v(T){var U;return((U=T.modelVersions.find(L=>L.name===C.value[T.id]))==null?void 0:U.trainedWords)||T.modelVersions[0].trainedWords||[]}const y=S(!0),V=S(""),_=S(l.flow.display_name),p=S(l.flow.description),W=S(l.flow.license),M=S(l.flow.required_memory_gb||0),x=S(l.flow.version);function d(){const T=Object.keys(l.flow.lora_connect_points)[0],L=l.flow.lora_connect_points[T].connected_loras.filter(q=>ue.value[q.hash]!==null).map(q=>({display_name:q.display_name,model_url:q.url,strength_model:q.strength_model})),G={[T]:[]};y.value&&G[T].push(...L);const A=P.value.reduce((q,ee)=>{const ce=ee.modelVersions.find(_e=>_e.name===C.value[ee.id]);if(!ce||ue.value[ce.files[0].hashes.SHA256.toLowerCase()])return q;const he={strength_model:1,model_url:ce.downloadUrl,display_name:ee.name};return q.push(he),q},[]);return G[T].push(...A),console.debug("[DEBUG] newFlowConnectionPoints: ",G),G}function R(T){const U=T.modelVersions.find(A=>A.name===C.value[T.id]);if(!U)return;const L=U.files[0].hashes.SHA256.toLowerCase();ue.value[L]&&(ue.value[L]=null);const G=P.value.indexOf(T);G!==-1&&P.value.splice(G,1),T.currentFlowLora=!1}const H=B(()=>i.flows.find(T=>T.name===V.value)),J=B(()=>/^[a-z0-9_-]+$/i.test(V.value)),oe=B(()=>V.value!==""&&J&&!H.value),se=B(()=>V.value===""?"Flow name is required.":J.value?H.value?"Flow name already exists.":"":"Flow name can only contain letters, numbers, dashes and underscores."),ae=B(()=>Object.values(ue.value).some(T=>T===null)),Y=B(()=>P.value.filter(T=>!ue.value[T.modelVersions[0].files[0].hashes.SHA256.toLowerCase()]).length!==0),be=B(()=>Y.value||ae.value),ie=B(()=>(Y.value||ae.value)&&oe.value&&_.value!==""&&p.value!==""),Re=B(()=>Y.value?oe.value?_.value===""?"Please provide a display name.":p.value===""?"Please provide a description.":"":"Please provide a valid flow name.":"No LoRAs selected");function $e(){if(P.value.length===0&&!ae.value){o.add({title:"No LoRAs selected",description:"Please select at least one LoRA to apply and install."});return}const T={new_name:V.value,new_display_name:_.value,new_description:p.value,new_license:W.value,new_required_memory_gb:M.value,new_version:x.value,new_lora_connection_points:d()};console.debug("[DEBUG] Clone flow params: ",T),r.value=!0,i.cloneFlow(l.flow,T).then(()=>{i.fetchFlows();const U=Jt();o.add({title:"Flow clone applied",actions:[{label:"View flow",click:()=>{U.push("/workflows/"+V.value)}}]})}).catch(U=>{console.error("Error applying and installing flow: ",U.message||"Unknown error"),o.add({title:"Error applying and installing flow",description:"An error occurred while applying and installing the flow. See the console for more details."})}).finally(()=>{r.value=!1})}const ue=S({});function ne(T=!1){const U=l.flow.lora_connect_points[Object.keys(l.flow.lora_connect_points)[0]].connected_loras;console.debug("Flow LORAs: ",U),Promise.all(U.map(L=>{var G;return(G=s.fetchFlowLorasByHash(l.flow,w.value,L.hash))==null?void 0:G.then(A=>((!(L.hash in ue.value)||T)&&(ue.value[L.hash]=A),A))})).then(()=>{console.debug("Fetched flow LORAs info: ",ue.value)}).catch(L=>{console.error("Error fetching flow LORAs info: ",L),o.add({title:"Error fetching flow LORAs info",description:"An error occurred while fetching LoRAs info for the flow. See the console for more details."})})}function E(T=!1){var L;if(!l.flow||!w.value)return;r.value=!0,T||ne();let U=null;return T&&((L=m.value.metadata)!=null&&L.nextPage)&&(U=m.value.metadata.nextPage),s.fetchFlowLoras(l.flow,w.value,50,U).then(G=>{console.debug('Fetched flow "'+l.flow.name+'" loras: ',G);const A=l.flow.lora_connect_points[Object.keys(l.flow.lora_connect_points)[0]].base_model_type,q=G.items.reduce((ee,ce)=>(ce.modelVersions=ce.modelVersions.filter(he=>he.baseModel===A),ce.modelVersions.length>0&&(m.value.items.find(he=>he.id===ce.id)||ee.push(ce)),ee),[]);return q.length===0&&o.add({title:"No more supported LoRAs",description:"No supported LoRAs available for the flow."}),m.value.items.push(...q),m.value.metadata=G.metadata,G}).catch(G=>{console.error('Error fetching flow "'+l.flow.name+'" loras: ',G),o.add({title:'Error fetching flow "'+l.flow.name+'" loras',description:"An error occurred while fetching LoRAs for the flow. See the console for more details."})}).finally(()=>{r.value=!1})}return(T,U)=>{const L=de,G=Ul,A=wt,q=Oe,ee=je,ce=Qe,he=Je,_e=Pt,Ae=Xe,qe=xe,at=lt,ot=Ve,st=Ne,re=Bl,nl=Qt,al=Ue;return u(),$(al,{modelValue:n.value,"onUpdate:modelValue":U[15]||(U[15]=D=>n.value=D),fullscreen:""},{default:h(()=>[b("div",Yo,[f(L,{class:"absolute top-3 right-3",icon:"i-heroicons-x-mark",variant:"ghost",onClick:U[0]||(U[0]=()=>n.value=!1)}),U[22]||(U[22]=b("h2",{class:"text-xl font-bold"},"Modify flow",-1)),U[23]||(U[23]=b("p",{class:"text-sm text-slate-500 my-2"}," Select LoRAs to modify the flow. New Flow will be created and installed with selected LoRAs. ",-1)),t(k)?(u(),O("div",Zo,[b("div",es,[f(L,{class:"my-1",variant:"outline",icon:"i-heroicons-arrow-down-on-square-stack",loading:t(r),onClick:U[1]||(U[1]=()=>{m.value={items:[],metadata:{}},ue.value={},z(),E()})},{default:h(()=>U[17]||(U[17]=[X(" Fetch LoRAs models from CivitAI ")])),_:1,__:[17]},8,["loading"]),b("div",ts,[f(ee,{label:"New flow name",class:"flex justify-center flex-col w-full",error:t(se)},{default:h(()=>[f(q,{modelValue:t(V),"onUpdate:modelValue":U[2]||(U[2]=D=>K(V)?V.value=D:null),type:"text",placeholder:"unique_flow_name",onInput:U[3]||(U[3]=D=>{D.target.value=D.target.value.toLowerCase(),V.value=D.target.value.toLowerCase()})},null,8,["modelValue"])]),_:1},8,["error"]),f(ee,{label:"New display name",class:"flex justify-center flex-col w-full",error:t(_)!==""?"":"Display name is required."},{default:h(()=>[f(q,{modelValue:t(_),"onUpdate:modelValue":U[4]||(U[4]=D=>K(_)?_.value=D:null),type:"text",placeholder:"Display name"},null,8,["modelValue"])]),_:1},8,["error"]),f(ee,{label:"New flow description",class:"flex justify-center flex-col w-full"},{default:h(()=>[f(q,{modelValue:t(p),"onUpdate:modelValue":U[5]||(U[5]=D=>K(p)?p.value=D:null),type:"text",placeholder:"Description"},null,8,["modelValue"])]),_:1}),f(ee,{label:"License (optional)",class:"flex justify-center flex-col w-full"},{default:h(()=>[f(q,{modelValue:t(W),"onUpdate:modelValue":U[6]||(U[6]=D=>K(W)?W.value=D:null),type:"text",placeholder:"License"},null,8,["modelValue"])]),_:1}),f(ee,{label:"Required memory (GB)",class:"flex justify-center flex-col w-full"},{default:h(()=>[f(q,{modelValue:t(M),"onUpdate:modelValue":U[7]||(U[7]=D=>K(M)?M.value=D:null),type:"text",placeholder:"Required memory (GB)"},null,8,["modelValue"])]),_:1}),f(ee,{label:"Version",class:"flex justify-center flex-col w-full"},{default:h(()=>[f(q,{modelValue:t(x),"onUpdate:modelValue":U[8]||(U[8]=D=>K(x)?x.value=D:null),type:"text",placeholder:"Version"},null,8,["modelValue"])]),_:1})])]),f(nl,{class:"w-full",ui:{base:"",ring:"",divide:"divide-y divide-gray-200 dark:divide-gray-700",header:{padding:"px-4 py-5"},body:{padding:"",base:"divide-y divide-gray-200 dark:divide-gray-700"},footer:{padding:"p-4"}}},{footer:h(()=>[b("div",gs,[f(L,{class:"mr-2",variant:"outline",icon:"i-heroicons-arrow-down-on-square-stack",color:"blue",disabled:t(m).items.length===0||t(m).items.length>0&&!t(m).metadata.nextPage,loading:t(r),onClick:U[14]||(U[14]=()=>{E(!0)})},{default:h(()=>U[21]||(U[21]=[X(" Load more ")])),_:1,__:[21]},8,["disabled","loading"])])]),default:h(()=>[b("div",ls,[b("div",ns,[f(q,{modelValue:t(I),"onUpdate:modelValue":U[9]||(U[9]=D=>K(I)?I.value=D:null),icon:"i-heroicons-magnifying-glass-20-solid",placeholder:"Filter by name..."},null,8,["modelValue"])]),b("div",as,[t(Y)?(u(),$(ce,{key:0,modelValue:t(y),"onUpdate:modelValue":U[10]||(U[10]=D=>K(y)?y.value=D:null),label:"Keep previous LoRAs",class:"mr-2"},null,8,["modelValue"])):F("",!0),t(be)?(u(),$(L,{key:1,variant:"outline",icon:"i-heroicons-x-circle",color:"orange",class:"mr-2",onClick:U[11]||(U[11]=()=>{t(P).splice(0),ne(!0)})},{default:h(()=>U[18]||(U[18]=[X(" Clear selection ")])),_:1,__:[18]})):F("",!0),f(he,{text:t(Re)},{default:h(()=>[f(L,{variant:"outline",icon:"i-heroicons-check-16-solid",disabled:!t(ie),loading:t(r),onClick:$e},{default:h(()=>U[19]||(U[19]=[X(" Apply and install ")])),_:1,__:[19]},8,["disabled","loading"])]),_:1},8,["text"])])]),f(re,{modelValue:t(P),"onUpdate:modelValue":U[12]||(U[12]=D=>K(P)?P.value=D:null),expand:t(j),"onUpdate:expand":U[13]||(U[13]=D=>K(j)?j.value=D:null),columns:g,rows:t(N),loading:t(r),ui:{thead:"sticky top-0 dark:bg-gray-800 bg-white z-10",tr:{base:"dark:hover:bg-slate-800"}}},{caption:h(()=>U[20]||(U[20]=[b("caption",{class:"text-slate-500 text-sm py-1"},"Only supported LORAs for the basic model type are listed",-1)])),"select-header":h(({indeterminate:D,checked:me,change:ol})=>[b("div",os,[b("input",{type:"checkbox",class:"h-4 w-4 dark:checked:bg-current dark:checked:border-transparent dark:indeterminate:bg-current dark:indeterminate:border-transparent disabled:opacity-50 disabled:cursor-not-allowed focus:ring-0 focus:ring-transparent focus:ring-offset-transparent form-checkbox rounded bg-white dark:bg-gray-900 border border-gray-300 dark:border-gray-700 focus-visible:ring-2 focus-visible:ring-primary-500 dark:focus-visible:ring-primary-400 focus-visible:ring-offset-2 focus-visible:ring-offset-white dark:focus-visible:ring-offset-gray-900 text-primary-500 dark:text-primary-400","aria-label":"Select row",checked:me,indeterminate:D&&t(Y),onChange:sl=>ol(sl.target.checked)},null,40,ss)])]),"name-data":h(({row:D})=>[b("a",{href:`https://civitai.com/models/${D.id}`,target:"_blank",class:"text-blue-500 underline"},Q(D.name),9,is)]),"description-data":h(({row:D})=>[f(_e,null,{panel:h(()=>[b("div",{class:"model-description p-4 max-h-64 max-w-xl overflow-y-auto",innerHTML:D.description},null,8,rs)]),default:h(()=>[f(L,{color:"white",label:"Description","trailing-icon":"i-heroicons-chevron-down-20-solid"})]),_:2},1024)]),"trigger_words-data":h(({row:D})=>[f(_e,null,{panel:h(()=>[b("div",us,[v(D).length===0?(u(),O("p",ds,"No trigger words available for this model version.")):(u(!0),O(te,{key:1},ve(v(D),me=>(u(),$(Ae,{key:me,class:"flex flex-wrap gap-3 my-1 whitespace-normal",label:me,color:"white",variant:"outline"},null,8,["label"]))),128))])]),default:h(()=>[f(L,{color:"white",label:`Trigger words (${v(D).length})`,"trailing-icon":"i-heroicons-chevron-down-20-solid"},null,8,["label"])]),_:2},1024)]),"nsfw-data":h(({row:D})=>[f(he,{text:`NSFW level: ${D.nsfwLevel}`,class:"pl-4"},{default:h(()=>[f(qe,{name:D.nsfw?"i-heroicons-x-circle":"i-heroicons-check-circle",class:le({"text-red-500":D.nsfw,"text-green-500":!D.nsfw})},null,8,["name","class"])]),_:2},1032,["text"])]),"statsThumbsUpCount-data":h(({row:D})=>[b("div",cs,[f(qe,{name:"i-heroicons-hand-thumb-up-solid",class:"text-green-500 mr-1"}),b("span",null,Q(D.stats.thumbsUpCount),1)])]),"statsDownloadCount-data":h(({row:D})=>[b("div",ms,[f(qe,{name:"i-heroicons-arrow-down-circle",class:"text-blue-500 mr-1"}),b("span",null,Q(D.stats.downloadCount),1)])]),"modelVersion-data":h(({row:D})=>[f(at,{modelValue:t(C)[D.id],"onUpdate:modelValue":me=>t(C)[D.id]=me,options:D.modelVersions.map(me=>me.name)},null,8,["modelValue","onUpdate:modelValue","options"])]),"actions-data":h(({row:D})=>[D!=null&&D.currentFlowLora?(u(),$(he,{key:1,text:"Remove previously selected LoRA"},{default:h(()=>[f(L,{icon:"i-heroicons-minus-16-solid",variant:"outline",color:"orange",onClick:me=>R(D)},null,8,["onClick"])]),_:2},1024)):(u(),$(L,{key:0,icon:t(P).includes(D)?"i-heroicons-check-16-solid":"i-heroicons-plus-16-solid",variant:"outline",color:t(P).includes(D)?"green":"white",onClick:()=>{if(t(P).includes(D)){t(P).splice(t(P).indexOf(D),1);return}t(P).push(D)}},null,8,["icon","color","onClick"]))]),expand:h(({row:D})=>[c(D).length>0?(u(),O("div",fs,[f(st,{class:"my-3",items:c(D).map(me=>({id:me.id,url:me.url,type:(me==null?void 0:me.type)||"image"})),ui:{item:"mx-1"}},{default:h(({item:me})=>[me.type==="image"?(u(),$(ot,{key:0,src:me.url,height:256,width:256,loading:"lazy",draggable:"false"},null,8,["src"])):(u(),O("video",ps,[b("source",{src:me.url},null,8,vs)]))]),_:2},1032,["items"])])):(u(),$(A,{key:1,title:"No images",description:"No images available for this model version.",variant:"soft",color:"amber"}))]),_:1},8,["modelValue","expand","rows","loading"])]),_:1})])):(u(),$(A,{key:0,class:"my-4",title:"CivitAI token missing",description:"Please add a CivitAI token in the settings to use this feature.",variant:"soft",color:"red"},{actions:h(()=>[f(G,{to:"/settings"},{default:h(()=>[f(L,{class:"lg:px-3 py-2",icon:"i-heroicons-arrow-top-right-on-square-16-solid",variant:"link",color:"white"},{default:h(()=>U[16]||(U[16]=[X(" Go to Settings ")])),_:1,__:[16]})]),_:1})]),_:1}))])]),_:1},8,["modelValue"])}}}),ys={class:"p-4 overflow-y-auto relative"},hs={class:"flex flex-col gap-2 mt-3"},bs={class:"flex justify-end mt-3"},ks=Z({__name:"EditMetadataModal",props:He({flow:{}},{show:{default:!1,type:Boolean},showModifiers:{}}),emits:["update:show"],setup(e){const l=e,n=Le(e,"show"),o=we(),i=ke(),a=S(!1),s=S(l.flow.display_name),r=S(l.flow.description),m=S(l.flow.license),k=S(l.flow.required_memory_gb||0),w=S(l.flow.version),g=B(()=>s.value!==""&&r.value!=="");function P(){a.value=!0,o.updateFlowMetadata(l.flow,{display_name:s.value,description:r.value,license:m.value,required_memory_gb:k.value,version:w.value}).then(()=>{n.value=!1,i.add({title:"Flow metadata updated",description:"Flow metadata has been updated successfully."})}).catch(j=>{console.debug("Failed to update flow metadata:",j),i.add({title:"Flow metadata update failed",description:(j==null?void 0:j.details)??"Failed to update flow metadata. Please try again."})}).finally(()=>{a.value=!1})}return(j,I)=>{const z=Oe,N=je,C=Ft,c=de,v=Ue;return u(),$(v,{modelValue:n.value,"onUpdate:modelValue":I[6]||(I[6]=y=>n.value=y)},{default:h(()=>[b("div",ys,[I[9]||(I[9]=b("h2",{class:"font-bold"},"Edit flow metadata",-1)),b("div",hs,[f(N,{label:"New display name",class:"flex justify-center flex-col w-full",error:t(s)!==""?"":"Display name is required."},{default:h(()=>[f(z,{modelValue:t(s),"onUpdate:modelValue":I[0]||(I[0]=y=>K(s)?s.value=y:null),type:"text",placeholder:"Display name"},null,8,["modelValue"])]),_:1},8,["error"]),f(N,{label:"New flow description",class:"flex justify-center flex-col w-full"},{default:h(()=>[f(C,{modelValue:t(r),"onUpdate:modelValue":I[1]||(I[1]=y=>K(r)?r.value=y:null),placeholder:"Description"},null,8,["modelValue"])]),_:1}),f(N,{label:"License (optional)",class:"flex justify-center flex-col w-full"},{default:h(()=>[f(z,{modelValue:t(m),"onUpdate:modelValue":I[2]||(I[2]=y=>K(m)?m.value=y:null),type:"text",placeholder:"License"},null,8,["modelValue"])]),_:1}),f(N,{label:"Required memory (GB)",class:"flex justify-center flex-col w-full"},{default:h(()=>[f(z,{modelValue:t(k),"onUpdate:modelValue":I[3]||(I[3]=y=>K(k)?k.value=y:null),type:"text",placeholder:"Required memory (GB)"},null,8,["modelValue"])]),_:1}),f(N,{label:"Version",class:"flex justify-center flex-col w-full"},{default:h(()=>[f(z,{modelValue:t(w),"onUpdate:modelValue":I[4]||(I[4]=y=>K(w)?w.value=y:null),type:"text",placeholder:"Version"},null,8,["modelValue"])]),_:1})]),b("div",bs,[f(c,{class:"mr-2",variant:"soft",color:"white",onClick:I[5]||(I[5]=y=>n.value=!1)},{default:h(()=>I[7]||(I[7]=[X(" Cancel ")])),_:1,__:[7]}),f(c,{variant:"soft",color:"primary",loading:t(a),disabled:!t(g),onClick:P},{default:h(()=>I[8]||(I[8]=[X(" Save ")])),_:1,__:[8]},8,["loading","disabled"])])])]),_:1},8,["modelValue"])}}}),xs={class:"flex flex-col lg:flex-row flex-grow items-start w-full"},_s={class:"card-wrapper w-full lg:pr-5"},$s={key:0,class:"p-0 text-sm"},Cs={class:"flex flex-row items-center text-slate-400 mb-2"},Is={class:"flex flex-row flex-wrap items-center text-md mb-2"},Ss=["href"],Ps={class:"flex flex-row items-center text-md mb-2"},Ms=["href"],Rs={key:1},Fs={class:"flex flex-row items-center text-md mb-2"},Us={key:0},Vs={class:"flex flex-row items-center text-md mb-2"},zs={key:0,class:"flex flex-row flex-wrap items-center text-md mb-2"},Ts=["href"],Os={key:1},js={class:"flex flex-row items-center mb-2"},Ns={key:1,class:"flex flex-row flex-wrap items-center text-md"},Bs={key:0,class:"flex justify-end"},Ls={class:"flex flex-row items-center justify-center text-sm mr-2"},As={key:1},qs={class:"text-sm flex justify-end"},Es={class:"flex flex-row items-center justify-center text-sm mr-3"},Ds={key:0,class:"text-right"},Ws={class:"prompt-wrapper w-full"},Hs={class:"flex items-center justify-between"},Gs={class:"pb-2"},Xs={class:"flex justify-end items-center"},ai=Z({__name:"[name]",setup(e){const l=Vl(),n=we(),o=ke();n.setCurrentFlow(l.params.name);const i=B(()=>n.flowInstallingByName(l.params.name)),a=B(()=>{var _;return i.value&&((_=i.value)==null?void 0:_.progress)<100||!1}),s=S(!1),r=B(()=>{var _;return i.value?"error"in i.value&&((_=i.value)==null?void 0:_.error)!==""?`${i.value.progress.toFixed(0)}% Error setting up`:`${i.value.progress.toFixed(0)}% Setting up`:"Setup flow"}),m=S(!1),k=S(!1),w=S(!1),g=S(!1),P=B(()=>{var p,W;const _=[[{label:"Export flow",icon:"i-heroicons-arrow-down-on-square-stack",click:()=>{n.fetchFlowDetails(n.currentFlow).then(M=>{console.debug("[DEBUG] Flow details for export: ",M);const x=new Blob([JSON.stringify(M==null?void 0:M.flow_comfy)],{type:"application/json"}),d=window.URL.createObjectURL(x),R=document.createElement("a");R.href=d,R.download=`${n.currentFlow.name}.json`,R.click(),window.URL.revokeObjectURL(d)}).catch(M=>{console.debug("Failed to fetch flow details for export: ",M),o.add({title:"Failed to export flow",description:(M==null?void 0:M.details)||"Failed to fetch flow details for export"})})}}],[{label:"Delete flow",icon:"i-heroicons-trash",click:I}]];return c.isAdmin&&_[0].unshift({label:"Edit metadata",icon:"i-heroicons-pencil-square",click:()=>{g.value=!0}}),((p=n==null?void 0:n.currentFlow)==null?void 0:p.new_version_available)!==""&&_[0].unshift({label:`Update to ${n.currentFlow.new_version_available}`,icon:"i-heroicons-arrow-path",click:()=>{n.updateFlow(n.currentFlow)}}),(W=n==null?void 0:n.currentFlow)!=null&&W.lora_connect_points&&Object.keys(n.currentFlow.lora_connect_points).length>0&&_[0].unshift({label:"Modify flow",icon:"i-heroicons-plus-circle",click:()=>{w.value=!0}}),_});function j(_,p=!1){m.value=!0,n.deleteFlow(_).then(()=>{p&&Jt().push("/")}).finally(()=>{m.value=!1,k.value=!1})}function I(){var p;const _=((p=n.currentFlow)==null?void 0:p.private)||!1;if(_){k.value=!0;return}j(n.currentFlow,_)}const z=S(!1),N=S(null),C=function(_){var p;(p=N.value)==null||p.copyPromptInputs(_)},c=Mt(),v=B(()=>{var _;return(_=n.currentFlow)==null?void 0:_.models.filter(p=>p.installed).reduce((p,W)=>p+(W==null?void 0:W.file_size)||0,0)}),y=B(()=>{var _;return(_=n.currentFlow)==null?void 0:_.models.reduce((p,W)=>p+(W==null?void 0:W.file_size)||0,0)}),V=B(()=>!v.value&&!y.value?"":v.value===y.value?` - ${We(y.value)}`:` - ${We(v.value)} / ${We(y.value)}`);return(_,p)=>{const W=xe,M=Je,x=Xe,d=de,R=gt,H=Qt,J=ra,oe=Ia,se=Qo,ae=Yt,Y=Ue,be=ws,ie=ks,Re=zl;return u(),$(Re,null,{default:h(()=>{var $e,ue;return[!t(n).loading.flows_available&&!t(n).loading.flows_installed&&t(n).currentFlow&&!t(n).$state.loading.tasks_history?(u(),O(te,{key:0},[b("div",xs,[b("div",_s,[f(H,{as:"div",class:"w-full mb-5"},Tl({header:h(()=>{var ne,E;return[b("h2",{class:"text-xl font-bold cursor-pointer select-none flex items-center",onClick:p[0]||(p[0]=()=>{z.value=!t(z)})},[(ne=t(n).currentFlow)!=null&&ne.private?(u(),$(M,{key:0,text:"This flow is local, manually added"},{default:h(()=>{var T;return[f(W,{name:"i-heroicons-lock-closed",class:le(["mr-2",{"text-stone-500":!((T=t(n).currentFlow)!=null&&T.is_supported_by_workers)}])},null,8,["class"])]}),_:1})):F("",!0),f(W,{name:t(z)?"i-heroicons-chevron-down":"i-heroicons-chevron-up",class:"mr-2"},null,8,["name"]),f(M,{text:(E=t(n).currentFlow)!=null&&E.is_supported_by_workers?"":"No workers capable of running this flow",popper:{placement:"top"}},{default:h(()=>{var T,U;return[b("span",{class:le({"text-stone-500":!((T=t(n).currentFlow)!=null&&T.is_supported_by_workers)})},Q((U=t(n).currentFlow)==null?void 0:U.display_name),3)]}),_:1},8,["text"])])]}),default:h(()=>{var ne,E,T,U,L,G,A,q,ee,ce,he,_e,Ae,qe,at,ot,st;return[t(z)?F("",!0):(u(),O("div",$s,[b("p",Cs,Q((ne=t(n).currentFlow)==null?void 0:ne.description),1),b("p",Is,[f(W,{name:"i-heroicons-user-16-solid",class:"mr-1"}),p[10]||(p[10]=b("b",null,"Author:",-1)),p[11]||(p[11]=X(" ")),b("a",{class:"hover:underline text-md",href:(E=t(n).currentFlow)==null?void 0:E.homepage,rel:"noopener",target:"_blank"},Q((T=t(n).currentFlow)==null?void 0:T.author),9,Ss)]),b("p",Ps,[f(W,{name:"i-heroicons-document-text",class:"mr-1"}),(U=t(n).currentFlow)!=null&&U.documentation?(u(),O("a",{key:0,class:"hover:underline",href:(L=t(n).currentFlow)==null?void 0:L.documentation,rel:"noopener",target:"_blank"}," Documentation ",8,Ms)):(u(),O("span",Rs,"No documentation"))]),b("p",Fs,[f(W,{name:"i-heroicons-clock",class:"mr-1"}),p[12]||(p[12]=b("b",null,"Version:",-1)),p[13]||(p[13]=X(" ")),b("span",null,Q((G=t(n).currentFlow)==null?void 0:G.version),1),((A=t(n).currentFlow)==null?void 0:A.new_version_available)!==""?(u(),O("span",Us," (new version available: "+Q((q=t(n).currentFlow)==null?void 0:q.new_version_available)+") ",1)):F("",!0)]),b("p",Vs,[f(W,{name:"i-heroicons-tag",class:"mr-1"}),p[14]||(p[14]=b("b",null,"Tags:",-1)),p[15]||(p[15]=X(" ")),((ee=t(n).currentFlow)==null?void 0:ee.tags.length)>0?(u(!0),O(te,{key:0},ve((ce=t(n).currentFlow)==null?void 0:ce.tags,re=>(u(),$(x,{key:re,label:re,color:"white",variant:"solid",class:"m-1"},null,8,["label"]))),128)):(u(),$(x,{key:1,label:"No tags",color:"white",variant:"solid",class:"m-1"}))]),((_e=(he=t(n).currentFlow)==null?void 0:he.models)==null?void 0:_e.length)>0?(u(),O("p",zs,[f(W,{name:"i-heroicons-arrow-down-on-square-stack",class:"mr-1"}),f(M,{text:t(y)-t(v)>0?`${("formatBytes"in _?_.formatBytes:t(We))(t(y)-t(v))} to download`:"All models installed",popper:{placement:"top"}},{default:h(()=>{var re;return[b("b",null,"Models ("+Q((re=t(n).currentFlow)==null?void 0:re.models.length)+Q(t(V))+"):",1),p[16]||(p[16]=X(" "))]}),_:1,__:[16]},8,["text"]),(u(!0),O(te,null,ve((Ae=t(n).currentFlow)==null?void 0:Ae.models,re=>(u(),$(x,{key:re.name,class:"m-1",color:"white",variant:"solid"},{default:h(()=>[f(M,{text:re.installed?"Model installed":"Model not installed"},{default:h(()=>[f(W,{name:re.installed?"i-heroicons-check-circle-20-solid":"i-heroicons-x-mark-20-solid",class:le(re.installed?"text-green-500":"text-orange-500")},null,8,["name","class"])]),_:2},1032,["text"]),re.gated?(u(),$(M,{key:0,text:"Gated model, requires auth token for download",popper:{placement:"top"}},{default:h(()=>[f(W,{name:"i-heroicons-key",class:"mr-1"})]),_:1})):F("",!0),b("a",{class:"hover:underline underline-offset-4",href:re.homepage,rel:"noopener",target:"_blank"},Q(re.name),9,Ts),re.file_size?(u(),O("span",Os," ("+Q(("formatBytes"in _?_.formatBytes:t(We))(re.file_size))+") ",1)):F("",!0)]),_:2},1024))),128))])):F("",!0),b("p",js,[f(W,{name:"i-mdi-help-network-outline",class:"mr-1"}),p[19]||(p[19]=b("b",null,"Platforms:",-1)),p[20]||(p[20]=X(" ")),f(M,{text:"Linux"},{default:h(()=>[f(W,{name:"i-mdi-linux",class:"mr-1"})]),_:1}),f(M,{text:"Microsoft Windows"},{default:h(()=>[f(W,{name:"i-mdi-microsoft-windows",class:"mr-1"})]),_:1}),t(n).currentFlow.is_macos_supported?(u(),$(M,{key:0,text:"macOS"},{default:h(()=>[f(W,{name:"i-mdi-apple",class:"mr-1"})]),_:1})):F("",!0),(qe=t(n).currentFlow)!=null&&qe.required_memory_gb?(u(),$(M,{key:1,class:"flex flex-row items-center",text:"Required VRAM memory (GB)"},{default:h(()=>{var re;return[p[17]||(p[17]=X(" (")),f(W,{name:"i-mdi-memory",class:"mr-1"}),b("span",null,Q((re=t(n).currentFlow)==null?void 0:re.required_memory_gb)+" GB",1),p[18]||(p[18]=X(") "))]}),_:1,__:[17,18]})):F("",!0)]),((ot=(at=t(n).currentFlow)==null?void 0:at.requires)==null?void 0:ot.length)>0?(u(),O("p",Ns,[p[21]||(p[21]=b("b",null,"Requires:",-1)),p[22]||(p[22]=X(" ")),(u(!0),O(te,null,ve((st=t(n).currentFlow)==null?void 0:st.requires,re=>(u(),$(x,{key:re,class:"m-1",color:"yellow",variant:"outline"},{default:h(()=>[X(Q(re),1)]),_:2},1024))),128))])):F("",!0)]))]}),_:2},[t(z)?void 0:{name:"footer",fn:h(()=>{var ne,E;return[t(c).isAdmin?(u(),O("div",Bs,[b("div",Ls,[f(W,{name:t(n).isFlowInstalled(t(l).params.name)?"i-heroicons-check-badge":"i-heroicons-x-mark",class:"mx-1"},null,8,["name"]),b("span",{class:le({"text-green-500":t(n).isFlowInstalled(t(l).params.name),"text-red-500":!t(n).isFlowInstalled(t(l).params.name),"text-stone-500":t(n).isFlowInstalled(t(l).params.name)&&!((ne=t(n).currentFlow)!=null&&ne.is_supported_by_workers)})},Q(t(n).isFlowInstalled(t(l).params.name)?(E=t(n).currentFlow)!=null&&E.is_supported_by_workers?"Installed":"Installed (no workers)":"Not installed"),3)]),t(n).isFlowInstalled(t(l).params.name)?F("",!0):(u(),$(M,{key:0,text:"Setup flow dependencies and configure it in ComfyUI",popper:{placement:"top"},"open-delay":500},{default:h(()=>[f(d,{icon:"i-heroicons-arrow-down-tray",class:"mx-3",color:"primary",variant:"outline",loading:t(a),onClick:p[1]||(p[1]=()=>t(n).setupFlow(t(n).currentFlow))},{default:h(()=>[X(Q(t(r)),1)]),_:1},8,["loading"])]),_:1})),!t(n).isFlowInstalled(t(l).params.name)&&t(a)?(u(),$(M,{key:1,text:"Cancel flow installation",popper:{placement:"top"},"open-delay":500},{default:h(()=>[f(d,{icon:"i-heroicons-stop",variant:"outline",color:"orange",loading:t(s),onClick:p[2]||(p[2]=()=>{s.value=!0,t(n).cancelFlowSetup(t(n).currentFlow).then(()=>{s.value=!1})})},{default:h(()=>p[23]||(p[23]=[X(" Cancel ")])),_:1,__:[23]},8,["loading"])]),_:1})):F("",!0),t(n).isFlowInstalled(t(l).params.name)?(u(),$(R,{key:2,items:t(P),mode:"click",label:"Actions",popper:{placement:"bottom-end"}},{default:h(()=>[f(d,{color:"white",label:"Actions","trailing-icon":"i-heroicons-chevron-down-20-solid"})]),_:1},8,["items"])):F("",!0)])):(u(),O("div",As,[b("div",qs,[b("div",Es,[f(W,{name:t(n).isFlowInstalled(t(l).params.name)?"i-heroicons-check-badge":"i-heroicons-x-mark",class:"mx-1"},null,8,["name"]),b("span",{class:le({"text-green-500":t(n).isFlowInstalled(t(l).params.name),"text-red-500":!t(n).isFlowInstalled(t(l).params.name)})},Q(t(n).isFlowInstalled(t(l).params.name)?"Installed":"Not installed"),3)]),t(n).isFlowInstalled(t(l).params.name)?F("",!0):(u(),O("div",Ds,p[24]||(p[24]=[b("p",{class:"text-orange-500"},"Only admin can manage workflows.",-1),b("span",{class:"text-slate-500"},"Ask your admin to setup this workflow",-1)])))])]))]}),key:"0"}]),1024)]),b("div",Ws,[!t(m)&&t(n).isFlowInstalled(t(l).params.name)?(u(),$(J,{key:0,ref_key:"workflowPrompt",ref:N},null,512)):F("",!0)])]),!t(m)&&t(n).isFlowInstalled(t(l).params.name)?(u(),$(oe,{key:0})):F("",!0),!t(m)&&t(n).isFlowInstalled(t(l).params.name)||t(n).flowResultsByName(t(l).params.name).length>0?(u(),$(se,{key:1,onCopyPromptInputs:p[3]||(p[3]=ne=>C(ne))})):F("",!0)],64)):(u(),$(ae,{key:1,class:"mb-3"})),f(Y,{modelValue:t(k),"onUpdate:modelValue":p[7]||(p[7]=ne=>K(k)?k.value=ne:null),"prevent-close":""},{default:h(()=>[f(H,{ui:{ring:"",divide:"divide-y divide-gray-100 dark:divide-gray-800"}},{header:h(()=>[b("div",Hs,[p[25]||(p[25]=b("h3",{class:"text-base font-semibold leading-6 text-gray-900 dark:text-white"}," Confirm workflow deletion ",-1)),f(d,{color:"gray",variant:"ghost",icon:"i-heroicons-x-mark-20-solid",class:"-my-1",onClick:p[4]||(p[4]=ne=>k.value=!1)})])]),default:h(()=>{var ne;return[b("p",Gs,[p[26]||(p[26]=X(" Are you sure you want to delete the ")),p[27]||(p[27]=b("b",null,"private",-1)),p[28]||(p[28]=X(" workflow ")),b("b",null,Q((ne=t(n).currentFlow)==null?void 0:ne.display_name),1),p[29]||(p[29]=X("? "))]),b("div",Xs,[f(d,{icon:"i-heroicons-x-mark-16-solid",variant:"outline",color:"green",class:"mr-2",onClick:p[5]||(p[5]=E=>k.value=!1)},{default:h(()=>p[30]||(p[30]=[X(" Cancel ")])),_:1,__:[30]}),f(d,{icon:"i-heroicons-trash",variant:"outline",color:"red",onClick:p[6]||(p[6]=E=>{var T;return j(t(n).currentFlow,((T=t(n).currentFlow)==null?void 0:T.private)||!1)})},{default:h(()=>p[31]||(p[31]=[X(" Delete ")])),_:1,__:[31]})])]}),_:1})]),_:1},8,["modelValue"]),t(c).isAdmin&&(($e=t(n))!=null&&$e.currentFlow)?(u(),$(be,{key:2,show:t(w),"onUpdate:show":p[8]||(p[8]=ne=>K(w)?w.value=ne:null),flow:t(n).currentFlow},null,8,["show","flow"])):F("",!0),t(c).isAdmin&&((ue=t(n))!=null&&ue.currentFlow)?(u(),$(ie,{key:3,show:t(g),"onUpdate:show":p[9]||(p[9]=ne=>K(g)?g.value=ne:null),flow:t(n).currentFlow},null,8,["show","flow"])):F("",!0)]}),_:1})}}});export{ai as default};
