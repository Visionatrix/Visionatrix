import{f as Y,N as C,Z as dt,$ as il,a0 as Lt,a1 as At,V as ge,a2 as et,a3 as _t,x as N,a4 as we,a5 as tt,a6 as zt,a7 as rl,a8 as yt,v as pe,a9 as ul,aa as Ke,ab as dl,F as te,ac as Ce,ad as it,ae as ut,af as cl,ag as Ee,ah as Ie,B as mt,ai as ml,C as Me,_ as ft,c as j,o as d,a as k,D as Fe,E as Te,n as le,H as pt,I as Be,aj as $t,ak as bt,K as ct,J as De,al as fl,am as pl,an as Tt,ao as kt,ap as vl,aq as gl,ar as Ot,T as Ye,as as qt,at as hl,p as t,au as wl,av as Ct,aw as yl,ax as Ze,ay as He,az as Le,g as he,M as It,W as St,aA as Se,i as $,k as R,w as b,b as f,r as ve,m as de,d as G,P as Q,aB as bl,s as be,aC as kl,t as J,aD as vt,Q as Pt,j as Je,q as Mt,z as xl,O as We,h as ke,y as Et,aE as Dt,l as Xe,aF as _l,aG as $l,aH as Wt,R as xt,aI as Ht,aJ as Gt,aK as fe,aL as Jt,aM as Cl,aN as Il,aO as Sl,S as Pl,G as Ml,aP as Xt,aQ as Rl,A as Fl,aR as Ul}from"./C-sDIiPu.js";import{b as gt,a as Vl,_ as Qt}from"./CxFfETnJ.js";import{t as zl,u as Kt,_ as Oe}from"./DbSF4-fX.js";import{a as Qe,_ as Yt}from"./9x9MKs0V.js";import{_ as Tl}from"./D5ENgeyb.js";import{_ as je}from"./ClsCkDye.js";import{_ as Ue}from"./B788zYor.js";import{_ as lt}from"./BsPmr68E.js";import{_ as ht}from"./C7ImCntW.js";import{_ as Ol}from"./CxPLV_qQ.js";import{_ as jl}from"./j_kgEEch.js";import{_ as Nl}from"./CYtDbvAB.js";const Bl={wrapper:"relative",container:"relative w-full flex overflow-x-auto snap-x snap-mandatory scroll-smooth",item:"flex flex-none snap-center",arrows:{wrapper:"flex items-center justify-between"},indicators:{wrapper:"absolute flex items-center justify-center gap-3 bottom-4 inset-x-0",base:"rounded-full h-3 w-3",active:"bg-primary-500 dark:bg-primary-400",inactive:"bg-gray-100 dark:bg-gray-800"},default:{prevButton:{color:"black",class:"rtl:[&_span:first-child]:rotate-180 absolute start-4 top-1/2 transform -translate-y-1/2 rounded-full",icon:"i-heroicons-chevron-left-20-solid"},nextButton:{color:"black",class:"rtl:[&_span:last-child]:rotate-180 absolute end-4 top-1/2 transform -translate-y-1/2 rounded-full",icon:"i-heroicons-chevron-right-20-solid"}}},Ll={wrapper:"relative w-full flex items-center",base:"w-full absolute appearance-none cursor-pointer disabled:cursor-not-allowed disabled:bg-opacity-50 focus:outline-none peer group",rounded:"rounded-lg",background:"bg-transparent",ring:"focus-visible:ring-2 focus-visible:ring-{color}-500 dark:focus-visible:ring-{color}-400 focus-visible:ring-offset-2 focus-visible:ring-offset-white dark:focus-visible:ring-offset-gray-900",progress:{base:"absolute pointer-events-none peer-disabled:bg-opacity-50",rounded:"rounded-s-lg",background:"bg-{color}-500 dark:bg-{color}-400",size:{"2xs":"h-px",xs:"h-0.5",sm:"h-1",md:"h-2",lg:"h-3",xl:"h-4","2xl":"h-5"}},thumb:{base:"[&::-webkit-slider-thumb]:relative [&::-moz-range-thumb]:relative [&::-webkit-slider-thumb]:z-[1] [&::-moz-range-thumb]:z-[1] [&::-webkit-slider-thumb]:appearance-none [&::-moz-range-thumb]:appearance-none [&::-webkit-slider-thumb]:rounded-full [&::-moz-range-thumb]:rounded-full [&::-moz-range-thumb]:border-0",color:"text-{color}-500 dark:text-{color}-400",background:"[&::-webkit-slider-thumb]:bg-white [&::-webkit-slider-thumb]:dark:bg-gray-900 [&::-moz-range-thumb]:bg-current",ring:"[&::-webkit-slider-thumb]:ring-2 [&::-webkit-slider-thumb]:ring-current",size:{"2xs":"[&::-webkit-slider-thumb]:h-1.5 [&::-moz-range-thumb]:h-1.5 [&::-webkit-slider-thumb]:w-1.5 [&::-moz-range-thumb]:w-1.5 [&::-webkit-slider-thumb]:mt-[-2.5px] [&::-moz-range-thumb]:mt-[-2.5px]",xs:"[&::-webkit-slider-thumb]:h-2 [&::-moz-range-thumb]:h-2 [&::-webkit-slider-thumb]:w-2 [&::-moz-range-thumb]:w-2 [&::-webkit-slider-thumb]:mt-[-3px] [&::-moz-range-thumb]:mt-[-3px]",sm:"[&::-webkit-slider-thumb]:h-3 [&::-moz-range-thumb]:h-3 [&::-webkit-slider-thumb]:w-3 [&::-moz-range-thumb]:w-3 [&::-webkit-slider-thumb]:-mt-1 [&::-moz-range-thumb]:-mt-1",md:"[&::-webkit-slider-thumb]:h-4 [&::-moz-range-thumb]:h-4 [&::-webkit-slider-thumb]:w-4 [&::-moz-range-thumb]:w-4 [&::-webkit-slider-thumb]:-mt-1 [&::-moz-range-thumb]:-mt-1",lg:"[&::-webkit-slider-thumb]:h-5 [&::-moz-range-thumb]:h-5 [&::-webkit-slider-thumb]:w-5 [&::-moz-range-thumb]:w-5 [&::-webkit-slider-thumb]:-mt-1 [&::-moz-range-thumb]:-mt-1",xl:"[&::-webkit-slider-thumb]:h-6 [&::-moz-range-thumb]:h-6 [&::-webkit-slider-thumb]:w-6 [&::-moz-range-thumb]:w-6 [&::-webkit-slider-thumb]:-mt-1 [&::-moz-range-thumb]:-mt-1","2xl":"[&::-webkit-slider-thumb]:h-7 [&::-moz-range-thumb]:h-7 [&::-webkit-slider-thumb]:w-7 [&::-moz-range-thumb]:w-7 [&::-webkit-slider-thumb]:-mt-1 [&::-moz-range-thumb]:-mt-1"}},track:{base:"[&::-webkit-slider-runnable-track]:group-disabled:bg-opacity-50 [&::-moz-range-track]:group-disabled:bg-opacity-50",background:"[&::-webkit-slider-runnable-track]:bg-gray-200 [&::-moz-range-track]:bg-gray-200 [&::-webkit-slider-runnable-track]:dark:bg-gray-700 [&::-moz-range-track]:dark:bg-gray-700",rounded:"[&::-webkit-slider-runnable-track]:rounded-lg [&::-moz-range-track]:rounded-lg",size:{"2xs":"[&::-webkit-slider-runnable-track]:h-px [&::-moz-range-track]:h-px",xs:"[&::-webkit-slider-runnable-track]:h-0.5 [&::-moz-range-track]:h-0.5",sm:"[&::-webkit-slider-runnable-track]:h-1 [&::-moz-range-track]:h-1",md:"[&::-webkit-slider-runnable-track]:h-2 [&::-moz-range-track]:h-2",lg:"[&::-webkit-slider-runnable-track]:h-3 [&::-moz-range-track]:h-3",xl:"[&::-webkit-slider-runnable-track]:h-4 [&::-moz-range-track]:h-4","2xl":"[&::-webkit-slider-runnable-track]:h-5 [&::-moz-range-track]:h-5"}},size:{"2xs":"h-1.5",xs:"h-2",sm:"h-3",md:"h-4",lg:"h-5",xl:"h-6","2xl":"h-7"},default:{size:"md",color:"primary"}},Al={wrapper:"relative space-y-2",container:"relative w-full",base:"focus:outline-none",list:{base:"relative",background:"bg-gray-100 dark:bg-gray-800",rounded:"rounded-lg",shadow:"",padding:"p-1",height:"h-10",width:"w-full",marker:{wrapper:"absolute top-[4px] left-[4px] duration-200 ease-out focus:outline-none",base:"w-full h-full",background:"bg-white dark:bg-gray-900",rounded:"rounded-md",shadow:"shadow-sm"},tab:{base:"relative inline-flex items-center justify-center flex-shrink-0 w-full ui-focus-visible:outline-0 ui-focus-visible:ring-2 ui-focus-visible:ring-primary-500 dark:ui-focus-visible:ring-primary-400 ui-not-focus-visible:outline-none focus:outline-none disabled:cursor-not-allowed disabled:opacity-75 transition-colors duration-200 ease-out",background:"",active:"text-gray-900 dark:text-white",inactive:"text-gray-500 dark:text-gray-400",height:"h-8",padding:"px-3",size:"text-sm",font:"font-medium",rounded:"rounded-md",shadow:"",icon:"w-4 h-4 flex-shrink-0 me-2"}}};let ql=Y({props:{onFocus:{type:Function,required:!0}},setup(e){let l=C(!0);return()=>l.value?dt(Lt,{as:"button",type:"button",features:il.Focusable,onFocus(n){n.preventDefault();let s,r=50;function o(){var i;if(r--<=0){s&&cancelAnimationFrame(s);return}if((i=e.onFocus)!=null&&i.call(e)){l.value=!1,cancelAnimationFrame(s);return}s=requestAnimationFrame(o)}s=requestAnimationFrame(o)}}):null}});var El=(e=>(e[e.Forwards=0]="Forwards",e[e.Backwards=1]="Backwards",e))(El||{}),Dl=(e=>(e[e.Less=-1]="Less",e[e.Equal=0]="Equal",e[e.Greater=1]="Greater",e))(Dl||{});let Zt=Symbol("TabsContext");function nt(e){let l=_t(Zt,null);if(l===null){let n=new Error(`<${e} /> is missing a parent <TabGroup /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(n,nt),n}return l}let Rt=Symbol("TabsSSRContext"),Wl=Y({name:"TabGroup",emits:{change:e=>!0},props:{as:{type:[Object,String],default:"template"},selectedIndex:{type:[Number],default:null},defaultIndex:{type:[Number],default:0},vertical:{type:[Boolean],default:!1},manual:{type:[Boolean],default:!1}},inheritAttrs:!1,setup(e,{slots:l,attrs:n,emit:s}){var r;let o=C((r=e.selectedIndex)!=null?r:e.defaultIndex),i=C([]),u=C([]),m=N(()=>e.selectedIndex!==null),x=N(()=>m.value?e.selectedIndex:o.value);function h(U){var O;let I=Ke(g.tabs.value,we),c=Ke(g.panels.value,we),v=I.filter(w=>{var V;return!((V=we(w))!=null&&V.hasAttribute("disabled"))});if(U<0||U>I.length-1){let w=ut(o.value===null?0:Math.sign(U-o.value),{[-1]:()=>1,0:()=>ut(Math.sign(U),{[-1]:()=>0,0:()=>0,1:()=>1}),1:()=>0}),V=ut(w,{0:()=>I.indexOf(v[0]),1:()=>I.indexOf(v[v.length-1])});V!==-1&&(o.value=V),g.tabs.value=I,g.panels.value=c}else{let w=I.slice(0,U),V=[...I.slice(U),...w].find(p=>v.includes(p));if(!V)return;let _=(O=I.indexOf(V))!=null?O:g.selectedIndex.value;_===-1&&(_=g.selectedIndex.value),o.value=_,g.tabs.value=I,g.panels.value=c}}let g={selectedIndex:N(()=>{var U,O;return(O=(U=o.value)!=null?U:e.defaultIndex)!=null?O:null}),orientation:N(()=>e.vertical?"vertical":"horizontal"),activation:N(()=>e.manual?"manual":"auto"),tabs:i,panels:u,setSelectedIndex(U){x.value!==U&&s("change",U),m.value||h(U)},registerTab(U){var O;if(i.value.includes(U))return;let I=i.value[o.value];if(i.value.push(U),i.value=Ke(i.value,we),!m.value){let c=(O=i.value.indexOf(I))!=null?O:o.value;c!==-1&&(o.value=c)}},unregisterTab(U){let O=i.value.indexOf(U);O!==-1&&i.value.splice(O,1)},registerPanel(U){u.value.includes(U)||(u.value.push(U),u.value=Ke(u.value,we))},unregisterPanel(U){let O=u.value.indexOf(U);O!==-1&&u.value.splice(O,1)}};yt(Zt,g);let M=C({tabs:[],panels:[]}),z=C(!1);ge(()=>{z.value=!0}),yt(Rt,N(()=>z.value?null:M.value));let S=N(()=>e.selectedIndex);return ge(()=>{pe([S],()=>{var U;return h((U=e.selectedIndex)!=null?U:e.defaultIndex)},{immediate:!0})}),ul(()=>{if(!m.value||x.value==null||g.tabs.value.length<=0)return;let U=Ke(g.tabs.value,we);U.some((O,I)=>we(g.tabs.value[I])!==we(O))&&g.setSelectedIndex(U.findIndex(O=>we(O)===we(g.tabs.value[x.value])))}),()=>{let U={selectedIndex:o.value};return dt(te,[i.value.length<=0&&dt(ql,{onFocus:()=>{for(let O of i.value){let I=we(O);if((I==null?void 0:I.tabIndex)===0)return I.focus(),!0}return!1}}),tt({theirProps:{...n,...dl(e,["selectedIndex","defaultIndex","manual","vertical","onChange"])},ourProps:{},slot:U,slots:l,attrs:n,name:"TabGroup"})])}}}),Hl=Y({name:"TabList",props:{as:{type:[Object,String],default:"div"}},setup(e,{attrs:l,slots:n}){let s=nt("TabList");return()=>{let r={selectedIndex:s.selectedIndex.value},o={role:"tablist","aria-orientation":s.orientation.value};return tt({ourProps:o,theirProps:e,slot:r,attrs:l,slots:n,name:"TabList"})}}}),Gl=Y({name:"Tab",props:{as:{type:[Object,String],default:"button"},disabled:{type:[Boolean],default:!1},id:{type:String,default:null}},setup(e,{attrs:l,slots:n,expose:s}){var r;let o=(r=e.id)!=null?r:`headlessui-tabs-tab-${At()}`,i=nt("Tab"),u=C(null);s({el:u,$el:u}),ge(()=>i.registerTab(u)),et(()=>i.unregisterTab(u));let m=_t(Rt),x=N(()=>{if(m.value){let c=m.value.tabs.indexOf(o);return c===-1?m.value.tabs.push(o)-1:c}return-1}),h=N(()=>{let c=i.tabs.value.indexOf(u);return c===-1?x.value:c}),g=N(()=>h.value===i.selectedIndex.value);function M(c){var v;let w=c();if(w===it.Success&&i.activation.value==="auto"){let V=(v=cl(u))==null?void 0:v.activeElement,_=i.tabs.value.findIndex(p=>we(p)===V);_!==-1&&i.setSelectedIndex(_)}return w}function z(c){let v=i.tabs.value.map(w=>we(w)).filter(Boolean);if(c.key===Ce.Space||c.key===Ce.Enter){c.preventDefault(),c.stopPropagation(),i.setSelectedIndex(h.value);return}switch(c.key){case Ce.Home:case Ce.PageUp:return c.preventDefault(),c.stopPropagation(),M(()=>Ee(v,Ie.First));case Ce.End:case Ce.PageDown:return c.preventDefault(),c.stopPropagation(),M(()=>Ee(v,Ie.Last))}if(M(()=>ut(i.orientation.value,{vertical(){return c.key===Ce.ArrowUp?Ee(v,Ie.Previous|Ie.WrapAround):c.key===Ce.ArrowDown?Ee(v,Ie.Next|Ie.WrapAround):it.Error},horizontal(){return c.key===Ce.ArrowLeft?Ee(v,Ie.Previous|Ie.WrapAround):c.key===Ce.ArrowRight?Ee(v,Ie.Next|Ie.WrapAround):it.Error}}))===it.Success)return c.preventDefault()}let S=C(!1);function U(){var c;S.value||(S.value=!0,!e.disabled&&((c=we(u))==null||c.focus({preventScroll:!0}),i.setSelectedIndex(h.value),zl(()=>{S.value=!1})))}function O(c){c.preventDefault()}let I=rl(N(()=>({as:e.as,type:l.type})),u);return()=>{var c,v;let w={selected:g.value,disabled:(c=e.disabled)!=null?c:!1},{...V}=e,_={ref:u,onKeydown:z,onMousedown:O,onClick:U,id:o,role:"tab",type:I.value,"aria-controls":(v=we(i.panels.value[h.value]))==null?void 0:v.id,"aria-selected":g.value,tabIndex:g.value?0:-1,disabled:e.disabled?!0:void 0};return tt({ourProps:_,theirProps:V,slot:w,attrs:l,slots:n,name:"Tab"})}}}),Jl=Y({name:"TabPanels",props:{as:{type:[Object,String],default:"div"}},setup(e,{slots:l,attrs:n}){let s=nt("TabPanels");return()=>{let r={selectedIndex:s.selectedIndex.value};return tt({theirProps:e,ourProps:{},slot:r,attrs:n,slots:l,name:"TabPanels"})}}}),Xl=Y({name:"TabPanel",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},id:{type:String,default:null},tabIndex:{type:Number,default:0}},setup(e,{attrs:l,slots:n,expose:s}){var r;let o=(r=e.id)!=null?r:`headlessui-tabs-panel-${At()}`,i=nt("TabPanel"),u=C(null);s({el:u,$el:u}),ge(()=>i.registerPanel(u)),et(()=>i.unregisterPanel(u));let m=_t(Rt),x=N(()=>{if(m.value){let M=m.value.panels.indexOf(o);return M===-1?m.value.panels.push(o)-1:M}return-1}),h=N(()=>{let M=i.panels.value.indexOf(u);return M===-1?x.value:M}),g=N(()=>h.value===i.selectedIndex.value);return()=>{var M;let z={selected:g.value},{tabIndex:S,...U}=e,O={ref:u,id:o,role:"tabpanel","aria-labelledby":(M=we(i.tabs.value[h.value]))==null?void 0:M.id,tabIndex:g.value?S:-1};return!g.value&&e.unmount&&!e.static?dt(Lt,{as:"span","aria-hidden":!0,...O}):tt({ourProps:O,theirProps:U,slot:z,attrs:l,slots:n,features:zt.Static|zt.RenderStrategy,visible:g.value,name:"TabPanel"})}}});const ze=mt(Me.ui.strategy,Me.ui.textarea,ml),Ql=Y({inheritAttrs:!1,props:{modelValue:{type:[String,Number],default:""},id:{type:String,default:null},name:{type:String,default:null},placeholder:{type:String,default:null},required:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},rows:{type:Number,default:3},maxrows:{type:Number,default:0},autoresize:{type:Boolean,default:!1},autofocus:{type:Boolean,default:!1},autofocusDelay:{type:Number,default:100},resize:{type:Boolean,default:!1},padded:{type:Boolean,default:!0},size:{type:String,default:null,validator(e){return Object.keys(ze.size).includes(e)}},color:{type:String,default:()=>ze.default.color,validator(e){return[...Me.ui.colors,...Object.keys(ze.color)].includes(e)}},variant:{type:String,default:()=>ze.default.variant,validator(e){return[...Object.keys(ze.variant),...Object.values(ze.color).flatMap(l=>Object.keys(l))].includes(e)}},textareaClass:{type:String,default:null},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})},modelModifiers:{type:Object,default:()=>({})}},emits:["update:modelValue","blur","change"],setup(e,{emit:l}){const{ui:n,attrs:s}=pt("textarea",Be(e,"ui"),ze,Be(e,"class")),{emitFormBlur:r,emitFormInput:o,inputId:i,color:u,size:m,name:x}=Kt(e,ze),h=C($t({},e.modelModifiers,{trim:!1,lazy:!1,number:!1,nullify:!1})),g=C(null),M=()=>{var v;e.autofocus&&((v=g.value)==null||v.focus())},z=()=>{if(e.autoresize){if(!g.value)return;g.value.rows=e.rows;const v=g.value.style.overflow;g.value.style.overflow="hidden";const w=window.getComputedStyle(g.value),V=Number.parseInt(w.paddingTop),_=Number.parseInt(w.paddingBottom),p=V+_,D=Number.parseInt(w.lineHeight),{scrollHeight:P}=g.value,a=(P-p)/D;a>e.rows&&(g.value.rows=e.maxrows?Math.min(a,e.maxrows):a),g.value.style.overflow=v}},S=v=>{h.value.trim&&(v=v.trim()),h.value.number&&(v=fl(v)),h.value.nullify&&(v||(v=null)),l("update:modelValue",v),o()},U=v=>{z(),h.value.lazy||S(v.target.value)},O=v=>{const w=v.target.value;l("change",w),h.value.lazy&&S(w),h.value.trim&&(v.target.value=w.trim())},I=v=>{l("blur",v),r()};ge(()=>{setTimeout(()=>{M()},e.autofocusDelay)}),pe(()=>e.modelValue,()=>{bt(z)}),ge(()=>{setTimeout(()=>{M(),z()},100)});const c=N(()=>{var w,V;const v=((V=(w=n.value.color)==null?void 0:w[u.value])==null?void 0:V[e.variant])||n.value.variant[e.variant];return ct(De(n.value.base,n.value.form,n.value.rounded,n.value.placeholder,n.value.size[m.value],e.padded?n.value.padding[m.value]:"p-0",v==null?void 0:v.replaceAll("{color}",u.value),!e.resize&&"resize-none"),e.textareaClass)});return{ui:n,attrs:s,name:x,inputId:i,textarea:g,textareaClass:c,onInput:U,onChange:O,onBlur:I}}}),Kl=["id","value","name","rows","required","disabled","placeholder"];function Yl(e,l,n,s,r,o){return d(),j("div",{class:le(e.ui.wrapper)},[k("textarea",Te({id:e.inputId,ref:"textarea",value:e.modelValue,name:e.name,rows:e.rows,required:e.required,disabled:e.disabled,placeholder:e.placeholder,class:e.textareaClass},e.attrs,{onInput:l[0]||(l[0]=(...i)=>e.onInput&&e.onInput(...i)),onBlur:l[1]||(l[1]=(...i)=>e.onBlur&&e.onBlur(...i)),onChange:l[2]||(l[2]=(...i)=>e.onChange&&e.onChange(...i))}),null,16,Kl),Fe(e.$slots,"default")],2)}const Ft=ft(Ql,[["render",Yl]]);async function Zl(e,l){return await en(l).catch(s=>(console.error("Failed to get image meta for "+l,s+""),{width:0,height:0,ratio:0}))}async function en(e){if(typeof Image>"u")throw new TypeError("Image not supported");return new Promise((l,n)=>{const s=new Image;s.onload=()=>{const r={width:s.width,height:s.height,ratio:s.width/s.height};l(r)},s.onerror=r=>n(r),s.src=e})}function jt(e){return l=>l?e[l]||l:e.missingValue}function tn({formatter:e,keyMap:l,joinWith:n="/",valueMap:s}={}){e||(e=(o,i)=>`${o}=${i}`),l&&typeof l!="function"&&(l=jt(l));const r=s||{};return Object.keys(r).forEach(o=>{typeof r[o]!="function"&&(r[o]=jt(r[o]))}),(o={})=>Object.entries(o).filter(([u,m])=>typeof m<"u").map(([u,m])=>{const x=r[u];return typeof x=="function"&&(m=x(o[u])),u=typeof l=="function"?l(u):u,e(u,m)}).join(n)}function Pe(e=""){if(typeof e=="number")return e;if(typeof e=="string"&&e.replace("px","").match(/^\d+$/g))return Number.parseInt(e,10)}function ln(e=""){if(e===void 0||!e.length)return[];const l=new Set;for(const n of e.split(" ")){const s=Number.parseInt(n.replace("x",""));s&&l.add(s)}return Array.from(l)}function nn(e){if(e.length===0)throw new Error("`densities` must not be empty, configure to `1` to render regular size only (DPR 1.0)")}function an(e){const l={};if(typeof e=="string")for(const n of e.split(/[\s,]+/).filter(s=>s)){const s=n.split(":");s.length!==2?l["1px"]=s[0].trim():l[s[0].trim()]=s[1].trim()}else Object.assign(l,e);return l}function on(e){const l={options:e},n=(r,o={})=>el(l,r,o),s=(r,o={},i={})=>n(r,{...i,modifiers:$t(o,i.modifiers||{})}).url;for(const r in e.presets)s[r]=(o,i,u)=>s(o,i,{...e.presets[r],...u});return s.options=e,s.getImage=n,s.getMeta=(r,o)=>sn(l,r,o),s.getSizes=(r,o)=>dn(l,r,o),l.$img=s,s}async function sn(e,l,n){const s=el(e,l,{...n});return typeof s.getMeta=="function"?await s.getMeta():await Zl(e,s.url)}function el(e,l,n){var x,h;if(l&&typeof l!="string")throw new TypeError(`input must be a string (received ${typeof l}: ${JSON.stringify(l)})`);if(!l||l.startsWith("data:"))return{url:l};const{provider:s,defaults:r}=rn(e,n.provider||e.options.provider),o=un(e,n.preset);if(l=Tt(l)?l:pl(l),!s.supportsAlias){for(const g in e.options.alias)if(l.startsWith(g)){const M=e.options.alias[g];M&&(l=kt(M,l.slice(g.length)))}}if(s.validateDomains&&Tt(l)){const g=vl(l).host;if(!e.options.domains.find(M=>M===g))return{url:l}}const i=$t(n,o,r);i.modifiers={...i.modifiers};const u=i.modifiers.format;(x=i.modifiers)!=null&&x.width&&(i.modifiers.width=Pe(i.modifiers.width)),(h=i.modifiers)!=null&&h.height&&(i.modifiers.height=Pe(i.modifiers.height));const m=s.getImage(l,i,e);return m.format=m.format||u||"",m}function rn(e,l){const n=e.options.providers[l];if(!n)throw new Error("Unknown provider: "+l);return n}function un(e,l){if(!l)return{};if(!e.options.presets[l])throw new Error("Unknown preset: "+l);return e.options.presets[l]}function dn(e,l,n){var S,U,O,I,c;const s=Pe((S=n.modifiers)==null?void 0:S.width),r=Pe((U=n.modifiers)==null?void 0:U.height),o=an(n.sizes),i=(O=n.densities)!=null&&O.trim()?ln(n.densities.trim()):e.options.densities;nn(i);const u=s&&r?r/s:0,m=[],x=[];if(Object.keys(o).length>=1){for(const v in o){const w=Nt(v,String(o[v]),r,u,e);if(w!==void 0){m.push({size:w.size,screenMaxWidth:w.screenMaxWidth,media:`(max-width: ${w.screenMaxWidth}px)`});for(const V of i)x.push({width:w._cWidth*V,src:Bt(e,l,n,w,V)})}}cn(m)}else for(const v of i){const w=Object.keys(o)[0];let V=w?Nt(w,String(o[w]),r,u,e):void 0;V===void 0&&(V={size:"",screenMaxWidth:0,_cWidth:(I=n.modifiers)==null?void 0:I.width,_cHeight:(c=n.modifiers)==null?void 0:c.height}),x.push({width:v,src:Bt(e,l,n,V,v)})}mn(x);const h=x[x.length-1],g=m.length?m.map(v=>`${v.media?v.media+" ":""}${v.size}`).join(", "):void 0,M=g?"w":"x",z=x.map(v=>`${v.src} ${v.width}${M}`).join(", ");return{sizes:g,srcset:z,src:h==null?void 0:h.src}}function Nt(e,l,n,s,r){const o=r.options.screens&&r.options.screens[e]||Number.parseInt(e),i=l.endsWith("vw");if(!i&&/^\d+$/.test(l)&&(l=l+"px"),!i&&!l.endsWith("px"))return;let u=Number.parseInt(l);if(!o||!u)return;i&&(u=Math.round(u/100*o));const m=s?Math.round(u*s):n;return{size:l,screenMaxWidth:o,_cWidth:u,_cHeight:m}}function Bt(e,l,n,s,r){return e.$img(l,{...n.modifiers,width:s._cWidth?s._cWidth*r:void 0,height:s._cHeight?s._cHeight*r:void 0},n)}function cn(e){var n;e.sort((s,r)=>s.screenMaxWidth-r.screenMaxWidth);let l=null;for(let s=e.length-1;s>=0;s--){const r=e[s];r.media===l&&e.splice(s,1),l=r.media}for(let s=0;s<e.length;s++)e[s].media=((n=e[s+1])==null?void 0:n.media)||""}function mn(e){e.sort((n,s)=>n.width-s.width);let l=null;for(let n=e.length-1;n>=0;n--){const s=e[n];s.width===l&&e.splice(n,1),l=s.width}}const fn=tn({keyMap:{format:"f",fit:"fit",width:"w",height:"h",resize:"s",quality:"q",background:"b"},joinWith:"&",formatter:(e,l)=>Ot(e)+"_"+Ot(l)}),pn=(e,{modifiers:l={},baseURL:n}={},s)=>{l.width&&l.height&&(l.resize=`${l.width}x${l.height}`,delete l.width,delete l.height);const r=fn(l)||"_";return n||(n=kt(s.options.nuxt.baseURL,"/_ipx")),{url:kt(n,r,gl(e))}},vn=!0,gn=!0,hn=Object.freeze(Object.defineProperty({__proto__:null,getImage:pn,supportsAlias:gn,validateDomains:vn},Symbol.toStringTag,{value:"Module"})),tl={screens:{xs:320,sm:640,md:768,lg:1024,xl:1280,xxl:1536,"2xl":1536},presets:{},provider:"ipxStatic",domains:[],alias:{},densities:[1,2],format:["webp"]};tl.providers={ipxStatic:{provider:hn,defaults:{}}};const Ut=()=>{const e=qt(),l=Ye();return l.$img||l._img||(l._img=on({...tl,nuxt:{baseURL:e.app.baseURL},runtimeConfig:e}))};function wn(e){var l;(l=performance==null?void 0:performance.mark)==null||l.call(performance,"mark_feature_usage",{detail:{feature:e}})}const yn={src:{type:String,required:!1},format:{type:String,required:!1},quality:{type:[Number,String],required:!1},background:{type:String,required:!1},fit:{type:String,required:!1},modifiers:{type:Object,required:!1},preset:{type:String,required:!1},provider:{type:String,required:!1},sizes:{type:[Object,String],required:!1},densities:{type:String,required:!1},preload:{type:[Boolean,Object],required:!1},width:{type:[String,Number],required:!1},height:{type:[String,Number],required:!1},alt:{type:String,required:!1},referrerpolicy:{type:String,required:!1},usemap:{type:String,required:!1},longdesc:{type:String,required:!1},ismap:{type:Boolean,required:!1},loading:{type:String,required:!1,validator:e=>["lazy","eager"].includes(e)},crossorigin:{type:[Boolean,String],required:!1,validator:e=>["anonymous","use-credentials","",!0,!1].includes(e)},decoding:{type:String,required:!1,validator:e=>["async","auto","sync"].includes(e)},nonce:{type:[String],required:!1}},bn=e=>{const l=N(()=>({provider:e.provider,preset:e.preset})),n=N(()=>({width:Pe(e.width),height:Pe(e.height),alt:e.alt,referrerpolicy:e.referrerpolicy,usemap:e.usemap,longdesc:e.longdesc,ismap:e.ismap,crossorigin:e.crossorigin===!0?"anonymous":e.crossorigin||void 0,loading:e.loading,decoding:e.decoding,nonce:e.nonce})),s=Ut(),r=N(()=>({...e.modifiers,width:Pe(e.width),height:Pe(e.height),format:e.format,quality:e.quality||s.options.quality,background:e.background,fit:e.fit}));return{options:l,attrs:n,modifiers:r}},kn={...yn,placeholder:{type:[Boolean,String,Number,Array],required:!1},placeholderClass:{type:String,required:!1},custom:{type:Boolean,required:!1}},xn=["src"],Ve=Y({__name:"NuxtImg",props:kn,emits:["load","error"],setup(e,{emit:l}){const n=e,s=hl(),r=l,o=!1,i=Ut(),u=bn(n),m=C(!1),x=C(),h=N(()=>i.getSizes(n.src,{...u.options.value,sizes:n.sizes,densities:n.densities,modifiers:{...u.modifiers.value,width:Pe(n.width),height:Pe(n.height)}})),g=N(()=>{const I={...u.attrs.value,"data-nuxt-img":""};return(!n.placeholder||m.value)&&(I.sizes=h.value.sizes,I.srcset=h.value.srcset),I}),M=N(()=>{let I=n.placeholder;if(I===""&&(I=!0),!I||m.value)return!1;if(typeof I=="string")return I;const c=Array.isArray(I)?I:typeof I=="number"?[I,I]:[10,10];return i(n.src,{...u.modifiers.value,width:c[0],height:c[1],quality:c[2]||50,blur:c[3]||3},u.options.value)}),z=N(()=>n.sizes?h.value.src:i(n.src,u.modifiers.value,u.options.value)),S=N(()=>M.value?M.value:z.value),O=Ye().isHydrating;return ge(()=>{if(M.value||n.custom){const I=new Image;z.value&&(I.src=z.value),n.sizes&&(I.sizes=h.value.sizes||"",I.srcset=h.value.srcset),I.onload=c=>{m.value=!0,r("load",c)},I.onerror=c=>{r("error",c)},wn("nuxt-image");return}x.value&&(x.value.complete&&O&&(x.value.getAttribute("data-error")?r("error",new Event("error")):r("load",new Event("load"))),x.value.onload=I=>{r("load",I)},x.value.onerror=I=>{r("error",I)})}),(I,c)=>I.custom?Fe(I.$slots,"default",wl(Te({key:1},{...t(o)?{onerror:"this.setAttribute('data-error', 1)"}:{},imgAttrs:{...g.value,...t(s)},isLoaded:m.value,src:S.value}))):(d(),j("img",Te({key:0,ref_key:"imgEl",ref:x,class:n.placeholder&&!m.value?n.placeholderClass:void 0},{...t(o)?{onerror:"this.setAttribute('data-error', 1)"}:{},...g.value,...t(s)},{src:S.value}),null,16,xn))}}),rt=mt(Me.ui.strategy,Me.ui.range,Ll),_n=Y({inheritAttrs:!1,props:{modelValue:{type:Number,default:0},id:{type:String,default:null},name:{type:String,default:null},disabled:{type:Boolean,default:!1},min:{type:Number,default:0},max:{type:Number,default:100},step:{type:Number,default:1},size:{type:String,default:null,validator(e){return Object.keys(rt.size).includes(e)}},color:{type:String,default:()=>rt.default.color,validator(e){return Me.ui.colors.includes(e)}},inputClass:{type:String,default:null},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})}},emits:["update:modelValue","change"],setup(e,{emit:l}){const{ui:n,attrs:s}=pt("range",Be(e,"ui"),rt),{emitFormChange:r,inputId:o,color:i,size:u,name:m}=Kt(e,rt),x=N({get(){return e.modelValue},set(I){l("update:modelValue",I)}}),h=I=>{l("change",I.target.value),r()},g=N(()=>ct(De(n.value.wrapper,n.value.size[u.value]),e.class)),M=N(()=>ct(De(n.value.base,n.value.background,n.value.rounded,i.value&&n.value.ring.replaceAll("{color}",i.value),n.value.size[u.value]),e.inputClass)),z=N(()=>De(n.value.thumb.base,i.value&&n.value.thumb.color.replaceAll("{color}",i.value),n.value.thumb.ring,n.value.thumb.background,n.value.thumb.size[u.value])),S=N(()=>De(n.value.track.base,n.value.track.background,n.value.track.rounded,n.value.track.size[u.value])),U=N(()=>De(n.value.progress.base,n.value.progress.rounded,i.value&&n.value.progress.background.replaceAll("{color}",i.value),n.value.progress.size[u.value])),O=N(()=>{const{modelValue:I,min:c,max:v}=e;return{width:`${(Math.max(c,Math.min(I,v))-c)/(v-c)*100}%`}});return{ui:n,attrs:s,name:m,inputId:o,value:x,wrapperClass:g,inputClass:M,thumbClass:z,trackClass:S,progressClass:U,progressStyle:O,onChange:h}}}),$n=["id","name","min","max","disabled","step"];function Cn(e,l,n,s,r,o){return d(),j("div",{class:le(e.wrapperClass)},[Ct(k("input",Te({id:e.inputId,ref:"input","onUpdate:modelValue":l[0]||(l[0]=i=>e.value=i),name:e.name,min:e.min,max:e.max,disabled:e.disabled,step:e.step,type:"range",class:[e.inputClass,e.thumbClass,e.trackClass]},e.attrs,{onChange:l[1]||(l[1]=(...i)=>e.onChange&&e.onChange(...i))}),null,16,$n),[[yl,e.value,void 0,{number:!0}]]),k("span",{class:le(e.progressClass),style:Ze(e.progressStyle)},null,6)],2)}const Vt=ft(_n,[["render",Cn]]),In={class:"image-mask flex flex-col w-full"},Sn={class:"canvas flex flex-col items-center justify-center mb-3 w-full"},Pn={class:"preview-over-original relative"},Mn={class:"actions flex items-center justify-center mb-3 mx-auto"},Rn={class:"options w-full max-w-[320px]"},Fn=Y({__name:"ImageInpaint",props:He({imageSrc:{type:String,required:!0}},{imageInpaintMask:{default:"",type:String},imageInpaintMaskModifiers:{},imageInpaintMaskData:{default:{},type:Object},imageInpaintMaskDataModifiers:{}}),emits:["update:imageInpaintMask","update:imageInpaintMaskData"],setup(e){const l=e,n=Le(e,"imageInpaintMask"),s=Le(e,"imageInpaintMaskData"),r=he(),o=C(null),i=C(null),u=C(null),m=C(null),x=C(30),h=C([]),g=C({width:r.$state.outputMaxSize,height:r.$state.outputMaxSize}),M=C(null),z=C({x:0,y:0}),S=C({x:0,y:0,radius:x.value,fill:"rgba(255, 255, 255, 0.5)",stroke:null,strokeWidth:0,visible:!1}),U=C(5),O=C(!1),I=C([]),c=C([]);function v(){if(!o.value||!u.value){console.error("Could not get stage, image layer, or mask layer");return}const q=o.value.getNode(),T=m.value?m.value.width:q.width(),F=m.value?m.value.height:q.height(),L=document.createElement("canvas");L.width=T,L.height=F;const H=L.getContext("2d");if(!H){console.error("Could not get 2d context for mask canvas");return}H.fillStyle="black",H.fillRect(0,0,T,F);const B=T/q.width(),A=F/q.height();H.fillStyle="white",h.value.forEach(ce=>{H.beginPath(),H.arc(ce.x*B,ce.y*A,ce.radius*Math.max(B,A),0,Math.PI*2,!0),H.closePath(),H.fill()});const Z=L.toDataURL("image/png",1);Z?(a(),n.value=Z,S.value.visible=!1,O.value=!1):console.error("Could not get data URI for masked image")}function w(q){const T=o.value.getNode();if(q.type.startsWith("touch")){const F=q.evt.touches[0]||q.evt.changedTouches[0];return{x:F.clientX-T.getContainer().offsetLeft,y:F.clientY-T.getContainer().offsetTop}}return T.getPointerPosition()}function V(q){q.type==="mousedown"&&q.evt.button!==0||(O.value=!0,z.value=w(q),P(),_(z.value))}function _(q){const T={x:q.x,y:q.y,radius:x.value,fill:"rgba(255, 255, 255, 1)"};h.value=h.value.filter(F=>!(p({x:F.x,y:F.y},q)+F.radius<=T.radius)),h.value.push(T)}function p(q,T){return Math.sqrt(Math.pow(T.x-q.x,2)+Math.pow(T.y-q.y,2))}function D(q){if(q.type.startsWith("touch")&&q.evt.preventDefault(),oe(q),!O.value)return;const T=w(q);p(z.value,w(q))>=U.value&&(_(T),z.value=T)}function P(){I.value.push([...h.value]),c.value=[]}function a(){s.value={circles:[...h.value],brushRadius:x.value,undoStack:I.value,redoStack:c.value}}function y(){s.value!==null&&(h.value=s.value.circles||[],x.value=s.value.brushRadius||30,I.value=s.value.undoStack||[],c.value=s.value.redoStack||[])}function W(){I.value.length!==0&&(c.value.push([...h.value]),h.value=I.value.pop()||[])}function X(){c.value.length!==0&&(I.value.push([...h.value]),h.value=c.value.pop()||[])}function ee(){O.value=!1}function ie(){n.value=""}function se(){P(),h.value=[],n.value=""}const ae=N(()=>I.value.length>0),K=N(()=>c.value.length>0);function oe(q){const T=w(q);S.value.x=T.x,S.value.y=T.y}function _e(){S.value.visible=!1,O.value=!1}function Re(){S.value.visible=!0,S.value.radius=x.value}function $e(){const q=new Image;q.src=l.imageSrc,q.onload=()=>{m.value=q,ue(),ne()}}function ue(){if(!m.value)return;const q=window.innerWidth,T=window.innerHeight,F=m.value.width/m.value.height;let L,H;const B=Math.min(q*.9,1200),A=Math.min(T*.8,r.outputMaxSize);F>B/A?(L=B,H=L/F):(H=A,L=H*F),g.value={width:Math.floor(L),height:Math.floor(H)},ne()}function ne(){const q=g.value.width,T=g.value.height,F=m.value.width,L=m.value.height,H=q/F,B=T/L,A=Math.min(H,B);M.value={x:0,y:0,width:F*A,height:L*A}}return It(()=>{$e(),y()}),ge(()=>{if(o.value){const q=o.value.getNode();q.on("touchstart",V),q.on("touchmove",D),q.on("touchend",ee),q.on("touchcancel",_e)}}),St(()=>{if(o.value){const q=o.value.getNode();q.off("touchstart"),q.off("touchmove"),q.off("touchend"),q.off("touchcancel")}a()}),(q,T)=>{const F=Ve,L=Se("v-image"),H=Se("v-layer"),B=Se("v-circle"),A=Se("v-stage"),Z=de,ce=Vt,ye=je;return d(),j("div",In,[k("div",Sn,[T[1]||(T[1]=k("p",{class:"text-sm my-2 text-slate-500"},"Select the target area for image inpaint",-1)),k("div",Pn,[e.imageSrc&&e.imageSrc!==""&&n.value!==""?(d(),$(F,{key:0,src:e.imageSrc,fit:"inside",width:t(g).width,height:t(g).height,draggable:"false",class:le({absolute:n.value!==""})},null,8,["src","width","height","class"])):R("",!0),n.value?(d(),$(F,{key:1,src:n.value,fit:"inside",width:t(g).width,height:t(g).height,draggable:"false",class:"opacity-50"},null,8,["src","width","height"])):R("",!0)]),n.value===""?(d(),$(A,{key:0,ref_key:"stageRef",ref:o,config:t(g),onMousedown:V,onMousemove:D,onMouseup:ee,onMouseleave:_e,onMouseenter:Re},{default:b(()=>[f(H,{ref_key:"imageLayerRef",ref:i},{default:b(()=>[f(L,{image:t(m),config:t(g)},null,8,["image","config"])]),_:1},512),f(H,{ref_key:"maskLayerRef",ref:u},{default:b(()=>[(d(!0),j(te,null,ve(t(h),(xe,Ae)=>(d(),$(B,{key:Ae,config:xe},null,8,["config"]))),128)),t(S).visible?(d(),$(B,{key:0,config:t(S)},null,8,["config"])):R("",!0)]),_:1},512)]),_:1},8,["config"])):R("",!0)]),k("div",Mn,[f(Z,{class:"mr-2",size:"xs",icon:"i-heroicons-clipboard-document-check-16-solid",variant:"soft",disabled:t(h).length===0||n.value!=="",onClick:v},{default:b(()=>T[2]||(T[2]=[G(" Apply ")])),_:1},8,["disabled"]),f(Z,{class:"mr-2",size:"xs",icon:"i-heroicons-arrow-uturn-left-16-solid",variant:"soft",color:"cyan",disabled:!t(ae)||n.value!=="",onClick:W},null,8,["disabled"]),f(Z,{class:"mr-2",size:"xs",icon:"i-heroicons-arrow-uturn-right-16-solid",variant:"soft",color:"cyan",disabled:!t(K)||n.value!=="",onClick:X},null,8,["disabled"]),f(Z,{class:"mr-2",size:"xs",icon:"i-heroicons-arrow-turn-up-left-20-solid",variant:"soft",disabled:t(h).length===0&&n.value==="",color:"red",onClick:se},{default:b(()=>T[3]||(T[3]=[G(" Reset ")])),_:1},8,["disabled"]),f(Z,{size:"xs",icon:"i-heroicons-pencil-solid",variant:"soft",disabled:n.value==="",color:"orange",onClick:ie},{default:b(()=>T[4]||(T[4]=[G(" Edit ")])),_:1},8,["disabled"])]),k("div",Rn,[f(ye,{class:"mb-3 text-sm",hint:`value: ${t(x)}`,label:"Brush radius"},{default:b(()=>[f(ce,{modelValue:t(x),"onUpdate:modelValue":T[0]||(T[0]=xe=>Q(x)?x.value=xe:null),min:1,max:100,size:"sm",class:"my-2",disabled:n.value!==""},null,8,["modelValue","disabled"])]),_:1},8,["hint"])])])}}});function Ge(e={}){const{copy:l,isSupported:n}=bl(),s=be();function r(o,i={},u={}){n&&l(o).then(()=>{!i.title&&!i.description||s.add({...i,...e})},function(m){s.add({...u,description:u.description||m.message,...e})})}return{copy:r}}const Un="0.05";function Vn(e,l){const n=parseFloat(e);if(isNaN(n))return e;const s=n+l;return s<0?"0":String(Number(s.toFixed(10)))}function zn(e,l){let n=l,s=l,r=0,o=0;for(;n>=0&&(n--,!(e[n]==="("&&r===o));)e[n]==="("&&r++,e[n]===")"&&o++;if(n<0)return!1;for(r=0,o=0;s<e.length&&!(e[s]===")"&&r===o);)e[s]==="("&&r++,e[s]===")"&&o++,s++;return s===e.length?!1:{start:n+1,end:s}}function Tn(e){const l=/^\((.*)\)$/,n=e.match(l),s=/:([+-]?(\d*\.)?\d+([eE][+-]?\d+)?)/,r=e.match(s);return n&&!r?`(${n[1]}:1.0)`:e}function ll(e){const l=e.composedPath()[0],n=parseFloat(Un);if(l.tagName!=="TEXTAREA"||!(e.key==="ArrowUp"||e.key==="ArrowDown")||!e.ctrlKey&&!e.metaKey)return;e.preventDefault();let s=l.selectionStart,r=l.selectionEnd,o=l.value.substring(s,r);if(!o){const m=zn(l.value,s);if(m)s=m.start,r=m.end,o=l.value.substring(s,r);else{const x=" .,\\/!?%^*;:{}=-_`~()\r\n	";for(;!x.includes(l.value[s-1])&&s>0;)s--;for(;!x.includes(l.value[r])&&r<l.value.length;)r++;if(o=l.value.substring(s,r),!o)return}}o[o.length-1]===" "&&(o=o.substring(0,o.length-1),r-=1),l.value[s-1]==="("&&l.value[r]===")"&&(s-=1,r+=1,o=l.value.substring(s,r)),(o[0]!=="("||o[o.length-1]!==")")&&(o=`(${o})`),o=Tn(o);const i=e.key==="ArrowUp"?n:-n,u=o.replace(/\((.*):(\d+(?:\.\d+)?)\)/,(m,x,h)=>(h=Vn(h,i),Number(h)==1?x:`(${x}:${h})`));return l.setRangeText(u,s,r,"select"),l.value}const On={key:0,class:"text-red-300"},jn={class:"flex items-center"},Nn={class:"p-2 max-w-48 max-h-48 not-italic"},Bn={class:"block font-medium text-gray-700 dark:text-gray-200"},Ln={key:0,class:"flex w-full items-center justify-between"},An={class:"flex items-center"},qn={key:2,class:"flex flex-row flex-grow items-center justify-between"},En={key:3,class:"flex flex-row flex-grow items-center"},Dn={class:"sm:inline"},Wn={class:"preview-over-original relative"},Hn={key:1,class:"text-red-300 text-sm"},Gn=Y({__name:"InputParam",props:{inputParam:{type:Object,required:!0},index:{type:Number,required:!0},inputParamsMap:{type:Array,required:!0},advanced:{type:Boolean,default:!1}},setup(e){const l=e,n=qt(),s=kl(),r=N(()=>s.selectedFiles[l.inputParam.name]?s.selectedFiles[l.inputParam.name]:null),o=N(()=>{var a;return r.value?`${window.location.origin}/index.php/core/preview?fileId=${(a=r.value)==null?void 0:a.id}&mimeFallback=true&a=1`:""}),i=N(()=>r.value?r.value.source:"");pe(r,P=>{P?(l.inputParamsMap[l.index][l.inputParam.name].value=P,l.inputParamsMap[l.index][l.inputParam.name].image_preview_url=i.value,l.inputParamsMap[l.index][l.inputParam.name].nc_file=!0):(l.inputParamsMap[l.index][l.inputParam.name].value=null,l.inputParamsMap[l.index][l.inputParam.name].image_preview_url="",l.inputParamsMap[l.index][l.inputParam.name].nc_file=!1)});const u=C(!1),m=C(null),x=C(""),h=C({width:0,height:0}),g=C(""),M=C({}),z=C(null),S=l.inputParamsMap[l.index][l.inputParam.name].source_input_name??"",U=l.inputParamsMap.findIndex(P=>{if(Object.keys(P)[0]===l.inputParamsMap[l.index][l.inputParam.name].source_input_name)return!0});function O(){try{const P=l.inputParamsMap.find(a=>{const y=Object.keys(a)[0];if(y===S)return a[y]});V(P[S].value)}catch{h.value.width=0,h.value.height=0}}ge(()=>{l.inputParam.type==="range_scale"&&O(),l.inputParam.type==="image-mask"&&pe(g,P=>{const a=new File([g.value],`image-mask-${l.inputParam.name}.png`,{type:"image/png"});l.inputParamsMap[l.index][l.inputParam.name].value=a,l.inputParamsMap[l.index][l.inputParam.name].mask_applied=P!==""})}),l.inputParam.type==="range_scale"&&pe(l.inputParamsMap,()=>{O()});function I(P){return P?URL.createObjectURL(P):""}function c(){URL.revokeObjectURL(x.value),x.value="",m.value&&(m.value.$refs.input.value=""),l.inputParamsMap[l.index][l.inputParam.name].value=null,l.inputParamsMap[l.index][l.inputParam.name].image_preview_url=""}function v(){URL.revokeObjectURL(g.value),g.value="",M.value={},l.inputParamsMap[l.index][l.inputParam.name].value=null,l.inputParamsMap[l.index][l.inputParam.name].mask_applied=!1}const w=N(()=>l.inputParam.type!=="bool"?l.inputParam.display_name:"");function V(P){if(!(P instanceof File)){h.value.width=0,h.value.height=0;return}const a=URL.createObjectURL(P),y=new Image;y.onload=function(){h.value.width=y.naturalWidth,h.value.height=y.naturalHeight,URL.revokeObjectURL(y.src)},y.src=a}const _=N(()=>{if(l.inputParam.type==="range_scale"){const P=l.inputParamsMap[l.index][l.inputParam.name].value;return`value: ${P}x (${h.value.width}x${h.value.height} -> ${(h.value.width*P).toFixed(0)}x${(h.value.height*P).toFixed(0)})`}return["range","range_scale"].includes(l.inputParam.type)?`value: ${l.inputParamsMap[l.index][l.inputParam.name].value}`:""}),p=C(null);function D(P){const a=ll(P);a&&(l.inputParamsMap[l.index][l.inputParam.name].value=a)}return ge(()=>{l.inputParam.type==="text"&&p.value&&p.value.$refs.textarea.addEventListener("keydown",D),l.inputParam.type==="image-mask"&&(z.value=l.inputParamsMap[U][S],pe(l.inputParamsMap[U][S],P=>{g.value="",M.value={},z.value=P}))}),St(()=>{URL.revokeObjectURL(x.value),URL.revokeObjectURL(g.value),s.removeSelectedFile(l.inputParam.name),l.inputParam.type==="text"&&p.value&&p.value.$refs.textarea.removeEventListener("keydown",D)}),(P,a)=>{var ne,q;const y=de,W=Je,X=Pt,ee=Ft,ie=Oe,se=Qe,ae=Tl,K=Ve,oe=Fn,_e=Ue,Re=lt,$e=Vt,ue=je;return(((ne=e.inputParam)==null?void 0:ne.advanced)||!1)===e.advanced?(d(),$(ue,{key:0,class:le(["mb-3",{italic:(q=e.inputParam)==null?void 0:q.dynamic_lora}]),help:t(_)},{hint:b(()=>[e.inputParam.optional?R("",!0):(d(),j("span",On,"required"))]),label:b(()=>{var T;return[k("div",jn,[(T=e.inputParam)!=null&&T.dynamic_lora&&e.inputParam.trigger_words.length>0?(d(),$(X,{key:0},{panel:b(()=>[k("div",Nn,[a[21]||(a[21]=k("h4",{class:"mb-2 text-center"},"Trigger words",-1)),(d(!0),j(te,null,ve(e.inputParam.trigger_words,F=>(d(),$(W,{key:F,color:"violet",class:"mr-1 cursor-pointer",onClick:()=>{("useCopyToClipboard"in P?P.useCopyToClipboard:t(Ge))().copy(F),("useToast"in P?P.useToast:t(be))().add({title:"Clipboard",description:"Trigger word copied to clipboard",timeout:2e3})}},{default:b(()=>[G(J(F),1)]),_:2},1032,["onClick"]))),128))])]),default:b(()=>[f(y,{icon:"i-heroicons-information-circle",variant:"ghost",size:"xs",color:"gray",class:"mr-2"})]),_:1})):R("",!0),k("label",Bn,J(t(w)),1)])]}),default:b(()=>{var T,F,L,H,B;return[e.inputParam.type==="text"?(d(),$(ee,{key:0,ref_key:"textareaInput",ref:p,size:"md",placeholder:e.inputParam.display_name,required:!e.inputParam.optional,resize:!0,label:e.inputParam.display_name,value:e.inputParamsMap[e.index][e.inputParam.name].value,autoresize:"",variant:"outline",onInput:a[0]||(a[0]=A=>{const Z=A.target;e.inputParamsMap[e.index][e.inputParam.name].value=Z.value})},null,8,["placeholder","required","label","value"])):R("",!0),e.inputParam.type==="number"?(d(),j(te,{key:1},[e.inputParam.name==="seed"?(d(),j("div",Ln,[k("div",An,[e.inputParam.type==="number"?(d(),$(ie,{key:0,modelValue:e.inputParamsMap[e.index][e.inputParam.name].value,"onUpdate:modelValue":a[1]||(a[1]=A=>e.inputParamsMap[e.index][e.inputParam.name].value=A),type:"number",label:e.inputParam.display_name,required:!e.inputParam.optional,max:e.inputParam.max||100,min:e.inputParam.min||0,variant:"outline"},null,8,["modelValue","label","required","max","min"])):R("",!0),f(y,{icon:"i-heroicons-arrow-path",color:"violet",variant:"outline",size:"xs",class:"ml-2",onClick:a[2]||(a[2]=()=>{e.inputParamsMap[e.index][e.inputParam.name].value=Math.floor(Math.random()*1e7)})})]),f(se,{modelValue:e.inputParamsMap[e.index][e.inputParam.name].auto_increment,"onUpdate:modelValue":a[3]||(a[3]=A=>e.inputParamsMap[e.index][e.inputParam.name].auto_increment=A),label:"Auto-increment seed"},null,8,["modelValue"])])):(d(),$(ie,{key:1,modelValue:e.inputParamsMap[e.index][e.inputParam.name].value,"onUpdate:modelValue":a[4]||(a[4]=A=>e.inputParamsMap[e.index][e.inputParam.name].value=A),type:"number",label:e.inputParam.display_name,required:!e.inputParam.optional,max:e.inputParam.max||100,min:e.inputParam.min||0,variant:"outline"},null,8,["modelValue","label","required","max","min"]))],64)):R("",!0),e.inputParam.type==="image"?(d(),j("div",qn,[f(ie,{ref_key:"imageInput",ref:m,type:"file",accept:"image/*",class:"w-full",variant:"outline",color:"gray",disabled:t(r)!==null,label:e.inputParam.display_name,onChange:a[5]||(a[5]=A=>{console.debug("files",A);const Z=A==null?void 0:A[0];e.inputParamsMap[e.index][e.inputParam.name].value=Z,x.value=I(Z),e.inputParamsMap[e.index][e.inputParam.name].image_preview_url=t(x),t(r)!==null&&t(s).removeSelectedFile(e.inputParam.name),console.debug("inputParamsMap",e.inputParamsMap)})},null,8,["disabled","label"]),t(n).app.isNextcloudIntegration?(d(),$(ae,{key:0,class:"mx-2",orientation:"vertical",label:"OR"})):R("",!0),t(n).app.isNextcloudIntegration?(d(),$(y,{key:1,icon:"i-heroicons-cloud-arrow-down",variant:"outline",color:"blue",disabled:t(r)!==null||t(x)!=="",title:t(r)!==null?t(r).attributes.filename:"Choose from Nextcloud",onClick:a[6]||(a[6]=()=>{t(s).openNextcloudFilePicker(e.inputParam.name)})},{default:b(()=>a[22]||(a[22]=[G(" Choose from Nextcloud ")])),_:1},8,["disabled","title"])):R("",!0),t(o)!==""?(d(),j(te,{key:2},[f(K,{src:t(o),class:"h-10 rounded-lg cursor-pointer ml-2",onClick:a[7]||(a[7]=()=>{u.value=!0})},null,8,["src"]),f(y,{icon:"i-heroicons-x-mark",variant:"outline",class:"ml-2",onClick:a[8]||(a[8]=()=>{t(s).removeSelectedFile(e.inputParam.name),t(x)!==""&&c()})})],64)):t(x)!==""?(d(),j(te,{key:3},[f(K,{src:t(g)?t(g):t(x),class:"h-10 rounded-lg cursor-pointer ml-2",onClick:a[9]||(a[9]=()=>{u.value=!0})},null,8,["src"]),f(y,{icon:"i-heroicons-x-mark",variant:"outline",class:"ml-2",onClick:c})],64)):R("",!0)])):R("",!0),e.inputParam.type==="image-mask"?(d(),j("div",En,[t(z)?(d(),$(y,{key:0,icon:"i-heroicons-paint-brush-16-solid",class:"mr-2",color:"violet",variant:"outline",size:"xs",disabled:!((T=t(z))!=null&&T.value),onClick:a[10]||(a[10]=()=>{u.value=!0})},{default:b(()=>[k("span",Dn,J(t(g)!==""?"Edit mask":"Draw mask"),1)]),_:1},8,["disabled"])):R("",!0),k("div",Wn,[t(z)&&((F=t(z))!=null&&F.value)?(d(),$(K,{key:0,src:(L=t(z))==null?void 0:L.image_preview_url,class:le(["h-10 rounded-lg cursor-pointer",{absolute:t(g)!==""}]),onClick:a[11]||(a[11]=()=>{u.value=!0})},null,8,["src","class"])):R("",!0),t(g)?(d(),$(K,{key:1,src:t(g),class:"h-10 rounded-lg cursor-pointer opacity-50",onClick:a[12]||(a[12]=()=>{u.value=!0})},null,8,["src"])):R("",!0)]),!t(z)||t(z)&&!((H=t(z))!=null&&H.value)?(d(),j("span",Hn," Select source image ")):R("",!0),t(g)?(d(),$(y,{key:2,icon:"i-heroicons-x-mark",variant:"outline",color:"violet",class:"ml-2",onClick:v})):R("",!0)])):R("",!0),e.inputParam.type==="image"||e.inputParam.type==="image-mask"?(d(),$(_e,{key:4,modelValue:t(u),"onUpdate:modelValue":a[17]||(a[17]=A=>Q(u)?u.value=A:null),class:"z-[90] overflow-y-auto",transition:!1,fullscreen:""},{default:b(()=>{var A;return[f(y,{class:"absolute top-4 right-4 z-[100]",icon:"i-heroicons-x-mark",variant:"ghost",onClick:a[13]||(a[13]=()=>u.value=!1)}),e.inputParam.type==="image"?(d(),j("div",{key:0,class:"flex items-center justify-center w-full h-full p-4",onClick:a[14]||(a[14]=vt(()=>u.value=!1,["left"]))},[t(x)!==""?(d(),$(K,{key:0,class:"lg:h-full",fit:"contain",src:t(x)},null,8,["src"])):R("",!0),t(o)!==""?(d(),$(K,{key:1,class:"lg:h-full",fit:"inside",src:t(i)},null,8,["src"])):R("",!0)])):(d(),$(oe,{key:1,ref:"imageInpaint","image-inpaint-mask":t(g),"onUpdate:imageInpaintMask":a[15]||(a[15]=Z=>Q(g)?g.value=Z:null),"image-inpaint-mask-data":t(M),"onUpdate:imageInpaintMaskData":a[16]||(a[16]=Z=>Q(M)?M.value=Z:null),class:"flex items-center justify-center w-full h-full p-4","image-src":(A=t(z))==null?void 0:A.image_preview_url},null,8,["image-inpaint-mask","image-inpaint-mask-data","image-src"]))]}),_:1},8,["modelValue"])):R("",!0),e.inputParam.type==="list"?(d(),$(Re,{key:5,modelValue:e.inputParamsMap[e.index][e.inputParam.name].value,"onUpdate:modelValue":a[18]||(a[18]=A=>e.inputParamsMap[e.index][e.inputParam.name].value=A),placeholder:e.inputParam.display_name,options:Object.keys(e.inputParam.options)},null,8,["modelValue","placeholder","options"])):R("",!0),e.inputParam.type==="bool"?(d(),$(se,{key:6,modelValue:e.inputParamsMap[e.index][e.inputParam.name].value,"onUpdate:modelValue":a[19]||(a[19]=A=>e.inputParamsMap[e.index][e.inputParam.name].value=A),label:(B=e.inputParam)==null?void 0:B.display_name},null,8,["modelValue","label"])):R("",!0),["range","range_scale"].includes(e.inputParam.type)?(d(),$($e,{key:7,modelValue:e.inputParamsMap[e.index][e.inputParam.name].value,"onUpdate:modelValue":a[20]||(a[20]=A=>e.inputParamsMap[e.index][e.inputParam.name].value=A),label:e.inputParam.display_name,size:"sm",min:e.inputParam.min,max:e.inputParam.max,step:e.inputParam.step},null,8,["modelValue","label","min","max","step"])):R("",!0)]}),_:1},8,["class","help"])):R("",!0)}}}),Jn={key:0,class:"heading"},Xn={key:1},Qn={key:0,class:"max-h-96 overflow-y-auto mt-5"},Kn={class:"heading"},Yn={key:0,class:"p-4"},Zn={key:0,class:"flex items-center w-full max-w-xs"},ea=Y({__name:"InputParams",props:He({inputParamsMap:{type:Array,required:!0},additionalInputParamsMap:{type:Array,required:!1,default:[]},advanced:{type:Boolean,default:!1}},{profilingOptions:{default:{},type:Object},profilingOptionsModifiers:{},profilingEnabled:{default:!1,type:Boolean},profilingEnabledModifiers:{}}),emits:["update:profilingOptions","update:profilingEnabled"],setup(e){const l=e,n=he(),s=Mt(),r=xl(),o=C(!l.advanced),i=Le(e,"profilingOptions"),u=Le(e,"profilingEnabled"),m=C(!0),x=N(()=>r.workers.map(h=>({value:h.worker_id,label:`${h.worker_id} (type: ${h.device_type}, vram_total: ${We(h.vram_total)})`})));return It(()=>{var g;if(!s.isAdmin)return;const h=localStorage.getItem(`profilingOptions_${(g=n.currentFlow)==null?void 0:g.name}`);h&&(i.value=JSON.parse(h)),r.fetchWorkersInfo().then(()=>{r.workers.find(z=>{var S;return z.worker_id===((S=i.value["X-WORKER-ID"])==null?void 0:S.value)})||(i.value["X-WORKER-ID"]=null)})}),(h,g)=>{const M=ke,z=Gn,S=Qe,U=lt,O=de,I=Oe,c=je;return d(),j(te,null,[e.advanced?(d(),j("div",Jn,[k("h4",{class:"text-md font-bold cursor-pointer select-none flex items-center mb-3",onClick:g[0]||(g[0]=()=>{o.value=!t(o)})},[f(M,{name:t(o)?"i-heroicons-chevron-up":"i-heroicons-chevron-down",class:"mr-2"},null,8,["name"]),g[3]||(g[3]=G(" Advanced options "))])])):R("",!0),t(o)?(d(),j("div",Xn,[(d(!0),j(te,null,ve(t(n).currentFlow.input_params,(v,w)=>(d(),$(z,{key:w,"input-params-map":e.inputParamsMap,index:w,"input-param":v,advanced:e.advanced},null,8,["input-params-map","index","input-param","advanced"]))),128)),(d(!0),j(te,null,ve(e.additionalInputParamsMap,(v,w)=>(d(),$(z,{key:Object.keys(v)[0],"input-params-map":e.additionalInputParamsMap,index:w,"input-param":v[Object.keys(v)[0]],advanced:e.advanced},null,8,["input-params-map","index","input-param","advanced"]))),128)),t(s).isAdmin&&e.advanced?(d(),j("div",Qn,[k("div",Kn,[k("h4",{class:"text-md font-bold cursor-pointer select-none flex items-center mb-3",onClick:g[1]||(g[1]=()=>{m.value=!t(m)})},[f(M,{name:t(m)?"i-heroicons-chevron-down":"i-heroicons-chevron-up",class:"mr-2"},null,8,["name"]),f(M,{name:"i-mdi-bug-outline",class:"mr-2"}),g[4]||(g[4]=G(" Execution settings "))])]),t(m)?R("",!0):(d(),j("div",Yn,[f(S,{modelValue:u.value,"onUpdate:modelValue":g[2]||(g[2]=v=>u.value=v),label:"Enable Execution settings",class:"mb-3"},null,8,["modelValue"]),(d(!0),j(te,null,ve(Object.keys(i.value),v=>(d(),$(c,{key:v,label:v},{default:b(()=>[v==="X-WORKER-ID"?(d(),j("div",Zn,[f(U,{modelValue:i.value[v],"onUpdate:modelValue":w=>i.value[v]=w,options:t(x),placeholder:"Select worker",class:"w-full my-3"},null,8,["modelValue","onUpdate:modelValue","options"]),f(O,{icon:"i-heroicons-x-mark",variant:"outline",size:"sm",color:"orange",class:"ml-2",onClick:()=>i.value[v]=null},null,8,["onClick"]),f(O,{icon:"i-heroicons-arrow-path-solid",variant:"outline",size:"sm",color:"blue",class:"ml-2",onClick:()=>{t(r).fetchWorkersInfo().then(()=>{i.value[v]=t(x).find(w=>{var V;return w.value===((V=i.value[v])==null?void 0:V.value)})})}},null,8,["onClick"])])):(d(),$(I,{key:1,modelValue:i.value[v],"onUpdate:modelValue":w=>i.value[v]=w,placeholder:"Enter value",class:"my-3"},null,8,["modelValue","onUpdate:modelValue"]))]),_:2},1032,["label"]))),128))]))])):R("",!0)])):R("",!0)],64)}}}),ta={key:0,id:"prompt",class:"w-full my-10 lg:my-0 p-4 ring-1 ring-gray-200 dark:ring-gray-800 rounded-lg"},la={class:"action flex items-center justify-end"},na=Y({__name:"Prompt",setup(e,{expose:l}){var _,p,D,P;const n=he(),s=Mt();let r=localStorage.getItem(`input_params_map_${(_=n.currentFlow)==null?void 0:_.name}`);if(r){const a=JSON.parse(r);"flow_version"in a&&a.flow_version.split(".")[0]===((p=n.currentFlow)==null?void 0:p.version.split(".")[0])?r=a:(r=null,localStorage.removeItem(`input_params_map_${(D=n.currentFlow)==null?void 0:D.name}`))}const o=C(((P=n.currentFlow)==null?void 0:P.input_params.map(a=>{var y;if(a.type==="text")return{[a.name]:{value:r!==null&&r[a.name]?r[a.name]:a.default||"",type:a.type,optional:a.optional,advanced:a.advanced||!1,default:a.default||"",translatable:a.translatable||!1,dynamic_lora:a.dynamic_lora||!1,trigger_words:a.trigger_words||[]}};if(a.type==="number")return{[a.name]:{value:r!==null&&r[a.name]?r[a.name]:a.default||0,type:a.type,optional:a.optional,advanced:a.advanced||!1,default:a.default||0,dynamic_lora:a.dynamic_lora||!1,trigger_words:a.trigger_words||[]}};if(a.type==="image")return{[a.name]:{value:null,type:a.type,optional:a.optional,advanced:a.advanced||!1,dynamic_lora:a.dynamic_lora||!1,trigger_words:a.trigger_words||[]}};if(a.type==="image-mask")return{[a.name]:{value:null,type:a.type,optional:a.optional,advanced:a.advanced||!1,source_input_name:a.source_input_name||null,dynamic_lora:a.dynamic_lora||!1,trigger_words:a.trigger_words||[]}};if(a.type==="list")return{[a.name]:{value:r!==null&&r[a.name]?r[a.name]:a.default||Object.keys(a.options)[0]||"",type:a.type,optional:a.optional,options:a.options,advanced:a.advanced||!1,default:Object.keys(a.options)[0]||"",dynamic_lora:a.dynamic_lora||!1,trigger_words:a.trigger_words||[]}};if(a.type==="bool")return{[a.name]:{value:r!==null&&r[a.name]?r[a.name]:a.default||!1,type:a.type,optional:a.optional,advanced:a.advanced||!1,default:a.default||!1,dynamic_lora:a.dynamic_lora||!1,trigger_words:a.trigger_words||[]}};if(["range","range_scale"].includes(a.type)){const W={value:r!==null&&r[a.name]?r[a.name]:a.default||0,type:a.type,optional:a.optional,advanced:a.advanced||!1,min:a.min||0,max:a.max||100,step:a.step||1,default:a.default||0,dynamic_lora:a.dynamic_lora||!1,trigger_words:a.trigger_words||[]};if(a.type==="range_scale"&&(W.source_input_name=a.source_input_name||null,W.source_input_name===null||W.source_input_name==="")){const X=(y=n.currentFlow)==null?void 0:y.input_params.find(ee=>ee.type==="image"&&!ee.optional);X&&(W.source_input_name=X.name)}return{[a.name]:W}}}))||[]),i=C([]);n.currentFlow.is_seed_supported&&i.value.push({seed:{name:"seed",display_name:"Random seed",value:Math.floor(Math.random()*1e7),type:"number",optional:!0,advanced:!0,min:0,max:1e7,auto_increment:!0}});const u=N(()=>{var a;return((a=i.value.find(y=>Object.keys(y)[0]==="seed"))==null?void 0:a.seed.auto_increment)||!1}),m=Et(),x=C(n.currentFlow.is_translations_supported&&m.settingsMap.translations_provider.value.trim()!==""),h=C(n.currentFlow.is_surprise_me_supported&&m.settingsMap.llm_provider.value.trim()!==""),g=C(x.value);It(()=>{const a=localStorage.getItem("translatePrompt");a&&(g.value=JSON.parse(a))}),pe(g,a=>{localStorage.setItem("translatePrompt",JSON.stringify(a))});function M(a){console.debug("Copy prompt inputs",a),Object.keys(a).forEach(W=>{const X=o.value.findIndex(ee=>Object.keys(ee)[0]===W);X!==-1&&(o.value[X][W].value=a[W].value)});const y=document.getElementById("prompt");y&&y.scrollIntoView({behavior:"smooth"})}l({copyPromptInputs:M}),o.value.forEach(a=>{const y=Object.keys(a)[0];["image","image-mask"].includes(a[y].type)||pe(()=>a[y].value,()=>{var X,ee;const W={};o.value.forEach(ie=>{const se=Object.keys(ie)[0];W[se]=ie[se].value}),localStorage.setItem(`input_params_map_${(X=n.currentFlow)==null?void 0:X.name}`,JSON.stringify({...W,flow_version:(ee=n.currentFlow)==null?void 0:ee.version}))})});const z=N(()=>o.value.filter(a=>{const y=Object.keys(a)[0];return!["image","image-mask"].includes(a[y].type)}).some(a=>{const y=Object.keys(a)[0];return a[y].value!==a[y].default}));function S(){o.value.forEach(a=>{const y=Object.keys(a)[0];a[y].type==="text"?a[y].value=a[y].default||"":a[y].type==="number"?a[y].value=a[y].default||a[y].min||0:a[y].type==="list"?a[y].value=Object.keys(a[y].options)[0]||"":a[y].type==="bool"?a[y].value=a[y].default||!1:["range","range_scale"].includes(a[y].type)&&(a[y].value=a[y].default||a[y].min||0)})}const U=C(!1),O=C(1),I=C(!1),c=N(()=>o.value.every(a=>{var X,ee,ie,se;const y=Object.keys(a)[0];if(a[y].optional)return!0;const W=a[y].value;if(a[y].type==="text")return W!=="";if(a[y].type==="number")return W>=a[y].min&&W<=a[y].max;if(a[y].type==="list")return W!==""&&Object.keys(a[y].options).includes(W);if(a[y].type==="bool")return!0;if(a[y].type==="range")return W>=a[y].min&&W<=a[y].max;if(a[y].type==="range_scale")return W>=a[y].min&&W<=a[y].max;if(a[y].type==="image")return(X=a[y])!=null&&X.nc_file?!0:W instanceof File&&W.size>0;if(a[y].type==="image-mask")return(ee=a[y])!=null&&ee.nc_file?((ie=a[y])==null?void 0:ie.mask_applied)||!1:W instanceof File&&W.size>0&&(((se=a[y])==null?void 0:se.mask_applied)||!1)})),v=C({"X-WORKER-UNLOAD-MODELS":1,"X-WORKER-EXECUTION-PROFILER":1,"X-WORKER-ID":null}),w=C(!1);pe(()=>v.value,()=>{var a;s.isAdmin&&localStorage.setItem(`profilingOptions_${(a=n.currentFlow)==null?void 0:a.name}`,JSON.stringify(v.value))},{deep:!0});function V(a=!1){U.value=!0;let y={};s.isAdmin&&w&&(y=Object.fromEntries(Object.entries(v).filter(([W,X])=>X!==null).map(([W,X])=>W==="X-WORKER-ID"?[W,X==null?void 0:X.value]:[W,X]))),n.runFlow(n.currentFlow,[...o.value,...i.value],u.value?O.value:1,x.value&&g.value,!1,null,a,y).finally(()=>{if(U.value=!1,u.value){const W=i.value.find(X=>Object.keys(X)[0]==="seed");W.seed.value=Number(W.seed.value)+O.value+1}})}return(a,y)=>{const W=ke,X=ea,ee=Oe,ie=je,se=Qe,ae=de,K=Xe;return t(n).currentFlow?(d(),j("div",ta,[k("h2",{class:"text-lg font-bold cursor-pointer select-none flex items-center mb-3",onClick:y[0]||(y[0]=()=>{I.value=!t(I)})},[f(W,{name:t(I)?"i-heroicons-chevron-down":"i-heroicons-chevron-up",class:"mr-2"},null,8,["name"]),y[11]||(y[11]=G(" Prompt "))]),Ct(k("div",null,[f(X,{"input-params-map":t(o),"onUpdate:inputParamsMap":y[1]||(y[1]=oe=>Q(o)?o.value=oe:null),"additional-input-params-map":t(i),"onUpdate:additionalInputParamsMap":y[2]||(y[2]=oe=>Q(i)?i.value=oe:null),advanced:!1},null,8,["input-params-map","additional-input-params-map"]),t(i).length>0?(d(),$(X,{key:0,"input-params-map":t(o),"onUpdate:inputParamsMap":y[3]||(y[3]=oe=>Q(o)?o.value=oe:null),"additional-input-params-map":t(i),"onUpdate:additionalInputParamsMap":y[4]||(y[4]=oe=>Q(i)?i.value=oe:null),"profiling-options":t(v),"onUpdate:profilingOptions":y[5]||(y[5]=oe=>Q(v)?v.value=oe:null),"profiling-enabled":t(w),"onUpdate:profilingEnabled":y[6]||(y[6]=oe=>Q(w)?w.value=oe:null),advanced:!0},null,8,["input-params-map","additional-input-params-map","profiling-options","profiling-enabled"])):R("",!0),t(n).currentFlow.is_count_supported?(d(),$(ie,{key:1,label:"Number of results"},{default:b(()=>[f(ee,{modelValue:t(O),"onUpdate:modelValue":y[7]||(y[7]=oe=>Q(O)?O.value=oe:null),type:"number",min:"1",max:"50",label:"Batch size",disabled:!t(u),class:"mb-3 max-w-fit flex justify-end"},null,8,["modelValue","disabled"])]),_:1})):R("",!0),t(x)?(d(),$(ie,{key:2,class:"my-3 flex justify-end"},{default:b(()=>[f(se,{modelValue:t(g),"onUpdate:modelValue":y[8]||(y[8]=oe=>Q(g)?g.value=oe:null),label:"Translate prompt"},null,8,["modelValue"])]),_:1})):R("",!0),k("div",{class:le(["flex flex-col md:flex-row",{"justify-between":t(z),"justify-end":!t(z)}])},[t(z)?(d(),$(K,{key:0,text:"Reset input params values to defaults"},{default:b(()=>[f(ae,{icon:"i-heroicons-arrow-path-rounded-square",variant:"ghost",color:"amber",onClick:S},{default:b(()=>y[12]||(y[12]=[G(" Reset params ")])),_:1})]),_:1})):R("",!0),k("div",la,[t(h)?(d(),$(K,{key:0,text:"Randomize prompt based on your input"},{default:b(()=>[f(ae,{class:"mr-2",icon:"i-heroicons-gift",variant:"soft",color:"blue",loading:t(U),onClick:y[9]||(y[9]=()=>V(!0))},{default:b(()=>y[13]||(y[13]=[G(" Surprise me ")])),_:1},8,["loading"])]),_:1})):R("",!0),f(ae,{icon:"i-heroicons-sparkles-16-solid",variant:"outline",loading:t(U),disabled:!t(c),onClick:y[10]||(y[10]=()=>V(!1))},{default:b(()=>y[14]||(y[14]=[G(" Run prompt ")])),_:1},8,["loading","disabled"])])],2)],512),[[Dt,!t(I)]])])):R("",!0)}}}),aa=e=>{const l=C(0);function n(o){e.value.style.scrollSnapType="none",e.value.style.scrollBehavior="auto",l.value=o.pageX,window.addEventListener("mousemove",r),window.addEventListener("mouseup",s)}function s(){e.value.style.removeProperty("scroll-behavior"),e.value.style.removeProperty("scroll-snap-type"),e.value.style.removeProperty("pointer-events"),window.removeEventListener("mousemove",r),window.removeEventListener("mouseup",s)}function r(o){o.preventDefault(),e.value.style.pointerEvents="none";const i=o.pageX-l.value;l.value=o.pageX,e.value.scrollBy(-i,0)}ge(()=>{e.value&&e.value.addEventListener("mousedown",n)}),et(()=>{e.value&&e.value.removeEventListener("mousedown",n)})},wt=mt(Me.ui.strategy,Me.ui.carousel,Bl),oa=Y({components:{UButton:de},inheritAttrs:!1,props:{items:{type:Array,default:()=>[]},arrows:{type:Boolean,default:!1},indicators:{type:Boolean,default:!1},dir:{type:String,default:"ltr"},prevButton:{type:Object,default:()=>wt.default.prevButton},nextButton:{type:Object,default:()=>wt.default.nextButton},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:void 0}},setup(e,{expose:l}){const{ui:n,attrs:s}=pt("carousel",Be(e,"ui"),wt,Be(e,"class")),r=C(),o=C(0),{x:i}=_l(r,{behavior:"smooth"}),{width:u}=$l(r);aa(r),Wt(r,O=>{var c,v;const[I]=O;o.value=((v=(c=I==null?void 0:I.target)==null?void 0:c.firstElementChild)==null?void 0:v.clientWidth)||0});const m=N(()=>e.dir==="rtl"),x=N(()=>o.value?m.value?Math.round(-i.value/o.value)+1:Math.round(i.value/o.value)+1:0),h=N(()=>{if(!o.value)return 0;const O=Math.round(u.value/o.value);return e.items.length<=O?0:e.items.length-O+1}),g=N(()=>x.value<=1),M=N(()=>x.value===h.value);function z(){i.value+=m.value?-o.value:o.value}function S(){i.value-=m.value?-o.value:o.value}function U(O){i.value=(O-1)*o.value*(m.value?-1:1)}return l({pages:h,page:x,prev:S,next:z,select:U}),{ui:n,attrs:s,isFirst:g,isLast:M,carouselRef:r,pages:h,currentPage:x,onClickNext:z,onClickPrev:S,onClick:U,twMerge:ct}}}),sa=["dir"],ia=["role"],ra=["aria-selected","aria-label","onClick"];function ua(e,l,n,s,r,o){const i=de;return d(),j("div",Te({class:e.ui.wrapper},e.attrs,{dir:e.dir}),[k("div",{ref:"carouselRef",class:le([e.ui.container,"no-scrollbar"])},[(d(!0),j(te,null,ve(e.items,(u,m)=>(d(),j("div",{key:m,class:le(e.ui.item),role:e.indicators?"tabpanel":null},[Fe(e.$slots,"default",{item:u,index:m},void 0,!0)],10,ia))),128))],2),e.arrows?(d(),j("div",{key:0,class:le(e.ui.arrows.wrapper)},[Fe(e.$slots,"prev",{onClick:e.onClickPrev,disabled:e.isFirst},()=>{var u;return[e.prevButton?(d(),$(i,Te({key:0,disabled:e.isFirst},{...e.ui.default.prevButton,...e.prevButton},{class:e.twMerge(e.ui.default.prevButton.class,(u=e.prevButton)==null?void 0:u.class),"aria-label":"Prev",onClick:e.onClickPrev}),null,16,["disabled","class","onClick"])):R("",!0)]},!0),Fe(e.$slots,"next",{onClick:e.onClickNext,disabled:e.isLast},()=>{var u;return[e.nextButton?(d(),$(i,Te({key:0,disabled:e.isLast},{...e.ui.default.nextButton,...e.nextButton},{class:e.twMerge(e.ui.default.nextButton.class,(u=e.nextButton)==null?void 0:u.class),"aria-label":"Next",onClick:e.onClickNext}),null,16,["disabled","class","onClick"])):R("",!0)]},!0)],2)):R("",!0),e.indicators?(d(),j("div",{key:1,role:"tablist",class:le(e.ui.indicators.wrapper)},[(d(!0),j(te,null,ve(e.pages,u=>Fe(e.$slots,"indicator",{key:u,onClick:e.onClick,active:u===e.currentPage,page:u},()=>[k("button",{type:"button",role:"tab","aria-selected":u===e.currentPage,class:le([e.ui.indicators.base,u===e.currentPage?e.ui.indicators.active:e.ui.indicators.inactive]),"aria-label":`set slide ${u}`,onClick:m=>e.onClick(u)},null,10,ra)],!0)),128))],2)):R("",!0)],16,sa)}const Ne=ft(oa,[["render",ua],["__scopeId","data-v-a3da86ff"]]),da={class:"flex flex-col basis-full"},ca=Y({__name:"InputFiles",props:{running:{type:Object,required:!0}},setup(e){const l=Ut(),n=function(u,m){return`${Ht()}/tasks/inputs?task_id=${u}&input_index=${m}`},s=C(!1),r=C(""),o=C(0),i=C(!0);return(u,m)=>{var S,U,O,I,c;const x=ke,h=Ve,g=Ne,M=de,z=Ue;return e.running&&e.running.input_files&&((S=Object.keys(e.running.input_files))==null?void 0:S.length)>0?(d(),j("div",{key:0,class:le(["ml-2 mt-2 mb-5",{"mb-10":((U=Object.keys(e.running.input_files))==null?void 0:U.length)>1&&!t(i)}])},[k("h4",{class:"mb-3 font-bold cursor-pointer select-none flex items-center text-sm",onClick:m[0]||(m[0]=()=>i.value=!t(i))},[f(x,{name:t(i)?"i-heroicons-chevron-down":"i-heroicons-chevron-up",class:"mr-2"},null,8,["name"]),k("span",null," Input files ("+J((O=Object.keys(e.running.input_files))==null?void 0:O.length)+") ",1)]),t(i)?R("",!0):(d(),j(te,{key:0},[((I=Object.keys(e.running.input_files))==null?void 0:I.length)===1?(d(),$(h,{key:0,class:"mb-5 rounded-lg cursor-pointer",fit:"outside",loading:"lazy",placeholder:t(l)(`${("buildBackendUrl"in u?u.buildBackendUrl:t(xt))()}/vix_logo.png`,{f:"png",blur:3,q:50}),src:n(e.running.task_id,0),onClick:m[1]||(m[1]=()=>{r.value=n(e.running.task_id,0),o.value=0,s.value=!0})},null,8,["placeholder","src"])):R("",!0),((c=Object.keys(e.running.input_files))==null?void 0:c.length)>1?(d(),$(g,{key:1,items:Object.keys(e.running.input_files).map(v=>({task_id:e.running.task_id,index:v})),ui:{item:"basis-full md:basis-1/2",indicators:{wrapper:"relative bottom-0 mt-4"}},page:1,indicators:""},{default:b(({item:v})=>[k("div",da,[f(h,{class:"rounded-lg cursor-pointer",fit:"outside",loading:"lazy",placeholder:t(l)(`${("buildBackendUrl"in u?u.buildBackendUrl:t(xt))()}/vix_logo.png`,{f:"png",blur:3,q:50}),src:n(v.task_id,v.index),onClick:()=>{r.value=n(e.running.task_id,v.index),o.value=v.index,s.value=!0}},null,8,["placeholder","src","onClick"])])]),_:1},8,["items"])):R("",!0),f(z,{modelValue:t(s),"onUpdate:modelValue":m[4]||(m[4]=v=>Q(s)?s.value=v:null),class:"z-[90]",transition:!1,fullscreen:""},{default:b(()=>[f(M,{class:"absolute top-4 right-4",icon:"i-heroicons-x-mark",variant:"ghost",onClick:m[2]||(m[2]=()=>s.value=!1)}),k("div",{class:"flex items-center justify-center w-full h-full p-4",onClick:m[3]||(m[3]=vt(()=>s.value=!1,["left"]))},[t(r)?(d(),$(h,{key:0,class:"lg:h-full",fit:"inside",loading:"lazy",placeholder:"/vix_logo.png",src:t(r)},null,8,["src"])):R("",!0)])]),_:1},8,["modelValue"])],64))],2)):R("",!0)}}}),ma=Y({__name:"ErrorAlert",props:{running:{type:Object,required:!0}},setup(e){const l=he(),n=C(!1);return(s,r)=>{const o=ht;return d(),$(o,{class:"mb-5",icon:"i-heroicons-exclamation-circle-16-solid",color:"red",variant:"soft",title:"Task failed",description:e.running.error,actions:[{variant:"outline",color:"yellow",label:"Restart",loading:t(n),icon:"i-heroicons-arrow-path",click:()=>{n.value=!0,t(l).restartFlow(e.running).finally(()=>{n.value=!1})}}]},null,8,["description","actions"])}}}),fa={class:"mb-5"},pa={class:"text-sm mb-5 text-slate-500"},va={class:"flex justify-between"},ga=Y({__name:"Item",props:{running:{type:Object,required:!0}},setup(e){const l=he(),n=C(!1),s=C(!1);function r(o){return[[{label:"Comfy flow",labelClass:"text-blue-500",icon:"i-heroicons-arrow-down-tray",iconClass:"bg-blue-500",click:()=>{var i;return l.downloadFlowComfy((i=l.currentFlow)==null?void 0:i.name,o.task_id)}}],[{label:`Raise priority ${o.priority>0?`(${o.priority})`:""}`,labelClass:"text-gray-500",icon:"i-heroicons-arrow-up",iconClass:"bg-gray-500",disabled:o.priority===15||o.progress>0,click:()=>{s.value=!0,l.raiseQueuePriority(o).finally(()=>{s.value=!1})}},{label:`Lower priority ${o.priority>0?`(${o.priority})`:""}`,labelClass:"text-gray-500",icon:"i-heroicons-arrow-down",iconClass:"bg-gray-500",disabled:o.priority===0||o.progress>0,click:()=>{s.value=!0,l.lowerQueuePriority(o).finally(()=>{s.value=!1})}},{label:`Reset priority ${o.priority>0?`(${o.priority})`:""}`,labelClass:"text-gray-500",icon:"i-heroicons-arrow-path-rounded-square-solid",iconClass:"bg-gray-500",disabled:o.priority===0||o.progress>0,click:()=>{s.value=!0,l.resetQueuePriority(o).finally(()=>{s.value=!1})}}]]}return(o,i)=>{var M,z;const u=Yt,m=ca,x=ma,h=de,g=gt;return d(),j("div",fa,[f(u,{class:"mb-3",value:(M=e.running)==null?void 0:M.progress,indicator:"",color:e.running.error?"red":"green"},null,8,["value","color"]),k("p",pa,J([`${(z=e.running)!=null&&z.priority&&e.running.priority>0?"["+e.running.priority+"] ":""}#${e.running.task_id}`,...Object.keys(e.running.input_params_mapped).filter(S=>e.running.input_params_mapped[S].value&&e.running.input_params_mapped[S].value!=="").map(S=>`${e.running.input_params_mapped[S].display_name}: ${e.running.input_params_mapped[S].value}`)].join(" | ")+`${e.running.execution_time?" | execution_time: "+e.running.execution_time.toFixed(2)+"s":""}`),1),f(m,{running:e.running},null,8,["running"]),e.running.error?(d(),$(x,{key:0,running:e.running},null,8,["running"])):R("",!0),k("div",va,[f(h,{icon:e.running.progress>=0&&e.running.progress<100?"i-heroicons-stop":"i-heroicons-minus-circle",color:e.running.error?"red":"orange",variant:"outline",loading:t(n),onClick:i[0]||(i[0]=()=>{n.value=!0,t(l).cancelRunningFlow(e.running).finally(()=>{n.value=!1})})},{default:b(()=>[G(J(e.running.progress>=0&&e.running.progress<100?"Cancel":"Remove"),1)]),_:1},8,["icon","color","loading"]),f(g,{items:r(e.running),mode:"click",popper:{placement:"bottom-end"}},{default:b(()=>[f(h,{color:"blue",variant:"outline",icon:"i-heroicons-ellipsis-vertical-16-solid"})]),_:1},8,["items"])])])}}}),ha={class:"w-full p-4 ring-1 ring-gray-200 dark:ring-gray-800 rounded-lg shadow-md mt-5 mb-10"},wa={class:"flex items-center justify-between mb-2"},ya={key:0},ba={key:1,class:"text-red-400"},ka=Y({__name:"Queue",setup(e){const l=he(),n=C(!0),s=C(!1);return(r,o)=>{var x,h,g,M,z,S,U,O,I;const i=ke,u=de,m=ga;return d(),j("div",ha,[k("div",wa,[k("h2",{class:"text-lg font-bold cursor-pointer select-none flex items-center",onClick:o[0]||(o[0]=()=>{n.value=!t(n)})},[f(i,{name:t(n)?"i-heroicons-chevron-down":"i-heroicons-chevron-up",class:"mr-2"},null,8,["name"]),k("span",null," Queue ("+J(t(l).flowsRunningByName((x=t(l).currentFlow)==null?void 0:x.name).length)+") ",1),t(l).flowsRunningByName((h=t(l).currentFlow)==null?void 0:h.name).length>0?(d(),j("span",ya,"  - "+J(`${((M=t(l).flowsRunningByName((g=t(l).currentFlow)==null?void 0:g.name).filter(c=>c.progress>0)[0])==null?void 0:M.progress.toFixed(0))??0}%`),1)):R("",!0),t(l).flowsRunningByNameWithErrors((z=t(l))==null?void 0:z.currentFlow.name).length>0?(d(),j("span",ba,"  ("+J(t(l).flowsRunningByNameWithErrors((S=t(l).currentFlow)==null?void 0:S.name).length)+") ",1)):R("",!0)]),(U=t(l).currentFlow)!=null&&U.name&&t(l).flowsRunningByName((O=t(l).currentFlow)==null?void 0:O.name).length>0?(d(),$(u,{key:0,icon:"i-heroicons-stop",color:"orange",variant:"outline",loading:t(s),onClick:o[1]||(o[1]=()=>{var c;s.value=!0,t(l).cancelRunningFlows((c=t(l).currentFlow)==null?void 0:c.name).finally(()=>{s.value=!1})})},{default:b(()=>o[2]||(o[2]=[G(" Cancel all ")])),_:1},8,["loading"])):R("",!0)]),t(n)?R("",!0):(d(!0),j(te,{key:0},ve(t(l).flowsRunningByName((I=t(l).currentFlow)==null?void 0:I.name),c=>(d(),$(m,{key:c.task_id,running:c},null,8,["running"]))),128))])}}}),xa=Y({__name:"ScrollToTop",props:{show:{type:Boolean,required:!0},target:{type:String,required:!0}},setup(e){const l=e;function n(){const s=document.getElementById(l.target);s&&s.scrollIntoView({behavior:"smooth"})}return(s,r)=>{const o=de;return e.show?(d(),$(o,{key:0,icon:"i-heroicons-arrow-small-up",color:"black",variant:"outline",onClick:n})):R("",!0)}}}),_a={class:"flex flex-col items-center mb-2 max-w-fit mx-auto z-0"},$a={class:"text-slate-500 text-center text-sm w-full mx-auto flex flex-wrap items-center justify-center md:justify-between"},Ca={class:"toggles py-2"},Ia={class:"mr-2 inline-flex items-center text-sm"},Sa=["for"],Pa={class:"mr-2 inline-flex items-center text-sm"},Ma=["for"],Ra={key:0,class:"flex items-center"},Fa=["title"],Ua=Y({__name:"Child",props:{flowResult:{type:Object,required:!0},outputsIndex:{type:Number,required:!1,default:()=>0},openImageModal:{type:Function,required:!0}},setup(e){const l=e,n=he(),s=(c,v=null,w=!1)=>{if(c.child_tasks.length===0)return c;const V=c.child_tasks.findIndex(_=>_.parent_task_node_id===v);return V!==-1?(w||(o.value=c),s(c.child_tasks[V],c.child_tasks[V].outputs[0].comfy_node_id,w)):c};function r(c,v,w=null){if(w!==null&&c.parent_task_node_id===w||Number(c.task_id)===v)return c;for(let V=0;V<c.child_tasks.length;V++)for(let _=0;_<c.child_tasks[V].outputs.length;_++){const p=r(c.child_tasks[V],v,c.child_tasks[V].outputs[_].comfy_node_id);if(p!==null)return p}return null}const o=C(l.flowResult),i=C(s(l.flowResult,l.flowResult.outputs[l.outputsIndex].comfy_node_id,!1));function u(c){var v;return[[{label:`${(v=n.flowByName((c==null?void 0:c.flow_name)??(c==null?void 0:c.name)))==null?void 0:v.display_name}#${c.task_id}`,disabled:!0}],[{label:"View image",icon:"i-heroicons-eye",click:()=>{l.openImageModal(fe({task_id:c.task_id,node_id:c.outputs.length>1?c.outputs[l.outputsIndex].comfy_node_id:c.outputs[0].comfy_node_id}))}}]]}function m(c){var w;const v=[[{label:`${(w=n.flowByName((c==null?void 0:c.flow_name)??(c==null?void 0:c.name)))==null?void 0:w.display_name}#${c.task_id}`,disabled:!0}],[{label:"View image",icon:"i-heroicons-eye",disabled:c.progress<100||c.error!=="",click:()=>{l.openImageModal(fe({task_id:c.task_id,node_id:c.outputs.length>1?c.outputs[l.outputsIndex].comfy_node_id:c.outputs[0].comfy_node_id}))}},{label:c.progress<100?"Cancel":"Delete",labelClass:c.progress<100?"text-orange-500":"text-red-500",icon:c.progress<100?"i-heroicons-stop":"i-heroicons-trash",iconClass:c.progress<100?"bg-orange-500":"bg-red-500",click:()=>{n.deleteFlowHistory(c.task_id).then(()=>{const V=r(l.flowResult,c.parent_task_id,c.parent_task_node_id);V&&(V.child_tasks=V.child_tasks.filter(_=>Number(_.task_id)!==Number(c.task_id))),S(!1,l.flowResult)})}}]];return c.progress<100&&(v[0][1]={label:`Progress: ${Math.ceil(c.progress)}% (${c.execution_time.toFixed(2)}s)`,labelClass:"text-blue-500",disabled:!0}),c.error!==""&&v[0].push({label:`Error: ${c.error}`,labelClass:"text-red-500",slot:"error",click:()=>{Ge().copy(c.error),be().add({title:"Clipboard",description:`Task #${c.task_id} error copied to clipboard`,timeout:2e3})}}),v}function x(){const c=o.value.parent_task_id;if(!c)return;const v=r(l.flowResult,c,o.value.parent_task_node_id);v&&(o.value=v)}function h(){if(o.value.child_tasks.length===0)return;const c=o.value.outputs.length>1?o.value.outputs[l.outputsIndex].comfy_node_id:o.value.outputs[0].comfy_node_id,v=o.value.child_tasks.find(w=>w.parent_task_node_id===c);v&&(o.value=v)}const g=N(()=>{if(o.value.child_tasks.length===0)return;const c=o.value.outputs.length>1?o.value.outputs[l.outputsIndex].comfy_node_id:o.value.outputs[0].comfy_node_id;return o.value.child_tasks.find(w=>w.parent_task_node_id===c).task_id!==i.value.task_id});function M(){const c=i.value.parent_task_id;if(!c)return;const v=r(l.flowResult,c,i.value.parent_task_node_id);v&&(i.value=v)}function z(){if(i.value.child_tasks.length===0)return;const c=Number(i.value.outputs[0].comfy_node_id),v=i.value.child_tasks.find(w=>Number(w.parent_task_node_id)===c);v&&(i.value=v)}function S(c=!1,v=null){c||(o.value=v),i.value=s(v,v==null?void 0:v.outputs[l.outputsIndex].comfy_node_id,c),U.value=!1}pe(l.flowResult,c=>{S(!0,c)});const U=C(!1),O=C(!0),I=C(null);return pe(U,c=>{c?(I.value=o.value,o.value=l.flowResult):I.value&&(o.value=I.value,i.value=Gt(I.value,l.outputsIndex,o.value.outputs.length>1?o.value.outputs[l.outputsIndex].comfy_node_id:o.value.outputs[0].comfy_node_id))}),(c,v)=>{const w=Ve,V=Se("ImgComparisonSlider"),_=jl,p=de,D=gt,P=ke,a=Xe;return d(),j("div",_a,[Ct(f(w,{class:"mb-2 rounded-lg cursor-pointer",height:t(n).outputMaxSize,width:t(n).outputMaxSize,draggable:"false",fit:"cover",loading:"lazy",src:("outputResultSrc"in c?c.outputResultSrc:t(fe))({task_id:t(i).progress===100?t(i).task_id:e.flowResult.task_id,node_id:t(i).progress===100?t(i).outputs[0].comfy_node_id:e.flowResult.outputs[e.outputsIndex].comfy_node_id}),onClick:v[0]||(v[0]=y=>e.openImageModal(("outputResultSrc"in c?c.outputResultSrc:t(fe))({task_id:t(i).task_id??e.flowResult.task_id,node_id:t(i).outputs[0].comfy_node_id??e.flowResult.outputs[e.outputsIndex].comfy_node_id})))},null,8,["height","width","src"]),[[Dt,!t(O)]]),t(O)?(d(),$(V,{key:0,class:"mb-2 mx-auto outline-none w-fit rounded-lg"},{default:b(()=>{var y,W,X;return[f(w,{slot:"first",height:t(n).outputMaxSize,width:t(n).outputMaxSize,fit:"cover",draggable:"false",src:("outputResultSrc"in c?c.outputResultSrc:t(fe))({task_id:t(U)?e.flowResult.task_id:t(o).task_id,node_id:t(U)?e.flowResult.outputs[e.outputsIndex].comfy_node_id:t(o).parent_task_node_id!==null?(y=t(o))==null?void 0:y.outputs[0].comfy_node_id:((W=t(o))==null?void 0:W.outputs[e.outputsIndex].comfy_node_id)??((X=t(o))==null?void 0:X.outputs[0].comfy_node_id)})},null,8,["height","width","src"]),t(i)&&t(i).progress===100?(d(),$(w,{key:0,slot:"second",height:t(n).outputMaxSize,width:t(n).outputMaxSize,fit:"cover",draggable:"false",src:("outputResultSrc"in c?c.outputResultSrc:t(fe))({task_id:t(i).task_id,node_id:t(i).outputs[0].comfy_node_id})},null,8,["height","width","src"])):(d(),$(w,{key:1,slot:"second",height:t(n).outputMaxSize,width:t(n).outputMaxSize,fit:"cover",draggable:"false",src:`${("buildBackendUrl"in c?c.buildBackendUrl:t(xt))()}/vix_logo.png`},null,8,["height","width","src"]))]}),_:1})):R("",!0),k("div",$a,[k("div",Ca,[k("div",Ia,[f(_,{id:`toggle-compare-${e.flowResult.task_id}-${e.outputsIndex}`,modelValue:t(O),"onUpdate:modelValue":v[1]||(v[1]=y=>Q(O)?O.value=y:null),size:"xs",class:"mr-2"},null,8,["id","modelValue"]),k("label",{class:"cursor-pointer select-none",for:`toggle-compare-${e.flowResult.task_id}-${e.outputsIndex}`}," Comparison ",8,Sa)]),k("div",Pa,[f(_,{id:`toggle-original-${e.flowResult.task_id}-${e.outputsIndex}`,modelValue:t(U),"onUpdate:modelValue":v[2]||(v[2]=y=>Q(U)?U.value=y:null),disabled:!t(O),size:"xs",class:"mr-2"},null,8,["id","modelValue","disabled"]),k("label",{class:"cursor-pointer select-none",for:`toggle-original-${e.flowResult.task_id}-${e.outputsIndex}`}," Original ",8,Ma)])]),t(O)?(d(),j("div",Ra,[f(p,{icon:"i-heroicons-arrow-small-left-20-solid",size:"2xs",variant:"soft",color:"cyan",disabled:t(U)||t(o).parent_task_id===null,onClick:x},null,8,["disabled"]),f(D,{items:u(t(o)),mode:"click",popper:{placement:"top"}},{default:b(()=>[f(p,{variant:"link",color:"white",size:"xs"},{default:b(()=>[G(" #"+J(t(U)?e.flowResult.task_id:t(o).task_id),1)]),_:1})]),_:1},8,["items"]),f(p,{icon:"i-heroicons-arrow-small-right-20-solid",size:"2xs",variant:"soft",color:"cyan",disabled:t(U)||!t(g),onClick:h},null,8,["disabled"]),f(P,{class:"mx-3",name:"i-heroicons-arrows-right-left-16-solid"}),f(p,{icon:"i-heroicons-arrow-small-left-20-solid",size:"2xs",variant:"soft",color:"cyan",disabled:!r(l.flowResult,t(i).parent_task_id,t(i).parent_task_node_id)||t(i).parent_task_id===Number(t(o).task_id)||t(i).parent_task_id===null,onClick:M},null,8,["disabled"]),f(D,{items:m(t(i)),mode:"click",popper:{placement:"top"}},{error:b(({item:y})=>[k("div",{class:"text-red-500 truncate",title:y.label},J(y.label),9,Fa)]),default:b(()=>[f(p,{class:le({"text-blue-500":t(i).progress!==100&&t(i).error==="","text-red-500":t(i).error!==""}),variant:"link",color:"white",size:"xs"},{default:b(()=>[G(J(t(i).progress===100?"#"+t(i).task_id:Math.ceil(t(i).progress)+"%"),1)]),_:1},8,["class"])]),_:1},8,["items"]),f(p,{icon:"i-heroicons-arrow-small-right-20-solid",size:"2xs",variant:"soft",color:"cyan",disabled:t(i).child_tasks.length===0,onClick:z},null,8,["disabled"]),f(a,{class:"ml-3",text:"Reset comparison",popper:{placement:"top"}},{default:b(()=>[f(p,{icon:"i-heroicons-arrow-path-rounded-square-solid",size:"2xs",variant:"outline",color:"white",onClick:v[3]||(v[3]=()=>S(!1,e.flowResult))})]),_:1})])):R("",!0)])])}}}),Va={class:"image-output"},za={class:"flex flex-col basis-full justify-between mx-2"},Ta=Y({__name:"Image",props:{flowResult:{type:Object,required:!0},handleSendToFlow:{type:Function,required:!0},openImageModal:{type:Function,required:!0}},setup(e){const l=he();return(n,s)=>{var m,x;const r=Ua,o=Ve,i=de,u=Ne;return d(),j("div",Va,[e.flowResult.outputs.length===1?(d(),j(te,{key:0},[(m=e.flowResult)!=null&&m.child_tasks&&((x=e.flowResult)==null?void 0:x.child_tasks.length)>0?(d(),$(r,{key:0,"flow-result":e.flowResult,"open-image-modal":e.openImageModal},null,8,["flow-result","open-image-modal"])):e.flowResult.outputs.length===1?(d(),$(o,{key:1,class:"mb-2 mx-auto rounded-lg cursor-pointer",height:t(l).$state.outputMaxSize,width:t(l).$state.outputMaxSize,draggable:"false",fit:"cover",loading:"lazy",src:("outputResultSrc"in n?n.outputResultSrc:t(fe))({task_id:e.flowResult.task_id,node_id:e.flowResult.outputs[0].comfy_node_id}),onClick:s[0]||(s[0]=h=>e.openImageModal(("outputResultSrc"in n?n.outputResultSrc:t(fe))({task_id:e.flowResult.task_id,node_id:e.flowResult.outputs[0].comfy_node_id})))},null,8,["height","width","src"])):R("",!0)],64)):e.flowResult.outputs.length>1?(d(),$(u,{key:1,class:"mb-3 rounded-lg overflow-hidden",items:e.flowResult.outputs.map((h,g)=>({task_id:e.flowResult.task_id,node_id:h.comfy_node_id,index:g})),ui:{item:"basis-full md:basis-1/2",indicators:{wrapper:"relative bottom-0 mt-4 md:hidden"}},page:1,indicators:""},{default:b(({item:h})=>{var g;return[k("div",za,[(g=e.flowResult)!=null&&g.child_tasks&&("hasChildTaskByParentTaskNodeId"in n?n.hasChildTaskByParentTaskNodeId:t(Jt))(e.flowResult,h.index,h.node_id)?(d(),$(r,{key:0,"flow-result":e.flowResult,"outputs-index":h.index,"open-image-modal":e.openImageModal},null,8,["flow-result","outputs-index","open-image-modal"])):(d(),$(o,{key:1,class:le(`mb-2 h-100 max-h-[${t(l).$state.outputMaxSize}px] mx-auto rounded-lg cursor-pointer`),draggable:"false",height:t(l).$state.outputMaxSize,width:t(l).$state.outputMaxSize,fit:"cover",loading:"lazy",src:("outputResultSrc"in n?n.outputResultSrc:t(fe))(h),onClick:M=>e.openImageModal(("outputResultSrc"in n?n.outputResultSrc:t(fe))(h))},null,8,["class","height","width","src","onClick"])),f(i,{class:"mt-2 w-fit mx-auto",icon:"i-heroicons-arrow-uturn-up-solid",color:"violet",size:"xs",variant:"outline",onClick:()=>{e.handleSendToFlow(e.flowResult,h.index)}},{default:b(()=>s[1]||(s[1]=[G(" Send to flow ")])),_:2},1032,["onClick"])])]}),_:1},8,["items"])):R("",!0)])}}}),Oa={class:"video-output"},ja=["width","height"],Na=["src"],Ba={class:"flex flex-col basis-full justify-between mx-2"},La=["width","height"],Aa=["src"],qa=Y({__name:"Video",props:{flowResult:{type:Object,required:!0}},setup(e){const l=he();return(n,s)=>{const r=Ne;return d(),j("div",Oa,[e.flowResult.outputs.length===1?(d(),j("video",{key:0,controls:"",class:"mb-2 mx-auto rounded-lg",style:{"max-height":"80vh"},width:t(l).$state.outputMaxSize,height:t(l).$state.outputMaxSize},[k("source",{src:("outputResultSrc"in n?n.outputResultSrc:t(fe))({task_id:e.flowResult.task_id,node_id:e.flowResult.outputs[0].comfy_node_id})},null,8,Na)],8,ja)):e.flowResult.outputs.length>1?(d(),$(r,{key:1,class:"mb-3 rounded-lg overflow-hidden",items:e.flowResult.outputs.map((o,i)=>({task_id:e.flowResult.task_id,node_id:o.comfy_node_id,index:i})),ui:{item:"basis-full md:basis-1/2",indicators:{wrapper:"relative bottom-0 mt-4 md:hidden"}},page:1,indicators:""},{default:b(()=>[k("div",Ba,[k("video",{controls:"",class:"mb-2 mx-auto rounded-lg",width:t(l).$state.outputMaxSize,height:t(l).$state.outputMaxSize},[k("source",{src:("outputResultSrc"in n?n.outputResultSrc:t(fe))({task_id:e.flowResult.task_id,node_id:e.flowResult.outputs[0].comfy_node_id})},null,8,Aa)],8,La)])]),_:1},8,["items"])):R("",!0)])}}}),Ea={class:"audio-output"},Da=["src"],Wa={class:"flex flex-col basis-full justify-between mx-2"},Ha=["src"],Ga=Y({__name:"Audio",props:{flowResult:{type:Object,required:!0}},setup(e){return(l,n)=>{const s=Ne;return d(),j("div",Ea,[e.flowResult.outputs.length===1?(d(),j("audio",{key:0,controls:"",class:"mb-2 mx-auto rounded-lg",src:("outputResultSrc"in l?l.outputResultSrc:t(fe))({task_id:e.flowResult.task_id,node_id:e.flowResult.outputs[0].comfy_node_id})},null,8,Da)):e.flowResult.outputs.length>1?(d(),$(s,{key:1,class:"mb-3 rounded-lg overflow-hidden",items:e.flowResult.outputs.map((r,o)=>({task_id:e.flowResult.task_id,node_id:r.comfy_node_id,index:o})),ui:{item:"basis-full md:basis-1/2",indicators:{wrapper:"relative bottom-0 mt-4 md:hidden"}},page:1,indicators:""},{default:b(()=>[k("div",Wa,[k("audio",{controls:"",class:"mb-2 mx-auto rounded-lg",src:("outputResultSrc"in l?l.outputResultSrc:t(fe))({task_id:e.flowResult.task_id,node_id:e.flowResult.outputs[0].comfy_node_id})},null,8,Ha)])]),_:1},8,["items"])):R("",!0)])}}}),Ja={class:"text-output"},Xa={key:0,class:"mb-2 mx-auto rounded-lg text-md p-4 pr-8 border border-slate-500 relative"},Qa=Y({__name:"Text",props:{flowResult:{type:Object,required:!0}},setup(e){const l=e,n=he(),s=be(),r=C(!1),o=C({});function i(u,m){const{$apiFetch:x}=Ye(),h=fe({task_id:u.task_id,node_id:m.comfy_node_id});return x(h).then(g=>{o.value[m.comfy_node_id]=g}).catch(g=>{console.error(g)}).finally(()=>{r.value=!1})}return ge(()=>{Promise.all(l.flowResult.outputs.filter(u=>u.type==="text").map(u=>i(l.flowResult,u)))}),(u,m)=>{const x=de,h=Ne;return d(),j("div",Ja,[e.flowResult.outputs.length===1?(d(),j("div",Xa,[t(r)?R("",!0):(d(),$(x,{key:0,variant:"outline",class:"absolute top-2 right-2 z-10",icon:"i-mdi-content-copy",size:"xs",color:"white",onClick:m[0]||(m[0]=()=>{("useCopyToClipboard"in u?u.useCopyToClipboard:t(Ge))().copy(t(o)[e.flowResult.outputs[0].comfy_node_id]),t(s).add({title:"Clipboard",description:"Text copied to clipboard"})})})),k("p",null,J(t(r)?"Loading...":t(o)[e.flowResult.outputs[0].comfy_node_id]),1)])):e.flowResult.outputs.length>1?(d(),$(h,{key:1,class:"mb-3 rounded-lg overflow-hidden",items:e.flowResult.outputs.map((g,M)=>({task_id:e.flowResult.task_id,node_id:g.comfy_node_id,index:M})),ui:{item:"basis-full md:basis-1/2",indicators:{wrapper:"relative bottom-0 mt-4"}},page:1,indicators:"",arrows:""},{default:b(({item:g})=>[k("div",{class:"mb-2 mx-2 rounded-lg text-md p-4 border border-slate-500 shadow-sm overflow-y-auto relative",style:Ze({"max-height":Math.ceil(t(n).$state.outputMaxSize/2)+"px"})},[t(r)?R("",!0):(d(),$(x,{key:0,variant:"outline",class:"absolute top-2 right-2 z-10",icon:"i-mdi-content-copy",size:"xs",color:"white",onClick:()=>{("useCopyToClipboard"in u?u.useCopyToClipboard:t(Ge))().copy(t(o)[g.node_id]),t(s).add({title:"Clipboard",description:"Text copied to clipboard"})}},null,8,["onClick"])),k("p",null,J(t(r)?"Loading...":t(o)[g.node_id]),1)],4)]),_:1},8,["items"])):R("",!0)])}}}),Ka=Symbol.for("nuxt:client-only"),Ya=Y({name:"ClientOnly",inheritAttrs:!1,props:["fallback","placeholder","placeholderTag","fallbackTag"],setup(e,{slots:l,attrs:n}){const s=C(!1);return ge(()=>{s.value=!0}),yt(Ka,!0),r=>{var m;if(s.value)return(m=l.default)==null?void 0:m.call(l);const o=l.fallback||l.placeholder;if(o)return o();const i=r.fallback||r.placeholder||"",u=r.fallbackTag||r.placeholderTag||"span";return j(u,n,i)}}}),Za={class:"3d-model-output"},eo=["src"],to={class:"flex flex-col basis-full justify-between mx-2"},lo=["src"],no=Y({__name:"3dModel",props:{flowResult:{type:Object,required:!0}},setup(e){ge(()=>{Cl(()=>import("./C5trISoi.js"),[],import.meta.url)});const l=he();return(n,s)=>{const r=Ya,o=Ne;return d(),j("div",Za,[e.flowResult.outputs.length===1?(d(),$(r,{key:0},{default:b(()=>[k("model-viewer",{"auto-rotate":"","camera-controls":"",class:"border border-slate-500 rounded-lg mx-auto mb-3",style:Ze({width:"100%",height:t(l).$state.outputMaxSize+"px"}),src:("outputResultSrc"in n?n.outputResultSrc:t(fe))({task_id:e.flowResult.task_id,node_id:e.flowResult.outputs[0].comfy_node_id})},null,12,eo)]),_:1})):e.flowResult.outputs.length>1?(d(),$(o,{key:1,class:"mb-3 rounded-lg overflow-hidden",items:e.flowResult.outputs.map((i,u)=>({task_id:e.flowResult.task_id,node_id:i.comfy_node_id,index:u})),ui:{item:"basis-full",indicators:{wrapper:"relative bottom-0 mt-4 md:hidden"}},page:1,indicators:""},{default:b(()=>[k("div",to,[f(r,null,{default:b(()=>[k("model-viewer",{"auto-rotate":"","camera-controls":"",style:Ze({width:t(l).$state.outputMaxSize+"px",height:t(l).$state.outputMaxSize+"px"}),src:("outputResultSrc"in n?n.outputResultSrc:t(fe))({task_id:e.flowResult.task_id,node_id:e.flowResult.outputs[0].comfy_node_id})},null,12,lo)]),_:1})])]),_:1},8,["items"])):R("",!0)])}}}),ao={class:"w-full h-full p-4"},oo={class:"mt-4 max-h-96 overflow-y-auto text-sm whitespace-pre-wrap"},so=Y({__name:"Params",props:{flowResult:{type:Object,required:!0}},setup(e){const l=e,n=C(!1),s=N(()=>["#"+l.flowResult.task_id,...Object.keys(l.flowResult.input_params_mapped).filter(u=>l.flowResult.input_params_mapped[u].value&&l.flowResult.input_params_mapped[u].value!=="").map(u=>n.value&&l.flowResult.translated_input_params_mapped&&l.flowResult.translated_input_params_mapped[u]?`${l.flowResult.input_params_mapped[u].display_name}: ${l.flowResult.translated_input_params_mapped[u].value}`:`${l.flowResult.input_params_mapped[u].display_name}: ${l.flowResult.input_params_mapped[u].value}`)].join(" | ")+`${l.flowResult.execution_time?" | execution_time: "+l.flowResult.execution_time.toFixed(2)+"s":""}`);et(()=>{l.flowResult.showInputFiles=!1,l.flowResult.showExecutionDetailsModal=!1});const r=N(()=>l.flowResult.execution_details&&l.flowResult.extra_flags!==null),o=N(()=>{const u={unload_models:l.flowResult.extra_flags.unload_models,max_memory_usage:l.flowResult.execution_details.max_memory_usage,disable_smart_memory:l.flowResult.execution_details.disable_smart_memory,vram_state:l.flowResult.execution_details.vram_state};return JSON.stringify(u,null,"	")});function i(){const u={extra_flags:l.flowResult.extra_flags,execution_details:l.flowResult.execution_details},m=new Blob([JSON.stringify(u,null,"	")],{type:"application/json"}),x=URL.createObjectURL(m),h=document.createElement("a");h.href=x,h.download=`${l.flowResult.task_id}_execution_details.json`,h.click(),window.URL.revokeObjectURL(x)}return(u,m)=>{const x=de,h=Ue,g=Xe,M=Je,z=ke;return d(),j(te,null,[t(r)?(d(),$(h,{key:0,modelValue:e.flowResult.showExecutionDetailsModal,"onUpdate:modelValue":m[2]||(m[2]=S=>e.flowResult.showExecutionDetailsModal=S)},{default:b(()=>[f(x,{class:"absolute top-4 right-4",icon:"i-heroicons-x-mark",variant:"ghost",onClick:m[0]||(m[0]=()=>e.flowResult.showExecutionDetailsModal=!1)}),k("div",ao,[m[6]||(m[6]=k("h3",{class:"text-center font-bold"}," Execution details ",-1)),k("div",oo,J(t(o)),1),f(x,{class:"mt-3",icon:"i-heroicons-arrow-down-tray-20-solid",variant:"outline",size:"xs",color:"gray",onClick:m[1]||(m[1]=()=>i())},{default:b(()=>m[5]||(m[5]=[G(" Download raw details ")])),_:1})])]),_:1},8,["modelValue"])):R("",!0),e.flowResult.translated_input_params_mapped&&Object.keys(e.flowResult.translated_input_params_mapped).length>0?(d(),$(g,{key:1,text:t(n)?"Hide translated input params":"Show translated input params",popper:{placement:"top"}},{default:b(()=>[f(x,{class:"mb-2 mr-2",color:"white",size:"xs",variant:"outline",icon:"i-heroicons-language-solid",onClick:m[3]||(m[3]=()=>{n.value=!t(n)})})]),_:1},8,["text"])):R("",!0),(d(!0),j(te,null,ve(t(s).split("|"),S=>(d(),$(M,{key:S,class:"mr-2 mb-2 last:mr-0 hover:cursor-pointer",variant:"soft",color:"gray",onClick:()=>{const U=("useCopyToClipboard"in u?u.useCopyToClipboard:t(Ge))(),O=S.indexOf(":"),I=S.substring(O+1).trim();U.copy(I),("useToast"in u?u.useToast:t(be))().add({title:"Clipboard",description:`${S.split(":")[0].trim()} copied to clipboard`,timeout:2e3})}},{default:b(()=>[G(J(S),1)]),_:2},1032,["onClick"]))),128)),e.flowResult.input_files.length>0?(d(),$(M,{key:2,class:"mr-2 mb-2 last:mr-0 hover:cursor-pointer select-none",variant:"subtle",color:"sky",onClick:m[4]||(m[4]=()=>{e.flowResult.showInputFiles=!e.flowResult.showInputFiles})},{default:b(()=>[f(z,{name:e.flowResult.showInputFiles?"i-heroicons-chevron-down":"i-heroicons-chevron-up",class:"mr-1"},null,8,["name"]),f(z,{name:"i-heroicons-document-solid",class:"mr-1"}),G(" "+J(`input_files: ${e.flowResult.input_files.length}`),1)]),_:1})):R("",!0)],64)}}}),io={key:0,class:le("w-full p-1")},ro={class:"flex flex-col basis-full justify-between mx-2"},uo=Y({__name:"InputFiles",props:{flowResult:{type:Object,required:!0}},setup(e){const l=he(),n=(i,u)=>`${Ht()}/tasks/inputs?task_id=${i}&input_index=${u}`,s=C(!1),r=C(""),o=C(0);return(i,u)=>{var M,z;const m=Ve,x=Ne,h=de,g=Ue;return e.flowResult.showInputFiles?(d(),j("div",io,[((M=Object.keys(e.flowResult.input_files))==null?void 0:M.length)===1?(d(),$(m,{key:0,class:le(`mb-5 mx-auto rounded-lg cursor-pointer max-h-[${t(l).$state.outputMaxSize}px] w-auto`),fit:"outside",loading:"lazy",src:n(e.flowResult.task_id,0),onClick:u[0]||(u[0]=()=>{r.value=n(e.flowResult.task_id,0),o.value=0,s.value=!0})},null,8,["class","src"])):R("",!0),((z=Object.keys(e.flowResult.input_files))==null?void 0:z.length)>1?(d(),$(x,{key:1,items:Object.keys(e.flowResult.input_files).map(S=>({task_id:e.flowResult.task_id,index:S})),ui:{item:"basis-full md:basis-1/2",indicators:{wrapper:"relative bottom-0 my-2"}},page:1,indicators:""},{default:b(({item:S})=>[k("div",ro,[f(m,{class:le(`mb-5 mx-auto rounded-lg cursor-pointer max-h-[${t(l).$state.outputMaxSize}px] w-auto`),fit:"outside",loading:"lazy",draggable:"false",src:n(S.task_id,S.index),onClick:()=>{r.value=n(e.flowResult.task_id,S.index),o.value=S.index,s.value=!0}},null,8,["class","src","onClick"])])]),_:1},8,["items"])):R("",!0),f(g,{modelValue:t(s),"onUpdate:modelValue":u[3]||(u[3]=S=>Q(s)?s.value=S:null),class:"z-[90]",transition:!1,fullscreen:""},{default:b(()=>[f(h,{class:"absolute top-4 right-4",icon:"i-heroicons-x-mark",variant:"ghost",onClick:u[1]||(u[1]=()=>s.value=!1)}),k("div",{class:"flex items-center justify-center w-full h-full p-4",onClick:u[2]||(u[2]=vt(()=>s.value=!1,["left"]))},[t(r)?(d(),$(m,{key:0,class:"lg:h-full",fit:"inside",loading:"lazy",placeholder:"/vix_logo.png",src:t(r)},null,8,["src"])):R("",!0)])]),_:1},8,["modelValue"])])):R("",!0)}}}),co={key:0,class:"text-red-300"},mo={class:"flex items-center"},fo={class:"p-2 max-w-48 max-h-48 not-italic"},po={class:"block font-medium text-gray-700 dark:text-gray-200"},vo={key:0,class:"flex items-center"},go=Y({__name:"InputParam",props:{inputParam:{type:Object,required:!0},index:{type:Number,required:!0},inputParamsMap:{type:Array,required:!0},advanced:{type:Boolean,default:!1}},setup(e){const l=e,n=N(()=>l.inputParam.type!=="bool"?l.inputParam.display_name:""),s=N(()=>["range"].includes(l.inputParam.type)?`value: ${l.inputParamsMap[l.index][l.inputParam.name].value}`:""),r=C(null);function o(i){const u=ll(i);u&&(l.inputParamsMap[l.index][l.inputParam.name].value=u)}return ge(()=>{l.inputParam.type==="text"&&r.value&&r.value.$refs.textarea.addEventListener("keydown",o)}),St(()=>{l.inputParam.type==="text"&&r.value&&r.value.$refs.textarea.removeEventListener("keydown",o)}),(i,u)=>{var I,c;const m=de,x=Je,h=Pt,g=Ft,M=Oe,z=lt,S=Qe,U=Vt,O=je;return(((I=e.inputParam)==null?void 0:I.advanced)||!1)===e.advanced&&!["image","image-mask","range_scale"].includes(e.inputParam.type)?(d(),$(O,{key:0,class:le(["mb-3",{italic:(c=e.inputParam)==null?void 0:c.dynamic_lora}]),help:t(s)},{hint:b(()=>[e.inputParam.optional?R("",!0):(d(),j("span",co,"required"))]),label:b(()=>{var v;return[k("div",mo,[(v=e.inputParam)!=null&&v.dynamic_lora&&e.inputParam.trigger_words.length>0?(d(),$(h,{key:0},{panel:b(()=>[k("div",fo,[u[7]||(u[7]=k("h4",{class:"mb-2 text-center"},"Trigger words",-1)),(d(!0),j(te,null,ve(e.inputParam.trigger_words,w=>(d(),$(x,{key:w,color:"violet",class:"mr-1 cursor-pointer",onClick:()=>{("useCopyToClipboard"in i?i.useCopyToClipboard:t(Ge))().copy(w),("useToast"in i?i.useToast:t(be))().add({title:"Clipboard",description:"Trigger word copied to clipboard",timeout:2e3})}},{default:b(()=>[G(J(w),1)]),_:2},1032,["onClick"]))),128))])]),default:b(()=>[f(m,{icon:"i-heroicons-information-circle",variant:"ghost",size:"xs",color:"gray",class:"mr-2"})]),_:1})):R("",!0),k("label",po,J(t(n)),1)])]}),default:b(()=>{var v;return[e.inputParam.type==="text"?(d(),$(g,{key:0,ref_key:"textareaInput",ref:r,size:"md",placeholder:e.inputParam.display_name,required:!e.inputParam.optional,resize:!0,label:e.inputParam.display_name,value:e.inputParamsMap[e.index][e.inputParam.name].value,autoresize:"",variant:"outline",onInput:u[0]||(u[0]=w=>{const V=w.target;e.inputParamsMap[e.index][e.inputParam.name].value=V.value})},null,8,["placeholder","required","label","value"])):R("",!0),e.inputParam.type==="number"?(d(),j(te,{key:1},[e.inputParam.name==="seed"?(d(),j("div",vo,[e.inputParam.type==="number"?(d(),$(M,{key:0,modelValue:e.inputParamsMap[e.index][e.inputParam.name].value,"onUpdate:modelValue":u[1]||(u[1]=w=>e.inputParamsMap[e.index][e.inputParam.name].value=w),type:"number",label:e.inputParam.display_name,required:!e.inputParam.optional,max:e.inputParam.max||100,min:e.inputParam.min||0,variant:"outline"},null,8,["modelValue","label","required","max","min"])):R("",!0),f(m,{icon:"i-heroicons-arrow-path",color:"violet",variant:"outline",size:"xs",class:"ml-2",onClick:u[2]||(u[2]=()=>{e.inputParamsMap[e.index][e.inputParam.name].value=Math.floor(Math.random()*1e7)})})])):(d(),$(M,{key:1,modelValue:e.inputParamsMap[e.index][e.inputParam.name].value,"onUpdate:modelValue":u[3]||(u[3]=w=>e.inputParamsMap[e.index][e.inputParam.name].value=w),type:"number",label:e.inputParam.display_name,required:!e.inputParam.optional,max:e.inputParam.max||100,min:e.inputParam.min||0,variant:"outline"},null,8,["modelValue","label","required","max","min"]))],64)):R("",!0),e.inputParam.type==="list"?(d(),$(z,{key:2,modelValue:e.inputParamsMap[e.index][e.inputParam.name].value,"onUpdate:modelValue":u[4]||(u[4]=w=>e.inputParamsMap[e.index][e.inputParam.name].value=w),placeholder:e.inputParam.display_name,options:Object.keys(e.inputParam.options)},null,8,["modelValue","placeholder","options"])):R("",!0),e.inputParam.type==="bool"?(d(),$(S,{key:3,modelValue:e.inputParamsMap[e.index][e.inputParam.name].value,"onUpdate:modelValue":u[5]||(u[5]=w=>e.inputParamsMap[e.index][e.inputParam.name].value=w),label:(v=e.inputParam)==null?void 0:v.display_name},null,8,["modelValue","label"])):R("",!0),["range","range_scale"].includes(e.inputParam.type)?(d(),$(U,{key:4,modelValue:e.inputParamsMap[e.index][e.inputParam.name].value,"onUpdate:modelValue":u[6]||(u[6]=w=>e.inputParamsMap[e.index][e.inputParam.name].value=w),label:e.inputParam.display_name,size:"sm",min:e.inputParam.min,max:e.inputParam.max,step:e.inputParam.step},null,8,["modelValue","label","min","max","step"])):R("",!0)]}),_:1},8,["class","help"])):R("",!0)}}}),ho={key:0,class:"heading"},wo={key:1},yo=Y({__name:"Params",props:{inputParamsMap:{type:Array,required:!0},additionalInputParamsMap:{type:Array,required:!1,default:[]},advanced:{type:Boolean,default:!1},flow:{type:Object,required:!0}},setup(e){const l=C(!0);return(n,s)=>{const r=ke,o=ht,i=go;return d(),j(te,null,[e.advanced?(d(),j("div",ho,[k("h4",{class:"text-md font-bold cursor-pointer select-none flex items-center mb-3",onClick:s[0]||(s[0]=()=>{l.value=!t(l)})},[f(r,{name:t(l)?"i-heroicons-chevron-up":"i-heroicons-chevron-down",class:"mr-2"},null,8,["name"]),s[1]||(s[1]=G(" Advanced options "))])])):R("",!0),t(l)?(d(),j("div",wo,[e.flow.input_params.filter(u=>(u.advanced||!1)===e.advanced&&!["image","image-mask","range_scale"].includes(u.type)).length===0?(d(),$(o,{key:0,type:"info",class:"mb-3",variant:"soft",color:"cyan",title:e.advanced?"No advanced input params to adjust":"No input params to adjust"},null,8,["title"])):R("",!0),(d(!0),j(te,null,ve(e.flow.input_params,(u,m)=>(d(),$(i,{key:m,"input-params-map":e.inputParamsMap,index:m,"input-param":u,advanced:e.advanced},null,8,["input-params-map","index","input-param","advanced"]))),128)),(d(!0),j(te,null,ve(e.additionalInputParamsMap,(u,m)=>(d(),$(i,{key:Object.keys(u)[0],"input-params-map":e.additionalInputParamsMap,index:m,"input-param":u[Object.keys(u)[0]],advanced:e.advanced},null,8,["input-params-map","index","input-param","advanced"]))),128))])):R("",!0)],64)}}}),bo=mt(Me.ui.strategy,Me.ui.tabs,Al),ko=Y({components:{UIcon:ke,HTabGroup:Wl,HTabList:Hl,HTab:Gl,HTabPanels:Jl,HTabPanel:Xl},inheritAttrs:!1,props:{modelValue:{type:Number,default:void 0},orientation:{type:String,default:"horizontal",validator:e=>["horizontal","vertical"].includes(e)},defaultIndex:{type:Number,default:0},items:{type:Array,default:()=>[]},unmount:{type:Boolean,default:!1},content:{type:Boolean,default:!0},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})}},emits:["update:modelValue","change"],setup(e,{emit:l}){const{ui:n,attrs:s}=pt("tabs",Be(e,"ui"),bo,Be(e,"class")),r=C(),o=C([]),i=C(),u=C(e.modelValue||e.defaultIndex);function m(h){var M;const g=(M=o.value[h])==null?void 0:M.$el;g&&i.value&&(i.value.style.top=`${g.offsetTop}px`,i.value.style.left=`${g.offsetLeft}px`,i.value.style.width=`${g.offsetWidth}px`,i.value.style.height=`${g.offsetHeight}px`)}function x(h){u.value=h,l("change",h),e.modelValue!==void 0&&l("update:modelValue",u.value),m(u.value)}return Wt(r,()=>{m(u.value)}),pe(()=>e.modelValue,h=>{u.value=h,m(u.value)}),pe(()=>e.items,async()=>{await bt(),m(u.value)},{deep:!0}),ge(async()=>{await bt(),m(u.value)}),Il(()=>Sl()),{ui:n,attrs:s,listRef:r,itemRefs:o,markerRef:i,selectedIndex:u,onChange:x}}}),xo=["aria-label"],_o={class:"truncate"};function $o(e,l,n,s,r,o){const i=ke,u=Se("HTab"),m=Se("HTabList"),x=Se("HTabPanel"),h=Se("HTabPanels"),g=Se("HTabGroup");return d(),$(g,Te({vertical:e.orientation==="vertical","selected-index":e.selectedIndex,as:"div",class:e.ui.wrapper},e.attrs,{onChange:e.onChange}),{default:b(()=>[f(m,{ref:"listRef",class:le([e.ui.list.base,e.ui.list.background,e.ui.list.rounded,e.ui.list.shadow,e.ui.list.padding,e.ui.list.width,e.orientation==="horizontal"&&e.ui.list.height,e.orientation==="horizontal"&&"inline-grid items-center"]),style:Ze([e.orientation==="horizontal"&&`grid-template-columns: repeat(${e.items.length}, minmax(0, 1fr))`])},{default:b(()=>[k("div",{ref:"markerRef",class:le(e.ui.list.marker.wrapper)},[k("div",{class:le([e.ui.list.marker.base,e.ui.list.marker.background,e.ui.list.marker.rounded,e.ui.list.marker.shadow])},null,2)],2),(d(!0),j(te,null,ve(e.items,(M,z)=>(d(),$(u,{key:z,ref_for:!0,ref:"itemRefs",disabled:M.disabled,as:"template"},{default:b(({selected:S,disabled:U})=>[k("button",{"aria-label":M.ariaLabel,class:le([e.ui.list.tab.base,e.ui.list.tab.background,e.ui.list.tab.height,e.ui.list.tab.padding,e.ui.list.tab.size,e.ui.list.tab.font,e.ui.list.tab.rounded,e.ui.list.tab.shadow,S?e.ui.list.tab.active:e.ui.list.tab.inactive])},[Fe(e.$slots,"icon",{item:M,index:z,selected:S,disabled:U},()=>[M.icon?(d(),$(i,{key:0,name:M.icon,class:le(e.ui.list.tab.icon)},null,8,["name","class"])):R("",!0)]),Fe(e.$slots,"default",{item:M,index:z,selected:S,disabled:U},()=>[k("span",_o,J(M.label),1)])],10,xo)]),_:2},1032,["disabled"]))),128))]),_:3},8,["class","style"]),e.content?(d(),$(h,{key:0,class:le(e.ui.container)},{default:b(()=>[(d(!0),j(te,null,ve(e.items,(M,z)=>(d(),$(x,{key:z,class:le(e.ui.base),unmount:e.unmount},{default:b(({selected:S})=>[Fe(e.$slots,M.slot||"item",{item:M,index:z,selected:S},()=>[G(J(M.content),1)])]),_:2},1032,["class","unmount"]))),128))]),_:3},8,["class"])):R("",!0)]),_:3},16,["vertical","selected-index","class","onChange"])}const Co=ft(ko,[["render",$o]]),Io={class:"p-4"},So={class:"text-center mb-4"},Po={class:"text-lg"},Mo={key:0,class:"text-sm text-slate-500"},Ro={class:"text-md text-center text-red-500 mb-4"},Fo={key:1},Uo={class:"flex justify-center mb-4"},Vo={key:0,class:"text-sm text-slate-500 text-center mb-4"},zo={class:"flex items-center justify-between"},To=Y({__name:"Modal",props:He({flowResult:{type:Object,required:!1,default:()=>null},outputImgSrc:{type:String,required:!0},outputParamIndex:{type:Number,required:!0},inputParamsMapped:{type:Object,required:!0},isChildTask:{type:Boolean,required:!1,default:!1},translatePrompt:{type:Boolean,required:!1,default:!1}},{show:{default:!1,type:Boolean},showModifiers:{}}),emits:He(["update:show"],["update:show"]),setup(e,{emit:l}){const n=e,s=Le(e,"show"),r=[{key:"send-to-flow-output",label:"Send to flow"},{key:"send-to-flow-params",label:"Edit params",description:"Edit prompt params before sending to sub-flow"}],o=C(0),i=he(),u=be(),m=N(()=>i.sub_flows.map(w=>({value:w.name,label:`${w.display_name} - ${w.description}`}))),x=C(m.value[0]||""),h=C({}),g=C([]),M=N(()=>g.value.every(w=>{if(!w||Object.keys(w).length===0)return!0;const V=Object.keys(w)[0],_=w[V];return _.optional?!0:_.type==="text"?_.value!=="":!0}));pe(()=>x.value,w=>{z(w)});function z(w){h.value=i.sub_flows.find(V=>V.name===w.value),h.value&&(g.value=h.value.input_params.reduce((V,_)=>{if(["image","image-mask","range_scale"].includes(_.type))return V.push({}),V;const p={[_.name]:{value:null,display_name:_.display_name,type:_.type,optional:_.optional,advanced:_.advanced||!1,default:_.default||"",dynamic_lora:_.dynamic_lora||!1,trigger_words:_.trigger_words||[]}};return _.type==="text"?(p[_.name].value=_.default||"",p[_.name].translatable=_.translatable||!1):_.type==="number"||_.type==="range"?(p[_.name].value=_.default||0,p[_.name].min=_.min||0,p[_.name].max=_.max||100,p[_.name].step=_.step||1):_.type==="list"?(p[_.name].value=Object.keys(_.options)[0]||"",p[_.name].default=Object.keys(_.options)[0]||""):_.type==="bool"&&(p[_.name].default=_.default||!1),V.push(p),V},[]),c.value=1)}const S=C(!1),U=l;function O(){console.debug("[Send to flow]: ",x.value);const w=i.sub_flows.find(_=>_.name===x.value.value&&_.display_name===x.value.label.split(" - ")[0]);if(console.debug("[Send to flow]: targetFlow",w),!w){be().add({title:`Target sub-flow "${x.value.value}" not found`,description:"Please, verify the target sub-flow is installed and available and try again",timeout:5e3});return}if(!M.value){be().add({title:"Missing required input params",description:"Please, fill in all required input params before sending to sub-flow",timeout:5e3}),o.value=1;return}const V=w.input_params.reduce((_,p)=>{const D={};let P=g.value.find(a=>Object.keys(a)[0]===p.name);return P=P?P[p.name].value:null,p.type==="text"?D[p.name]={value:P??(p.default||""),type:p.type}:p.type==="number"?D[p.name]={value:P??(p.default||0),type:p.type}:p.type==="image"?D[p.name]={value:JSON.stringify({task_id:n.flowResult.task_id,node_id:n.flowResult.outputs.length>1?n.flowResult.outputs[n.outputParamIndex].comfy_node_id:n.flowResult.outputs[0].comfy_node_id})||"",type:p.type}:p.type==="list"?D[p.name]={value:P??(p.default||Object.keys(p.options)[0]||""),type:p.type,options:p.options}:p.type==="bool"?D[p.name]={value:P??(p.default||!1),type:p.type}:["range","range_scale"].includes(p.type)&&(D[p.name]={value:P??(p.default||0),type:p.type}),_.push(D),_},[]);console.debug("[Send to flow]: input_params_map",V),S.value=!0,i.runFlow(w,V,c.value,n.translatePrompt,I.value,I.value?Number(n.flowResult.task_id):null).then(()=>{u.add({title:"Task sent to sub-flow",description:`Task ${n.flowResult.task_id} sent to sub-flow ${x.value.value}`,timeout:5e3})}).finally(()=>{S.value=!1,U("update:show",!1)})}const I=C(!1),c=C(1),v=N(()=>{var w;return n.flowResult.progress===100&&((w=n.flowResult)==null?void 0:w.error)===""});return pe(()=>c.value,w=>{w>1&&I.value&&(I.value=!1)}),ge(()=>{var V,_;const w=n.flowResult?((_=(V=n==null?void 0:n.flowResult)==null?void 0:V.outputs[n.outputParamIndex])==null?void 0:_.type)??"image":"image";i.fetchSubFlows(w).then(()=>{x.value=m.value[0]||"",z(x.value)}),I.value=!1}),(w,V)=>{const _=lt,p=Ve,D=ht,P=yo,a=Oe,y=je,W=Qe,X=Xe,ee=de,ie=Co,se=Ue;return d(),$(se,{modelValue:s.value,"onUpdate:modelValue":V[6]||(V[6]=ae=>s.value=ae),transition:!1},{default:b(()=>[k("div",Io,[f(ie,{modelValue:t(o),"onUpdate:modelValue":V[5]||(V[5]=ae=>Q(o)?o.value=ae:null),items:r,class:"w-full"},{item:b(({item:ae})=>[k("div",So,[k("h2",Po,J(ae.label),1),ae.description?(d(),j("p",Mo,J(ae.description),1)):R("",!0)]),k("p",Ro,[t(m).length>0?(d(),$(_,{key:0,modelValue:t(x),"onUpdate:modelValue":V[0]||(V[0]=K=>Q(x)?x.value=K:null),class:"w-full",searchable:"",size:"lg",options:t(m)},null,8,["modelValue","options"])):(d(),j("span",Fo,"No sub-flows available"))]),ae.key==="send-to-flow-output"?(d(),j(te,{key:0},[k("div",Uo,[t(v)?(d(),$(p,{key:0,src:e.outputImgSrc,class:"w-1/2 rounded-lg",draggable:!1},null,8,["src"])):(d(),$(D,{key:1,color:"orange",icon:"i-heroicons-exclamation-circle-solid",title:`Task is still running (${Math.ceil(e.flowResult.progress)}%, ${e.flowResult.execution_time.toFixed(2)}s)`,description:e.flowResult.error!==""?e.flowResult.error:""},null,8,["title","description"]))]),e.inputParamsMapped?(d(),j("p",Vo,J(["#"+e.flowResult.task_id,...Object.keys(e.inputParamsMapped).filter(K=>e.inputParamsMapped[K].value!=="").map(K=>`${e.inputParamsMapped[K].display_name}: ${e.inputParamsMapped[K].value}`)].join(" | ")),1)):R("",!0)],64)):R("",!0),ae.key==="send-to-flow-params"?(d(),j(te,{key:1},[t(g).length>0?(d(),$(P,{key:0,"input-params-map":t(g),"onUpdate:inputParamsMap":V[1]||(V[1]=K=>Q(g)?g.value=K:null),flow:t(h),advanced:!1},null,8,["input-params-map","flow"])):R("",!0),t(g).length>0?(d(),$(P,{key:1,"input-params-map":t(g),"onUpdate:inputParamsMap":V[2]||(V[2]=K=>Q(g)?g.value=K:null),flow:t(h),advanced:!0},null,8,["input-params-map","flow"])):R("",!0),t(g).length===0?(d(),$(D,{key:2,class:"mb-4",title:"No input params",description:"No input params available for selected sub-flow",variant:"soft",color:"primary"})):R("",!0)],64)):R("",!0),e.isChildTask?(d(),$(D,{key:2,class:"mb-4",icon:"i-heroicons-exclamation-circle-solid",title:"Child task",description:"The latest child task is always used as input for sub-flow"})):R("",!0),t(h)&&t(h).is_count_supported?(d(),$(y,{key:3,label:"Number of results"},{default:b(()=>[f(a,{modelValue:t(c),"onUpdate:modelValue":V[3]||(V[3]=K=>Q(c)?c.value=K:null),type:"number",min:"1",max:"50",label:"Batch size",class:"mb-3 max-w-fit flex justify-end"},null,8,["modelValue"])]),_:1})):R("",!0),k("div",zo,[f(X,{text:t(c)>1?"Multiple number of results is not supported for child tasks":""},{default:b(()=>[f(W,{modelValue:t(I),"onUpdate:modelValue":V[4]||(V[4]=K=>Q(I)?I.value=K:null),label:"Bind as child task",disabled:t(c)>1},null,8,["modelValue","disabled"])]),_:1},8,["text"]),f(ee,{icon:"i-heroicons-arrow-uturn-up-solid",color:"violet",variant:"outline",loading:t(S),disabled:t(m).length===0||e.isChildTask&&!t(v),onClick:O},{default:b(()=>V[7]||(V[7]=[G(" Send ")])),_:1},8,["loading","disabled"])])]),_:1},8,["modelValue"])])]),_:1},8,["modelValue"])}}}),Oo={class:"flex flex-col md:flex-row items-center justify-center mb-5 sticky top-1 z-[10]"},jo={class:"flex items-center justify-center"},No={class:"p-4"},Bo={class:"text-md text-center text-red-500 mb-4"},Lo={class:"flex justify-center"},Ao={key:0,class:"results overflow-auto"},qo=["id"],Eo={class:"text-sm text-slate-500 text-center mb-1"},Do={class:"w-5/6 mx-auto flex flex-wrap items-center justify-center"},Wo={class:"w-full flex justify-center items-center"},Ho={key:1,class:"text-center text-slate-500"},Go=Y({__name:"Output",emits:["copy-prompt-inputs"],setup(e,{emit:l}){const n=he(),s=N(()=>{var P;return n.flowResultsByName((P=n.currentFlow)==null?void 0:P.name).length>0||!1}),r=N(()=>{var P;return n.flowResultsByName((P=n.currentFlow)==null?void 0:P.name)||[]}),o=N(()=>n.$state.resultsPageSize);pe(r,()=>{r.value.length<=n.$state.resultsPageSize?n.$state.resultsPage=1:n.$state.resultsPage>Math.ceil(r.value.length/n.$state.resultsPageSize)&&(n.$state.resultsPage=Math.ceil(r.value.length/n.$state.resultsPageSize))}),pe(o,()=>{r.value.length<=n.$state.resultsPageSize?n.$state.resultsPage=1:n.$state.resultsPage>Math.ceil(r.value.length/n.$state.resultsPageSize)&&(n.$state.resultsPage=Math.ceil(r.value.length/n.$state.resultsPageSize)),n.saveUserOptions()}),et(()=>{n.$state.flow_results_filter="",n.$state.resultsPage=1});const i=l;function u(P){i("copy-prompt-inputs",P.input_params_mapped)}function m(P){S.value=P,z.value=!0}const x=C(null),h=C(!1);window.addEventListener("scroll",()=>{var P;h.value=window.scrollY>(((P=x.value)==null?void 0:P.offsetTop)+window.screen.height||0)});const g=N(()=>n.$state.resultsPage);pe(g,()=>{const P=document.getElementById("output-container");P&&P.scrollIntoView({behavior:"smooth"})});const M=C(!1),z=C(!1),S=C(""),U=C(!1),O=C(!1),I=C(!1),c=C(""),v=C(null),w=C({}),V=C(0),_=C(!1);function p(P,a=0){if(P.child_tasks.length===0||!Jt(P,a,P.outputs[a].comfy_node_id))v.value=P,c.value=fe({task_id:P.task_id,node_id:P.outputs[a].comfy_node_id}),w.value=P.input_params_mapped,_.value=!1;else{const y=Gt(P,a,P.outputs[a].comfy_node_id);v.value=y,w.value=P.input_params_mapped,c.value=fe({task_id:y.task_id,node_id:y.outputs[0].comfy_node_id}),_.value=!0}V.value=a,I.value=!0}function D(P){var X;const a=P.extra_flags!==null&&((X=P==null?void 0:P.extra_flags)==null?void 0:X.profiler_execution),y=[{label:"Comfy flow",labelClass:"text-blue-500 text-sm",icon:"i-heroicons-arrow-down-tray",iconClass:"bg-blue-500 h-4 w-4",click:()=>{var ee;return n.downloadFlowComfy((ee=n.currentFlow)==null?void 0:ee.name,P.task_id)}}];a&&y.push({label:"Execution details",labelClass:"text-orange-500 text-sm",icon:"i-mdi-bug",iconClass:"bg-orange-500 h-4 w-4",click:()=>{P.execution_details?P.showExecutionDetailsModal=!0:n.fetchTaskHistoryItem(P.task_id).then(ee=>{P.execution_details=ee.execution_details,P.showExecutionDetailsModal=!0})}});const W=[[{label:"Use params",labelClass:"text-cyan-500 text-sm",icon:"i-heroicons-document-duplicate-16-solid",iconClass:"bg-cyan-500 h-4 w-4",click:()=>u(P)}],y];return P.outputs.length===1&&P.outputs.every(ee=>ee.type==="image")&&W.splice(1,0,[{label:"Send to flow",labelClass:"text-violet-500 text-sm",icon:"i-heroicons-arrow-uturn-up-solid",iconClass:"bg-violet-500 h-4 w-4",click:()=>{p(P)}}]),W}return(P,a)=>{var H;const y=xa,W=ke,X=Oe,ee=Vl,ie=Ol,se=de,ae=gt,K=Je,oe=Ue,_e=Ta,Re=qa,$e=Ga,ue=Qa,ne=no,q=so,T=uo,F=To,L=Ve;return d(),j("div",{id:"output-container",ref_key:"outputContainer",ref:x,class:"w-full p-4 ring-1 ring-gray-200 dark:ring-gray-800 rounded-lg shadow-md my-10"},[f(y,{show:t(h),class:"fixed bottom-5 right-5",target:"output-container"},null,8,["show"]),k("h2",{class:"text-lg font-bold cursor-pointer select-none flex items-center mb-3",onClick:a[0]||(a[0]=()=>{M.value=!t(M)})},[f(W,{name:t(M)?"i-heroicons-chevron-down":"i-heroicons-chevron-up",class:"mr-2"},null,8,["name"]),G(" Output ("+J(t(r).filter(B=>B.parent_task_id===null&&!B.hidden).length)+") ",1)]),t(M)?R("",!0):(d(),j(te,{key:0},[k("div",Oo,[f(X,{modelValue:t(n).$state.flow_results_filter,"onUpdate:modelValue":a[1]||(a[1]=B=>t(n).$state.flow_results_filter=B),icon:"i-heroicons-magnifying-glass-20-solid",color:"white",class:"md:mr-3",label:"Filter by prompt",trailing:!0,placeholder:"Filter results by prompt"},null,8,["modelValue"]),t(r).filter(B=>B.parent_task_id===null&&!B.hidden).length>t(n).$state.resultsPageSize?(d(),$(ee,{key:0,modelValue:t(n).$state.resultsPage,"onUpdate:modelValue":a[2]||(a[2]=B=>t(n).$state.resultsPage=B),class:"my-1 md:my-0","page-count":t(n).$state.resultsPageSize,total:t(r).filter(B=>B.parent_task_id===null&&!B.hidden).length,"show-first":"","show-last":""},null,8,["modelValue","page-count","total"])):R("",!0),k("div",jo,[f(ie,{modelValue:t(n).resultsPageSize,"onUpdate:modelValue":a[3]||(a[3]=B=>t(n).resultsPageSize=B),class:"md:mx-3 w-fit mr-3",options:[5,10,20,50,100],label:"Results per page"},null,8,["modelValue"]),f(ae,{items:[[{label:"Delete all results",labelClass:"text-red-500",icon:"i-heroicons-trash",iconClass:"dark:text-red-500 text-red-500",click:()=>U.value=!0}]],mode:"click",label:"Options",popper:{placement:"bottom-end"}},{default:b(()=>[f(se,{color:"white",icon:"i-heroicons-ellipsis-vertical-16-solid"})]),_:1},8,["items"])]),f(oe,{modelValue:t(U),"onUpdate:modelValue":a[6]||(a[6]=B=>Q(U)?U.value=B:null),class:"z-[90]",transition:!1},{default:b(()=>[k("div",No,[a[15]||(a[15]=k("p",{class:"text-lg text-center mb-4"},"Are you sure you want to delete all results?",-1)),k("p",Bo,[a[11]||(a[11]=G(" All history and images of ")),f(K,{class:"mx-1",color:"orange",variant:"outline"},{default:b(()=>[G(J(t(n).currentFlow.display_name),1)]),_:1}),a[12]||(a[12]=G(" will be deleted. "))]),k("div",Lo,[f(se,{class:"mr-2",color:"red",variant:"outline",loading:t(O),onClick:a[4]||(a[4]=()=>{var B;O.value=!0,t(n).deleteFlowResults((B=t(n).currentFlow)==null?void 0:B.name).then(()=>{O.value=!1,U.value=!1})})},{default:b(()=>a[13]||(a[13]=[G(" Yes ")])),_:1},8,["loading"]),f(se,{variant:"outline",onClick:a[5]||(a[5]=()=>U.value=!1)},{default:b(()=>a[14]||(a[14]=[G("No")])),_:1})])])]),_:1},8,["modelValue"])]),t(s)?(d(),j("div",Ao,[(d(!0),j(te,null,ve(t(n).flowResultsByNamePaginated((H=t(n).currentFlow)==null?void 0:H.name),B=>(d(),j("div",{id:"task_id_"+B.task_id,key:B.task_id,class:"flex flex-col justify-center mx-auto mb-5"},[B.outputs.some(A=>["image","image-animated"].includes(A.type))?(d(),$(_e,{key:0,"flow-result":B,"handle-send-to-flow":p,"open-image-modal":m},null,8,["flow-result"])):B.outputs.some(A=>A.type==="video")?(d(),$(Re,{key:1,"flow-result":B},null,8,["flow-result"])):B.outputs.some(A=>A.type==="audio")?(d(),$($e,{key:2,"flow-result":B},null,8,["flow-result"])):B.outputs.some(A=>A.type==="text")?(d(),$(ue,{key:3,"flow-result":B},null,8,["flow-result"])):B.outputs.some(A=>A.type==="3d-model")?(d(),$(ne,{key:4,"flow-result":B},null,8,["flow-result"])):R("",!0),k("div",Eo,[k("div",Do,[f(q,{"flow-result":B},null,8,["flow-result"])])]),f(T,{"flow-result":B},null,8,["flow-result"]),k("div",Wo,[f(se,{class:"mr-3",color:"red",icon:"i-heroicons-trash",variant:"outline",size:"xs",onClick:()=>t(n).deleteFlowHistory(B.task_id)},{default:b(()=>a[16]||(a[16]=[G(" Delete ")])),_:2},1032,["onClick"]),f(ae,{items:D(B),mode:"click",popper:{placement:"bottom-start"}},{default:b(()=>[f(se,{color:"white",icon:"i-heroicons-ellipsis-vertical-16-solid",size:"xs"})]),_:2},1032,["items"])])],8,qo))),128)),f(F,{show:t(I),"onUpdate:show":a[7]||(a[7]=B=>Q(I)?I.value=B:null),"flow-result":t(v),"output-img-src":t(c),"output-param-index":t(V),"input-params-mapped":t(w),"is-child-task":t(_)},null,8,["show","flow-result","output-img-src","output-param-index","input-params-mapped","is-child-task"])])):(d(),j("p",Ho," No output results available "))],64)),f(oe,{modelValue:t(z),"onUpdate:modelValue":a[10]||(a[10]=B=>Q(z)?z.value=B:null),class:"z-[90]",transition:!1,fullscreen:""},{default:b(()=>[f(se,{class:"absolute top-4 right-4",icon:"i-heroicons-x-mark",variant:"ghost",onClick:a[8]||(a[8]=()=>z.value=!1)}),k("div",{class:"flex items-center justify-center w-full h-full p-4",onClick:a[9]||(a[9]=vt(()=>z.value=!1,["left"]))},[t(S)?(d(),$(L,{key:0,class:"lg:h-full",fit:"inside",loading:"lazy",src:t(S)},null,8,["src"])):R("",!0)])]),_:1},8,["modelValue"])],512)}}}),Jo=Pl("civitAiStore",{actions:{fetchFlowLoras(e,l,n=50,s=null){if(!e.lora_connect_points||Object.keys(e.lora_connect_points).length!==1){console.debug("Flow does not have lora_connect_points or has more than one, skipping fetching loras");return}const{$apiFetch:r}=Ye();let i=`https://civitai.com/api/v1/models?baseModels=${e.lora_connect_points[Object.keys(e.lora_connect_points)[0]].base_model_type}&types=LORA&limit=${n}`;s&&(s.includes(window.location.hostname)&&(s=s.replace(window.location.hostname,"civitai.com")),i=s);const u=`/other/proxy?target=${encodeURIComponent(i)}`;return r(u,{method:"GET",headers:{Authentication:"Bearer "+l,Accept:"application/json"}})},fetchFlowLorasByHash(e,l,n){if(!e.lora_connect_points||Object.keys(e.lora_connect_points).length!==1){console.debug("Flow does not have lora_connect_points or has more than one, skipping fetching loras");return}const{$apiFetch:s}=Ye(),r=`https://civitai.com/api/v1/model-versions/by-hash/${n}`,o=`/other/proxy?target=${encodeURIComponent(r)}`;return s(o,{method:"GET",headers:{Authentication:"Bearer "+l,Accept:"application/json"}})}}}),Xo={class:"p-4 overflow-y-auto relative"},Qo={key:1},Ko={class:"flex flex-col justify-between w-full md:flex-row md:gap-4 md:items-center lg:items-start"},Yo={class:"flex flex-col gap-2 lg:flex-row md:justify-end items-start w-full"},Zo={class:"flex flex-col md:flex-row flex-wrap gap-2 justify-between items-center w-full px-4 py-3"},es={class:"flex items-center gap-1.5"},ts={class:"flex gap-1.5 items-center"},ls={class:"flex items-center h-5"},ns=["checked","indeterminate","onChange"],as=["href"],os=["innerHTML"],ss={class:"p-4 max-h-64 max-w-xl overflow-y-auto"},is={key:0},rs={class:"flex items-center"},us={class:"flex items-center"},ds={key:0,class:"flex justify-center space-x-2 w-full"},cs={key:1,controls:"",width:256,height:256},ms=["src"],fs={class:"flex justify-end"},ps=Y({__name:"LoraSelectorModal",props:He({flow:{}},{show:{default:!1,type:Boolean},showModifiers:{}}),emits:["update:show"],setup(e){const l=e,n=Le(e,"show"),s=be(),r=he(),o=Et(),i=Jo(),u=C(!1),m=C({items:[],metadata:{}}),x=N(()=>o.settingsMap.civitai_auth_token.value!==""),h=N(()=>o.settingsMap.civitai_auth_token.value||""),g=[{key:"name",label:"Name",sortable:!0,class:""},{key:"description",label:"Description",sortable:!1,class:""},{key:"trigger_words",label:"Trigger words",sortable:!1,class:""},{key:"nsfw",label:"NSFW",sortable:!1,class:""},{key:"statsDownloadCount",label:"Download count",sortable:!1,class:""},{key:"statsThumbsUpCount",label:"Thumbs up",sortable:!1,class:""},{key:"modelVersion",label:"Model version",sortable:!1,class:""},{key:"actions",label:"Actions",sortable:!1,class:""}],M=C([]);pe(M,(T,F)=>{F.filter(H=>!T.includes(H)).forEach(H=>{H.currentFlowLora&&W(H)})});const z=C({openedRows:[],row:{}}),S=C(""),U=()=>{S.value=""},O=N(()=>{var F;let T=((F=m.value)==null?void 0:F.items)||[];return S.value&&(T=T.filter(L=>L.name.toLowerCase().includes(S.value.toLowerCase()))),T.forEach(L=>{!I.value[L.id]&&(L==null?void 0:L.modelVersions.length)>0&&(I.value[L.id]=L==null?void 0:L.modelVersions[0].name);const H=Object.keys(ue.value);L.modelVersions.forEach(B=>{H.includes(B.files[0].hashes.SHA256.toLowerCase())&&ue.value[B.files[0].hashes.SHA256.toLowerCase()]!==null&&(I.value[L.id]=B.name,L.currentFlowLora=!0,M.value.includes(L)||M.value.push(L))})}),T}),I=C({});function c(T){var F;return((F=T.modelVersions.find(L=>L.name===I.value[T.id]))==null?void 0:F.images)||T.modelVersions[0].images||[]}function v(T){var F;return((F=T.modelVersions.find(L=>L.name===I.value[T.id]))==null?void 0:F.trainedWords)||T.modelVersions[0].trainedWords||[]}const w=C(!0),V=C(""),_=C(l.flow.display_name),p=C(l.flow.description),D=C(l.flow.license),P=C(l.flow.required_memory_gb||0),a=C(l.flow.version);function y(){const T=Object.keys(l.flow.lora_connect_points)[0],L=l.flow.lora_connect_points[T].connected_loras.filter(A=>ue.value[A.hash]!==null).map(A=>({display_name:A.display_name,model_url:A.url,strength_model:A.strength_model})),H={[T]:[]};w.value&&H[T].push(...L);const B=M.value.reduce((A,Z)=>{const ce=Z.modelVersions.find(xe=>xe.name===I.value[Z.id]);if(!ce||ue.value[ce.files[0].hashes.SHA256.toLowerCase()])return A;const ye={strength_model:1,model_url:ce.downloadUrl,display_name:Z.name};return A.push(ye),A},[]);return H[T].push(...B),console.debug("[DEBUG] newFlowConnectionPoints: ",H),H}function W(T){const F=T.modelVersions.find(B=>B.name===I.value[T.id]);if(!F)return;const L=F.files[0].hashes.SHA256.toLowerCase();ue.value[L]&&(ue.value[L]=null);const H=M.value.indexOf(T);H!==-1&&M.value.splice(H,1),T.currentFlowLora=!1}const X=N(()=>r.flows.find(T=>T.name===V.value)),ee=N(()=>/^[a-z0-9_-]+$/i.test(V.value)),ie=N(()=>V.value!==""&&ee&&!X.value),se=N(()=>V.value===""?"Flow name is required.":ee.value?X.value?"Flow name already exists.":"":"Flow name can only contain letters, numbers, dashes and underscores."),ae=N(()=>Object.values(ue.value).some(T=>T===null)),K=N(()=>M.value.filter(T=>!ue.value[T.modelVersions[0].files[0].hashes.SHA256.toLowerCase()]).length!==0),oe=N(()=>K.value||ae.value),_e=N(()=>(K.value||ae.value)&&ie.value&&_.value!==""&&p.value!==""),Re=N(()=>K.value?ie.value?_.value===""?"Please provide a display name.":p.value===""?"Please provide a description.":"":"Please provide a valid flow name.":"No LoRAs selected");function $e(){if(M.value.length===0&&!ae.value){s.add({title:"No LoRAs selected",description:"Please select at least one LoRA to apply and install."});return}const T={new_name:V.value,new_display_name:_.value,new_description:p.value,new_license:D.value,new_required_memory_gb:P.value,new_version:a.value,new_lora_connection_points:y()};console.debug("[DEBUG] Clone flow params: ",T),u.value=!0,r.cloneFlow(l.flow,T).then(()=>{r.fetchFlows();const F=Xt();s.add({title:"Flow clone applied",actions:[{label:"View flow",click:()=>{F.push("/workflows/"+V.value)}}]})}).catch(F=>{console.error("Error applying and installing flow: ",F.message||"Unknown error"),s.add({title:"Error applying and installing flow",description:"An error occurred while applying and installing the flow. See the console for more details."})}).finally(()=>{u.value=!1})}const ue=C({});function ne(T=!1){const F=l.flow.lora_connect_points[Object.keys(l.flow.lora_connect_points)[0]].connected_loras;console.debug("Flow LORAs: ",F),Promise.all(F.map(L=>{var H;return(H=i.fetchFlowLorasByHash(l.flow,h.value,L.hash))==null?void 0:H.then(B=>((!(L.hash in ue.value)||T)&&(ue.value[L.hash]=B),B))})).then(()=>{console.debug("Fetched flow LORAs info: ",ue.value)}).catch(L=>{console.error("Error fetching flow LORAs info: ",L),s.add({title:"Error fetching flow LORAs info",description:"An error occurred while fetching LoRAs info for the flow. See the console for more details."})})}function q(T=!1){var L;if(!l.flow||!h.value)return;u.value=!0,T||ne();let F=null;return T&&((L=m.value.metadata)!=null&&L.nextPage)&&(F=m.value.metadata.nextPage),i.fetchFlowLoras(l.flow,h.value,50,F).then(H=>{console.debug('Fetched flow "'+l.flow.name+'" loras: ',H);const B=l.flow.lora_connect_points[Object.keys(l.flow.lora_connect_points)[0]].base_model_type,A=H.items.reduce((Z,ce)=>(ce.modelVersions=ce.modelVersions.filter(ye=>ye.baseModel===B),ce.modelVersions.length>0&&(m.value.items.find(ye=>ye.id===ce.id)||Z.push(ce)),Z),[]);return A.length===0&&s.add({title:"No more supported LoRAs",description:"No supported LoRAs available for the flow."}),m.value.items.push(...A),m.value.metadata=H.metadata,H}).catch(H=>{console.error('Error fetching flow "'+l.flow.name+'" loras: ',H),s.add({title:'Error fetching flow "'+l.flow.name+'" loras',description:"An error occurred while fetching LoRAs for the flow. See the console for more details."})}).finally(()=>{u.value=!1})}return(T,F)=>{const L=de,H=Ml,B=ht,A=Oe,Z=je,ce=Qe,ye=Xe,xe=Pt,Ae=Je,qe=ke,at=lt,ot=Ve,st=Ne,re=Nl,nl=Qt,al=Ue;return d(),$(al,{modelValue:n.value,"onUpdate:modelValue":F[15]||(F[15]=E=>n.value=E),fullscreen:""},{default:b(()=>[k("div",Xo,[f(L,{class:"absolute top-3 right-3",icon:"i-heroicons-x-mark",variant:"ghost",onClick:F[0]||(F[0]=()=>n.value=!1)}),F[22]||(F[22]=k("h2",{class:"text-xl font-bold"},"Modify flow",-1)),F[23]||(F[23]=k("p",{class:"text-sm text-slate-500 my-2"}," Select LoRAs to modify the flow. New Flow will be created and installed with selected LoRAs. ",-1)),t(x)?(d(),j("div",Qo,[k("div",Ko,[f(L,{class:"my-1",variant:"outline",icon:"i-heroicons-arrow-down-on-square-stack",loading:t(u),onClick:F[1]||(F[1]=()=>{m.value={items:[],metadata:{}},ue.value={},U(),q()})},{default:b(()=>F[17]||(F[17]=[G(" Fetch LoRAs models from CivitAI ")])),_:1},8,["loading"]),k("div",Yo,[f(Z,{label:"New flow name",class:"flex justify-center flex-col w-full",error:t(se)},{default:b(()=>[f(A,{modelValue:t(V),"onUpdate:modelValue":F[2]||(F[2]=E=>Q(V)?V.value=E:null),type:"text",placeholder:"unique_flow_name",onInput:F[3]||(F[3]=E=>{E.target.value=E.target.value.toLowerCase(),V.value=E.target.value.toLowerCase()})},null,8,["modelValue"])]),_:1},8,["error"]),f(Z,{label:"New display name",class:"flex justify-center flex-col w-full",error:t(_)!==""?"":"Display name is required."},{default:b(()=>[f(A,{modelValue:t(_),"onUpdate:modelValue":F[4]||(F[4]=E=>Q(_)?_.value=E:null),type:"text",placeholder:"Display name"},null,8,["modelValue"])]),_:1},8,["error"]),f(Z,{label:"New flow description",class:"flex justify-center flex-col w-full"},{default:b(()=>[f(A,{modelValue:t(p),"onUpdate:modelValue":F[5]||(F[5]=E=>Q(p)?p.value=E:null),type:"text",placeholder:"Description"},null,8,["modelValue"])]),_:1}),f(Z,{label:"License (optional)",class:"flex justify-center flex-col w-full"},{default:b(()=>[f(A,{modelValue:t(D),"onUpdate:modelValue":F[6]||(F[6]=E=>Q(D)?D.value=E:null),type:"text",placeholder:"License"},null,8,["modelValue"])]),_:1}),f(Z,{label:"Required memory (GB)",class:"flex justify-center flex-col w-full"},{default:b(()=>[f(A,{modelValue:t(P),"onUpdate:modelValue":F[7]||(F[7]=E=>Q(P)?P.value=E:null),type:"text",placeholder:"Required memory (GB)"},null,8,["modelValue"])]),_:1}),f(Z,{label:"Version",class:"flex justify-center flex-col w-full"},{default:b(()=>[f(A,{modelValue:t(a),"onUpdate:modelValue":F[8]||(F[8]=E=>Q(a)?a.value=E:null),type:"text",placeholder:"Version"},null,8,["modelValue"])]),_:1})])]),f(nl,{class:"w-full",ui:{base:"",ring:"",divide:"divide-y divide-gray-200 dark:divide-gray-700",header:{padding:"px-4 py-5"},body:{padding:"",base:"divide-y divide-gray-200 dark:divide-gray-700"},footer:{padding:"p-4"}}},{footer:b(()=>[k("div",fs,[f(L,{class:"mr-2",variant:"outline",icon:"i-heroicons-arrow-down-on-square-stack",color:"blue",disabled:t(m).items.length===0||t(m).items.length>0&&!t(m).metadata.nextPage,loading:t(u),onClick:F[14]||(F[14]=()=>{q(!0)})},{default:b(()=>F[21]||(F[21]=[G(" Load more ")])),_:1},8,["disabled","loading"])])]),default:b(()=>[k("div",Zo,[k("div",es,[f(A,{modelValue:t(S),"onUpdate:modelValue":F[9]||(F[9]=E=>Q(S)?S.value=E:null),icon:"i-heroicons-magnifying-glass-20-solid",placeholder:"Filter by name..."},null,8,["modelValue"])]),k("div",ts,[t(K)?(d(),$(ce,{key:0,modelValue:t(w),"onUpdate:modelValue":F[10]||(F[10]=E=>Q(w)?w.value=E:null),label:"Keep previous LoRAs",class:"mr-2"},null,8,["modelValue"])):R("",!0),t(oe)?(d(),$(L,{key:1,variant:"outline",icon:"i-heroicons-x-circle",color:"orange",class:"mr-2",onClick:F[11]||(F[11]=()=>{t(M).splice(0),ne(!0)})},{default:b(()=>F[18]||(F[18]=[G(" Clear selection ")])),_:1})):R("",!0),f(ye,{text:t(Re)},{default:b(()=>[f(L,{variant:"outline",icon:"i-heroicons-check-16-solid",disabled:!t(_e),loading:t(u),onClick:$e},{default:b(()=>F[19]||(F[19]=[G(" Apply and install ")])),_:1},8,["disabled","loading"])]),_:1},8,["text"])])]),f(re,{modelValue:t(M),"onUpdate:modelValue":F[12]||(F[12]=E=>Q(M)?M.value=E:null),expand:t(z),"onUpdate:expand":F[13]||(F[13]=E=>Q(z)?z.value=E:null),columns:g,rows:t(O),loading:t(u),ui:{thead:"sticky top-0 dark:bg-gray-800 bg-white z-10",tr:{base:"dark:hover:bg-slate-800"}}},{caption:b(()=>F[20]||(F[20]=[k("caption",{class:"text-slate-500 text-sm py-1"},"Only supported LORAs for the basic model type are listed",-1)])),"select-header":b(({indeterminate:E,checked:me,change:ol})=>[k("div",ls,[k("input",{type:"checkbox",class:"h-4 w-4 dark:checked:bg-current dark:checked:border-transparent dark:indeterminate:bg-current dark:indeterminate:border-transparent disabled:opacity-50 disabled:cursor-not-allowed focus:ring-0 focus:ring-transparent focus:ring-offset-transparent form-checkbox rounded bg-white dark:bg-gray-900 border border-gray-300 dark:border-gray-700 focus-visible:ring-2 focus-visible:ring-primary-500 dark:focus-visible:ring-primary-400 focus-visible:ring-offset-2 focus-visible:ring-offset-white dark:focus-visible:ring-offset-gray-900 text-primary-500 dark:text-primary-400","aria-label":"Select row",checked:me,indeterminate:E&&t(K),onChange:sl=>ol(sl.target.checked)},null,40,ns)])]),"name-data":b(({row:E})=>[k("a",{href:`https://civitai.com/models/${E.id}`,target:"_blank",class:"text-blue-500 underline"},J(E.name),9,as)]),"description-data":b(({row:E})=>[f(xe,null,{panel:b(()=>[k("div",{class:"model-description p-4 max-h-64 max-w-xl overflow-y-auto",innerHTML:E.description},null,8,os)]),default:b(()=>[f(L,{color:"white",label:"Description","trailing-icon":"i-heroicons-chevron-down-20-solid"})]),_:2},1024)]),"trigger_words-data":b(({row:E})=>[f(xe,null,{panel:b(()=>[k("div",ss,[v(E).length===0?(d(),j("p",is,"No trigger words available for this model version.")):(d(!0),j(te,{key:1},ve(v(E),me=>(d(),$(Ae,{key:me,class:"flex flex-wrap gap-3 my-1 whitespace-normal",label:me,color:"white",variant:"outline"},null,8,["label"]))),128))])]),default:b(()=>[f(L,{color:"white",label:`Trigger words (${v(E).length})`,"trailing-icon":"i-heroicons-chevron-down-20-solid"},null,8,["label"])]),_:2},1024)]),"nsfw-data":b(({row:E})=>[f(ye,{text:`NSFW level: ${E.nsfwLevel}`,class:"pl-4"},{default:b(()=>[f(qe,{name:E.nsfw?"i-heroicons-x-circle":"i-heroicons-check-circle",class:le({"text-red-500":E.nsfw,"text-green-500":!E.nsfw})},null,8,["name","class"])]),_:2},1032,["text"])]),"statsThumbsUpCount-data":b(({row:E})=>[k("div",rs,[f(qe,{name:"i-heroicons-hand-thumb-up-solid",class:"text-green-500 mr-1"}),k("span",null,J(E.stats.thumbsUpCount),1)])]),"statsDownloadCount-data":b(({row:E})=>[k("div",us,[f(qe,{name:"i-heroicons-arrow-down-circle",class:"text-blue-500 mr-1"}),k("span",null,J(E.stats.downloadCount),1)])]),"modelVersion-data":b(({row:E})=>[f(at,{modelValue:t(I)[E.id],"onUpdate:modelValue":me=>t(I)[E.id]=me,options:E.modelVersions.map(me=>me.name)},null,8,["modelValue","onUpdate:modelValue","options"])]),"actions-data":b(({row:E})=>[E!=null&&E.currentFlowLora?(d(),$(ye,{key:1,text:"Remove previously selected LoRA"},{default:b(()=>[f(L,{icon:"i-heroicons-minus-16-solid",variant:"outline",color:"orange",onClick:me=>W(E)},null,8,["onClick"])]),_:2},1024)):(d(),$(L,{key:0,icon:t(M).includes(E)?"i-heroicons-check-16-solid":"i-heroicons-plus-16-solid",variant:"outline",color:t(M).includes(E)?"green":"white",onClick:()=>{if(t(M).includes(E)){t(M).splice(t(M).indexOf(E),1);return}t(M).push(E)}},null,8,["icon","color","onClick"]))]),expand:b(({row:E})=>[c(E).length>0?(d(),j("div",ds,[f(st,{class:"my-3",items:c(E).map(me=>({id:me.id,url:me.url,type:(me==null?void 0:me.type)||"image"})),ui:{item:"mx-1"}},{default:b(({item:me})=>[me.type==="image"?(d(),$(ot,{key:0,src:me.url,height:256,width:256,loading:"lazy",draggable:"false"},null,8,["src"])):(d(),j("video",cs,[k("source",{src:me.url},null,8,ms)]))]),_:2},1032,["items"])])):(d(),$(B,{key:1,title:"No images",description:"No images available for this model version.",variant:"soft",color:"amber"}))]),_:1},8,["modelValue","expand","rows","loading"])]),_:1})])):(d(),$(B,{key:0,class:"my-4",title:"CivitAI token missing",description:"Please add a CivitAI token in the settings to use this feature.",variant:"soft",color:"red"},{actions:b(()=>[f(H,{to:"/settings"},{default:b(()=>[f(L,{class:"lg:px-3 py-2",icon:"i-heroicons-arrow-top-right-on-square-16-solid",variant:"link",color:"white"},{default:b(()=>F[16]||(F[16]=[G(" Go to Settings ")])),_:1})]),_:1})]),_:1}))])]),_:1},8,["modelValue"])}}}),vs={class:"p-4 overflow-y-auto relative"},gs={class:"flex flex-col gap-2 mt-3"},hs={class:"flex justify-end mt-3"},ws=Y({__name:"EditMetadataModal",props:He({flow:{}},{show:{default:!1,type:Boolean},showModifiers:{}}),emits:["update:show"],setup(e){const l=e,n=Le(e,"show"),s=he(),r=be(),o=C(!1),i=C(l.flow.display_name),u=C(l.flow.description),m=C(l.flow.license),x=C(l.flow.required_memory_gb||0),h=C(l.flow.version),g=N(()=>i.value!==""&&u.value!=="");function M(){o.value=!0,s.updateFlowMetadata(l.flow,{display_name:i.value,description:u.value,license:m.value,required_memory_gb:x.value,version:h.value}).then(()=>{n.value=!1,r.add({title:"Flow metadata updated",description:"Flow metadata has been updated successfully."})}).catch(z=>{console.debug("Failed to update flow metadata:",z),r.add({title:"Flow metadata update failed",description:(z==null?void 0:z.details)??"Failed to update flow metadata. Please try again."})}).finally(()=>{o.value=!1})}return(z,S)=>{const U=Oe,O=je,I=Ft,c=de,v=Ue;return d(),$(v,{modelValue:n.value,"onUpdate:modelValue":S[6]||(S[6]=w=>n.value=w)},{default:b(()=>[k("div",vs,[S[9]||(S[9]=k("h2",{class:"font-bold"},"Edit flow metadata",-1)),k("div",gs,[f(O,{label:"New display name",class:"flex justify-center flex-col w-full",error:t(i)!==""?"":"Display name is required."},{default:b(()=>[f(U,{modelValue:t(i),"onUpdate:modelValue":S[0]||(S[0]=w=>Q(i)?i.value=w:null),type:"text",placeholder:"Display name"},null,8,["modelValue"])]),_:1},8,["error"]),f(O,{label:"New flow description",class:"flex justify-center flex-col w-full"},{default:b(()=>[f(I,{modelValue:t(u),"onUpdate:modelValue":S[1]||(S[1]=w=>Q(u)?u.value=w:null),placeholder:"Description"},null,8,["modelValue"])]),_:1}),f(O,{label:"License (optional)",class:"flex justify-center flex-col w-full"},{default:b(()=>[f(U,{modelValue:t(m),"onUpdate:modelValue":S[2]||(S[2]=w=>Q(m)?m.value=w:null),type:"text",placeholder:"License"},null,8,["modelValue"])]),_:1}),f(O,{label:"Required memory (GB)",class:"flex justify-center flex-col w-full"},{default:b(()=>[f(U,{modelValue:t(x),"onUpdate:modelValue":S[3]||(S[3]=w=>Q(x)?x.value=w:null),type:"text",placeholder:"Required memory (GB)"},null,8,["modelValue"])]),_:1}),f(O,{label:"Version",class:"flex justify-center flex-col w-full"},{default:b(()=>[f(U,{modelValue:t(h),"onUpdate:modelValue":S[4]||(S[4]=w=>Q(h)?h.value=w:null),type:"text",placeholder:"Version"},null,8,["modelValue"])]),_:1})]),k("div",hs,[f(c,{class:"mr-2",variant:"soft",color:"white",onClick:S[5]||(S[5]=w=>n.value=!1)},{default:b(()=>S[7]||(S[7]=[G(" Cancel ")])),_:1}),f(c,{variant:"soft",color:"primary",loading:t(o),disabled:!t(g),onClick:M},{default:b(()=>S[8]||(S[8]=[G(" Save ")])),_:1},8,["loading","disabled"])])])]),_:1},8,["modelValue"])}}}),ys={class:"flex flex-col lg:flex-row flex-grow items-start w-full"},bs={class:"card-wrapper w-full lg:pr-5"},ks={key:0,class:"p-0 text-sm"},xs={class:"flex flex-row items-center text-slate-400 mb-2"},_s={class:"flex flex-row flex-wrap items-center text-md mb-2"},$s=["href"],Cs={class:"flex flex-row items-center text-md mb-2"},Is=["href"],Ss={key:1},Ps={class:"flex flex-row items-center text-md mb-2"},Ms={key:0},Rs={class:"flex flex-row items-center text-md mb-2"},Fs={key:0,class:"flex flex-row flex-wrap items-center text-md mb-2"},Us=["href"],Vs={key:1},zs={class:"flex flex-row items-center mb-2"},Ts={key:1,class:"flex flex-row flex-wrap items-center text-md"},Os={key:0,class:"flex justify-end"},js={class:"flex flex-row items-center justify-center text-sm mr-2"},Ns={key:1},Bs={class:"text-sm flex justify-end"},Ls={class:"flex flex-row items-center justify-center text-sm mr-3"},As={key:0,class:"text-right"},qs={class:"prompt-wrapper w-full"},Es={class:"flex items-center justify-between"},Ds={class:"pb-2"},Ws={class:"flex justify-end items-center"},ai=Y({__name:"[name]",setup(e){const l=Rl(),n=he(),s=be();n.setCurrentFlow(l.params.name);const r=N(()=>n.flowInstallingByName(l.params.name)),o=N(()=>{var _;return r.value&&((_=r.value)==null?void 0:_.progress)<100||!1}),i=C(!1),u=N(()=>{var _;return r.value?"error"in r.value&&((_=r.value)==null?void 0:_.error)!==""?`${r.value.progress.toFixed(0)}% Error setting up`:`${r.value.progress.toFixed(0)}% Setting up`:"Setup flow"}),m=C(!1),x=C(!1),h=C(!1),g=C(!1),M=N(()=>{var p,D;const _=[[{label:"Export flow",icon:"i-heroicons-arrow-down-on-square-stack",click:()=>{n.fetchFlowDetails(n.currentFlow).then(P=>{console.debug("[DEBUG] Flow details for export: ",P);const a=new Blob([JSON.stringify(P==null?void 0:P.flow_comfy)],{type:"application/json"}),y=window.URL.createObjectURL(a),W=document.createElement("a");W.href=y,W.download=`${n.currentFlow.name}.json`,W.click(),window.URL.revokeObjectURL(y)}).catch(P=>{console.debug("Failed to fetch flow details for export: ",P),s.add({title:"Failed to export flow",description:(P==null?void 0:P.details)||"Failed to fetch flow details for export"})})}}],[{label:"Delete flow",icon:"i-heroicons-trash",click:S}]];return c.isAdmin&&_[0].unshift({label:"Edit metadata",icon:"i-heroicons-pencil-square",click:()=>{g.value=!0}}),((p=n==null?void 0:n.currentFlow)==null?void 0:p.new_version_available)!==""&&_[0].unshift({label:`Update to ${n.currentFlow.new_version_available}`,icon:"i-heroicons-arrow-path",click:()=>{n.updateFlow(n.currentFlow)}}),(D=n==null?void 0:n.currentFlow)!=null&&D.lora_connect_points&&Object.keys(n.currentFlow.lora_connect_points).length>0&&_[0].unshift({label:"Modify flow",icon:"i-heroicons-plus-circle",click:()=>{h.value=!0}}),_});function z(_,p=!1){m.value=!0,n.deleteFlow(_).then(()=>{p&&Xt().push("/")}).finally(()=>{m.value=!1,x.value=!1})}function S(){var p;const _=((p=n.currentFlow)==null?void 0:p.private)||!1;if(_){x.value=!0;return}z(n.currentFlow,_)}const U=C(!1),O=C(null),I=function(_){var p;(p=O.value)==null||p.copyPromptInputs(_)},c=Mt(),v=N(()=>{var _;return(_=n.currentFlow)==null?void 0:_.models.filter(p=>p.installed).reduce((p,D)=>p+(D==null?void 0:D.file_size)||0,0)}),w=N(()=>{var _;return(_=n.currentFlow)==null?void 0:_.models.reduce((p,D)=>p+(D==null?void 0:D.file_size)||0,0)}),V=N(()=>!v.value&&!w.value?"":v.value===w.value?` - ${We(w.value)}`:` - ${We(v.value)} / ${We(w.value)}`);return(_,p)=>{const D=ke,P=Xe,a=Je,y=de,W=gt,X=Qt,ee=na,ie=ka,se=Go,ae=Yt,K=Ue,oe=ps,_e=ws,Re=Fl;return d(),$(Re,null,{default:b(()=>{var $e,ue;return[!t(n).loading.flows_available&&!t(n).loading.flows_installed&&t(n).currentFlow&&!t(n).$state.loading.tasks_history?(d(),j(te,{key:0},[k("div",ys,[k("div",bs,[f(X,{as:"div",class:"w-full mb-5"},Ul({header:b(()=>{var ne,q;return[k("h2",{class:"text-xl font-bold cursor-pointer select-none flex items-center",onClick:p[0]||(p[0]=()=>{U.value=!t(U)})},[(ne=t(n).currentFlow)!=null&&ne.private?(d(),$(P,{key:0,text:"This flow is local, manually added"},{default:b(()=>{var T;return[f(D,{name:"i-heroicons-lock-closed",class:le(["mr-2",{"text-stone-500":!((T=t(n).currentFlow)!=null&&T.is_supported_by_workers)}])},null,8,["class"])]}),_:1})):R("",!0),f(D,{name:t(U)?"i-heroicons-chevron-down":"i-heroicons-chevron-up",class:"mr-2"},null,8,["name"]),f(P,{text:(q=t(n).currentFlow)!=null&&q.is_supported_by_workers?"":"No workers capable of running this flow",popper:{placement:"top"}},{default:b(()=>{var T,F;return[k("span",{class:le({"text-stone-500":!((T=t(n).currentFlow)!=null&&T.is_supported_by_workers)})},J((F=t(n).currentFlow)==null?void 0:F.display_name),3)]}),_:1},8,["text"])])]}),default:b(()=>{var ne,q,T,F,L,H,B,A,Z,ce,ye,xe,Ae,qe,at,ot,st;return[t(U)?R("",!0):(d(),j("div",ks,[k("p",xs,J((ne=t(n).currentFlow)==null?void 0:ne.description),1),k("p",_s,[f(D,{name:"i-heroicons-user-16-solid",class:"mr-1"}),p[10]||(p[10]=k("b",null,"Author:",-1)),p[11]||(p[11]=G("  ")),k("a",{class:"hover:underline text-md",href:(q=t(n).currentFlow)==null?void 0:q.homepage,rel:"noopener",target:"_blank"},J((T=t(n).currentFlow)==null?void 0:T.author),9,$s)]),k("p",Cs,[f(D,{name:"i-heroicons-document-text",class:"mr-1"}),(F=t(n).currentFlow)!=null&&F.documentation?(d(),j("a",{key:0,class:"hover:underline",href:(L=t(n).currentFlow)==null?void 0:L.documentation,rel:"noopener",target:"_blank"}," Documentation ",8,Is)):(d(),j("span",Ss,"No documentation"))]),k("p",Ps,[f(D,{name:"i-heroicons-clock",class:"mr-1"}),p[12]||(p[12]=k("b",null,"Version:",-1)),p[13]||(p[13]=G("  ")),k("span",null,J((H=t(n).currentFlow)==null?void 0:H.version),1),((B=t(n).currentFlow)==null?void 0:B.new_version_available)!==""?(d(),j("span",Ms,"  (new version available: "+J((A=t(n).currentFlow)==null?void 0:A.new_version_available)+") ",1)):R("",!0)]),k("p",Rs,[f(D,{name:"i-heroicons-tag",class:"mr-1"}),p[14]||(p[14]=k("b",null,"Tags:",-1)),p[15]||(p[15]=G("  ")),((Z=t(n).currentFlow)==null?void 0:Z.tags.length)>0?(d(!0),j(te,{key:0},ve((ce=t(n).currentFlow)==null?void 0:ce.tags,re=>(d(),$(a,{key:re,label:re,color:"white",variant:"solid",class:"m-1"},null,8,["label"]))),128)):(d(),$(a,{key:1,label:"No tags",color:"white",variant:"solid",class:"m-1"}))]),((xe=(ye=t(n).currentFlow)==null?void 0:ye.models)==null?void 0:xe.length)>0?(d(),j("p",Fs,[f(D,{name:"i-heroicons-arrow-down-on-square-stack",class:"mr-1"}),f(P,{text:t(w)-t(v)>0?`${("formatBytes"in _?_.formatBytes:t(We))(t(w)-t(v))} to download`:"All models installed",popper:{placement:"top"}},{default:b(()=>{var re;return[k("b",null,"Models ("+J((re=t(n).currentFlow)==null?void 0:re.models.length)+J(t(V))+"):",1),p[16]||(p[16]=G("  "))]}),_:1},8,["text"]),(d(!0),j(te,null,ve((Ae=t(n).currentFlow)==null?void 0:Ae.models,re=>(d(),$(a,{key:re.name,class:"m-1",color:"white",variant:"solid"},{default:b(()=>[f(P,{text:re.installed?"Model installed":"Model not installed"},{default:b(()=>[f(D,{name:re.installed?"i-heroicons-check-circle-20-solid":"i-heroicons-x-mark-20-solid",class:le(re.installed?"text-green-500":"text-orange-500")},null,8,["name","class"])]),_:2},1032,["text"]),re.gated?(d(),$(P,{key:0,text:"Gated model, requires auth token for download",popper:{placement:"top"}},{default:b(()=>[f(D,{name:"i-heroicons-key",class:"mr-1"})]),_:1})):R("",!0),k("a",{class:"hover:underline underline-offset-4",href:re.homepage,rel:"noopener",target:"_blank"},J(re.name),9,Us),re.file_size?(d(),j("span",Vs," ("+J(("formatBytes"in _?_.formatBytes:t(We))(re.file_size))+") ",1)):R("",!0)]),_:2},1024))),128))])):R("",!0),k("p",zs,[f(D,{name:"i-mdi-help-network-outline",class:"mr-1"}),p[19]||(p[19]=k("b",null,"Platforms:",-1)),p[20]||(p[20]=G("  ")),f(P,{text:"Linux"},{default:b(()=>[f(D,{name:"i-mdi-linux",class:"mr-1"})]),_:1}),f(P,{text:"Microsoft Windows"},{default:b(()=>[f(D,{name:"i-mdi-microsoft-windows",class:"mr-1"})]),_:1}),t(n).currentFlow.is_macos_supported?(d(),$(P,{key:0,text:"macOS"},{default:b(()=>[f(D,{name:"i-mdi-apple",class:"mr-1"})]),_:1})):R("",!0),(qe=t(n).currentFlow)!=null&&qe.required_memory_gb?(d(),$(P,{key:1,class:"flex flex-row items-center",text:"Required VRAM memory (GB)"},{default:b(()=>{var re;return[p[17]||(p[17]=G(" (")),f(D,{name:"i-mdi-memory",class:"mr-1"}),k("span",null,J((re=t(n).currentFlow)==null?void 0:re.required_memory_gb)+" GB",1),p[18]||(p[18]=G(") "))]}),_:1})):R("",!0)]),((ot=(at=t(n).currentFlow)==null?void 0:at.requires)==null?void 0:ot.length)>0?(d(),j("p",Ts,[p[21]||(p[21]=k("b",null,"Requires:",-1)),p[22]||(p[22]=G("  ")),(d(!0),j(te,null,ve((st=t(n).currentFlow)==null?void 0:st.requires,re=>(d(),$(a,{key:re,class:"m-1",color:"yellow",variant:"outline"},{default:b(()=>[G(J(re),1)]),_:2},1024))),128))])):R("",!0)]))]}),_:2},[t(U)?void 0:{name:"footer",fn:b(()=>{var ne,q;return[t(c).isAdmin?(d(),j("div",Os,[k("div",js,[f(D,{name:t(n).isFlowInstalled(t(l).params.name)?"i-heroicons-check-badge":"i-heroicons-x-mark",class:"mx-1"},null,8,["name"]),k("span",{class:le({"text-green-500":t(n).isFlowInstalled(t(l).params.name),"text-red-500":!t(n).isFlowInstalled(t(l).params.name),"text-stone-500":t(n).isFlowInstalled(t(l).params.name)&&!((ne=t(n).currentFlow)!=null&&ne.is_supported_by_workers)})},J(t(n).isFlowInstalled(t(l).params.name)?(q=t(n).currentFlow)!=null&&q.is_supported_by_workers?"Installed":"Installed (no workers)":"Not installed"),3)]),t(n).isFlowInstalled(t(l).params.name)?R("",!0):(d(),$(P,{key:0,text:"Setup flow dependencies and configure it in ComfyUI",popper:{placement:"top"},"open-delay":500},{default:b(()=>[f(y,{icon:"i-heroicons-arrow-down-tray",class:"mx-3",color:"primary",variant:"outline",loading:t(o),onClick:p[1]||(p[1]=()=>t(n).setupFlow(t(n).currentFlow))},{default:b(()=>[G(J(t(u)),1)]),_:1},8,["loading"])]),_:1})),!t(n).isFlowInstalled(t(l).params.name)&&t(o)?(d(),$(P,{key:1,text:"Cancel flow installation",popper:{placement:"top"},"open-delay":500},{default:b(()=>[f(y,{icon:"i-heroicons-stop",variant:"outline",color:"orange",loading:t(i),onClick:p[2]||(p[2]=()=>{i.value=!0,t(n).cancelFlowSetup(t(n).currentFlow).then(()=>{i.value=!1})})},{default:b(()=>p[23]||(p[23]=[G(" Cancel ")])),_:1},8,["loading"])]),_:1})):R("",!0),t(n).isFlowInstalled(t(l).params.name)?(d(),$(W,{key:2,items:t(M),mode:"click",label:"Actions",popper:{placement:"bottom-end"}},{default:b(()=>[f(y,{color:"white",label:"Actions","trailing-icon":"i-heroicons-chevron-down-20-solid"})]),_:1},8,["items"])):R("",!0)])):(d(),j("div",Ns,[k("div",Bs,[k("div",Ls,[f(D,{name:t(n).isFlowInstalled(t(l).params.name)?"i-heroicons-check-badge":"i-heroicons-x-mark",class:"mx-1"},null,8,["name"]),k("span",{class:le({"text-green-500":t(n).isFlowInstalled(t(l).params.name),"text-red-500":!t(n).isFlowInstalled(t(l).params.name)})},J(t(n).isFlowInstalled(t(l).params.name)?"Installed":"Not installed"),3)]),t(n).isFlowInstalled(t(l).params.name)?R("",!0):(d(),j("div",As,p[24]||(p[24]=[k("p",{class:"text-orange-500"},"Only admin can manage workflows.",-1),k("span",{class:"text-slate-500"},"Ask your admin to setup this workflow",-1)])))])]))]}),key:"0"}]),1024)]),k("div",qs,[!t(m)&&t(n).isFlowInstalled(t(l).params.name)?(d(),$(ee,{key:0,ref_key:"workflowPrompt",ref:O},null,512)):R("",!0)])]),!t(m)&&t(n).isFlowInstalled(t(l).params.name)?(d(),$(ie,{key:0})):R("",!0),!t(m)&&t(n).isFlowInstalled(t(l).params.name)||t(n).flowResultsByName(t(l).params.name).length>0?(d(),$(se,{key:1,onCopyPromptInputs:p[3]||(p[3]=ne=>I(ne))})):R("",!0)],64)):(d(),$(ae,{key:1,class:"mb-3"})),f(K,{modelValue:t(x),"onUpdate:modelValue":p[7]||(p[7]=ne=>Q(x)?x.value=ne:null),"prevent-close":""},{default:b(()=>[f(X,{ui:{ring:"",divide:"divide-y divide-gray-100 dark:divide-gray-800"}},{header:b(()=>[k("div",Es,[p[25]||(p[25]=k("h3",{class:"text-base font-semibold leading-6 text-gray-900 dark:text-white"}," Confirm workflow deletion ",-1)),f(y,{color:"gray",variant:"ghost",icon:"i-heroicons-x-mark-20-solid",class:"-my-1",onClick:p[4]||(p[4]=ne=>x.value=!1)})])]),default:b(()=>{var ne;return[k("p",Ds,[p[26]||(p[26]=G(" Are you sure you want to delete the ")),p[27]||(p[27]=k("b",null,"private",-1)),p[28]||(p[28]=G(" workflow ")),k("b",null,J((ne=t(n).currentFlow)==null?void 0:ne.display_name),1),p[29]||(p[29]=G("? "))]),k("div",Ws,[f(y,{icon:"i-heroicons-x-mark-16-solid",variant:"outline",color:"green",class:"mr-2",onClick:p[5]||(p[5]=q=>x.value=!1)},{default:b(()=>p[30]||(p[30]=[G(" Cancel ")])),_:1}),f(y,{icon:"i-heroicons-trash",variant:"outline",color:"red",onClick:p[6]||(p[6]=q=>{var T;return z(t(n).currentFlow,((T=t(n).currentFlow)==null?void 0:T.private)||!1)})},{default:b(()=>p[31]||(p[31]=[G(" Delete ")])),_:1})])]}),_:1})]),_:1},8,["modelValue"]),t(c).isAdmin&&(($e=t(n))!=null&&$e.currentFlow)?(d(),$(oe,{key:2,show:t(h),"onUpdate:show":p[8]||(p[8]=ne=>Q(h)?h.value=ne:null),flow:t(n).currentFlow},null,8,["show","flow"])):R("",!0),t(c).isAdmin&&((ue=t(n))!=null&&ue.currentFlow)?(d(),$(_e,{key:3,show:t(g),"onUpdate:show":p[9]||(p[9]=ne=>Q(g)?g.value=ne:null),flow:t(n).currentFlow},null,8,["show","flow"])):R("",!0)]}),_:1})}}});export{ai as default};
