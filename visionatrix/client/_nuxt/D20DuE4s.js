import{_ as T}from"./Cty_TBS6.js";import{_ as W,a as q}from"./XW-HZBd7.js";import{_ as D,a as P,b as E}from"./BcBO4f41.js";import{_ as R}from"./DZjbicC_.js";import{f as j,g as F,c as _,o as a,b as o,w as r,a as i,t as u,d as g,h as G,i as m,F as O,r as I,j as H,k as $,l as J,m as L,n as B,p as t,u as K,q as Q,s as X,v as Y,x as N,y as A,z as Z,A as ee}from"./DIYZyP7P.js";import{_ as te}from"./DtLhkt7h.js";const se={class:"p-4 w-full md:w-6/12 lg:w-4/12 z-[10]"},oe={class:"flex flex-grow justify-between"},le=["title"],ne={class:"flex flex-col items-between text-sm"},ae=["title"],ie={class:"flex flex-row flex-wrap items-center mb-2"},re={class:"flex flex-row items-center"},fe=["href"],de={class:"flex flex-row items-center mb-2"},_e=["href"],me={key:1},we={class:"flex flex-row items-center mb-2"},ce={class:"flex flex-row items-center"},ue=j({__name:"ListItem",props:{flow:{type:Object,required:!0}},setup(l){const e=F();return(z,n)=>{const d=G,w=J,v=L,S=H,k=D;return a(),_("div",se,[o(k,{as:"div",class:"hover:shadow-md"},{header:r(()=>{var s,p,h;return[i("div",oe,[i("h2",{class:"text-xl font-bold truncate flex items-center",title:(s=l.flow)==null?void 0:s.display_name},[(p=l.flow)!=null&&p.private?(a(),m(w,{key:0,text:"This flow is local, manually added"},{default:r(()=>[o(d,{name:"i-heroicons-lock-closed",class:B(["mr-2",{"text-stone-500":!l.flow.is_supported_by_workers}])},null,8,["class"])]),_:1})):$("",!0),o(w,{text:l.flow.is_supported_by_workers?"":"No workers capable of running this flow",popper:{placement:"top"}},{default:r(()=>{var c;return[i("span",{class:B({"text-stone-500":!l.flow.is_supported_by_workers})},u((c=l.flow)==null?void 0:c.display_name),3)]}),_:1},8,["text"])],8,le),t(e).isFlowInstalled((h=l.flow)==null?void 0:h.name)?(a(),m(w,{key:0,text:"Mark flow as favorite",class:"ml-3",popper:{placement:"top"},"open-delay":500},{default:r(()=>[o(v,{icon:t(e).isFlowFavorite(l.flow.name)?"i-heroicons-star-16-solid":"i-heroicons-star",variant:"outline",color:"yellow",onClick:n[0]||(n[0]=c=>t(e).markFlowFavorite(l.flow))},null,8,["icon"])]),_:1})):$("",!0)])]}),footer:r(()=>{var s;return[o(v,{to:`/workflows/${(s=l.flow)==null?void 0:s.name}`,icon:"i-heroicons-arrow-up-right-16-solid",class:"flex justify-center dark:bg-slate-500 bg-slate-500 dark:hover:bg-slate-700 hover:bg-slate-700 dark:text-white"},{default:r(()=>n[9]||(n[9]=[g(" Open ")])),_:1},8,["to"])]}),default:r(()=>{var s,p,h,c,V,b,y,U,C;return[i("div",ne,[i("p",{class:"text-md text-slate-400 truncate text-ellipsis mb-2",title:(s=l.flow)==null?void 0:s.description},u((p=l.flow)==null?void 0:p.description),9,ae),i("p",ie,[i("span",re,[o(d,{name:"i-heroicons-user-16-solid",class:"mr-1"}),n[1]||(n[1]=i("b",null,"Author:",-1)),n[2]||(n[2]=g("  "))]),i("a",{class:"hover:underline flex flex-row items-center",href:(h=l.flow)==null?void 0:h.homepage,rel:"noopener",target:"_blank"},u((c=l.flow)==null?void 0:c.author),9,fe)]),i("p",de,[o(d,{name:"i-heroicons-document-text",class:"mr-1"}),(V=l.flow)!=null&&V.documentation?(a(),_("a",{key:0,class:"hover:underline",href:(b=l.flow)==null?void 0:b.documentation,rel:"noopener",target:"_blank"},"Documentation",8,_e)):(a(),_("span",me,"No documentation"))]),i("p",we,[o(d,{name:"i-heroicons-tag",class:"mr-1"}),n[3]||(n[3]=i("b",null,"Tags:",-1)),n[4]||(n[4]=g("  ")),((y=l.flow)==null?void 0:y.tags.length)>0?(a(!0),_(O,{key:0},I((U=l.flow)==null?void 0:U.tags,x=>(a(),m(S,{key:x,label:x,color:"white",variant:"solid",class:"m-1"},null,8,["label"]))),128)):(a(),m(S,{key:1,label:"No tags",color:"white",variant:"solid",class:"m-1"}))]),i("p",ce,[o(d,{name:"i-mdi-help-network-outline",class:"mr-1"}),n[7]||(n[7]=i("b",null,"Platforms:",-1)),n[8]||(n[8]=g("  ")),o(w,{text:"Linux"},{default:r(()=>[o(d,{name:"i-mdi-linux",class:"mr-1"})]),_:1}),o(w,{text:"Microsoft Windows"},{default:r(()=>[o(d,{name:"i-mdi-microsoft-windows",class:"mr-1"})]),_:1}),l.flow.is_macos_supported?(a(),m(w,{key:0,text:"macOS"},{default:r(()=>[o(d,{name:"i-mdi-apple",class:"mr-1"})]),_:1})):$("",!0),(C=l.flow)!=null&&C.required_memory_gb?(a(),m(w,{key:1,class:"flex flex-row items-center",text:"Required VRAM memory (GB)"},{default:r(()=>{var x;return[n[5]||(n[5]=g(" (")),o(d,{name:"i-mdi-memory",class:"mr-1"}),i("span",null,u((x=l.flow)==null?void 0:x.required_memory_gb)+" GB",1),n[6]||(n[6]=g(") "))]}),_:1})):$("",!0)])])]}),_:1})])}}}),pe={class:"w-full sticky z-[100] top-1 flex flex-col md:flex-row justify-center items-center my-1"},he={class:"flex"},xe={key:0,class:"truncate"},ge={key:1},$e={key:0},ye={key:1,class:"flex flex-wrap justify-center items-center mb-10"},ke={key:2,class:"text-center text-slate-500 my-5"},Fe=j({__name:"index",setup(l){K({title:"Workflows - Visionatrix",meta:[{name:"description",content:"Workflows - Visionatrix"}]});const e=F(),z=Q(),n=X();Y(()=>e.paginatedFlows,()=>{e.flows.length<=e.$state.pageSize?e.$state.page=1:e.$state.page>Math.ceil(e.flows.length/e.$state.pageSize)&&(e.$state.page=Math.ceil(e.flows.length/e.$state.pageSize))});function d(){const k=[[{label:"Show unsupported flows",icon:e.$state.show_unsupported_flows?"i-mdi-filter-check":"i-mdi-filter-minus",slot:"show_unsupported_flows",click:()=>{e.$state.show_unsupported_flows=!e.$state.show_unsupported_flows,e.saveUserOptions()}}],[{label:"Show hidden flows",icon:e.$state.flows_hidden_filter?"i-mdi-filter-check":"i-mdi-filter-minus",slot:"show_hidden_flows",click:()=>{e.$state.flows_hidden_filter=!e.$state.flows_hidden_filter,e.saveUserOptions()}}],[{label:"Clear filters",labelClass:"text-xs",icon:"i-mdi-filter-off",iconClass:"w-4 h-4",click:()=>{e.$state.flows_search_filter="",e.$state.flows_tags_filter=[],e.$state.flows_hidden_filter=!1,e.$state.show_unsupported_flows=!1,e.$state.show_only_installed_flows=!1,e.saveUserOptions()}}]],s=[{label:"Show only installed	flows",icon:e.$state.show_only_installed_flows?"i-mdi-filter-check":"i-mdi-filter-minus",slot:"show_only_installed_flows",click:()=>{e.$state.show_only_installed_flows=!e.$state.show_only_installed_flows,e.saveUserOptions()}}];return z.isAdmin&&k.splice(2,0,s),k}const w=N(()=>e.$state.flows_search_filter||e.$state.flows_tags_filter.length>0||e.$state.show_unsupported_flows||e.$state.flows_hidden_filter||e.$state.show_only_installed_flows),v=N(()=>(e.$state.flows_search_filter?1:0)+(e.$state.flows_tags_filter.length>0?1:0)+(e.$state.show_unsupported_flows?1:0)+(e.$state.flows_hidden_filter?1:0)+(e.$state.show_only_installed_flows?1:0));function S(){n.clear(),A().loadLocalSettings(),A().fetchAllSettings(),F().fetchFlows(),Z().loadWorkers()}return(k,s)=>{const p=T,h=W,c=P,V=R,b=L,y=q,U=E,C=te,x=ue,M=ee;return a(),m(M,{class:"lg:h-dvh"},{default:r(()=>[t(e).$state.loading.flows_available||t(e).loading.flows_installed||t(e).$state.loading.tasks_history?(a(),m(p,{key:0})):(a(),_(O,{key:1},[i("div",pe,[o(h,{modelValue:t(e).$state.flows_search_filter,"onUpdate:modelValue":s[0]||(s[0]=f=>t(e).$state.flows_search_filter=f),icon:"i-heroicons-magnifying-glass-20-solid",color:"white",class:"mb-1 md:mr-3 md:mb-0",label:"Filter by prompt",trailing:!0,placeholder:"Search flows"},null,8,["modelValue"]),t(e).flows.length>t(e).$state.pageSize?(a(),m(c,{key:0,modelValue:t(e).$state.page,"onUpdate:modelValue":s[1]||(s[1]=f=>t(e).$state.page=f),class:"mb-1 md:mr-3 md:mb-0","page-count":t(e).$state.pageSize,total:t(e).flows.length},null,8,["modelValue","page-count","total"])):$("",!0),i("div",he,[o(V,{modelValue:t(e).$state.flows_tags_filter,"onUpdate:modelValue":s[2]||(s[2]=f=>t(e).$state.flows_tags_filter=f),options:t(e).flowsTags,multiple:"",searchable:""},{label:r(()=>[t(e).$state.flows_tags_filter.length>0?(a(),_("span",xe,u(t(e).$state.flows_tags_filter.join(",")),1)):(a(),_("span",ge,"Select tags to filter"))]),_:1},8,["modelValue","options"]),o(U,{class:"ml-2",items:d(),mode:"click",label:"Options"},{show_unsupported_flows:r(()=>[o(y,{modelValue:t(e).$state.show_unsupported_flows,"onUpdate:modelValue":s[3]||(s[3]=f=>t(e).$state.show_unsupported_flows=f)},null,8,["modelValue"]),s[6]||(s[6]=i("span",{class:"text-xs"},"Show unsupported flows",-1))]),show_hidden_flows:r(()=>[o(y,{modelValue:t(e).$state.flows_hidden_filter,"onUpdate:modelValue":s[4]||(s[4]=f=>t(e).$state.flows_hidden_filter=f)},null,8,["modelValue"]),s[7]||(s[7]=i("span",{class:"text-xs"},"Show hidden flows",-1))]),show_only_installed_flows:r(()=>[o(y,{modelValue:t(e).$state.show_only_installed_flows,"onUpdate:modelValue":s[5]||(s[5]=f=>t(e).$state.show_only_installed_flows=f)},null,8,["modelValue"]),s[8]||(s[8]=i("span",{class:"text-xs"},"Show only installed flows",-1))]),default:r(()=>[o(b,{color:"white",icon:"i-mdi-filter"},{default:r(()=>[i("span",null,u(t(e).flows.length),1),t(w)?(a(),_("span",$e,"("+u(t(v))+")",1)):$("",!0)]),_:1})]),_:1},8,["items"])])]),t(e).$state.error.flows_available||t(e).$state.error.flows_installed?(a(),m(C,{key:0,class:"my-4",title:"Error fetching flows",icon:"i-mdi-alert-circle",description:"An error occurred while fetching flows. Please try again later.",variant:"soft",color:"red"},{actions:r(()=>[o(b,{icon:"i-heroicons-arrow-path-solid",variant:"outline",color:"white",onClick:S},{default:r(()=>s[9]||(s[9]=[g(" Retry ")])),_:1})]),_:1})):$("",!0),t(e).flows.length>0?(a(),_("div",ye,[(a(!0),_(O,null,I(t(e).paginatedFlows,f=>(a(),m(x,{key:f.name,flow:f},null,8,["flow"]))),128))])):(a(),_("p",ke,u(t(e).$state.flows_search_filter||t(e).$state.flows_tags_filter?"No flows found":"No flows available"),1))],64))]),_:1})}}});export{Fe as default};
