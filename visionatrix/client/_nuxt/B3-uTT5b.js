import{_ as A}from"./tVi4UxLs.js";import{g as O,u as G,v as I,x as P,y as C,h as N,z as w,q as L,i as x,w as n,s as $,o as c,a,b as l,k as t,c as y,j as v,d as h,l as q,m as B}from"./BQyYDYMr.js";import{_ as E,a as j}from"./CO3-dXmr.js";import{_ as H,a as T}from"./g1T21V3p.js";const R={class:"flex flex-col md:flex-row"},D={class:"px-5 pb-5 md:w-4/5"},W=a("h2",{class:"mb-3 text-xl"},"Settings",-1),J={key:0,class:"admin-settings mb-3"},K=a("h3",{class:"mb-3"},"Admin settings",-1),Q={class:"flex items-center"},X=a("p",{class:"text-amber-400"},[a("span",null,"Access tokens are required forÂ "),a("a",{class:"hover:underline underline-offset-4",href:"https://visionatrix.github.io/VixFlowsDocs/GatedModels.html",target:"_blank"},"gated models"),h(". ")],-1),Y={class:"flex items-center"},Z={key:1,class:"upload-flow mb-5 py-4 rounded-md"},ee=a("h3",{class:"mb-3 text-xl font-bold"},"Upload Flow",-1),oe=a("p",{class:"text-gray-400 text-sm mb-3"}," Upload a Visionatrix workflow file (.json) to add it to the available flows. On successful upload of the valid workflow file, the installation will start automatically. ",-1),te={class:"flex items-center space-x-3"},le={class:"user-settings mb-3"},se=a("h3",{class:"mb-3"},"User settings",-1),re=O({__name:"index",setup(ae){G({title:"Settings - Visionatrix",meta:[{name:"description",content:"Settings - Visionatrix"}]});const k=[{label:"Settings",icon:"i-heroicons-cog-6-tooth-20-solid",to:"/settings"},{label:"Workers information",icon:"i-heroicons-chart-bar-16-solid",to:"/settings/workers"}],m=I(),o=P(),r=C();function V(){console.debug("Saving settings",o.settingsMap),Promise.all(Object.keys(o.settingsMap).map(i=>o.settingsMap[i].admin&&m.isAdmin?o.saveGlobalSetting(o.settingsMap[i].key,o.settingsMap[i].value,o.settingsMap[i].sensitive):o.saveUserSetting(o.settingsMap[i].key,o.settingsMap[i].value))).then(()=>{r.add({title:"Settings saved",description:"Settings saved successfully"})}).catch(i=>{r.add({title:"Error saving setting",description:i.message})})}const p=N(),_=w(null),g=w(!1);function b(){const i=_.value.$refs.input.files[0]||null;if(!i){r.add({title:"No file selected",description:"Please select a file to upload"});return}g.value=!0,p.uploadFlow(i).then(e=>{if(console.debug("uploadFlow",e),e&&"detail"in e&&(e==null?void 0:e.detail)!==""){r.add({title:"Error uploading flow",description:e.detail});return}else r.add({title:"Flow uploaded",description:"Flow uploaded successfully"});_.value.$refs.input.value=""}).catch(e=>{console.debug("uploadFlow error",e),r.add({title:"Error uploading flow",description:e.message})}).finally(()=>{g.value=!1})}return L(()=>p.outputMaxSize,()=>{p.saveUserOptions()}),(i,e)=>{const M=A,U=q,u=E,d=H,S=T,f=B,z=j,F=$;return c(),x(F,{class:"lg:h-dvh"},{default:n(()=>[a("div",R,[l(M,{links:k,class:"md:w-1/5"}),a("div",D,[W,t(m).isAdmin?(c(),y("div",J,[K,a("div",Q,[l(U,{name:"i-heroicons-question-mark-circle",class:"mr-2 text-amber-400"}),X]),l(d,{size:"md",class:"py-3",label:"Huggingface Auth token",description:"Bearer authentication token from your Huggingface account to allow downloading gated models with limited access"},{default:n(()=>[l(u,{modelValue:t(o).settingsMap.huggingface_auth_token.value,"onUpdate:modelValue":e[0]||(e[0]=s=>t(o).settingsMap.huggingface_auth_token.value=s),placeholder:"Huggingface Auth token",class:"w-full",type:"password",icon:"i-heroicons-shield-check",size:"md",autocomplete:"off"},null,8,["modelValue"])]),_:1}),l(d,{size:"md",class:"py-3",label:"Google API key",description:"Global Google API key, required for Flows, e.g. where ComfyUI-Gemini Node is used"},{default:n(()=>[l(u,{modelValue:t(o).settingsMap.google_api_key.value,"onUpdate:modelValue":e[1]||(e[1]=s=>t(o).settingsMap.google_api_key.value=s),placeholder:"Google API key",class:"w-full",type:"password",icon:"i-heroicons-shield-check",size:"md",autocomplete:"off"},null,8,["modelValue"])]),_:1}),l(d,{size:"md",class:"py-3",label:"Proxy",description:"Proxy configuration string (to access Gemini)"},{default:n(()=>[l(u,{modelValue:t(o).settingsMap.google_proxy.value,"onUpdate:modelValue":e[2]||(e[2]=s=>t(o).settingsMap.google_proxy.value=s),placeholder:"Proxy",class:"w-full",type:"text",size:"md",autocomplete:"off"},null,8,["modelValue"])]),_:1}),l(d,{size:"md",class:"py-3",label:"Ollama URL",description:"URL to server where Ollama is running, required for flows using node with it"},{default:n(()=>[l(u,{modelValue:t(o).settingsMap.ollama_url.value,"onUpdate:modelValue":e[3]||(e[3]=s=>t(o).settingsMap.ollama_url.value=s),placeholder:"Ollama URL",class:"w-full",type:"text",size:"md",autocomplete:"off"},null,8,["modelValue"])]),_:1}),l(d,{size:"md",class:"py-3",label:"Ollama Vision Model",description:"Override Ollama Vision model used in workflows by default"},{default:n(()=>[l(u,{modelValue:t(o).settingsMap.ollama_vision_model.value,"onUpdate:modelValue":e[4]||(e[4]=s=>t(o).settingsMap.ollama_vision_model.value=s),placeholder:"Ollama Vision Model",class:"w-full",type:"text",size:"md",autocomplete:"off"},null,8,["modelValue"])]),_:1}),l(d,{size:"md",class:"py-3",label:"Ollama LLM Model",description:"Ollama LLM model used in workflows by default"},{default:n(()=>[l(u,{modelValue:t(o).settingsMap.ollama_llm_model.value,"onUpdate:modelValue":e[5]||(e[5]=s=>t(o).settingsMap.ollama_llm_model.value=s),placeholder:"Ollama Vision Model",class:"w-full",type:"text",size:"md",autocomplete:"off"},null,8,["modelValue"])]),_:1}),l(d,{size:"md",class:"py-3",label:"Translations provider",description:"Prompt translations provider. Empty if not enabled."},{default:n(()=>[a("div",Y,[l(S,{modelValue:t(o).settingsMap.translations_provider.value,"onUpdate:modelValue":e[6]||(e[6]=s=>t(o).settingsMap.translations_provider.value=s),color:"white",variant:"outline",placeholder:"Select translations provider",options:t(o).settingsMap.translations_provider.options},null,8,["modelValue","options"]),t(o).settingsMap.translations_provider.value?(c(),x(f,{key:0,icon:"i-heroicons-x-mark",variant:"outline",color:"white",class:"ml-2",onClick:e[7]||(e[7]=()=>t(o).settingsMap.translations_provider.value="")})):v("",!0)])]),_:1})])):v("",!0),t(m).isAdmin?(c(),y("div",Z,[ee,oe,a("div",te,[l(u,{ref_key:"flowFileInput",ref:_,type:"file",accept:".json",class:"w-auto"},null,512),l(f,{icon:"i-heroicons-arrow-up-tray-16-solid",variant:"outline",loading:t(g),onClick:b},{default:n(()=>[h(" Upload Flow ")]),_:1},8,["loading"])])])):v("",!0),a("div",le,[se,l(d,{size:"md",class:"py-3",label:"Google API key",description:"Google API key, required for Flows where, e.g. ComfyUI-Gemini Node is used"},{default:n(()=>[l(u,{modelValue:t(o).settingsMap.google_api_key_user.value,"onUpdate:modelValue":e[8]||(e[8]=s=>t(o).settingsMap.google_api_key_user.value=s),placeholder:"Google API key",class:"w-full",type:"password",icon:"i-heroicons-shield-check",size:"md",autocomplete:"off"},null,8,["modelValue"])]),_:1}),l(d,{size:"md",class:"py-3",label:"Outputs maximum image size",description:"To keep the output seamless, we limit the size of the outputs (512px by default)"},{default:n(()=>[l(z,{modelValue:t(p).$state.outputMaxSize,"onUpdate:modelValue":e[9]||(e[9]=s=>t(p).$state.outputMaxSize=s),options:["512","768","1024","1536","2048"]},null,8,["modelValue"])]),_:1})]),l(f,{icon:"i-heroicons-check-16-solid",onClick:V},{default:n(()=>[h(" Save ")]),_:1})])])]),_:1})}}});export{re as default};
