import{_ as Ge,o as m,c as U,a as y,y as Se,x as Re,n as Q,f as Y,A as Qe,B as ze,C as Ke,a1 as _t,D as ye,K as C,W as Ye,S as _e,q as de,a2 as $t,s as V,G as je,E as Ce,a3 as Ct,a4 as at,a5 as It,a6 as Je,a7 as St,a8 as st,a9 as Mt,aa as dt,ab as Rt,ac as Pt,p as n,ad as Ze,ae as zt,af as Ft,ag as Fe,g as ue,J as Be,T as ct,ah as Pe,i as S,l as $,w as P,b as g,F as ee,r as ce,d as N,m as te,O as X,ai as Te,t as D,U as Ve,P as et,R as Ut,L as Ie,h as be,I as Ot,aj as mt,k as Ne,ak as tt,al as jt,am as Tt,an as Bt,ao as ft,Q as Xe,ap as Vt,M as Me,aq as pt,ar as ae,as as gt,j as nt,at as Nt,au as qt,av as Et,v as Wt}from"./CuIvhbA9.js";import{b as qe,a as At,_ as Dt}from"./Bxywnyi5.js";import{u as vt,_ as Ee}from"./DaEodgvS.js";import{_ as We}from"./Dq_csfd_.js";import{_ as $e,a as Lt}from"./DT-nsvSG.js";import{_ as lt}from"./CoN8gq5z.js";import{a as Ae,_ as ht}from"./Dv79n_Ce.js";import{_ as wt,a as Ht}from"./DDTHOM_X.js";const Jt={wrapper:"relative",container:"relative w-full flex overflow-x-auto snap-x snap-mandatory scroll-smooth",item:"flex flex-none snap-center",arrows:{wrapper:"flex items-center justify-between"},indicators:{wrapper:"absolute flex items-center justify-center gap-3 bottom-4 inset-x-0",base:"rounded-full h-3 w-3",active:"bg-primary-500 dark:bg-primary-400",inactive:"bg-gray-100 dark:bg-gray-800"},default:{prevButton:{color:"black",class:"rtl:[&_span:first-child]:rotate-180 absolute start-4 top-1/2 transform -translate-y-1/2 rounded-full",icon:"i-heroicons-chevron-left-20-solid"},nextButton:{color:"black",class:"rtl:[&_span:last-child]:rotate-180 absolute end-4 top-1/2 transform -translate-y-1/2 rounded-full",icon:"i-heroicons-chevron-right-20-solid"}}},Xt={wrapper:"relative w-full flex items-center",base:"w-full absolute appearance-none cursor-pointer disabled:cursor-not-allowed disabled:bg-opacity-50 focus:outline-none peer group",rounded:"rounded-lg",background:"bg-transparent",ring:"focus-visible:ring-2 focus-visible:ring-{color}-500 dark:focus-visible:ring-{color}-400 focus-visible:ring-offset-2 focus-visible:ring-offset-white dark:focus-visible:ring-offset-gray-900",progress:{base:"absolute pointer-events-none peer-disabled:bg-opacity-50",rounded:"rounded-s-lg",background:"bg-{color}-500 dark:bg-{color}-400",size:{"2xs":"h-px",xs:"h-0.5",sm:"h-1",md:"h-2",lg:"h-3",xl:"h-4","2xl":"h-5"}},thumb:{base:"[&::-webkit-slider-thumb]:relative [&::-moz-range-thumb]:relative [&::-webkit-slider-thumb]:z-[1] [&::-moz-range-thumb]:z-[1] [&::-webkit-slider-thumb]:appearance-none [&::-moz-range-thumb]:appearance-none [&::-webkit-slider-thumb]:rounded-full [&::-moz-range-thumb]:rounded-full [&::-moz-range-thumb]:border-0",color:"text-{color}-500 dark:text-{color}-400",background:"[&::-webkit-slider-thumb]:bg-white [&::-webkit-slider-thumb]:dark:bg-gray-900 [&::-moz-range-thumb]:bg-current",ring:"[&::-webkit-slider-thumb]:ring-2 [&::-webkit-slider-thumb]:ring-current",size:{"2xs":"[&::-webkit-slider-thumb]:h-1.5 [&::-moz-range-thumb]:h-1.5 [&::-webkit-slider-thumb]:w-1.5 [&::-moz-range-thumb]:w-1.5 [&::-webkit-slider-thumb]:mt-[-2.5px] [&::-moz-range-thumb]:mt-[-2.5px]",xs:"[&::-webkit-slider-thumb]:h-2 [&::-moz-range-thumb]:h-2 [&::-webkit-slider-thumb]:w-2 [&::-moz-range-thumb]:w-2 [&::-webkit-slider-thumb]:mt-[-3px] [&::-moz-range-thumb]:mt-[-3px]",sm:"[&::-webkit-slider-thumb]:h-3 [&::-moz-range-thumb]:h-3 [&::-webkit-slider-thumb]:w-3 [&::-moz-range-thumb]:w-3 [&::-webkit-slider-thumb]:-mt-1 [&::-moz-range-thumb]:-mt-1",md:"[&::-webkit-slider-thumb]:h-4 [&::-moz-range-thumb]:h-4 [&::-webkit-slider-thumb]:w-4 [&::-moz-range-thumb]:w-4 [&::-webkit-slider-thumb]:-mt-1 [&::-moz-range-thumb]:-mt-1",lg:"[&::-webkit-slider-thumb]:h-5 [&::-moz-range-thumb]:h-5 [&::-webkit-slider-thumb]:w-5 [&::-moz-range-thumb]:w-5 [&::-webkit-slider-thumb]:-mt-1 [&::-moz-range-thumb]:-mt-1",xl:"[&::-webkit-slider-thumb]:h-6 [&::-moz-range-thumb]:h-6 [&::-webkit-slider-thumb]:w-6 [&::-moz-range-thumb]:w-6 [&::-webkit-slider-thumb]:-mt-1 [&::-moz-range-thumb]:-mt-1","2xl":"[&::-webkit-slider-thumb]:h-7 [&::-moz-range-thumb]:h-7 [&::-webkit-slider-thumb]:w-7 [&::-moz-range-thumb]:w-7 [&::-webkit-slider-thumb]:-mt-1 [&::-moz-range-thumb]:-mt-1"}},track:{base:"[&::-webkit-slider-runnable-track]:group-disabled:bg-opacity-50 [&::-moz-range-track]:group-disabled:bg-opacity-50",background:"[&::-webkit-slider-runnable-track]:bg-gray-200 [&::-moz-range-track]:bg-gray-200 [&::-webkit-slider-runnable-track]:dark:bg-gray-700 [&::-moz-range-track]:dark:bg-gray-700",rounded:"[&::-webkit-slider-runnable-track]:rounded-lg [&::-moz-range-track]:rounded-lg",size:{"2xs":"[&::-webkit-slider-runnable-track]:h-px [&::-moz-range-track]:h-px",xs:"[&::-webkit-slider-runnable-track]:h-0.5 [&::-moz-range-track]:h-0.5",sm:"[&::-webkit-slider-runnable-track]:h-1 [&::-moz-range-track]:h-1",md:"[&::-webkit-slider-runnable-track]:h-2 [&::-moz-range-track]:h-2",lg:"[&::-webkit-slider-runnable-track]:h-3 [&::-moz-range-track]:h-3",xl:"[&::-webkit-slider-runnable-track]:h-4 [&::-moz-range-track]:h-4","2xl":"[&::-webkit-slider-runnable-track]:h-5 [&::-moz-range-track]:h-5"}},size:{"2xs":"h-1.5",xs:"h-2",sm:"h-3",md:"h-4",lg:"h-5",xl:"h-6","2xl":"h-7"},default:{size:"md",color:"primary"}},we=Ke(ye.ui.strategy,ye.ui.textarea,_t),Gt=Y({inheritAttrs:!1,props:{modelValue:{type:[String,Number],default:""},id:{type:String,default:null},name:{type:String,default:null},placeholder:{type:String,default:null},required:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},rows:{type:Number,default:3},maxrows:{type:Number,default:0},autoresize:{type:Boolean,default:!1},autofocus:{type:Boolean,default:!1},autofocusDelay:{type:Number,default:100},resize:{type:Boolean,default:!1},padded:{type:Boolean,default:!0},size:{type:String,default:null,validator(e){return Object.keys(we.size).includes(e)}},color:{type:String,default:()=>we.default.color,validator(e){return[...ye.ui.colors,...Object.keys(we.color)].includes(e)}},variant:{type:String,default:()=>we.default.variant,validator(e){return[...Object.keys(we.variant),...Object.values(we.color).flatMap(l=>Object.keys(l))].includes(e)}},textareaClass:{type:String,default:null},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})},modelModifiers:{type:Object,default:()=>({})}},emits:["update:modelValue","blur","change"],setup(e,{emit:l}){const{ui:t,attrs:s}=Qe("textarea",ze(e,"ui"),we,ze(e,"class")),{emitFormBlur:r,emitFormInput:o,inputId:a,color:f,size:p,name:k}=vt(e,we),h=C(Ye({},e.modelModifiers,{trim:!1,lazy:!1,number:!1,nullify:!1})),x=C(null),F=()=>{var d;e.autofocus&&((d=x.value)==null||d.focus())},I=()=>{if(e.autoresize){if(!x.value)return;x.value.rows=e.rows;const d=x.value.style.overflow;x.value.style.overflow="hidden";const i=window.getComputedStyle(x.value),v=Number.parseInt(i.paddingTop),B=Number.parseInt(i.paddingBottom),u=v+B,w=Number.parseInt(i.lineHeight),{scrollHeight:R}=x.value,z=(R-u)/w;z>e.rows&&(x.value.rows=e.maxrows?Math.min(z,e.maxrows):z),x.value.style.overflow=d}},_=d=>{h.value.trim&&(d=d.trim()),h.value.number&&(d=Ct(d)),h.value.nullify&&(d||(d=null)),l("update:modelValue",d),o()},M=d=>{I(),h.value.lazy||_(d.target.value)},O=d=>{const i=d.target.value;l("change",i),h.value.lazy&&_(i),h.value.trim&&(d.target.value=i.trim())},b=d=>{l("blur",d),r()};_e(()=>{setTimeout(()=>{F()},e.autofocusDelay)}),de(()=>e.modelValue,()=>{$t(I)}),_e(()=>{setTimeout(()=>{F(),I()},100)});const c=V(()=>{var i,v;const d=((v=(i=t.value.color)==null?void 0:i[f.value])==null?void 0:v[e.variant])||t.value.variant[e.variant];return je(Ce(t.value.base,t.value.form,t.value.rounded,t.value.placeholder,t.value.size[p.value],e.padded?t.value.padding[p.value]:"p-0",d==null?void 0:d.replaceAll("{color}",f.value),!e.resize&&"resize-none"),e.textareaClass)});return{ui:t,attrs:s,name:k,inputId:a,textarea:x,textareaClass:c,onInput:M,onChange:O,onBlur:b}}}),Qt=["id","value","name","rows","required","disabled","placeholder"];function Kt(e,l,t,s,r,o){return m(),U("div",{class:Q(e.ui.wrapper)},[y("textarea",Se({id:e.inputId,ref:"textarea",value:e.modelValue,name:e.name,rows:e.rows,required:e.required,disabled:e.disabled,placeholder:e.placeholder,class:e.textareaClass},e.attrs,{onInput:l[0]||(l[0]=(...a)=>e.onInput&&e.onInput(...a)),onBlur:l[1]||(l[1]=(...a)=>e.onBlur&&e.onBlur(...a)),onChange:l[2]||(l[2]=(...a)=>e.onChange&&e.onChange(...a))}),null,16,Qt),Re(e.$slots,"default")],2)}const Yt=Ge(Gt,[["render",Kt]]);async function Zt(e,l){return await en(l).catch(s=>(console.error("Failed to get image meta for "+l,s+""),{width:0,height:0,ratio:0}))}async function en(e){if(typeof Image>"u")throw new TypeError("Image not supported");return new Promise((l,t)=>{const s=new Image;s.onload=()=>{const r={width:s.width,height:s.height,ratio:s.width/s.height};l(r)},s.onerror=r=>t(r),s.src=e})}function it(e){return l=>l?e[l]||l:e.missingValue}function tn({formatter:e,keyMap:l,joinWith:t="/",valueMap:s}={}){e||(e=(o,a)=>`${o}=${a}`),l&&typeof l!="function"&&(l=it(l));const r=s||{};return Object.keys(r).forEach(o=>{typeof r[o]!="function"&&(r[o]=it(r[o]))}),(o={})=>Object.entries(o).filter(([f,p])=>typeof p<"u").map(([f,p])=>{const k=r[f];return typeof k=="function"&&(p=k(o[f])),f=typeof l=="function"?l(f):f,e(f,p)}).join(t)}function pe(e=""){if(typeof e=="number")return e;if(typeof e=="string"&&e.replace("px","").match(/^\d+$/g))return Number.parseInt(e,10)}function nn(e=""){if(e===void 0||!e.length)return[];const l=new Set;for(const t of e.split(" ")){const s=Number.parseInt(t.replace("x",""));s&&l.add(s)}return Array.from(l)}function ln(e){if(e.length===0)throw new Error("`densities` must not be empty, configure to `1` to render regular size only (DPR 1.0)")}function on(e){const l={};if(typeof e=="string")for(const t of e.split(/[\s,]+/).filter(s=>s)){const s=t.split(":");s.length!==2?l["1px"]=s[0].trim():l[s[0].trim()]=s[1].trim()}else Object.assign(l,e);return l}function an(e){const l={options:e},t=(r,o={})=>yt(l,r,o),s=(r,o={},a={})=>t(r,{...a,modifiers:Ye(o,a.modifiers||{})}).url;for(const r in e.presets)s[r]=(o,a,f)=>s(o,a,{...e.presets[r],...f});return s.options=e,s.getImage=t,s.getMeta=(r,o)=>sn(l,r,o),s.getSizes=(r,o)=>dn(l,r,o),l.$img=s,s}async function sn(e,l,t){const s=yt(e,l,{...t});return typeof s.getMeta=="function"?await s.getMeta():await Zt(e,s.url)}function yt(e,l,t){var k,h;if(l&&typeof l!="string")throw new TypeError(`input must be a string (received ${typeof l}: ${JSON.stringify(l)})`);if(!l||l.startsWith("data:"))return{url:l};const{provider:s,defaults:r}=rn(e,t.provider||e.options.provider),o=un(e,t.preset);if(l=at(l)?l:It(l),!s.supportsAlias){for(const x in e.options.alias)if(l.startsWith(x)){const F=e.options.alias[x];F&&(l=Je(F,l.slice(x.length)))}}if(s.validateDomains&&at(l)){const x=St(l).host;if(!e.options.domains.find(F=>F===x))return{url:l}}const a=Ye(t,o,r);a.modifiers={...a.modifiers};const f=a.modifiers.format;(k=a.modifiers)!=null&&k.width&&(a.modifiers.width=pe(a.modifiers.width)),(h=a.modifiers)!=null&&h.height&&(a.modifiers.height=pe(a.modifiers.height));const p=s.getImage(l,a,e);return p.format=p.format||f||"",p}function rn(e,l){const t=e.options.providers[l];if(!t)throw new Error("Unknown provider: "+l);return t}function un(e,l){if(!l)return{};if(!e.options.presets[l])throw new Error("Unknown preset: "+l);return e.options.presets[l]}function dn(e,l,t){var _,M,O,b,c;const s=pe((_=t.modifiers)==null?void 0:_.width),r=pe((M=t.modifiers)==null?void 0:M.height),o=on(t.sizes),a=(O=t.densities)!=null&&O.trim()?nn(t.densities.trim()):e.options.densities;ln(a);const f=s&&r?r/s:0,p=[],k=[];if(Object.keys(o).length>=1){for(const d in o){const i=rt(d,String(o[d]),r,f,e);if(i!==void 0){p.push({size:i.size,screenMaxWidth:i.screenMaxWidth,media:`(max-width: ${i.screenMaxWidth}px)`});for(const v of a)k.push({width:i._cWidth*v,src:ut(e,l,t,i,v)})}}cn(p)}else for(const d of a){const i=Object.keys(o)[0];let v=i?rt(i,String(o[i]),r,f,e):void 0;v===void 0&&(v={size:"",screenMaxWidth:0,_cWidth:(b=t.modifiers)==null?void 0:b.width,_cHeight:(c=t.modifiers)==null?void 0:c.height}),k.push({width:d,src:ut(e,l,t,v,d)})}mn(k);const h=k[k.length-1],x=p.length?p.map(d=>`${d.media?d.media+" ":""}${d.size}`).join(", "):void 0,F=x?"w":"x",I=k.map(d=>`${d.src} ${d.width}${F}`).join(", ");return{sizes:x,srcset:I,src:h==null?void 0:h.src}}function rt(e,l,t,s,r){const o=r.options.screens&&r.options.screens[e]||Number.parseInt(e),a=l.endsWith("vw");if(!a&&/^\d+$/.test(l)&&(l=l+"px"),!a&&!l.endsWith("px"))return;let f=Number.parseInt(l);if(!o||!f)return;a&&(f=Math.round(f/100*o));const p=s?Math.round(f*s):t;return{size:l,screenMaxWidth:o,_cWidth:f,_cHeight:p}}function ut(e,l,t,s,r){return e.$img(l,{...t.modifiers,width:s._cWidth?s._cWidth*r:void 0,height:s._cHeight?s._cHeight*r:void 0},t)}function cn(e){var t;e.sort((s,r)=>s.screenMaxWidth-r.screenMaxWidth);let l=null;for(let s=e.length-1;s>=0;s--){const r=e[s];r.media===l&&e.splice(s,1),l=r.media}for(let s=0;s<e.length;s++)e[s].media=((t=e[s+1])==null?void 0:t.media)||""}function mn(e){e.sort((t,s)=>t.width-s.width);let l=null;for(let t=e.length-1;t>=0;t--){const s=e[t];s.width===l&&e.splice(t,1),l=s.width}}const fn=tn({keyMap:{format:"f",fit:"fit",width:"w",height:"h",resize:"s",quality:"q",background:"b"},joinWith:"&",formatter:(e,l)=>st(e)+"_"+st(l)}),pn=(e,{modifiers:l={},baseURL:t}={},s)=>{l.width&&l.height&&(l.resize=`${l.width}x${l.height}`,delete l.width,delete l.height);const r=fn(l)||"_";return t||(t=Je(s.options.nuxt.baseURL,"/_ipx")),{url:Je(t,r,Mt(e))}},gn=!0,vn=!0,hn=Object.freeze(Object.defineProperty({__proto__:null,getImage:pn,supportsAlias:vn,validateDomains:gn},Symbol.toStringTag,{value:"Module"})),bt={screens:{xs:320,sm:640,md:768,lg:1024,xl:1280,xxl:1536,"2xl":1536},presets:{},provider:"ipxStatic",domains:[],alias:{},densities:[1,2],format:["webp"]};bt.providers={ipxStatic:{provider:hn,defaults:{}}};const ot=()=>{const e=Rt(),l=dt();return l.$img||l._img||(l._img=an({...bt,nuxt:{baseURL:e.app.baseURL},runtimeConfig:e}))};function wn(e){var l;(l=performance==null?void 0:performance.mark)==null||l.call(performance,"mark_feature_usage",{detail:{feature:e}})}const yn={src:{type:String,required:!1},format:{type:String,required:!1},quality:{type:[Number,String],required:!1},background:{type:String,required:!1},fit:{type:String,required:!1},modifiers:{type:Object,required:!1},preset:{type:String,required:!1},provider:{type:String,required:!1},sizes:{type:[Object,String],required:!1},densities:{type:String,required:!1},preload:{type:[Boolean,Object],required:!1},width:{type:[String,Number],required:!1},height:{type:[String,Number],required:!1},alt:{type:String,required:!1},referrerpolicy:{type:String,required:!1},usemap:{type:String,required:!1},longdesc:{type:String,required:!1},ismap:{type:Boolean,required:!1},loading:{type:String,required:!1,validator:e=>["lazy","eager"].includes(e)},crossorigin:{type:[Boolean,String],required:!1,validator:e=>["anonymous","use-credentials","",!0,!1].includes(e)},decoding:{type:String,required:!1,validator:e=>["async","auto","sync"].includes(e)},nonce:{type:[String],required:!1}},bn=e=>{const l=V(()=>({provider:e.provider,preset:e.preset})),t=V(()=>({width:pe(e.width),height:pe(e.height),alt:e.alt,referrerpolicy:e.referrerpolicy,usemap:e.usemap,longdesc:e.longdesc,ismap:e.ismap,crossorigin:e.crossorigin===!0?"anonymous":e.crossorigin||void 0,loading:e.loading,decoding:e.decoding,nonce:e.nonce})),s=ot(),r=V(()=>({...e.modifiers,width:pe(e.width),height:pe(e.height),format:e.format,quality:e.quality||s.options.quality,background:e.background,fit:e.fit}));return{options:l,attrs:t,modifiers:r}},kn={...yn,placeholder:{type:[Boolean,String,Number,Array],required:!1},placeholderClass:{type:String,required:!1}},xn=["src"],ke=Y({__name:"NuxtImg",props:kn,emits:["load","error"],setup(e,{emit:l}){const t=e,s=Pt(),r=l,o=!1,a=ot(),f=bn(t),p=C(!1),k=C(),h=V(()=>a.getSizes(t.src,{...f.options.value,sizes:t.sizes,densities:t.densities,modifiers:{...f.modifiers.value,width:pe(t.width),height:pe(t.height)}})),x=V(()=>{const b={...f.attrs.value,"data-nuxt-img":""};return(!t.placeholder||p.value)&&(b.sizes=h.value.sizes,b.srcset=h.value.srcset),b}),F=V(()=>{let b=t.placeholder;if(b===""&&(b=!0),!b||p.value)return!1;if(typeof b=="string")return b;const c=Array.isArray(b)?b:typeof b=="number"?[b,b]:[10,10];return a(t.src,{...f.modifiers.value,width:c[0],height:c[1],quality:c[2]||50,blur:c[3]||3},f.options.value)}),I=V(()=>t.sizes?h.value.src:a(t.src,f.modifiers.value,f.options.value)),_=V(()=>F.value?F.value:I.value),O=dt().isHydrating;return _e(()=>{if(F.value){const b=new Image;I.value&&(b.src=I.value),t.sizes&&(b.sizes=h.value.sizes||"",b.srcset=h.value.srcset),b.onload=c=>{p.value=!0,r("load",c)},wn("nuxt-image");return}k.value&&(k.value.complete&&O&&(k.value.getAttribute("data-error")?r("error",new Event("error")):r("load",new Event("load"))),k.value.onload=b=>{r("load",b)},k.value.onerror=b=>{r("error",b)})}),(b,c)=>(m(),U("img",Se({ref_key:"imgEl",ref:k,class:t.placeholder&&!p.value?t.placeholderClass:void 0},{...n(o)?{onerror:"this.setAttribute('data-error', 1)"}:{},...x.value,...n(s)},{src:_.value}),null,16,xn))}}),Ue=Ke(ye.ui.strategy,ye.ui.range,Xt),_n=Y({inheritAttrs:!1,props:{modelValue:{type:Number,default:0},id:{type:String,default:null},name:{type:String,default:null},disabled:{type:Boolean,default:!1},min:{type:Number,default:0},max:{type:Number,default:100},step:{type:Number,default:1},size:{type:String,default:null,validator(e){return Object.keys(Ue.size).includes(e)}},color:{type:String,default:()=>Ue.default.color,validator(e){return ye.ui.colors.includes(e)}},inputClass:{type:String,default:null},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})}},emits:["update:modelValue","change"],setup(e,{emit:l}){const{ui:t,attrs:s}=Qe("range",ze(e,"ui"),Ue),{emitFormChange:r,inputId:o,color:a,size:f,name:p}=vt(e,Ue),k=V({get(){return e.modelValue},set(b){l("update:modelValue",b)}}),h=b=>{l("change",b.target.value),r()},x=V(()=>je(Ce(t.value.wrapper,t.value.size[f.value]),e.class)),F=V(()=>je(Ce(t.value.base,t.value.background,t.value.rounded,a.value&&t.value.ring.replaceAll("{color}",a.value),t.value.size[f.value]),e.inputClass)),I=V(()=>Ce(t.value.thumb.base,a.value&&t.value.thumb.color.replaceAll("{color}",a.value),t.value.thumb.ring,t.value.thumb.background,t.value.thumb.size[f.value])),_=V(()=>Ce(t.value.track.base,t.value.track.background,t.value.track.rounded,t.value.track.size[f.value])),M=V(()=>Ce(t.value.progress.base,t.value.progress.rounded,a.value&&t.value.progress.background.replaceAll("{color}",a.value),t.value.progress.size[f.value])),O=V(()=>{const{modelValue:b,min:c,max:d}=e;return{width:`${(Math.max(c,Math.min(b,d))-c)/(d-c)*100}%`}});return{ui:t,attrs:s,name:p,inputId:o,value:k,wrapperClass:x,inputClass:F,thumbClass:I,trackClass:_,progressClass:M,progressStyle:O,onChange:h}}}),$n=["id","name","min","max","disabled","step"];function Cn(e,l,t,s,r,o){return m(),U("div",{class:Q(e.wrapperClass)},[Ze(y("input",Se({id:e.inputId,ref:"input","onUpdate:modelValue":l[0]||(l[0]=a=>e.value=a),name:e.name,min:e.min,max:e.max,disabled:e.disabled,step:e.step,type:"range",class:[e.inputClass,e.thumbClass,e.trackClass]},e.attrs,{onChange:l[1]||(l[1]=(...a)=>e.onChange&&e.onChange(...a))}),null,16,$n),[[zt,e.value,void 0,{number:!0}]]),y("span",{class:Q(e.progressClass),style:Ft(e.progressStyle)},null,6)],2)}const kt=Ge(_n,[["render",Cn]]),In={class:"image-mask flex flex-col w-full"},Sn={class:"canvas flex flex-col items-center justify-center mb-3 w-full"},Mn={class:"preview-over-original relative"},Rn={class:"actions flex items-center justify-center mb-3 mx-auto"},Pn={class:"options w-full max-w-[320px]"},zn=Y({__name:"ImageInpaint",props:Te({imageSrc:{type:String,required:!0}},{imageInpaintMask:{default:"",type:String},imageInpaintMaskModifiers:{},imageInpaintMaskData:{default:{},type:Object},imageInpaintMaskDataModifiers:{}}),emits:["update:imageInpaintMask","update:imageInpaintMaskData"],setup(e){const l=e,t=Fe(e,"imageInpaintMask"),s=Fe(e,"imageInpaintMaskData"),r=ue(),o=C(null),a=C(null),f=C(null),p=C(null),k=C(30),h=C([]),x=C({width:r.$state.outputMaxSize,height:r.$state.outputMaxSize}),F=C(null),I=C({x:0,y:0}),_=C({x:0,y:0,radius:k.value,fill:"rgba(255, 255, 255, 0.5)",stroke:null,strokeWidth:0,visible:!1}),M=C(5),O=C(!1),b=C([]),c=C([]);function d(){if(!o.value||!f.value){console.error("Could not get stage, image layer, or mask layer");return}const T=o.value.getNode(),q=p.value?p.value.width:T.width(),j=p.value?p.value.height:T.height(),G=document.createElement("canvas");G.width=q,G.height=j;const K=G.getContext("2d");if(!K){console.error("Could not get 2d context for mask canvas");return}K.fillStyle="black",K.fillRect(0,0,q,j);const ie=q/T.width(),re=j/T.height();K.fillStyle="white",h.value.forEach(he=>{K.beginPath(),K.arc(he.x*ie,he.y*re,he.radius*Math.max(ie,re),0,Math.PI*2,!0),K.closePath(),K.fill()});const fe=G.toDataURL("image/png",1);fe?(z(),t.value=fe,_.value.visible=!1,O.value=!1):console.error("Could not get data URI for masked image")}function i(T){const q=o.value.getNode();if(T.type.startsWith("touch")){const j=T.evt.touches[0]||T.evt.changedTouches[0];return{x:j.clientX-q.getContainer().offsetLeft,y:j.clientY-q.getContainer().offsetTop}}return q.getPointerPosition()}function v(T){T.type==="mousedown"&&T.evt.button!==0||(O.value=!0,I.value=i(T),R(),B(I.value))}function B(T){const q={x:T.x,y:T.y,radius:k.value,fill:"rgba(255, 255, 255, 1)"};h.value=h.value.filter(j=>!(u({x:j.x,y:j.y},T)+j.radius<=q.radius)),h.value.push(q)}function u(T,q){return Math.sqrt(Math.pow(q.x-T.x,2)+Math.pow(q.y-T.y,2))}function w(T){if(T.type.startsWith("touch")&&T.evt.preventDefault(),Z(T),!O.value)return;const q=i(T);u(I.value,i(T))>=M.value&&(B(q),I.value=q)}function R(){b.value.push([...h.value]),c.value=[]}function z(){s.value={circles:[...h.value],brushRadius:k.value,undoStack:b.value,redoStack:c.value}}function E(){s.value!==null&&(h.value=s.value.circles||[],k.value=s.value.brushRadius||30,b.value=s.value.undoStack||[],c.value=s.value.redoStack||[])}function ne(){b.value.length!==0&&(c.value.push([...h.value]),h.value=b.value.pop()||[])}function le(){c.value.length!==0&&(b.value.push([...h.value]),h.value=c.value.pop()||[])}function me(){O.value=!1}function ge(){t.value=""}function W(){R(),h.value=[],t.value=""}const A=V(()=>b.value.length>0),H=V(()=>c.value.length>0);function Z(T){const q=i(T);_.value.x=q.x,_.value.y=q.y}function se(){_.value.visible=!1,O.value=!1}function ve(){_.value.visible=!0,_.value.radius=k.value}function L(){const T=new Image;T.src=l.imageSrc,T.onload=()=>{p.value=T,oe(),xe()}}function oe(){if(!p.value)return;const T=window.innerWidth,q=window.innerHeight,j=p.value.width/p.value.height;let G,K;const ie=Math.min(T*.9,1200),re=Math.min(q*.8,r.outputMaxSize);j>ie/re?(G=ie,K=G/j):(K=re,G=K*j),x.value={width:Math.floor(G),height:Math.floor(K)},xe()}function xe(){const T=x.value.width,q=x.value.height,j=p.value.width,G=p.value.height,K=T/j,ie=q/G,re=Math.min(K,ie);F.value={x:0,y:0,width:j*re,height:G*re}}return Be(()=>{L(),E()}),_e(()=>{if(o.value){const T=o.value.getNode();T.on("touchstart",v),T.on("touchmove",w),T.on("touchend",me),T.on("touchcancel",se)}}),ct(()=>{if(o.value){const T=o.value.getNode();T.off("touchstart"),T.off("touchmove"),T.off("touchend"),T.off("touchcancel")}z()}),(T,q)=>{const j=ke,G=Pe("v-image"),K=Pe("v-layer"),ie=Pe("v-circle"),re=Pe("v-stage"),fe=te,he=kt,J=We;return m(),U("div",In,[y("div",Sn,[q[1]||(q[1]=y("p",{class:"text-sm my-2 text-slate-500"},"Select the target area for image inpaint",-1)),y("div",Mn,[e.imageSrc&&e.imageSrc!==""&&t.value!==""?(m(),S(j,{key:0,src:e.imageSrc,fit:"inside",width:n(x).width,height:n(x).height,draggable:"false",class:Q({absolute:t.value!==""})},null,8,["src","width","height","class"])):$("",!0),t.value?(m(),S(j,{key:1,src:t.value,fit:"inside",width:n(x).width,height:n(x).height,draggable:"false",class:"opacity-50"},null,8,["src","width","height"])):$("",!0)]),t.value===""?(m(),S(re,{key:0,ref_key:"stageRef",ref:o,config:n(x),onMousedown:v,onMousemove:w,onMouseup:me,onMouseleave:se,onMouseenter:ve},{default:P(()=>[g(K,{ref_key:"imageLayerRef",ref:a},{default:P(()=>[g(G,{image:n(p),config:n(x)},null,8,["image","config"])]),_:1},512),g(K,{ref_key:"maskLayerRef",ref:f},{default:P(()=>[(m(!0),U(ee,null,ce(n(h),(Le,xt)=>(m(),S(ie,{key:xt,config:Le},null,8,["config"]))),128)),n(_).visible?(m(),S(ie,{key:0,config:n(_)},null,8,["config"])):$("",!0)]),_:1},512)]),_:1},8,["config"])):$("",!0)]),y("div",Rn,[g(fe,{class:"mr-2",size:"xs",icon:"i-heroicons-clipboard-document-check-16-solid",variant:"soft",disabled:n(h).length===0||t.value!=="",onClick:d},{default:P(()=>q[2]||(q[2]=[N(" Apply ")])),_:1},8,["disabled"]),g(fe,{class:"mr-2",size:"xs",icon:"i-heroicons-arrow-uturn-left-16-solid",variant:"soft",color:"cyan",disabled:!n(A)||t.value!=="",onClick:ne},null,8,["disabled"]),g(fe,{class:"mr-2",size:"xs",icon:"i-heroicons-arrow-uturn-right-16-solid",variant:"soft",color:"cyan",disabled:!n(H)||t.value!=="",onClick:le},null,8,["disabled"]),g(fe,{class:"mr-2",size:"xs",icon:"i-heroicons-arrow-turn-up-left-20-solid",variant:"soft",disabled:n(h).length===0&&t.value==="",color:"red",onClick:W},{default:P(()=>q[3]||(q[3]=[N(" Reset ")])),_:1},8,["disabled"]),g(fe,{size:"xs",icon:"i-heroicons-pencil-solid",variant:"soft",disabled:t.value==="",color:"orange",onClick:ge},{default:P(()=>q[4]||(q[4]=[N(" Edit ")])),_:1},8,["disabled"])]),y("div",Pn,[g(J,{class:"mb-3 text-sm",hint:`value: ${n(k)}`,label:"Brush radius"},{default:P(()=>[g(he,{modelValue:n(k),"onUpdate:modelValue":q[0]||(q[0]=Le=>X(k)?k.value=Le:null),min:1,max:100,size:"sm",class:"my-2",disabled:t.value!==""},null,8,["modelValue","disabled"])]),_:1},8,["hint"])])])}}}),Fn="0.05";function Un(e,l){const t=parseFloat(e);if(isNaN(t))return e;const s=t+l;return s<0?"0":String(Number(s.toFixed(10)))}function On(e,l){let t=l,s=l,r=0,o=0;for(;t>=0&&(t--,!(e[t]==="("&&r===o));)e[t]==="("&&r++,e[t]===")"&&o++;if(t<0)return!1;for(r=0,o=0;s<e.length&&!(e[s]===")"&&r===o);)e[s]==="("&&r++,e[s]===")"&&o++,s++;return s===e.length?!1:{start:t+1,end:s}}function jn(e){const l=/^\((.*)\)$/,t=e.match(l),s=/:([+-]?(\d*\.)?\d+([eE][+-]?\d+)?)/,r=e.match(s);return t&&!r?`(${t[1]}:1.0)`:e}function Tn(e){const l=e.composedPath()[0],t=parseFloat(Fn);if(l.tagName!=="TEXTAREA"||!(e.key==="ArrowUp"||e.key==="ArrowDown")||!e.ctrlKey&&!e.metaKey)return;e.preventDefault();let s=l.selectionStart,r=l.selectionEnd,o=l.value.substring(s,r);if(!o){const p=On(l.value,s);if(p)s=p.start,r=p.end,o=l.value.substring(s,r);else{const k=" .,\\/!?%^*;:{}=-_`~()\r\n	";for(;!k.includes(l.value[s-1])&&s>0;)s--;for(;!k.includes(l.value[r])&&r<l.value.length;)r++;if(o=l.value.substring(s,r),!o)return}}o[o.length-1]===" "&&(o=o.substring(0,o.length-1),r-=1),l.value[s-1]==="("&&l.value[r]===")"&&(s-=1,r+=1,o=l.value.substring(s,r)),(o[0]!=="("||o[o.length-1]!==")")&&(o=`(${o})`),o=jn(o);const a=e.key==="ArrowUp"?t:-t,f=o.replace(/\((.*):(\d+(?:\.\d+)?)\)/,(p,k,h)=>(h=Un(h,a),Number(h)==1?k:`(${k}:${h})`));return l.setRangeText(f,s,r,"select"),l.value}const Bn={key:0,class:"text-red-300"},Vn={key:0,class:"flex items-center"},Nn={key:2,class:"flex flex-row flex-grow items-center justify-between"},qn={key:3,class:"flex flex-row flex-grow items-center"},En={class:"sm:inline"},Wn={class:"preview-over-original relative"},An={key:1,class:"text-red-300 text-sm"},Dn=Y({__name:"InputParam",props:{inputParam:{type:Object,required:!0},index:{type:Number,required:!0},inputParamsMap:{type:Array,required:!0},advanced:{type:Boolean,default:!1}},setup(e){const l=e,t=C(!1),s=C(null),r=C(""),o=C({width:0,height:0}),a=C(""),f=C({}),p=C(null),k=l.inputParamsMap[l.index][l.inputParam.name].source_input_name,h=l.inputParamsMap.findIndex(i=>{if(Object.keys(i)[0]===l.inputParamsMap[l.index][l.inputParam.name].source_input_name)return!0});function x(){try{const i=l.inputParamsMap.find(v=>{const B=Object.keys(v)[0];if(B===k)return v[B]});O(i[k].value)}catch{o.value.width=0,o.value.height=0}}_e(()=>{l.inputParam.type==="range_scale"&&x(),l.inputParam.type==="image-mask"&&de(a,i=>{const v=new File([a.value],`image-mask-${l.inputParam.name}.png`,{type:"image/png"});l.inputParamsMap[l.index][l.inputParam.name].value=v,l.inputParamsMap[l.index][l.inputParam.name].mask_applied=i!==""})}),l.inputParam.type==="range_scale"&&de(l.inputParamsMap,()=>{x()});function F(i){return i?URL.createObjectURL(i):""}function I(){URL.revokeObjectURL(r.value),r.value="",s.value&&(s.value.$refs.input.value=""),l.inputParamsMap[l.index][l.inputParam.name].value=null,l.inputParamsMap[l.index][l.inputParam.name].image_preview_url=""}function _(){URL.revokeObjectURL(a.value),a.value="",f.value={},l.inputParamsMap[l.index][l.inputParam.name].value=null,l.inputParamsMap[l.index][l.inputParam.name].mask_applied=!1}const M=V(()=>l.inputParam.type!=="bool"?l.inputParam.display_name:"");function O(i){if(!(i instanceof File)){o.value.width=0,o.value.height=0;return}const v=URL.createObjectURL(i),B=new Image;B.onload=function(){o.value.width=B.naturalWidth,o.value.height=B.naturalHeight,URL.revokeObjectURL(B.src)},B.src=v}const b=V(()=>{if(l.inputParam.type==="range_scale"){const i=l.inputParamsMap[l.index][l.inputParam.name].value;return`value: ${i}x (${o.value.width}x${o.value.height} -> ${(o.value.width*i).toFixed(0)}x${(o.value.height*i).toFixed(0)})`}return["range","range_scale"].includes(l.inputParam.type)?`value: ${l.inputParamsMap[l.index][l.inputParam.name].value}`:""}),c=C(null);function d(i){const v=Tn(i);v&&(l.inputParamsMap[l.index][l.inputParam.name].value=v)}return _e(()=>{l.inputParam.type==="text"&&c.value&&c.value.$refs.textarea.addEventListener("keydown",d),l.inputParam.type==="image-mask"&&(p.value=l.inputParamsMap[h][k],de(l.inputParamsMap[h][k],i=>{a.value="",f.value={},p.value=i}))}),ct(()=>{URL.revokeObjectURL(r.value),URL.revokeObjectURL(a.value),l.inputParam.type==="text"&&c.value&&c.value.$refs.textarea.removeEventListener("keydown",d)}),(i,v)=>{var W;const B=Yt,u=Ee,w=te,R=ke,z=zn,E=$e,ne=lt,le=Ae,me=kt,ge=We;return(((W=e.inputParam)==null?void 0:W.advanced)||!1)===e.advanced?(m(),S(ge,{key:0,label:n(M),class:"mb-3",help:n(b)},{hint:P(()=>[e.inputParam.optional?$("",!0):(m(),U("span",Bn,"required"))]),default:P(()=>{var A,H,Z,se,ve;return[e.inputParam.type==="text"?(m(),S(B,{key:0,ref_key:"textareaInput",ref:c,size:"md",placeholder:e.inputParam.display_name,required:!e.inputParam.optional,resize:!0,label:e.inputParam.display_name,value:e.inputParamsMap[e.index][e.inputParam.name].value,autoresize:"",variant:"outline",onInput:v[0]||(v[0]=L=>{const oe=L.target;e.inputParamsMap[e.index][e.inputParam.name].value=oe.value})},null,8,["placeholder","required","label","value"])):$("",!0),e.inputParam.type==="number"?(m(),U(ee,{key:1},[e.inputParam.name==="seed"?(m(),U("div",Vn,[e.inputParam.type==="number"?(m(),S(u,{key:0,modelValue:e.inputParamsMap[e.index][e.inputParam.name].value,"onUpdate:modelValue":v[1]||(v[1]=L=>e.inputParamsMap[e.index][e.inputParam.name].value=L),type:"number",label:e.inputParam.display_name,required:!e.inputParam.optional,max:e.inputParam.max||100,min:e.inputParam.min||0,variant:"outline"},null,8,["modelValue","label","required","max","min"])):$("",!0),g(w,{icon:"i-heroicons-arrow-path",color:"violet",variant:"outline",size:"xs",class:"ml-2",onClick:v[2]||(v[2]=()=>{e.inputParamsMap[e.index][e.inputParam.name].value=Math.floor(Math.random()*1e7)})})])):(m(),S(u,{key:1,modelValue:e.inputParamsMap[e.index][e.inputParam.name].value,"onUpdate:modelValue":v[3]||(v[3]=L=>e.inputParamsMap[e.index][e.inputParam.name].value=L),type:"number",label:e.inputParam.display_name,required:!e.inputParam.optional,max:e.inputParam.max||100,min:e.inputParam.min||0,variant:"outline"},null,8,["modelValue","label","required","max","min"]))],64)):$("",!0),e.inputParam.type==="image"?(m(),U("div",Nn,[g(u,{ref_key:"imageInput",ref:s,type:"file",accept:"image/*",class:"w-full",variant:"outline",color:"gray",label:e.inputParam.display_name,onChange:v[4]||(v[4]=L=>{console.debug("files",L);const oe=L==null?void 0:L[0];e.inputParamsMap[e.index][e.inputParam.name].value=oe,r.value=F(oe),e.inputParamsMap[e.index][e.inputParam.name].image_preview_url=n(r),console.debug("inputParamsMap",e.inputParamsMap)})},null,8,["label"]),n(r)!==""?(m(),S(R,{key:0,src:n(a)?n(a):n(r),class:"h-10 rounded-lg cursor-pointer ml-2",onClick:v[5]||(v[5]=()=>{t.value=!0})},null,8,["src"])):$("",!0),n(r)!==""?(m(),S(w,{key:1,icon:"i-heroicons-x-mark",variant:"outline",class:"ml-2",onClick:I})):$("",!0)])):$("",!0),e.inputParam.type==="image-mask"?(m(),U("div",qn,[n(p)?(m(),S(w,{key:0,icon:"i-heroicons-paint-brush-16-solid",class:"mr-2",color:"violet",variant:"outline",size:"xs",disabled:!((A=n(p))!=null&&A.value),onClick:v[6]||(v[6]=()=>{t.value=!0})},{default:P(()=>[y("span",En,D(n(a)!==""?"Edit mask":"Draw mask"),1)]),_:1},8,["disabled"])):$("",!0),y("div",Wn,[n(p)&&((H=n(p))!=null&&H.value)?(m(),S(R,{key:0,src:(Z=n(p))==null?void 0:Z.image_preview_url,class:Q(["h-10 rounded-lg cursor-pointer",{absolute:n(a)!==""}]),onClick:v[7]||(v[7]=()=>{t.value=!0})},null,8,["src","class"])):$("",!0),n(a)?(m(),S(R,{key:1,src:n(a),class:"h-10 rounded-lg cursor-pointer opacity-50",onClick:v[8]||(v[8]=()=>{t.value=!0})},null,8,["src"])):$("",!0)]),!n(p)||n(p)&&!((se=n(p))!=null&&se.value)?(m(),U("span",An," Select source image ")):$("",!0),n(a)?(m(),S(w,{key:2,icon:"i-heroicons-x-mark",variant:"outline",color:"violet",class:"ml-2",onClick:_})):$("",!0)])):$("",!0),e.inputParam.type==="image"||e.inputParam.type==="image-mask"?(m(),S(E,{key:4,modelValue:n(t),"onUpdate:modelValue":v[13]||(v[13]=L=>X(t)?t.value=L:null),class:"z-[90] overflow-y-auto",transition:!1,fullscreen:""},{default:P(()=>{var L;return[g(w,{class:"absolute top-4 right-4 z-[100]",icon:"i-heroicons-x-mark",variant:"ghost",onClick:v[9]||(v[9]=()=>t.value=!1)}),e.inputParam.type==="image"?(m(),U("div",{key:0,class:"flex items-center justify-center w-full h-full p-4",onClick:v[10]||(v[10]=Ve(()=>t.value=!1,["left"]))},[g(R,{class:"lg:h-full",fit:"inside",src:n(r)},null,8,["src"])])):(m(),S(z,{key:1,ref:"imageInpaint","image-inpaint-mask":n(a),"onUpdate:imageInpaintMask":v[11]||(v[11]=oe=>X(a)?a.value=oe:null),"image-inpaint-mask-data":n(f),"onUpdate:imageInpaintMaskData":v[12]||(v[12]=oe=>X(f)?f.value=oe:null),class:"flex items-center justify-center w-full h-full p-4","image-src":(L=n(p))==null?void 0:L.image_preview_url},null,8,["image-inpaint-mask","image-inpaint-mask-data","image-src"]))]}),_:1},8,["modelValue"])):$("",!0),e.inputParam.type==="list"?(m(),S(ne,{key:5,modelValue:e.inputParamsMap[e.index][e.inputParam.name].value,"onUpdate:modelValue":v[14]||(v[14]=L=>e.inputParamsMap[e.index][e.inputParam.name].value=L),placeholder:e.inputParam.display_name,options:Object.keys(e.inputParam.options)},null,8,["modelValue","placeholder","options"])):$("",!0),e.inputParam.type==="bool"?(m(),S(le,{key:6,modelValue:e.inputParamsMap[e.index][e.inputParam.name].value,"onUpdate:modelValue":v[15]||(v[15]=L=>e.inputParamsMap[e.index][e.inputParam.name].value=L),label:(ve=e.inputParam)==null?void 0:ve.display_name},null,8,["modelValue","label"])):$("",!0),["range","range_scale"].includes(e.inputParam.type)?(m(),S(me,{key:7,modelValue:e.inputParamsMap[e.index][e.inputParam.name].value,"onUpdate:modelValue":v[16]||(v[16]=L=>e.inputParamsMap[e.index][e.inputParam.name].value=L),label:e.inputParam.display_name,size:"sm",min:e.inputParam.min,max:e.inputParam.max,step:e.inputParam.step},null,8,["modelValue","label","min","max","step"])):$("",!0)]}),_:1},8,["label","help"])):$("",!0)}}}),Ln={key:0,class:"heading"},Hn={key:1},Jn={key:0,class:"max-h-96 overflow-y-auto mt-5"},Xn={class:"heading"},Gn={key:0,class:"p-4"},Qn={key:0,class:"flex items-center w-full max-w-xs"},Kn=Y({__name:"InputParams",props:Te({inputParamsMap:{type:Array,required:!0},additionalInputParamsMap:{type:Array,required:!1,default:[]},advanced:{type:Boolean,default:!1}},{profilingOptions:{default:{},type:Object},profilingOptionsModifiers:{},profilingEnabled:{default:!1,type:Boolean},profilingEnabledModifiers:{}}),emits:["update:profilingOptions","update:profilingEnabled"],setup(e){const l=e,t=ue(),s=et(),r=Ut(),o=C(!l.advanced),a=Fe(e,"profilingOptions"),f=Fe(e,"profilingEnabled"),p=C(!0),k=V(()=>r.workers.map(h=>({value:h.worker_id,label:`${h.worker_id} (type: ${h.device_type}, vram_total: ${Ie(h.vram_total)})`})));return Be(()=>{var x;if(!s.isAdmin)return;const h=localStorage.getItem(`profilingOptions_${(x=t.currentFlow)==null?void 0:x.name}`);h&&(a.value=JSON.parse(h)),r.fetchWorkersInfo().then(()=>{r.workers.find(I=>{var _;return I.worker_id===((_=a.value["X-WORKER-ID"])==null?void 0:_.value)})||(a.value["X-WORKER-ID"]=null)})}),(h,x)=>{const F=be,I=Dn,_=Ae,M=lt,O=te,b=Ee,c=We;return m(),U(ee,null,[e.advanced?(m(),U("div",Ln,[y("h4",{class:"text-md font-bold cursor-pointer select-none flex items-center mb-3",onClick:x[0]||(x[0]=()=>{o.value=!n(o)})},[g(F,{name:n(o)?"i-heroicons-chevron-up":"i-heroicons-chevron-down",class:"mr-2"},null,8,["name"]),x[3]||(x[3]=N(" Advanced options "))])])):$("",!0),n(o)?(m(),U("div",Hn,[(m(!0),U(ee,null,ce(n(t).currentFlow.input_params,(d,i)=>(m(),S(I,{key:i,"input-params-map":e.inputParamsMap,index:i,"input-param":d,advanced:e.advanced},null,8,["input-params-map","index","input-param","advanced"]))),128)),(m(!0),U(ee,null,ce(e.additionalInputParamsMap,(d,i)=>(m(),S(I,{key:Object.keys(d)[0],"input-params-map":e.additionalInputParamsMap,index:i,"input-param":d[Object.keys(d)[0]],advanced:e.advanced},null,8,["input-params-map","index","input-param","advanced"]))),128)),n(s).isAdmin&&e.advanced?(m(),U("div",Jn,[y("div",Xn,[y("h4",{class:"text-md font-bold cursor-pointer select-none flex items-center mb-3",onClick:x[1]||(x[1]=()=>{p.value=!n(p)})},[g(F,{name:n(p)?"i-heroicons-chevron-down":"i-heroicons-chevron-up",class:"mr-2"},null,8,["name"]),g(F,{name:"i-mdi-bug-outline",class:"mr-2"}),x[4]||(x[4]=N(" Execution settings "))])]),n(p)?$("",!0):(m(),U("div",Gn,[g(_,{modelValue:f.value,"onUpdate:modelValue":x[2]||(x[2]=d=>f.value=d),label:"Enable Execution settings",class:"mb-3"},null,8,["modelValue"]),(m(!0),U(ee,null,ce(Object.keys(a.value),d=>(m(),S(c,{key:d,label:d},{default:P(()=>[d==="X-WORKER-ID"?(m(),U("div",Qn,[g(M,{modelValue:a.value[d],"onUpdate:modelValue":i=>a.value[d]=i,options:n(k),placeholder:"Select worker",class:"w-full my-3"},null,8,["modelValue","onUpdate:modelValue","options"]),g(O,{icon:"i-heroicons-x-mark",variant:"outline",size:"sm",color:"orange",class:"ml-2",onClick:()=>a.value[d]=null},null,8,["onClick"]),g(O,{icon:"i-heroicons-arrow-path-solid",variant:"outline",size:"sm",color:"blue",class:"ml-2",onClick:()=>{n(r).fetchWorkersInfo().then(()=>{a.value[d]=n(k).find(i=>{var v;return i.value===((v=a.value[d])==null?void 0:v.value)})})}},null,8,["onClick"])])):(m(),S(b,{key:1,modelValue:a.value[d],"onUpdate:modelValue":i=>a.value[d]=i,placeholder:"Enter value",class:"my-3"},null,8,["modelValue","onUpdate:modelValue"]))]),_:2},1032,["label"]))),128))]))])):$("",!0)])):$("",!0)],64)}}}),Yn={key:0,id:"prompt",class:"w-full my-10 lg:my-0 p-4 ring-1 ring-gray-200 dark:ring-gray-800 rounded-lg"},Zn={class:"action flex items-center"},el=Y({__name:"Prompt",setup(e,{expose:l}){var d,i,v,B;const t=ue(),s=et();let r=localStorage.getItem(`input_params_map_${(d=t.currentFlow)==null?void 0:d.name}`);if(r){const u=JSON.parse(r);"flow_version"in u&&u.flow_version.split(".")[0]===((i=t.currentFlow)==null?void 0:i.version.split(".")[0])?r=u:(r=null,localStorage.removeItem(`input_params_map_${(v=t.currentFlow)==null?void 0:v.name}`))}const o=C(((B=t.currentFlow)==null?void 0:B.input_params.map(u=>{var w;if(u.type==="text")return{[u.name]:{value:r!==null&&r[u.name]?r[u.name]:u.default||"",type:u.type,optional:u.optional,advanced:u.advanced||!1,default:u.default||"",translatable:u.translatable||!1}};if(u.type==="number")return{[u.name]:{value:r!==null&&r[u.name]?r[u.name]:u.default||0,type:u.type,optional:u.optional,advanced:u.advanced||!1,default:u.default||0}};if(u.type==="image")return{[u.name]:{value:null,type:u.type,optional:u.optional,advanced:u.advanced||!1}};if(u.type==="image-mask")return{[u.name]:{value:null,type:u.type,optional:u.optional,advanced:u.advanced||!1,source_input_name:u.source_input_name||null}};if(u.type==="list")return{[u.name]:{value:r!==null&&r[u.name]?r[u.name]:u.default||Object.keys(u.options)[0]||"",type:u.type,optional:u.optional,options:u.options,advanced:u.advanced||!1,default:Object.keys(u.options)[0]||""}};if(u.type==="bool")return{[u.name]:{value:r!==null&&r[u.name]?r[u.name]:u.default||!1,type:u.type,optional:u.optional,advanced:u.advanced||!1,default:u.default||!1}};if(["range","range_scale"].includes(u.type)){const R={value:r!==null&&r[u.name]?r[u.name]:u.default||0,type:u.type,optional:u.optional,advanced:u.advanced||!1,min:u.min||0,max:u.max||100,step:u.step||1,default:u.default||0};if(u.type==="range_scale"&&(R.source_input_name=u.source_input_name||null,R.source_input_name===null||R.source_input_name==="")){const z=(w=t.currentFlow)==null?void 0:w.input_params.find(E=>E.type==="image"&&!E.optional);z&&(R.source_input_name=z.name)}return{[u.name]:R}}}))||[]),a=C([]);t.currentFlow.is_seed_supported&&a.value.push({seed:{name:"seed",display_name:"Random seed",value:Math.floor(Math.random()*1e7),type:"number",optional:!0,advanced:!0,min:0,max:1e7}});const f=Ot(),p=C(t.currentFlow.is_translations_supported&&f.settingsMap.translations_provider.value.trim()!==""),k=C(p.value);Be(()=>{const u=localStorage.getItem("translatePrompt");u&&(k.value=JSON.parse(u))}),de(k,u=>{localStorage.setItem("translatePrompt",JSON.stringify(u))});function h(u){console.debug("Copy prompt inputs",u),Object.keys(u).forEach(R=>{const z=o.value.findIndex(E=>Object.keys(E)[0]===R);z!==-1&&(o.value[z][R].value=u[R].value)});const w=document.getElementById("prompt");w&&w.scrollIntoView({behavior:"smooth"})}l({copyPromptInputs:h}),o.value.forEach(u=>{const w=Object.keys(u)[0];["image","image-mask"].includes(u[w].type)||de(()=>u[w].value,()=>{var z,E;const R={};o.value.forEach(ne=>{const le=Object.keys(ne)[0];R[le]=ne[le].value}),localStorage.setItem(`input_params_map_${(z=t.currentFlow)==null?void 0:z.name}`,JSON.stringify({...R,flow_version:(E=t.currentFlow)==null?void 0:E.version}))})});const x=V(()=>o.value.filter(u=>{const w=Object.keys(u)[0];return!["image","image-mask"].includes(u[w].type)}).some(u=>{const w=Object.keys(u)[0];return u[w].value!==u[w].default}));function F(){o.value.forEach(u=>{const w=Object.keys(u)[0];u[w].type==="text"?u[w].value=u[w].default||"":u[w].type==="number"?u[w].value=u[w].default||u[w].min||0:u[w].type==="list"?u[w].value=Object.keys(u[w].options)[0]||"":u[w].type==="bool"?u[w].value=u[w].default||!1:["range","range_scale"].includes(u[w].type)&&(u[w].value=u[w].default||u[w].min||0)})}const I=C(!1),_=C(1),M=C(!1),O=V(()=>o.value.every(u=>{var z;const w=Object.keys(u)[0];if(u[w].optional)return!0;const R=u[w].value;if(u[w].type==="text")return R!=="";if(u[w].type==="number")return R>=u[w].min&&R<=u[w].max;if(u[w].type==="list")return R!==""&&Object.keys(u[w].options).includes(R);if(u[w].type==="bool")return!0;if(u[w].type==="range")return R>=u[w].min&&R<=u[w].max;if(u[w].type==="range_scale")return R>=u[w].min&&R<=u[w].max;if(u[w].type==="image")return R instanceof File&&R.size>0;if(u[w].type==="image-mask")return R instanceof File&&R.size>0&&(((z=u[w])==null?void 0:z.mask_applied)||!1)})),b=C({"X-WORKER-UNLOAD-MODELS":1,"X-WORKER-EXECUTION-PROFILER":1,"X-WORKER-ID":null}),c=C(!1);return de(()=>b.value,()=>{var u;s.isAdmin&&localStorage.setItem(`profilingOptions_${(u=t.currentFlow)==null?void 0:u.name}`,JSON.stringify(b.value))},{deep:!0}),(u,w)=>{const R=be,z=Kn,E=Ee,ne=We,le=Ae,me=te,ge=Ne;return n(t).currentFlow?(m(),U("div",Yn,[y("h2",{class:"text-lg font-bold cursor-pointer select-none flex items-center mb-3",onClick:w[0]||(w[0]=()=>{M.value=!n(M)})},[g(R,{name:n(M)?"i-heroicons-chevron-down":"i-heroicons-chevron-up",class:"mr-2"},null,8,["name"]),w[10]||(w[10]=N(" Prompt "))]),Ze(y("div",null,[g(z,{"input-params-map":n(o),"onUpdate:inputParamsMap":w[1]||(w[1]=W=>X(o)?o.value=W:null),"additional-input-params-map":n(a),"onUpdate:additionalInputParamsMap":w[2]||(w[2]=W=>X(a)?a.value=W:null),advanced:!1},null,8,["input-params-map","additional-input-params-map"]),n(a).length>0?(m(),S(z,{key:0,"input-params-map":n(o),"onUpdate:inputParamsMap":w[3]||(w[3]=W=>X(o)?o.value=W:null),"additional-input-params-map":n(a),"onUpdate:additionalInputParamsMap":w[4]||(w[4]=W=>X(a)?a.value=W:null),"profiling-options":n(b),"onUpdate:profilingOptions":w[5]||(w[5]=W=>X(b)?b.value=W:null),"profiling-enabled":n(c),"onUpdate:profilingEnabled":w[6]||(w[6]=W=>X(c)?c.value=W:null),advanced:!0},null,8,["input-params-map","additional-input-params-map","profiling-options","profiling-enabled"])):$("",!0),n(t).currentFlow.is_count_supported?(m(),S(ne,{key:1,label:"Number of results"},{default:P(()=>[g(E,{modelValue:n(_),"onUpdate:modelValue":w[7]||(w[7]=W=>X(_)?_.value=W:null),type:"number",min:"1",max:"50",label:"Batch size",class:"mb-3 max-w-fit flex justify-end"},null,8,["modelValue"])]),_:1})):$("",!0),n(p)?(m(),S(ne,{key:2,class:"my-3 flex justify-end"},{default:P(()=>[g(le,{modelValue:n(k),"onUpdate:modelValue":w[8]||(w[8]=W=>X(k)?k.value=W:null),label:"Translate prompt"},null,8,["modelValue"])]),_:1})):$("",!0),y("div",{class:Q(["flex",{"justify-between":n(x),"justify-end":!n(x)}])},[n(x)?(m(),S(ge,{key:0,text:"Reset input params values to defaults"},{default:P(()=>[g(me,{icon:"i-heroicons-arrow-path-rounded-square",variant:"ghost",color:"amber",onClick:F},{default:P(()=>w[11]||(w[11]=[N(" Reset params ")])),_:1})]),_:1})):$("",!0),y("div",Zn,[g(me,{icon:"i-heroicons-sparkles-16-solid",variant:"outline",loading:n(I),disabled:!n(O),onClick:w[9]||(w[9]=()=>{I.value=!0;let W={};n(s).isAdmin&&n(c)&&(W=Object.fromEntries(Object.entries(n(b)).filter(([A,H])=>H!==null).map(([A,H])=>A==="X-WORKER-ID"?[A,H==null?void 0:H.value]:[A,H]))),n(t).runFlow(n(t).currentFlow,[...n(o),...n(a)],n(_),n(p)&&n(k),!1,null,W).finally(()=>{I.value=!1;const A=n(a).find(H=>Object.keys(H)[0]==="seed");A.seed.value=Number(A.seed.value)+n(_)+1})})},{default:P(()=>w[12]||(w[12]=[N(" Run prompt ")])),_:1},8,["loading","disabled"])])],2)],512),[[mt,!n(M)]])])):$("",!0)}}}),tl=e=>{const l=C(0);function t(o){e.value.style.scrollSnapType="none",e.value.style.scrollBehavior="auto",l.value=o.pageX,window.addEventListener("mousemove",r),window.addEventListener("mouseup",s)}function s(){e.value.style.removeProperty("scroll-behavior"),e.value.style.removeProperty("scroll-snap-type"),e.value.style.removeProperty("pointer-events"),window.removeEventListener("mousemove",r),window.removeEventListener("mouseup",s)}function r(o){o.preventDefault(),e.value.style.pointerEvents="none";const a=o.pageX-l.value;l.value=o.pageX,e.value.scrollBy(-a,0)}_e(()=>{e.value&&e.value.addEventListener("mousedown",t)}),tt(()=>{e.value&&e.value.removeEventListener("mousedown",t)})},He=Ke(ye.ui.strategy,ye.ui.carousel,Jt),nl=Y({components:{UButton:te},inheritAttrs:!1,props:{items:{type:Array,default:()=>[]},arrows:{type:Boolean,default:!1},indicators:{type:Boolean,default:!1},dir:{type:String,default:"ltr"},prevButton:{type:Object,default:()=>He.default.prevButton},nextButton:{type:Object,default:()=>He.default.nextButton},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:void 0}},setup(e,{expose:l}){const{ui:t,attrs:s}=Qe("carousel",ze(e,"ui"),He,ze(e,"class")),r=C(),o=C(0),{x:a}=jt(r,{behavior:"smooth"}),{width:f}=Tt(r);tl(r),Bt(r,O=>{var c,d;const[b]=O;o.value=((d=(c=b==null?void 0:b.target)==null?void 0:c.firstElementChild)==null?void 0:d.clientWidth)||0});const p=V(()=>e.dir==="rtl"),k=V(()=>o.value?p.value?Math.round(-a.value/o.value)+1:Math.round(a.value/o.value)+1:0),h=V(()=>{if(!o.value)return 0;const O=Math.round(f.value/o.value);return e.items.length<=O?0:e.items.length-O+1}),x=V(()=>k.value<=1),F=V(()=>k.value===h.value);function I(){a.value+=p.value?-o.value:o.value}function _(){a.value-=p.value?-o.value:o.value}function M(O){a.value=(O-1)*o.value*(p.value?-1:1)}return l({pages:h,page:k,prev:_,next:I,select:M}),{ui:t,attrs:s,isFirst:x,isLast:F,carouselRef:r,pages:h,currentPage:k,onClickNext:I,onClickPrev:_,onClick:M,twMerge:je}}}),ll=["dir"],ol=["role"],al=["aria-selected","aria-label","onClick"];function sl(e,l,t,s,r,o){const a=te;return m(),U("div",Se({class:e.ui.wrapper},e.attrs,{dir:e.dir}),[y("div",{ref:"carouselRef",class:Q([e.ui.container,"no-scrollbar"])},[(m(!0),U(ee,null,ce(e.items,(f,p)=>(m(),U("div",{key:p,class:Q(e.ui.item),role:e.indicators?"tabpanel":null},[Re(e.$slots,"default",{item:f,index:p},void 0,!0)],10,ol))),128))],2),e.arrows?(m(),U("div",{key:0,class:Q(e.ui.arrows.wrapper)},[Re(e.$slots,"prev",{onClick:e.onClickPrev,disabled:e.isFirst},()=>{var f;return[e.prevButton?(m(),S(a,Se({key:0,disabled:e.isFirst},{...e.ui.default.prevButton,...e.prevButton},{class:e.twMerge(e.ui.default.prevButton.class,(f=e.prevButton)==null?void 0:f.class),"aria-label":"Prev",onClick:e.onClickPrev}),null,16,["disabled","class","onClick"])):$("",!0)]},!0),Re(e.$slots,"next",{onClick:e.onClickNext,disabled:e.isLast},()=>{var f;return[e.nextButton?(m(),S(a,Se({key:0,disabled:e.isLast},{...e.ui.default.nextButton,...e.nextButton},{class:e.twMerge(e.ui.default.nextButton.class,(f=e.nextButton)==null?void 0:f.class),"aria-label":"Next",onClick:e.onClickNext}),null,16,["disabled","class","onClick"])):$("",!0)]},!0)],2)):$("",!0),e.indicators?(m(),U("div",{key:1,role:"tablist",class:Q(e.ui.indicators.wrapper)},[(m(!0),U(ee,null,ce(e.pages,f=>Re(e.$slots,"indicator",{key:f,onClick:e.onClick,active:f===e.currentPage,page:f},()=>[y("button",{type:"button",role:"tab","aria-selected":f===e.currentPage,class:Q([e.ui.indicators.base,f===e.currentPage?e.ui.indicators.active:e.ui.indicators.inactive]),"aria-label":`set slide ${f}`,onClick:p=>e.onClick(f)},null,10,al)],!0)),128))],2)):$("",!0)],16,ll)}const De=Ge(nl,[["render",sl],["__scopeId","data-v-5fdb8633"]]),il={class:"flex flex-col basis-full"},rl=Y({__name:"InputFiles",props:{running:{type:Object,required:!0}},setup(e){const l=ot(),t=function(f,p){return`${ft()}/tasks/inputs?task_id=${f}&input_index=${p}`},s=C(!1),r=C(""),o=C(0),a=C(!0);return(f,p)=>{var _,M,O,b,c;const k=be,h=ke,x=De,F=te,I=$e;return e.running&&e.running.input_files&&((_=Object.keys(e.running.input_files))==null?void 0:_.length)>0?(m(),U("div",{key:0,class:Q(["ml-2 mt-2 mb-5",{"mb-10":((M=Object.keys(e.running.input_files))==null?void 0:M.length)>1&&!n(a)}])},[y("h4",{class:"mb-3 font-bold cursor-pointer select-none flex items-center text-sm",onClick:p[0]||(p[0]=()=>a.value=!n(a))},[g(k,{name:n(a)?"i-heroicons-chevron-down":"i-heroicons-chevron-up",class:"mr-2"},null,8,["name"]),y("span",null," Input files ("+D((O=Object.keys(e.running.input_files))==null?void 0:O.length)+") ",1)]),n(a)?$("",!0):(m(),U(ee,{key:0},[((b=Object.keys(e.running.input_files))==null?void 0:b.length)===1?(m(),S(h,{key:0,class:"mb-5 rounded-lg cursor-pointer",fit:"outside",loading:"lazy",placeholder:n(l)(`${("buildBackendUrl"in f?f.buildBackendUrl:n(Xe))()}/vix_logo.png`,{f:"png",blur:3,q:50}),src:t(e.running.task_id,0),onClick:p[1]||(p[1]=()=>{r.value=t(e.running.task_id,0),o.value=0,s.value=!0})},null,8,["placeholder","src"])):$("",!0),((c=Object.keys(e.running.input_files))==null?void 0:c.length)>1?(m(),S(x,{key:1,items:Object.keys(e.running.input_files).map(d=>({task_id:e.running.task_id,index:d})),ui:{item:"basis-full md:basis-1/2",indicators:{wrapper:"relative bottom-0 mt-4"}},page:1,indicators:""},{default:P(({item:d})=>[y("div",il,[g(h,{class:"rounded-lg cursor-pointer",fit:"outside",loading:"lazy",placeholder:n(l)(`${("buildBackendUrl"in f?f.buildBackendUrl:n(Xe))()}/vix_logo.png`,{f:"png",blur:3,q:50}),src:t(d.task_id,d.index),onClick:()=>{r.value=t(e.running.task_id,d.index),o.value=d.index,s.value=!0}},null,8,["placeholder","src","onClick"])])]),_:1},8,["items"])):$("",!0),g(I,{modelValue:n(s),"onUpdate:modelValue":p[4]||(p[4]=d=>X(s)?s.value=d:null),class:"z-[90]",transition:!1,fullscreen:""},{default:P(()=>[g(F,{class:"absolute top-4 right-4",icon:"i-heroicons-x-mark",variant:"ghost",onClick:p[2]||(p[2]=()=>s.value=!1)}),y("div",{class:"flex items-center justify-center w-full h-full p-4",onClick:p[3]||(p[3]=Ve(()=>s.value=!1,["left"]))},[n(r)?(m(),S(h,{key:0,class:"lg:h-full",fit:"inside",loading:"lazy",placeholder:"/vix_logo.png",src:n(r)},null,8,["src"])):$("",!0)])]),_:1},8,["modelValue"])],64))],2)):$("",!0)}}}),ul=Y({__name:"ErrorAlert",props:{running:{type:Object,required:!0}},setup(e){const l=ue(),t=C(!1);return(s,r)=>{const o=wt;return m(),S(o,{class:"mb-5",icon:"i-heroicons-exclamation-circle-16-solid",color:"red",variant:"soft",title:"Task failed",description:e.running.error,actions:[{variant:"outline",color:"yellow",label:"Restart",loading:n(t),icon:"i-heroicons-arrow-path",click:()=>{t.value=!0,n(l).restartFlow(e.running).finally(()=>{t.value=!1})}}]},null,8,["description","actions"])}}}),dl={class:"mb-5"},cl={class:"text-sm mb-5 text-slate-500"},ml={class:"flex justify-between"},fl=Y({__name:"Item",props:{running:{type:Object,required:!0}},setup(e){const l=ue(),t=C(!1),s=C(!1);function r(o){return[[{label:"Comfy flow",labelClass:"text-blue-500",icon:"i-heroicons-arrow-down-tray",iconClass:"bg-blue-500",click:()=>{var a;return l.downloadFlowComfy((a=l.currentFlow)==null?void 0:a.name,o.task_id)}}],[{label:`Raise priority ${o.priority>0?`(${o.priority})`:""}`,labelClass:"text-gray-500",icon:"i-heroicons-arrow-up",iconClass:"bg-gray-500",disabled:o.priority===15||o.progress>0,click:()=>{s.value=!0,l.raiseQueuePriority(o).finally(()=>{s.value=!1})}},{label:`Lower priority ${o.priority>0?`(${o.priority})`:""}`,labelClass:"text-gray-500",icon:"i-heroicons-arrow-down",iconClass:"bg-gray-500",disabled:o.priority===0||o.progress>0,click:()=>{s.value=!0,l.lowerQueuePriority(o).finally(()=>{s.value=!1})}},{label:`Reset priority ${o.priority>0?`(${o.priority})`:""}`,labelClass:"text-gray-500",icon:"i-heroicons-arrow-path-rounded-square-solid",iconClass:"bg-gray-500",disabled:o.priority===0||o.progress>0,click:()=>{s.value=!0,l.resetQueuePriority(o).finally(()=>{s.value=!1})}}]]}return(o,a)=>{var F,I;const f=ht,p=rl,k=ul,h=te,x=qe;return m(),U("div",dl,[g(f,{class:"mb-3",value:(F=e.running)==null?void 0:F.progress,indicator:"",color:e.running.error?"red":"green"},null,8,["value","color"]),y("p",cl,D([`${(I=e.running)!=null&&I.priority&&e.running.priority>0?"["+e.running.priority+"] ":""}#${e.running.task_id}`,...Object.keys(e.running.input_params_mapped).filter(_=>e.running.input_params_mapped[_].value&&e.running.input_params_mapped[_].value!=="").map(_=>`${e.running.input_params_mapped[_].display_name}: ${e.running.input_params_mapped[_].value}`)].join(" | ")+`${e.running.execution_time?" | execution_time: "+e.running.execution_time.toFixed(2)+"s":""}`),1),g(p,{running:e.running},null,8,["running"]),e.running.error?(m(),S(k,{key:0,running:e.running},null,8,["running"])):$("",!0),y("div",ml,[g(h,{icon:e.running.progress>=0&&e.running.progress<100?"i-heroicons-stop":"i-heroicons-minus-circle",color:e.running.error?"red":"orange",variant:"outline",loading:n(t),onClick:a[0]||(a[0]=()=>{t.value=!0,n(l).cancelRunningFlow(e.running).finally(()=>{t.value=!1})})},{default:P(()=>[N(D(e.running.progress>=0&&e.running.progress<100?"Cancel":"Remove"),1)]),_:1},8,["icon","color","loading"]),g(x,{items:r(e.running),mode:"click",popper:{placement:"bottom-end"}},{default:P(()=>[g(h,{color:"blue",variant:"outline",icon:"i-heroicons-ellipsis-vertical-16-solid"})]),_:1},8,["items"])])])}}}),pl={class:"w-full p-4 ring-1 ring-gray-200 dark:ring-gray-800 rounded-lg shadow-md mt-5 mb-10"},gl={class:"flex items-center justify-between mb-2"},vl={key:0},hl={key:1,class:"text-red-400"},wl=Y({__name:"Queue",setup(e){const l=ue(),t=C(!0),s=C(!1);return(r,o)=>{var k,h,x,F,I,_,M,O,b;const a=be,f=te,p=fl;return m(),U("div",pl,[y("div",gl,[y("h2",{class:"text-lg font-bold cursor-pointer select-none flex items-center",onClick:o[0]||(o[0]=()=>{t.value=!n(t)})},[g(a,{name:n(t)?"i-heroicons-chevron-down":"i-heroicons-chevron-up",class:"mr-2"},null,8,["name"]),y("span",null," Queue ("+D(n(l).flowsRunningByName((k=n(l).currentFlow)==null?void 0:k.name).length)+") ",1),n(l).flowsRunningByName((h=n(l).currentFlow)==null?void 0:h.name).length>0?(m(),U("span",vl," - "+D(`${((F=n(l).flowsRunningByName((x=n(l).currentFlow)==null?void 0:x.name).filter(c=>c.progress>0)[0])==null?void 0:F.progress.toFixed(0))??0}%`),1)):$("",!0),n(l).flowsRunningByNameWithErrors((I=n(l))==null?void 0:I.currentFlow.name).length>0?(m(),U("span",hl," ("+D(n(l).flowsRunningByNameWithErrors((_=n(l).currentFlow)==null?void 0:_.name).length)+") ",1)):$("",!0)]),(M=n(l).currentFlow)!=null&&M.name&&n(l).flowsRunningByName((O=n(l).currentFlow)==null?void 0:O.name).length>0?(m(),S(f,{key:0,icon:"i-heroicons-stop",color:"orange",variant:"outline",loading:n(s),onClick:o[1]||(o[1]=()=>{var c;s.value=!0,n(l).cancelRunningFlows((c=n(l).currentFlow)==null?void 0:c.name).finally(()=>{s.value=!1})})},{default:P(()=>o[2]||(o[2]=[N(" Cancel all ")])),_:1},8,["loading"])):$("",!0)]),n(t)?$("",!0):(m(!0),U(ee,{key:0},ce(n(l).flowsRunningByName((b=n(l).currentFlow)==null?void 0:b.name),c=>(m(),S(p,{key:c.task_id,running:c},null,8,["running"]))),128))])}}}),yl=Y({__name:"ScrollToTop",props:{show:{type:Boolean,required:!0},target:{type:String,required:!0}},setup(e){const l=e;function t(){const s=document.getElementById(l.target);s&&s.scrollIntoView({behavior:"smooth"})}return(s,r)=>{const o=te;return e.show?(m(),S(o,{key:0,icon:"i-heroicons-arrow-small-up",color:"black",variant:"outline",onClick:t})):$("",!0)}}});function Oe(e={}){const{copy:l,isSupported:t}=Vt(),s=Me();function r(o,a={},f={}){t&&l(o).then(()=>{!a.title&&!a.description||s.add({...a,...e})},function(p){s.add({...f,description:f.description||p.message,...e})})}return{copy:r}}const bl={class:"flex flex-col items-center mb-2 max-w-fit mx-auto z-0"},kl={class:"text-slate-500 text-center text-sm w-full mx-auto flex flex-wrap items-center justify-center md:justify-between"},xl={class:"toggles py-2"},_l={class:"mr-2 inline-flex items-center text-sm"},$l=["for"],Cl={class:"mr-2 inline-flex items-center text-sm"},Il=["for"],Sl={key:0,class:"flex items-center"},Ml=["title"],Rl=Y({__name:"Child",props:{flowResult:{type:Object,required:!0},outputsIndex:{type:Number,required:!1,default:()=>0},openImageModal:{type:Function,required:!0}},setup(e){const l=e,t=ue(),s=(c,d=null,i=!1)=>{if(c.child_tasks.length===0)return c;const v=c.child_tasks.findIndex(B=>B.parent_task_node_id===d);return v!==-1?(i||(o.value=c),s(c.child_tasks[v],c.child_tasks[v].outputs[0].comfy_node_id,i)):c};function r(c,d,i=null){if(i!==null&&c.parent_task_node_id===i||Number(c.task_id)===d)return c;for(let v=0;v<c.child_tasks.length;v++)for(let B=0;B<c.child_tasks[v].outputs.length;B++){const u=r(c.child_tasks[v],d,c.child_tasks[v].outputs[B].comfy_node_id);if(u!==null)return u}return null}const o=C(l.flowResult),a=C(s(l.flowResult,l.flowResult.outputs[l.outputsIndex].comfy_node_id,!1));function f(c){var d;return[[{label:`${(d=t.flowByName((c==null?void 0:c.flow_name)??(c==null?void 0:c.name)))==null?void 0:d.display_name}#${c.task_id}`,disabled:!0}],[{label:"View image",icon:"i-heroicons-eye",click:()=>{l.openImageModal(ae({task_id:c.task_id,node_id:c.outputs.length>1?c.outputs[l.outputsIndex].comfy_node_id:c.outputs[0].comfy_node_id}))}}]]}function p(c){var i;const d=[[{label:`${(i=t.flowByName((c==null?void 0:c.flow_name)??(c==null?void 0:c.name)))==null?void 0:i.display_name}#${c.task_id}`,disabled:!0}],[{label:"View image",icon:"i-heroicons-eye",disabled:c.progress<100||c.error!=="",click:()=>{l.openImageModal(ae({task_id:c.task_id,node_id:c.outputs.length>1?c.outputs[l.outputsIndex].comfy_node_id:c.outputs[0].comfy_node_id}))}},{label:c.progress<100?"Cancel":"Delete",labelClass:c.progress<100?"text-orange-500":"text-red-500",icon:c.progress<100?"i-heroicons-stop":"i-heroicons-trash",iconClass:c.progress<100?"bg-orange-500":"bg-red-500",click:()=>{t.deleteFlowHistory(c.task_id).then(()=>{const v=r(l.flowResult,c.parent_task_id,c.parent_task_node_id);v&&(v.child_tasks=v.child_tasks.filter(B=>Number(B.task_id)!==Number(c.task_id))),_(!1,l.flowResult)})}}]];return c.progress<100&&(d[0][1]={label:`Progress: ${Math.ceil(c.progress)}% (${c.execution_time.toFixed(2)}s)`,labelClass:"text-blue-500",disabled:!0}),c.error!==""&&d[0].push({label:`Error: ${c.error}`,labelClass:"text-red-500",slot:"error",click:()=>{Oe().copy(c.error),Me().add({title:"Clipboard",description:`Task #${c.task_id} error copied to clipboard`,timeout:2e3})}}),d}function k(){const c=o.value.parent_task_id;if(!c)return;const d=r(l.flowResult,c,o.value.parent_task_node_id);d&&(o.value=d)}function h(){if(o.value.child_tasks.length===0)return;const c=o.value.outputs.length>1?o.value.outputs[l.outputsIndex].comfy_node_id:o.value.outputs[0].comfy_node_id,d=o.value.child_tasks.find(i=>i.parent_task_node_id===c);d&&(o.value=d)}const x=V(()=>{if(o.value.child_tasks.length===0)return;const c=o.value.outputs.length>1?o.value.outputs[l.outputsIndex].comfy_node_id:o.value.outputs[0].comfy_node_id;return o.value.child_tasks.find(i=>i.parent_task_node_id===c).task_id!==a.value.task_id});function F(){const c=a.value.parent_task_id;if(!c)return;const d=r(l.flowResult,c,a.value.parent_task_node_id);d&&(a.value=d)}function I(){if(a.value.child_tasks.length===0)return;const c=Number(a.value.outputs[0].comfy_node_id),d=a.value.child_tasks.find(i=>Number(i.parent_task_node_id)===c);d&&(a.value=d)}function _(c=!1,d=null){c||(o.value=d),a.value=s(d,d==null?void 0:d.outputs[l.outputsIndex].comfy_node_id,c),M.value=!1}de(l.flowResult,c=>{_(!0,c)});const M=C(!1),O=C(!0),b=C(null);return de(M,c=>{c?(b.value=o.value,o.value=l.flowResult):b.value&&(o.value=b.value,a.value=pt(b.value,l.outputsIndex,o.value.outputs.length>1?o.value.outputs[l.outputsIndex].comfy_node_id:o.value.outputs[0].comfy_node_id))}),(c,d)=>{const i=ke,v=Pe("ImgComparisonSlider"),B=Lt,u=te,w=qe,R=be,z=Ne;return m(),U("div",bl,[Ze(g(i,{class:"mb-2 rounded-lg cursor-pointer",height:n(t).outputMaxSize,width:n(t).outputMaxSize,draggable:"false",fit:"cover",loading:"lazy",src:("outputResultSrc"in c?c.outputResultSrc:n(ae))({task_id:n(a).progress===100?n(a).task_id:e.flowResult.task_id,node_id:n(a).progress===100?n(a).outputs[0].comfy_node_id:e.flowResult.outputs[e.outputsIndex].comfy_node_id}),onClick:d[0]||(d[0]=E=>e.openImageModal(("outputResultSrc"in c?c.outputResultSrc:n(ae))({task_id:n(a).task_id??e.flowResult.task_id,node_id:n(a).outputs[0].comfy_node_id??e.flowResult.outputs[e.outputsIndex].comfy_node_id})))},null,8,["height","width","src"]),[[mt,!n(O)]]),n(O)?(m(),S(v,{key:0,class:"mb-2 mx-auto outline-none w-fit rounded-lg"},{default:P(()=>{var E,ne,le;return[g(i,{slot:"first",height:n(t).outputMaxSize,width:n(t).outputMaxSize,fit:"cover",draggable:"false",src:("outputResultSrc"in c?c.outputResultSrc:n(ae))({task_id:n(M)?e.flowResult.task_id:n(o).task_id,node_id:n(M)?e.flowResult.outputs[e.outputsIndex].comfy_node_id:n(o).parent_task_node_id!==null?(E=n(o))==null?void 0:E.outputs[0].comfy_node_id:((ne=n(o))==null?void 0:ne.outputs[e.outputsIndex].comfy_node_id)??((le=n(o))==null?void 0:le.outputs[0].comfy_node_id)})},null,8,["height","width","src"]),n(a)&&n(a).progress===100?(m(),S(i,{key:0,slot:"second",height:n(t).outputMaxSize,width:n(t).outputMaxSize,fit:"cover",draggable:"false",src:("outputResultSrc"in c?c.outputResultSrc:n(ae))({task_id:n(a).task_id,node_id:n(a).outputs[0].comfy_node_id})},null,8,["height","width","src"])):(m(),S(i,{key:1,slot:"second",height:n(t).outputMaxSize,width:n(t).outputMaxSize,fit:"cover",draggable:"false",src:`${("buildBackendUrl"in c?c.buildBackendUrl:n(Xe))()}/vix_logo.png`},null,8,["height","width","src"]))]}),_:1})):$("",!0),y("div",kl,[y("div",xl,[y("div",_l,[g(B,{id:`toggle-compare-${e.flowResult.task_id}-${e.outputsIndex}`,modelValue:n(O),"onUpdate:modelValue":d[1]||(d[1]=E=>X(O)?O.value=E:null),size:"xs",class:"mr-2"},null,8,["id","modelValue"]),y("label",{class:"cursor-pointer select-none",for:`toggle-compare-${e.flowResult.task_id}-${e.outputsIndex}`}," Comparison ",8,$l)]),y("div",Cl,[g(B,{id:`toggle-original-${e.flowResult.task_id}-${e.outputsIndex}`,modelValue:n(M),"onUpdate:modelValue":d[2]||(d[2]=E=>X(M)?M.value=E:null),disabled:!n(O),size:"xs",class:"mr-2"},null,8,["id","modelValue","disabled"]),y("label",{class:"cursor-pointer select-none",for:`toggle-original-${e.flowResult.task_id}-${e.outputsIndex}`}," Original ",8,Il)])]),n(O)?(m(),U("div",Sl,[g(u,{icon:"i-heroicons-arrow-small-left-20-solid",size:"2xs",variant:"soft",color:"cyan",disabled:n(M)||n(o).parent_task_id===null,onClick:k},null,8,["disabled"]),g(w,{items:f(n(o)),mode:"click",popper:{placement:"top"}},{default:P(()=>[g(u,{variant:"link",color:"white",size:"xs"},{default:P(()=>[N(" #"+D(n(M)?e.flowResult.task_id:n(o).task_id),1)]),_:1})]),_:1},8,["items"]),g(u,{icon:"i-heroicons-arrow-small-right-20-solid",size:"2xs",variant:"soft",color:"cyan",disabled:n(M)||!n(x),onClick:h},null,8,["disabled"]),g(R,{class:"mx-3",name:"i-heroicons-arrows-right-left-16-solid"}),g(u,{icon:"i-heroicons-arrow-small-left-20-solid",size:"2xs",variant:"soft",color:"cyan",disabled:!r(l.flowResult,n(a).parent_task_id,n(a).parent_task_node_id)||n(a).parent_task_id===Number(n(o).task_id)||n(a).parent_task_id===null,onClick:F},null,8,["disabled"]),g(w,{items:p(n(a)),mode:"click",popper:{placement:"top"}},{error:P(({item:E})=>[y("div",{class:"text-red-500 truncate",title:E.label},D(E.label),9,Ml)]),default:P(()=>[g(u,{class:Q({"text-blue-500":n(a).progress!==100&&n(a).error==="","text-red-500":n(a).error!==""}),variant:"link",color:"white",size:"xs"},{default:P(()=>[N(D(n(a).progress===100?"#"+n(a).task_id:Math.ceil(n(a).progress)+"%"),1)]),_:1},8,["class"])]),_:1},8,["items"]),g(u,{icon:"i-heroicons-arrow-small-right-20-solid",size:"2xs",variant:"soft",color:"cyan",disabled:n(a).child_tasks.length===0,onClick:I},null,8,["disabled"]),g(z,{class:"ml-3",text:"Reset comparison",popper:{placement:"top"}},{default:P(()=>[g(u,{icon:"i-heroicons-arrow-path-rounded-square-solid",size:"2xs",variant:"outline",color:"white",onClick:d[3]||(d[3]=()=>_(!1,e.flowResult))})]),_:1})])):$("",!0)])])}}}),Pl={class:"image-output"},zl={class:"flex flex-col basis-full justify-between mx-2"},Fl=Y({__name:"Image",props:{flowResult:{type:Object,required:!0},handleSendToFlow:{type:Function,required:!0},openImageModal:{type:Function,required:!0}},setup(e){const l=ue();return(t,s)=>{var p,k;const r=Rl,o=ke,a=te,f=De;return m(),U("div",Pl,[e.flowResult.outputs.length===1?(m(),U(ee,{key:0},[(p=e.flowResult)!=null&&p.child_tasks&&((k=e.flowResult)==null?void 0:k.child_tasks.length)>0?(m(),S(r,{key:0,"flow-result":e.flowResult,"open-image-modal":e.openImageModal},null,8,["flow-result","open-image-modal"])):e.flowResult.outputs.length===1?(m(),S(o,{key:1,class:"mb-2 mx-auto rounded-lg cursor-pointer",height:n(l).$state.outputMaxSize,width:n(l).$state.outputMaxSize,draggable:"false",fit:"cover",loading:"lazy",src:("outputResultSrc"in t?t.outputResultSrc:n(ae))({task_id:e.flowResult.task_id,node_id:e.flowResult.outputs[0].comfy_node_id}),onClick:s[0]||(s[0]=h=>e.openImageModal(("outputResultSrc"in t?t.outputResultSrc:n(ae))({task_id:e.flowResult.task_id,node_id:e.flowResult.outputs[0].comfy_node_id})))},null,8,["height","width","src"])):$("",!0)],64)):e.flowResult.outputs.length>1?(m(),S(f,{key:1,class:"mb-3 rounded-lg overflow-hidden",items:e.flowResult.outputs.map((h,x)=>({task_id:e.flowResult.task_id,node_id:h.comfy_node_id,index:x})),ui:{item:"basis-full md:basis-1/2",indicators:{wrapper:"relative bottom-0 mt-4 md:hidden"}},page:1,indicators:""},{default:P(({item:h})=>{var x;return[y("div",zl,[(x=e.flowResult)!=null&&x.child_tasks&&("hasChildTaskByParentTaskNodeId"in t?t.hasChildTaskByParentTaskNodeId:n(gt))(e.flowResult,h.index,h.node_id)?(m(),S(r,{key:0,"flow-result":e.flowResult,"outputs-index":h.index,"open-image-modal":e.openImageModal},null,8,["flow-result","outputs-index","open-image-modal"])):(m(),S(o,{key:1,class:Q(`mb-2 h-100 max-h-[${n(l).$state.outputMaxSize}px] mx-auto rounded-lg cursor-pointer`),draggable:"false",height:n(l).$state.outputMaxSize,width:n(l).$state.outputMaxSize,fit:"cover",loading:"lazy",src:("outputResultSrc"in t?t.outputResultSrc:n(ae))(h),onClick:F=>e.openImageModal(("outputResultSrc"in t?t.outputResultSrc:n(ae))(h))},null,8,["class","height","width","src","onClick"])),g(a,{class:"mt-2 w-fit mx-auto",icon:"i-heroicons-arrow-uturn-up-solid",color:"violet",size:"xs",variant:"outline",onClick:()=>{e.handleSendToFlow(e.flowResult,h.index)}},{default:P(()=>s[1]||(s[1]=[N(" Send to flow ")])),_:2},1032,["onClick"])])]}),_:1},8,["items"])):$("",!0)])}}}),Ul={class:"image-output"},Ol=["width","height"],jl=["src"],Tl={class:"flex flex-col basis-full justify-between mx-2"},Bl=["width","height"],Vl=["src"],Nl=Y({__name:"Video",props:{flowResult:{type:Object,required:!0},handleSendToFlow:{type:Function,required:!0},openImageModal:{type:Function,required:!0}},setup(e){const l=ue();return(t,s)=>{const r=te,o=De;return m(),U("div",Ul,[e.flowResult.outputs.length===1?(m(),U("video",{key:0,controls:"",class:"mb-2 mx-auto rounded-lg",style:{"max-height":"80vh"},width:n(l).$state.outputMaxSize,height:n(l).$state.outputMaxSize},[y("source",{src:("outputResultSrc"in t?t.outputResultSrc:n(ae))({task_id:e.flowResult.task_id,node_id:e.flowResult.outputs[0].comfy_node_id})},null,8,jl)],8,Ol)):e.flowResult.outputs.length>1?(m(),S(o,{key:1,class:"mb-3 rounded-lg overflow-hidden",items:e.flowResult.outputs.map((a,f)=>({task_id:e.flowResult.task_id,node_id:a.comfy_node_id,index:f})),ui:{item:"basis-full md:basis-1/2",indicators:{wrapper:"relative bottom-0 mt-4 md:hidden"}},page:1,indicators:""},{default:P(({item:a})=>[y("div",Tl,[y("video",{controls:"",class:"mb-2 mx-auto rounded-lg",width:n(l).$state.outputMaxSize,height:n(l).$state.outputMaxSize},[y("source",{src:("outputResultSrc"in t?t.outputResultSrc:n(ae))({task_id:e.flowResult.task_id,node_id:e.flowResult.outputs[0].comfy_node_id})},null,8,Vl)],8,Bl),g(r,{class:"mt-2 w-fit mx-auto",icon:"i-heroicons-arrow-uturn-up-solid",color:"violet",size:"xs",variant:"outline",onClick:()=>{e.handleSendToFlow(e.flowResult,a.index)}},{default:P(()=>s[0]||(s[0]=[N(" Send to flow ")])),_:2},1032,["onClick"])])]),_:1},8,["items"])):$("",!0)])}}}),ql={class:"w-full h-full p-4"},El={class:"mt-2 flex items-center"},Wl={class:"mt-4 max-h-96 overflow-y-auto text-sm whitespace-pre-wrap"},Al={class:"mt-2 flex items-center"},Dl={class:"mt-4 max-h-96 overflow-y-auto text-sm whitespace-pre-wrap"},Ll=Y({__name:"Params",props:{flowResult:{type:Object,required:!0}},setup(e){const l=e,t=C(!1),s=V(()=>["#"+l.flowResult.task_id,...Object.keys(l.flowResult.input_params_mapped).filter(a=>l.flowResult.input_params_mapped[a].value&&l.flowResult.input_params_mapped[a].value!=="").map(a=>t.value&&l.flowResult.translated_input_params_mapped&&l.flowResult.translated_input_params_mapped[a]?`${l.flowResult.input_params_mapped[a].display_name}: ${l.flowResult.translated_input_params_mapped[a].value}`:`${l.flowResult.input_params_mapped[a].display_name}: ${l.flowResult.input_params_mapped[a].value}`)].join(" | ")+`${l.flowResult.execution_time?" | execution_time: "+l.flowResult.execution_time.toFixed(2)+"s":""}`);tt(()=>{l.flowResult.showInputFiles=!1});const r=V(()=>l.flowResult.execution_details&&l.flowResult.extra_flags!==null),o=C(!1);return(a,f)=>{const p=te,k=$e,h=Ne,x=nt,F=be;return m(),U(ee,null,[n(r)?(m(),S(h,{key:0,text:"Show profiling details",popper:{placement:"top"}},{default:P(()=>[g(p,{class:"mb-2 mr-2",color:"orange",size:"xs",variant:"outline",icon:"i-mdi-bug",onClick:f[0]||(f[0]=()=>{o.value=!0})}),g(k,{modelValue:n(o),"onUpdate:modelValue":f[4]||(f[4]=I=>X(o)?o.value=I:null)},{default:P(()=>[g(p,{class:"absolute top-4 right-4",icon:"i-heroicons-x-mark",variant:"ghost",onClick:f[1]||(f[1]=()=>o.value=!1)}),y("div",ql,[f[9]||(f[9]=y("h3",{class:"text-center font-bold"}," Profiling details ",-1)),y("h4",El,[f[7]||(f[7]=N(" Extra flags ")),g(p,{class:"ml-2",icon:"i-mdi-content-copy",variant:"outline",size:"xs",color:"gray",onClick:f[2]||(f[2]=()=>{("useCopyToClipboard"in a?a.useCopyToClipboard:n(Oe))().copy(JSON.stringify(l.flowResult.extra_flags,null,"	")),("useToast"in a?a.useToast:n(Me))().add({title:"Clipboard",description:"Extra flags copied to clipboard",timeout:2e3})})})]),y("div",Wl,D(JSON.stringify(l.flowResult.extra_flags,null,"	")),1),y("h4",Al,[f[8]||(f[8]=N(" Execution details ")),g(p,{class:"ml-2",icon:"i-mdi-content-copy",variant:"outline",size:"xs",color:"gray",onClick:f[3]||(f[3]=()=>{("useCopyToClipboard"in a?a.useCopyToClipboard:n(Oe))().copy(JSON.stringify(l.flowResult.execution_details,null,"	")),("useToast"in a?a.useToast:n(Me))().add({title:"Clipboard",description:"Execution details copied to clipboard",timeout:2e3})})})]),y("div",Dl,D(JSON.stringify(l.flowResult.execution_details,null,"	")),1)])]),_:1},8,["modelValue"])]),_:1})):$("",!0),e.flowResult.translated_input_params_mapped&&Object.keys(e.flowResult.translated_input_params_mapped).length>0?(m(),S(h,{key:1,text:n(t)?"Hide translated input params":"Show translated input params",popper:{placement:"top"}},{default:P(()=>[g(p,{class:"mb-2 mr-2",color:"white",size:"xs",variant:"outline",icon:"i-heroicons-language-solid",onClick:f[5]||(f[5]=()=>{t.value=!n(t)})})]),_:1},8,["text"])):$("",!0),(m(!0),U(ee,null,ce(n(s).split("|"),I=>(m(),S(x,{key:I,class:"mr-2 mb-2 last:mr-0 hover:cursor-pointer",variant:"soft",color:"gray",onClick:()=>{("useCopyToClipboard"in a?a.useCopyToClipboard:n(Oe))().copy(I.split(":")[1].trim()),("useToast"in a?a.useToast:n(Me))().add({title:"Clipboard",description:`${I.split(":")[0].trim()} copied to clipboard`,timeout:2e3})}},{default:P(()=>[N(D(I),1)]),_:2},1032,["onClick"]))),128)),e.flowResult.input_files.length>0?(m(),S(x,{key:2,class:"mr-2 mb-2 last:mr-0 hover:cursor-pointer select-none",variant:"subtle",color:"sky",onClick:f[6]||(f[6]=()=>{e.flowResult.showInputFiles=!e.flowResult.showInputFiles})},{default:P(()=>[g(F,{name:e.flowResult.showInputFiles?"i-heroicons-chevron-down":"i-heroicons-chevron-up",class:"mr-1"},null,8,["name"]),g(F,{name:"i-heroicons-document-solid",class:"mr-1"}),N(" "+D(`input_files: ${e.flowResult.input_files.length}`),1)]),_:1})):$("",!0)],64)}}}),Hl={key:0,class:Q("w-full p-1")},Jl={class:"flex flex-col basis-full justify-between mx-2"},Xl=Y({__name:"InputFiles",props:{flowResult:{type:Object,required:!0}},setup(e){const l=ue(),t=(a,f)=>`${ft()}/tasks/inputs?task_id=${a}&input_index=${f}`,s=C(!1),r=C(""),o=C(0);return(a,f)=>{var F,I;const p=ke,k=De,h=te,x=$e;return e.flowResult.showInputFiles?(m(),U("div",Hl,[((F=Object.keys(e.flowResult.input_files))==null?void 0:F.length)===1?(m(),S(p,{key:0,class:Q(`mb-5 mx-auto rounded-lg cursor-pointer max-h-[${n(l).$state.outputMaxSize}px] w-auto`),fit:"outside",loading:"lazy",src:t(e.flowResult.task_id,0),onClick:f[0]||(f[0]=()=>{r.value=t(e.flowResult.task_id,0),o.value=0,s.value=!0})},null,8,["class","src"])):$("",!0),((I=Object.keys(e.flowResult.input_files))==null?void 0:I.length)>1?(m(),S(k,{key:1,items:Object.keys(e.flowResult.input_files).map(_=>({task_id:e.flowResult.task_id,index:_})),ui:{item:"basis-full md:basis-1/2",indicators:{wrapper:"relative bottom-0 my-2"}},page:1,indicators:""},{default:P(({item:_})=>[y("div",Jl,[g(p,{class:Q(`mb-5 mx-auto rounded-lg cursor-pointer max-h-[${n(l).$state.outputMaxSize}px] w-auto`),fit:"outside",loading:"lazy",draggable:"false",src:t(_.task_id,_.index),onClick:()=>{r.value=t(e.flowResult.task_id,_.index),o.value=_.index,s.value=!0}},null,8,["class","src","onClick"])])]),_:1},8,["items"])):$("",!0),g(x,{modelValue:n(s),"onUpdate:modelValue":f[3]||(f[3]=_=>X(s)?s.value=_:null),class:"z-[90]",transition:!1,fullscreen:""},{default:P(()=>[g(h,{class:"absolute top-4 right-4",icon:"i-heroicons-x-mark",variant:"ghost",onClick:f[1]||(f[1]=()=>s.value=!1)}),y("div",{class:"flex items-center justify-center w-full h-full p-4",onClick:f[2]||(f[2]=Ve(()=>s.value=!1,["left"]))},[n(r)?(m(),S(p,{key:0,class:"lg:h-full",fit:"inside",loading:"lazy",placeholder:"/vix_logo.png",src:n(r)},null,8,["src"])):$("",!0)])]),_:1},8,["modelValue"])])):$("",!0)}}}),Gl={class:"p-4"},Ql={class:"flex justify-center mb-4"},Kl={key:0,class:"text-sm text-slate-500 text-center mb-4"},Yl={class:"text-md text-center text-red-500 mb-4"},Zl={key:1},eo={class:"flex items-center justify-between"},to=Y({__name:"SendToFlowModal",props:Te({flowResult:{type:Object,required:!1,default:()=>null},outputImgSrc:{type:String,required:!0},outputParamIndex:{type:Number,required:!0},inputParamsMapped:{type:Object,required:!0},isChildTask:{type:Boolean,required:!1,default:!1},translatePrompt:{type:Boolean,required:!1,default:!1}},{show:{default:!1,type:Boolean},showModifiers:{}}),emits:Te(["update:show"],["update:show"]),setup(e,{emit:l}){const t=e,s=Fe(e,"show"),r=ue(),o=V(()=>r.sub_flows.map(F=>({value:F.name,label:`${F.display_name} - ${F.description}`}))),a=C(o.value[0]||""),f=C(!1),p=l;function k(){console.debug("[Send to flow]: ",a.value);const F=r.sub_flows.find(_=>_.name===a.value.value&&_.display_name===a.value.label.split(" - ")[0]);if(console.debug("[Send to flow]: targetFlow",F),!F){Me().add({title:`Target sub-flow "${a.value.value}" not found`,description:"Please, verify the target sub-flow is installed and available and try again",timeout:5e3});return}const I=F.input_params.reduce((_,M)=>{const O={};return M.type==="text"?O[M.name]={value:M.default||"",type:M.type}:M.type==="number"?O[M.name]={value:M.default||0,type:M.type}:M.type==="image"?O[M.name]={value:JSON.stringify({task_id:t.flowResult.task_id,node_id:t.flowResult.outputs.length>1?t.flowResult.outputs[t.outputParamIndex].comfy_node_id:t.flowResult.outputs[0].comfy_node_id})||"",type:M.type}:M.type==="list"?O[M.name]={value:M.default||Object.keys(M.options)[0]||"",type:M.type,options:M.options}:M.type==="bool"?O[M.name]={value:M.default||!1,type:M.type}:["range","range_scale"].includes(M.type)&&(O[M.name]={value:M.default||0,type:M.type}),_.push(O),_},[]);console.debug("[Send to flow]: input_params_map",I),f.value=!0,r.runFlow(F,I,1,t.translatePrompt,h.value,h.value?Number(t.flowResult.task_id):null).finally(()=>{f.value=!1,p("update:show",!1)})}const h=C(!1),x=V(()=>{var F;return t.flowResult.progress===100&&((F=t.flowResult)==null?void 0:F.error)===""});return Be(()=>{var I,_;const F=t.flowResult?((_=(I=t==null?void 0:t.flowResult)==null?void 0:I.outputs[t.outputParamIndex])==null?void 0:_.type)??"image":"image";r.fetchSubFlows(F).then(()=>{a.value=o.value[0]||""}),h.value=!1}),(F,I)=>{const _=ke,M=wt,O=lt,b=Ae,c=te,d=$e;return m(),S(d,{modelValue:s.value,"onUpdate:modelValue":I[2]||(I[2]=i=>s.value=i),class:"z-[90]",transition:!1},{default:P(()=>[y("div",Gl,[I[4]||(I[4]=y("h2",{class:"text-lg text-center mb-4"},"Send to flow",-1)),y("div",Ql,[n(x)?(m(),S(_,{key:0,src:e.outputImgSrc,class:"w-1/2 rounded-lg",draggable:!1},null,8,["src"])):(m(),S(M,{key:1,color:"orange",icon:"i-heroicons-exclamation-circle-solid",title:`Task is still running (${Math.ceil(e.flowResult.progress)}%, ${e.flowResult.execution_time.toFixed(2)}s)`,description:e.flowResult.error!==""?e.flowResult.error:""},null,8,["title","description"]))]),e.inputParamsMapped?(m(),U("p",Kl,D(["#"+e.flowResult.task_id,...Object.keys(e.inputParamsMapped).filter(i=>e.inputParamsMapped[i].value!=="").map(i=>`${e.inputParamsMapped[i].display_name}: ${e.inputParamsMapped[i].value}`)].join(" | ")),1)):$("",!0),y("p",Yl,[n(o).length>0?(m(),S(O,{key:0,modelValue:n(a),"onUpdate:modelValue":I[0]||(I[0]=i=>X(a)?a.value=i:null),class:"w-full",size:"lg",options:n(o)},null,8,["modelValue","options"])):(m(),U("span",Zl,"No sub-flows available"))]),e.isChildTask?(m(),S(M,{key:1,class:"mb-4",icon:"i-heroicons-exclamation-circle-solid",title:"Child task",description:"The latest child task is always used as input for sub-flow"})):$("",!0),y("div",eo,[g(b,{modelValue:n(h),"onUpdate:modelValue":I[1]||(I[1]=i=>X(h)?h.value=i:null),label:"Bind as child task"},null,8,["modelValue"]),g(c,{icon:"i-heroicons-arrow-uturn-up-solid",color:"violet",variant:"outline",loading:n(f),disabled:n(o).length===0||e.isChildTask&&!n(x),onClick:k},{default:P(()=>I[3]||(I[3]=[N(" Send ")])),_:1},8,["loading","disabled"])])])]),_:1},8,["modelValue"])}}}),no={class:"flex flex-col md:flex-row items-center justify-center mb-5 sticky top-1 z-[10]"},lo={class:"flex items-center justify-center"},oo={class:"p-4"},ao={class:"text-md text-center text-red-500 mb-4"},so={class:"flex justify-center"},io={key:0,class:"results overflow-auto"},ro=["id"],uo={class:"text-sm text-slate-500 text-center mb-1"},co={class:"w-5/6 mx-auto flex flex-wrap items-center justify-center"},mo={class:"w-full flex justify-center items-center"},fo={key:1,class:"text-center text-slate-500"},po=Y({__name:"Output",emits:["copy-prompt-inputs"],setup(e,{emit:l}){const t=ue(),s=V(()=>{var R;return t.flowResultsByName((R=t.currentFlow)==null?void 0:R.name).length>0||!1}),r=V(()=>{var R;return t.flowResultsByName((R=t.currentFlow)==null?void 0:R.name)||[]}),o=V(()=>t.$state.resultsPageSize);de(r,()=>{r.value.length<=t.$state.resultsPageSize?t.$state.resultsPage=1:t.$state.resultsPage>Math.ceil(r.value.length/t.$state.resultsPageSize)&&(t.$state.resultsPage=Math.ceil(r.value.length/t.$state.resultsPageSize))}),de(o,()=>{r.value.length<=t.$state.resultsPageSize?t.$state.resultsPage=1:t.$state.resultsPage>Math.ceil(r.value.length/t.$state.resultsPageSize)&&(t.$state.resultsPage=Math.ceil(r.value.length/t.$state.resultsPageSize)),t.saveUserOptions()}),tt(()=>{t.$state.flow_results_filter="",t.$state.resultsPage=1});const a=l;function f(R){a("copy-prompt-inputs",R.input_params_mapped)}function p(R){_.value=R,I.value=!0}const k=C(null),h=C(!1);window.addEventListener("scroll",()=>{var R;h.value=window.scrollY>(((R=k.value)==null?void 0:R.offsetTop)+window.screen.height||0)});const x=V(()=>t.$state.resultsPage);de(x,()=>{const R=document.getElementById("output-container");R&&R.scrollIntoView({behavior:"smooth"})});const F=C(!1),I=C(!1),_=C(""),M=C(!1),O=C(!1),b=C(!1),c=C(""),d=C(null),i=C({}),v=C(0),B=C(!1);function u(R,z=0){if(R.child_tasks.length===0||!gt(R,z,R.outputs[z].comfy_node_id))d.value=R,c.value=ae({task_id:R.task_id,node_id:R.outputs[z].comfy_node_id}),i.value=R.input_params_mapped,B.value=!1;else{const E=pt(R,z,R.outputs[z].comfy_node_id);d.value=E,i.value=R.input_params_mapped,c.value=ae({task_id:E.task_id,node_id:E.outputs[0].comfy_node_id}),B.value=!0}v.value=z,b.value=!0}function w(R){const z=[[{label:"Use params",labelClass:"text-cyan-500 text-sm",icon:"i-heroicons-document-duplicate-16-solid",iconClass:"bg-cyan-500 h-4 w-4",click:()=>f(R)}],[{label:"Comfy flow",labelClass:"text-blue-500 text-sm",icon:"i-heroicons-arrow-down-tray",iconClass:"bg-blue-500 h-4 w-4",click:()=>{var E;return t.downloadFlowComfy((E=t.currentFlow)==null?void 0:E.name,R.task_id)}}]];return R.outputs.length===1&&R.outputs.every(E=>E.type==="image")&&z.splice(1,0,[{label:"Send to flow",labelClass:"text-violet-500 text-sm",icon:"i-heroicons-arrow-uturn-up-solid",iconClass:"bg-violet-500 h-4 w-4",click:()=>{u(R)}}]),z}return(R,z)=>{var q;const E=yl,ne=be,le=Ee,me=At,ge=Ht,W=te,A=qe,H=nt,Z=$e,se=Fl,ve=Nl,L=Ll,oe=Xl,xe=to,T=ke;return m(),U("div",{id:"output-container",ref_key:"outputContainer",ref:k,class:"w-full p-4 ring-1 ring-gray-200 dark:ring-gray-800 rounded-lg shadow-md my-10"},[g(E,{show:n(h),class:"fixed bottom-5 right-5",target:"output-container"},null,8,["show"]),y("h2",{class:"text-lg font-bold cursor-pointer select-none flex items-center mb-3",onClick:z[0]||(z[0]=()=>{F.value=!n(F)})},[g(ne,{name:n(F)?"i-heroicons-chevron-down":"i-heroicons-chevron-up",class:"mr-2"},null,8,["name"]),N(" Output ("+D(n(r).filter(j=>j.parent_task_id===null).length)+") ",1)]),n(F)?$("",!0):(m(),U(ee,{key:0},[y("div",no,[g(le,{modelValue:n(t).$state.flow_results_filter,"onUpdate:modelValue":z[1]||(z[1]=j=>n(t).$state.flow_results_filter=j),icon:"i-heroicons-magnifying-glass-20-solid",color:"white",class:"md:mr-3",label:"Filter by prompt",trailing:!0,placeholder:"Filter results by prompt"},null,8,["modelValue"]),n(r).filter(j=>j.parent_task_id===null).length>n(t).$state.resultsPageSize?(m(),S(me,{key:0,modelValue:n(t).$state.resultsPage,"onUpdate:modelValue":z[2]||(z[2]=j=>n(t).$state.resultsPage=j),class:"my-1 md:my-0","page-count":n(t).$state.resultsPageSize,total:n(r).filter(j=>j.parent_task_id===null).length,"show-first":"","show-last":""},null,8,["modelValue","page-count","total"])):$("",!0),y("div",lo,[g(ge,{modelValue:n(t).resultsPageSize,"onUpdate:modelValue":z[3]||(z[3]=j=>n(t).resultsPageSize=j),class:"md:mx-3 w-fit mr-3",options:[5,10,20,50,100],label:"Results per page"},null,8,["modelValue"]),g(A,{items:[[{label:"Delete all results",labelClass:"text-red-500",icon:"i-heroicons-trash",iconClass:"dark:text-red-500 text-red-500",click:()=>M.value=!0}]],mode:"click",label:"Options",popper:{placement:"bottom-end"}},{default:P(()=>[g(W,{color:"white",icon:"i-heroicons-ellipsis-vertical-16-solid"})]),_:1},8,["items"])]),g(Z,{modelValue:n(M),"onUpdate:modelValue":z[6]||(z[6]=j=>X(M)?M.value=j:null),class:"z-[90]",transition:!1},{default:P(()=>[y("div",oo,[z[15]||(z[15]=y("p",{class:"text-lg text-center mb-4"},"Are you sure you want to delete all results?",-1)),y("p",ao,[z[11]||(z[11]=N(" All history and images of ")),g(H,{class:"mx-1",color:"orange",variant:"outline"},{default:P(()=>[N(D(n(t).currentFlow.display_name),1)]),_:1}),z[12]||(z[12]=N(" will be deleted. "))]),y("div",so,[g(W,{class:"mr-2",color:"red",variant:"outline",loading:n(O),onClick:z[4]||(z[4]=()=>{var j;O.value=!0,n(t).deleteFlowResults((j=n(t).currentFlow)==null?void 0:j.name).then(()=>{O.value=!1,M.value=!1})})},{default:P(()=>z[13]||(z[13]=[N(" Yes ")])),_:1},8,["loading"]),g(W,{variant:"outline",onClick:z[5]||(z[5]=()=>M.value=!1)},{default:P(()=>z[14]||(z[14]=[N("No")])),_:1})])])]),_:1},8,["modelValue"])]),n(s)?(m(),U("div",io,[(m(!0),U(ee,null,ce(n(t).flowResultsByNamePaginated((q=n(t).currentFlow)==null?void 0:q.name),j=>(m(),U("div",{id:"task_id_"+j.task_id,key:j.task_id,class:"flex flex-col justify-center mx-auto mb-5"},[j.outputs.some(G=>["image","image-animated"].includes(G.type))?(m(),S(se,{key:0,"flow-result":j,"handle-send-to-flow":u,"open-image-modal":p},null,8,["flow-result"])):j.outputs.some(G=>G.type==="video")?(m(),S(ve,{key:1,"flow-result":j,"handle-send-to-flow":u,"open-image-modal":p},null,8,["flow-result"])):$("",!0),y("div",uo,[y("div",co,[g(L,{"flow-result":j},null,8,["flow-result"])])]),g(oe,{"flow-result":j},null,8,["flow-result"]),y("div",mo,[g(W,{class:"mr-3",color:"red",icon:"i-heroicons-trash",variant:"outline",size:"xs",onClick:()=>n(t).deleteFlowHistory(j.task_id)},{default:P(()=>z[16]||(z[16]=[N(" Delete ")])),_:2},1032,["onClick"]),g(A,{items:w(j),mode:"click",popper:{placement:"bottom-start"}},{default:P(()=>[g(W,{color:"white",icon:"i-heroicons-ellipsis-vertical-16-solid",size:"xs"})]),_:2},1032,["items"])])],8,ro))),128)),g(xe,{show:n(b),"onUpdate:show":z[7]||(z[7]=j=>X(b)?b.value=j:null),"flow-result":n(d),"output-img-src":n(c),"output-param-index":n(v),"input-params-mapped":n(i),"is-child-task":n(B)},null,8,["show","flow-result","output-img-src","output-param-index","input-params-mapped","is-child-task"])])):(m(),U("p",fo," No output results available "))],64)),g(Z,{modelValue:n(I),"onUpdate:modelValue":z[10]||(z[10]=j=>X(I)?I.value=j:null),class:"z-[90]",transition:!1,fullscreen:""},{default:P(()=>[g(W,{class:"absolute top-4 right-4",icon:"i-heroicons-x-mark",variant:"ghost",onClick:z[8]||(z[8]=()=>I.value=!1)}),y("div",{class:"flex items-center justify-center w-full h-full p-4",onClick:z[9]||(z[9]=Ve(()=>I.value=!1,["left"]))},[n(_)?(m(),S(T,{key:0,class:"lg:h-full",fit:"inside",loading:"lazy",src:n(_)},null,8,["src"])):$("",!0)])]),_:1},8,["modelValue"])],512)}}}),go={class:"flex flex-col lg:flex-row flex-grow items-start w-full"},vo={class:"card-wrapper w-full lg:pr-5"},ho={key:0,class:"p-0 text-sm"},wo={class:"flex flex-row items-center text-slate-400 mb-2"},yo={class:"flex flex-row flex-wrap items-center text-md mb-2"},bo=["href"],ko={class:"flex flex-row items-center text-md mb-2"},xo=["href"],_o={key:1},$o={class:"flex flex-row items-center text-md mb-2"},Co={key:0},Io={class:"flex flex-row items-center text-md mb-2"},So={key:0,class:"flex flex-row flex-wrap items-center text-md mb-2"},Mo=["href"],Ro={key:1},Po={class:"flex flex-row items-center mb-2"},zo={key:1,class:"flex flex-row flex-wrap items-center text-md"},Fo={key:0,class:"flex justify-end"},Uo={class:"flex flex-row items-center justify-center text-sm mr-2"},Oo={key:1},jo={class:"text-sm flex justify-end"},To={class:"flex flex-row items-center justify-center text-sm mr-3"},Bo={key:0,class:"text-right"},Vo={class:"prompt-wrapper w-full"},No={class:"flex items-center justify-between"},qo={class:"pb-2"},Eo={class:"flex justify-end items-center"},Qo=Y({__name:"[name]",setup(e){const l=Nt(),t=ue();t.setCurrentFlow(l.params.name);const s=V(()=>t.flowInstallingByName(l.params.name)),r=V(()=>{var d;return s.value&&((d=s.value)==null?void 0:d.progress)<100||!1}),o=C(!1),a=V(()=>{var d;return s.value?"error"in s.value&&((d=s.value)==null?void 0:d.error)!==""?`${s.value.progress.toFixed(0)}% Error setting up`:`${s.value.progress.toFixed(0)}% Setting up`:"Setup flow"}),f=C(!1),p=C(!1),k=V(()=>{var i;const d=[[{label:"Delete flow",icon:"i-heroicons-trash",click:x}]];return((i=t==null?void 0:t.currentFlow)==null?void 0:i.new_version_available)!==""&&d[0].unshift({label:`Update to ${t.currentFlow.new_version_available}`,icon:"i-heroicons-arrow-path",click:()=>{t.updateFlow(t.currentFlow)}}),d});function h(d,i=!1){f.value=!0,t.deleteFlow(d).then(()=>{i&&qt().push("/")}).finally(()=>{f.value=!1,p.value=!1})}function x(){var i;const d=((i=t.currentFlow)==null?void 0:i.private)||!1;if(d){p.value=!0;return}h(t.currentFlow,d)}const F=C(!1),I=C(null),_=function(d){var i;(i=I.value)==null||i.copyPromptInputs(d)},M=et(),O=V(()=>{var d;return(d=t.currentFlow)==null?void 0:d.models.filter(i=>i.installed).reduce((i,v)=>i+(v==null?void 0:v.file_size)||0,0)}),b=V(()=>{var d;return(d=t.currentFlow)==null?void 0:d.models.reduce((i,v)=>i+(v==null?void 0:v.file_size)||0,0)}),c=V(()=>!O.value&&!b.value?"":O.value===b.value?` - ${Ie(b.value)}`:` - ${Ie(O.value)} / ${Ie(b.value)}`);return(d,i)=>{const v=be,B=Ne,u=nt,w=te,R=qe,z=Dt,E=el,ne=wl,le=po,me=ht,ge=$e,W=Wt;return m(),S(W,null,{default:P(()=>[!n(t).loading.flows_available&&!n(t).loading.flows_installed&&n(t).currentFlow&&!n(t).$state.loading.tasks_history?(m(),U(ee,{key:0},[y("div",go,[y("div",vo,[g(z,{as:"div",class:"w-full mb-5"},Et({header:P(()=>{var A,H;return[y("h2",{class:"text-xl font-bold cursor-pointer select-none flex items-center",onClick:i[0]||(i[0]=()=>{F.value=!n(F)})},[(A=n(t).currentFlow)!=null&&A.private?(m(),S(B,{key:0,text:"This flow is local, manually added"},{default:P(()=>{var Z;return[g(v,{name:"i-heroicons-lock-closed",class:Q(["mr-2",{"text-stone-500":!((Z=n(t).currentFlow)!=null&&Z.is_supported_by_workers)}])},null,8,["class"])]}),_:1})):$("",!0),g(v,{name:n(F)?"i-heroicons-chevron-down":"i-heroicons-chevron-up",class:"mr-2"},null,8,["name"]),g(B,{text:(H=n(t).currentFlow)!=null&&H.is_supported_by_workers?"":"No workers capable of running this flow",popper:{placement:"top"}},{default:P(()=>{var Z,se;return[y("span",{class:Q({"text-stone-500":!((Z=n(t).currentFlow)!=null&&Z.is_supported_by_workers)})},D((se=n(t).currentFlow)==null?void 0:se.display_name),3)]}),_:1},8,["text"])])]}),default:P(()=>{var A,H,Z,se,ve,L,oe,xe,T,q,j,G,K,ie,re,fe,he;return[n(F)?$("",!0):(m(),U("div",ho,[y("p",wo,D((A=n(t).currentFlow)==null?void 0:A.description),1),y("p",yo,[g(v,{name:"i-heroicons-user-16-solid",class:"mr-1"}),i[8]||(i[8]=y("b",null,"Author:",-1)),i[9]||(i[9]=N(" ")),y("a",{class:"hover:underline text-md",href:(H=n(t).currentFlow)==null?void 0:H.homepage,rel:"noopener",target:"_blank"},D((Z=n(t).currentFlow)==null?void 0:Z.author),9,bo)]),y("p",ko,[g(v,{name:"i-heroicons-document-text",class:"mr-1"}),(se=n(t).currentFlow)!=null&&se.documentation?(m(),U("a",{key:0,class:"hover:underline",href:(ve=n(t).currentFlow)==null?void 0:ve.documentation,rel:"noopener",target:"_blank"}," Documentation ",8,xo)):(m(),U("span",_o,"No documentation"))]),y("p",$o,[g(v,{name:"i-heroicons-clock",class:"mr-1"}),i[10]||(i[10]=y("b",null,"Version:",-1)),i[11]||(i[11]=N(" ")),y("span",null,D((L=n(t).currentFlow)==null?void 0:L.version),1),((oe=n(t).currentFlow)==null?void 0:oe.new_version_available)!==""?(m(),U("span",Co," (new version available: "+D((xe=n(t).currentFlow)==null?void 0:xe.new_version_available)+") ",1)):$("",!0)]),y("p",Io,[g(v,{name:"i-heroicons-tag",class:"mr-1"}),i[12]||(i[12]=y("b",null,"Tags:",-1)),i[13]||(i[13]=N(" ")),((T=n(t).currentFlow)==null?void 0:T.tags.length)>0?(m(!0),U(ee,{key:0},ce((q=n(t).currentFlow)==null?void 0:q.tags,J=>(m(),S(u,{key:J,label:J,color:"white",variant:"solid",class:"m-1"},null,8,["label"]))),128)):(m(),S(u,{key:1,label:"No tags",color:"white",variant:"solid",class:"m-1"}))]),((G=(j=n(t).currentFlow)==null?void 0:j.models)==null?void 0:G.length)>0?(m(),U("p",So,[g(v,{name:"i-heroicons-arrow-down-on-square-stack",class:"mr-1"}),g(B,{text:n(b)-n(O)>0?`${("formatBytes"in d?d.formatBytes:n(Ie))(n(b)-n(O))} to download`:"All models installed",popper:{placement:"top"}},{default:P(()=>{var J;return[y("b",null,"Models ("+D((J=n(t).currentFlow)==null?void 0:J.models.length)+D(n(c))+"):",1),i[14]||(i[14]=N(" "))]}),_:1},8,["text"]),(m(!0),U(ee,null,ce((K=n(t).currentFlow)==null?void 0:K.models,J=>(m(),S(u,{key:J.name,class:"m-1",color:"white",variant:"solid"},{default:P(()=>[g(B,{text:J.installed?"Model installed":"Model not installed"},{default:P(()=>[g(v,{name:J.installed?"i-heroicons-check-circle-20-solid":"i-heroicons-x-mark-20-solid",class:Q(J.installed?"text-green-500":"text-orange-500")},null,8,["name","class"])]),_:2},1032,["text"]),J.gated?(m(),S(B,{key:0,text:"Gated model, requires auth token for download",popper:{placement:"top"}},{default:P(()=>[g(v,{name:"i-heroicons-key",class:"mr-1"})]),_:1})):$("",!0),y("a",{class:"hover:underline underline-offset-4",href:J.homepage,rel:"noopener",target:"_blank"},D(J.name),9,Mo),J.file_size?(m(),U("span",Ro," ("+D(("formatBytes"in d?d.formatBytes:n(Ie))(J.file_size))+") ",1)):$("",!0)]),_:2},1024))),128))])):$("",!0),y("p",Po,[g(v,{name:"i-mdi-help-network-outline",class:"mr-1"}),i[17]||(i[17]=y("b",null,"Platforms:",-1)),i[18]||(i[18]=N(" ")),g(B,{text:"Linux"},{default:P(()=>[g(v,{name:"i-mdi-linux",class:"mr-1"})]),_:1}),g(B,{text:"Microsoft Windows"},{default:P(()=>[g(v,{name:"i-mdi-microsoft-windows",class:"mr-1"})]),_:1}),n(t).currentFlow.is_macos_supported?(m(),S(B,{key:0,text:"macOS"},{default:P(()=>[g(v,{name:"i-mdi-apple",class:"mr-1"})]),_:1})):$("",!0),(ie=n(t).currentFlow)!=null&&ie.required_memory_gb?(m(),S(B,{key:1,class:"flex flex-row items-center",text:"Required VRAM memory (GB)"},{default:P(()=>{var J;return[i[15]||(i[15]=N(" (")),g(v,{name:"i-mdi-memory",class:"mr-1"}),y("span",null,D((J=n(t).currentFlow)==null?void 0:J.required_memory_gb)+" GB",1),i[16]||(i[16]=N(") "))]}),_:1})):$("",!0)]),((fe=(re=n(t).currentFlow)==null?void 0:re.requires)==null?void 0:fe.length)>0?(m(),U("p",zo,[i[19]||(i[19]=y("b",null,"Requires:",-1)),i[20]||(i[20]=N(" ")),(m(!0),U(ee,null,ce((he=n(t).currentFlow)==null?void 0:he.requires,J=>(m(),S(u,{key:J,class:"m-1",color:"yellow",variant:"outline"},{default:P(()=>[N(D(J),1)]),_:2},1024))),128))])):$("",!0)]))]}),_:2},[n(F)?void 0:{name:"footer",fn:P(()=>{var A,H;return[n(M).isAdmin?(m(),U("div",Fo,[y("div",Uo,[g(v,{name:n(t).isFlowInstalled(n(l).params.name)?"i-heroicons-check-badge":"i-heroicons-x-mark",class:"mx-1"},null,8,["name"]),y("span",{class:Q({"text-green-500":n(t).isFlowInstalled(n(l).params.name),"text-red-500":!n(t).isFlowInstalled(n(l).params.name),"text-stone-500":n(t).isFlowInstalled(n(l).params.name)&&!((A=n(t).currentFlow)!=null&&A.is_supported_by_workers)})},D(n(t).isFlowInstalled(n(l).params.name)?(H=n(t).currentFlow)!=null&&H.is_supported_by_workers?"Installed":"Installed (no workers)":"Not installed"),3)]),n(t).isFlowInstalled(n(l).params.name)?$("",!0):(m(),S(B,{key:0,text:"Setup flow dependencies and configure it in ComfyUI",popper:{placement:"top"},"open-delay":500},{default:P(()=>[g(w,{icon:"i-heroicons-arrow-down-tray",class:"mx-3",color:"primary",variant:"outline",loading:n(r),onClick:i[1]||(i[1]=()=>n(t).setupFlow(n(t).currentFlow))},{default:P(()=>[N(D(n(a)),1)]),_:1},8,["loading"])]),_:1})),!n(t).isFlowInstalled(n(l).params.name)&&n(r)?(m(),S(B,{key:1,text:"Cancel flow installation",popper:{placement:"top"},"open-delay":500},{default:P(()=>[g(w,{icon:"i-heroicons-stop",variant:"outline",color:"orange",loading:n(o),onClick:i[2]||(i[2]=()=>{o.value=!0,n(t).cancelFlowSetup(n(t).currentFlow).then(()=>{o.value=!1})})},{default:P(()=>i[21]||(i[21]=[N(" Cancel ")])),_:1},8,["loading"])]),_:1})):$("",!0),n(t).isFlowInstalled(n(l).params.name)?(m(),S(R,{key:2,items:n(k),mode:"click",label:"Actions",popper:{placement:"bottom-end"}},{default:P(()=>[g(w,{color:"white",label:"Actions","trailing-icon":"i-heroicons-chevron-down-20-solid"})]),_:1},8,["items"])):$("",!0)])):(m(),U("div",Oo,[y("div",jo,[y("div",To,[g(v,{name:n(t).isFlowInstalled(n(l).params.name)?"i-heroicons-check-badge":"i-heroicons-x-mark",class:"mx-1"},null,8,["name"]),y("span",{class:Q({"text-green-500":n(t).isFlowInstalled(n(l).params.name),"text-red-500":!n(t).isFlowInstalled(n(l).params.name)})},D(n(t).isFlowInstalled(n(l).params.name)?"Installed":"Not installed"),3)]),n(t).isFlowInstalled(n(l).params.name)?$("",!0):(m(),U("div",Bo,i[22]||(i[22]=[y("p",{class:"text-orange-500"},"Only admin can manage workflows.",-1),y("span",{class:"text-slate-500"},"Ask your admin to setup this workflow",-1)])))])]))]}),key:"0"}]),1024)]),y("div",Vo,[!n(f)&&n(t).isFlowInstalled(n(l).params.name)?(m(),S(E,{key:0,ref_key:"workflowPrompt",ref:I},null,512)):$("",!0)])]),!n(f)&&n(t).isFlowInstalled(n(l).params.name)?(m(),S(ne,{key:0})):$("",!0),!n(f)&&n(t).isFlowInstalled(n(l).params.name)||n(t).flowResultsByName(n(l).params.name).length>0?(m(),S(le,{key:1,onCopyPromptInputs:i[3]||(i[3]=A=>_(A))})):$("",!0)],64)):(m(),S(me,{key:1,class:"mb-3"})),g(ge,{modelValue:n(p),"onUpdate:modelValue":i[7]||(i[7]=A=>X(p)?p.value=A:null),"prevent-close":""},{default:P(()=>[g(z,{ui:{ring:"",divide:"divide-y divide-gray-100 dark:divide-gray-800"}},{header:P(()=>[y("div",No,[i[23]||(i[23]=y("h3",{class:"text-base font-semibold leading-6 text-gray-900 dark:text-white"}," Confirm workflow deletion ",-1)),g(w,{color:"gray",variant:"ghost",icon:"i-heroicons-x-mark-20-solid",class:"-my-1",onClick:i[4]||(i[4]=A=>p.value=!1)})])]),default:P(()=>{var A;return[y("p",qo,[i[24]||(i[24]=N(" Are you sure you want to delete the ")),i[25]||(i[25]=y("b",null,"private",-1)),i[26]||(i[26]=N(" workflow ")),y("b",null,D((A=n(t).currentFlow)==null?void 0:A.display_name),1),i[27]||(i[27]=N("? "))]),y("div",Eo,[g(w,{icon:"i-heroicons-x-mark-16-solid",variant:"outline",color:"green",class:"mr-2",onClick:i[5]||(i[5]=H=>p.value=!1)},{default:P(()=>i[28]||(i[28]=[N(" Cancel ")])),_:1}),g(w,{icon:"i-heroicons-trash",variant:"outline",color:"red",onClick:i[6]||(i[6]=H=>{var Z;return h(n(t).currentFlow,((Z=n(t).currentFlow)==null?void 0:Z.private)||!1)})},{default:P(()=>i[29]||(i[29]=[N(" Delete ")])),_:1})])]}),_:1})]),_:1},8,["modelValue"])]),_:1})}}});export{Qo as default};
