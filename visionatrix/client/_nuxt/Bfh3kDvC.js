import{f as H,a1 as at,a2 as Vt,J as S,P as j,S as _e,a3 as Ne,a4 as qt,a5 as ze,a6 as oe,a7 as Ve,a8 as yt,a9 as Dt,aa as Be,ab as ct,ac as ae,ad as At,ae as mt,af as Lt,ag as Et,ah as Wt,ai as Ht,aj as Qt,ak as Jt,al as Gt,am as Kt,_ as qe,an as xe,o as f,i as M,w as P,b as y,n as L,v as Re,a as I,c as z,ao as wt,ap as Xt,x as he,l as C,F as X,r as ie,e as bt,aq as Yt,h as be,$ as kt,t as A,ar as xt,d as V,z as De,A as Fe,B as Ae,as as Zt,C as we,W as Le,at as en,q as me,au as tn,av as nn,D as Pe,E as je,aw as an,ax as ln,ay as on,az as ft,aA as sn,aB as Ze,aC as rn,aD as pt,aE as un,aF as _t,aG as dn,aH as cn,p as a,aI as lt,aJ as mn,aK as et,g as fe,I as ot,T as It,m as ne,N as Y,aL as tt,U as Ee,H as fn,aM as $t,k as We,aN as pn,aO as vn,aP as gn,aQ as St,Q as nt,aR as hn,L as He,aS as Mt,aT as se,aU as Ct,j as st,aV as yn,aW as wn,O as bn,K as Te,aX as kn,s as xn}from"./BkmaeSbd.js";import{p as _n,u as In,c as pe,i as $n,f as Sn,_ as Pt}from"./C3aN936R.js";import{a as Mn,_ as Cn}from"./BUrUJsYe.js";import{u as Rt,_ as it}from"./DOs2DJj1.js";import{_ as rt}from"./DkblD9_5.js";import{_ as Ue,a as Pn}from"./CAuwoXQh.js";import{_ as ut}from"./COKWXBIv.js";import{_ as zt}from"./Cdvf8zsD.js";import{_ as Ft,a as Rn}from"./BYzak-1N.js";const zn={wrapper:"relative",container:"relative w-full flex overflow-x-auto snap-x snap-mandatory scroll-smooth",item:"flex flex-none snap-center",arrows:{wrapper:"flex items-center justify-between"},indicators:{wrapper:"absolute flex items-center justify-center gap-3 bottom-4 inset-x-0",base:"rounded-full h-3 w-3",active:"bg-primary-500 dark:bg-primary-400",inactive:"bg-gray-100 dark:bg-gray-800"},default:{prevButton:{color:"black",class:"rtl:[&_span:first-child]:rotate-180 absolute start-4 top-1/2 transform -translate-y-1/2 rounded-full",icon:"i-heroicons-chevron-left-20-solid"},nextButton:{color:"black",class:"rtl:[&_span:last-child]:rotate-180 absolute end-4 top-1/2 transform -translate-y-1/2 rounded-full",icon:"i-heroicons-chevron-right-20-solid"}}},Fn={wrapper:"relative w-full flex items-center",base:"w-full absolute appearance-none cursor-pointer disabled:cursor-not-allowed disabled:bg-opacity-50 focus:outline-none peer group",rounded:"rounded-lg",background:"bg-transparent",ring:"focus-visible:ring-2 focus-visible:ring-{color}-500 dark:focus-visible:ring-{color}-400 focus-visible:ring-offset-2 focus-visible:ring-offset-white dark:focus-visible:ring-offset-gray-900",progress:{base:"absolute pointer-events-none peer-disabled:bg-opacity-50",rounded:"rounded-s-lg",background:"bg-{color}-500 dark:bg-{color}-400",size:{"2xs":"h-px",xs:"h-0.5",sm:"h-1",md:"h-2",lg:"h-3",xl:"h-4","2xl":"h-5"}},thumb:{base:"[&::-webkit-slider-thumb]:relative [&::-moz-range-thumb]:relative [&::-webkit-slider-thumb]:z-[1] [&::-moz-range-thumb]:z-[1] [&::-webkit-slider-thumb]:appearance-none [&::-moz-range-thumb]:appearance-none [&::-webkit-slider-thumb]:rounded-full [&::-moz-range-thumb]:rounded-full [&::-moz-range-thumb]:border-0",color:"text-{color}-500 dark:text-{color}-400",background:"[&::-webkit-slider-thumb]:bg-white [&::-webkit-slider-thumb]:dark:bg-gray-900 [&::-moz-range-thumb]:bg-current",ring:"[&::-webkit-slider-thumb]:ring-2 [&::-webkit-slider-thumb]:ring-current",size:{"2xs":"[&::-webkit-slider-thumb]:h-1.5 [&::-moz-range-thumb]:h-1.5 [&::-webkit-slider-thumb]:w-1.5 [&::-moz-range-thumb]:w-1.5 [&::-webkit-slider-thumb]:mt-[-2.5px] [&::-moz-range-thumb]:mt-[-2.5px]",xs:"[&::-webkit-slider-thumb]:h-2 [&::-moz-range-thumb]:h-2 [&::-webkit-slider-thumb]:w-2 [&::-moz-range-thumb]:w-2 [&::-webkit-slider-thumb]:mt-[-3px] [&::-moz-range-thumb]:mt-[-3px]",sm:"[&::-webkit-slider-thumb]:h-3 [&::-moz-range-thumb]:h-3 [&::-webkit-slider-thumb]:w-3 [&::-moz-range-thumb]:w-3 [&::-webkit-slider-thumb]:-mt-1 [&::-moz-range-thumb]:-mt-1",md:"[&::-webkit-slider-thumb]:h-4 [&::-moz-range-thumb]:h-4 [&::-webkit-slider-thumb]:w-4 [&::-moz-range-thumb]:w-4 [&::-webkit-slider-thumb]:-mt-1 [&::-moz-range-thumb]:-mt-1",lg:"[&::-webkit-slider-thumb]:h-5 [&::-moz-range-thumb]:h-5 [&::-webkit-slider-thumb]:w-5 [&::-moz-range-thumb]:w-5 [&::-webkit-slider-thumb]:-mt-1 [&::-moz-range-thumb]:-mt-1",xl:"[&::-webkit-slider-thumb]:h-6 [&::-moz-range-thumb]:h-6 [&::-webkit-slider-thumb]:w-6 [&::-moz-range-thumb]:w-6 [&::-webkit-slider-thumb]:-mt-1 [&::-moz-range-thumb]:-mt-1","2xl":"[&::-webkit-slider-thumb]:h-7 [&::-moz-range-thumb]:h-7 [&::-webkit-slider-thumb]:w-7 [&::-moz-range-thumb]:w-7 [&::-webkit-slider-thumb]:-mt-1 [&::-moz-range-thumb]:-mt-1"}},track:{base:"[&::-webkit-slider-runnable-track]:group-disabled:bg-opacity-50 [&::-moz-range-track]:group-disabled:bg-opacity-50",background:"[&::-webkit-slider-runnable-track]:bg-gray-200 [&::-moz-range-track]:bg-gray-200 [&::-webkit-slider-runnable-track]:dark:bg-gray-700 [&::-moz-range-track]:dark:bg-gray-700",rounded:"[&::-webkit-slider-runnable-track]:rounded-lg [&::-moz-range-track]:rounded-lg",size:{"2xs":"[&::-webkit-slider-runnable-track]:h-px [&::-moz-range-track]:h-px",xs:"[&::-webkit-slider-runnable-track]:h-0.5 [&::-moz-range-track]:h-0.5",sm:"[&::-webkit-slider-runnable-track]:h-1 [&::-moz-range-track]:h-1",md:"[&::-webkit-slider-runnable-track]:h-2 [&::-moz-range-track]:h-2",lg:"[&::-webkit-slider-runnable-track]:h-3 [&::-moz-range-track]:h-3",xl:"[&::-webkit-slider-runnable-track]:h-4 [&::-moz-range-track]:h-4","2xl":"[&::-webkit-slider-runnable-track]:h-5 [&::-moz-range-track]:h-5"}},size:{"2xs":"h-1.5",xs:"h-2",sm:"h-3",md:"h-4",lg:"h-5",xl:"h-6","2xl":"h-7"},default:{size:"md",color:"primary"}};var Un=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(Un||{}),Tn=(e=>(e[e.Pointer=0]="Pointer",e[e.Other=1]="Other",e))(Tn||{});function jn(e){requestAnimationFrame(()=>requestAnimationFrame(e))}let Ut=Symbol("MenuContext");function Qe(e){let n=Vt(Ut,null);if(n===null){let t=new Error(`<${e} /> is missing a parent <Menu /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(t,Qe),t}return n}let On=H({name:"Menu",props:{as:{type:[Object,String],default:"template"}},setup(e,{slots:n,attrs:t}){let i=S(1),r=S(null),s=S(null),o=S([]),c=S(""),m=S(null),b=S(1);function h(v=k=>k){let k=m.value!==null?o.value[m.value]:null,w=Wt(v(o.value.slice()),_=>oe(_.dataRef.domRef)),x=k?w.indexOf(k):null;return x===-1&&(x=null),{items:w,activeItemIndex:x}}let $={menuState:i,buttonRef:r,itemsRef:s,items:o,searchQuery:c,activeItemIndex:m,activationTrigger:b,closeMenu:()=>{i.value=1,m.value=null},openMenu:()=>i.value=0,goToItem(v,k,w){let x=h(),_=Sn(v===pe.Specific?{focus:pe.Specific,id:k}:{focus:v},{resolveItems:()=>x.items,resolveActiveIndex:()=>x.activeItemIndex,resolveId:g=>g.id,resolveDisabled:g=>g.dataRef.disabled});c.value="",m.value=_,b.value=w??1,o.value=x.items},search(v){let k=c.value!==""?0:1;c.value+=v.toLowerCase();let w=(m.value!==null?o.value.slice(m.value+k).concat(o.value.slice(0,m.value+k)):o.value).find(_=>_.dataRef.textValue.startsWith(c.value)&&!_.dataRef.disabled),x=w?o.value.indexOf(w):-1;x===-1||x===m.value||(m.value=x,b.value=1)},clearSearch(){c.value=""},registerItem(v,k){let w=h(x=>[...x,{id:v,dataRef:k}]);o.value=w.items,m.value=w.activeItemIndex,b.value=1},unregisterItem(v){let k=h(w=>{let x=w.findIndex(_=>_.id===v);return x!==-1&&w.splice(x,1),w});o.value=k.items,m.value=k.activeItemIndex,b.value=1}};return Et([r,s],(v,k)=>{var w;$.closeMenu(),Ht(k,Qt.Loose)||(v.preventDefault(),(w=oe(r))==null||w.focus())},j(()=>i.value===0)),Jt(Ut,$),Gt(j(()=>Kt(i.value,{0:Be.Open,1:Be.Closed}))),()=>{let v={open:i.value===0,close:$.closeMenu};return Ve({ourProps:{},theirProps:e,slot:v,slots:n,attrs:t,name:"Menu"})}}}),Bn=H({name:"MenuButton",props:{disabled:{type:Boolean,default:!1},as:{type:[Object,String],default:"button"},id:{type:String,default:null}},setup(e,{attrs:n,slots:t,expose:i}){var r;let s=(r=e.id)!=null?r:`headlessui-menu-button-${at()}`,o=Qe("MenuButton");i({el:o.buttonRef,$el:o.buttonRef});function c($){switch($.key){case ae.Space:case ae.Enter:case ae.ArrowDown:$.preventDefault(),$.stopPropagation(),o.openMenu(),ze(()=>{var v;(v=oe(o.itemsRef))==null||v.focus({preventScroll:!0}),o.goToItem(pe.First)});break;case ae.ArrowUp:$.preventDefault(),$.stopPropagation(),o.openMenu(),ze(()=>{var v;(v=oe(o.itemsRef))==null||v.focus({preventScroll:!0}),o.goToItem(pe.Last)});break}}function m($){switch($.key){case ae.Space:$.preventDefault();break}}function b($){e.disabled||(o.menuState.value===0?(o.closeMenu(),ze(()=>{var v;return(v=oe(o.buttonRef))==null?void 0:v.focus({preventScroll:!0})})):($.preventDefault(),o.openMenu(),jn(()=>{var v;return(v=oe(o.itemsRef))==null?void 0:v.focus({preventScroll:!0})})))}let h=Lt(j(()=>({as:e.as,type:n.type})),o.buttonRef);return()=>{var $;let v={open:o.menuState.value===0},{...k}=e,w={ref:o.buttonRef,id:s,type:h.value,"aria-haspopup":"menu","aria-controls":($=oe(o.itemsRef))==null?void 0:$.id,"aria-expanded":o.menuState.value===0,onKeydown:c,onKeyup:m,onClick:b};return Ve({ourProps:w,theirProps:k,slot:v,attrs:n,slots:t,name:"MenuButton"})}}}),Nn=H({name:"MenuItems",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},id:{type:String,default:null}},setup(e,{attrs:n,slots:t,expose:i}){var r;let s=(r=e.id)!=null?r:`headlessui-menu-items-${at()}`,o=Qe("MenuItems"),c=S(null);i({el:o.itemsRef,$el:o.itemsRef}),$n({container:j(()=>oe(o.itemsRef)),enabled:j(()=>o.menuState.value===0),accept(v){return v.getAttribute("role")==="menuitem"?NodeFilter.FILTER_REJECT:v.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(v){v.setAttribute("role","none")}});function m(v){var k;switch(c.value&&clearTimeout(c.value),v.key){case ae.Space:if(o.searchQuery.value!=="")return v.preventDefault(),v.stopPropagation(),o.search(v.key);case ae.Enter:if(v.preventDefault(),v.stopPropagation(),o.activeItemIndex.value!==null){let w=o.items.value[o.activeItemIndex.value];(k=oe(w.dataRef.domRef))==null||k.click()}o.closeMenu(),yt(oe(o.buttonRef));break;case ae.ArrowDown:return v.preventDefault(),v.stopPropagation(),o.goToItem(pe.Next);case ae.ArrowUp:return v.preventDefault(),v.stopPropagation(),o.goToItem(pe.Previous);case ae.Home:case ae.PageUp:return v.preventDefault(),v.stopPropagation(),o.goToItem(pe.First);case ae.End:case ae.PageDown:return v.preventDefault(),v.stopPropagation(),o.goToItem(pe.Last);case ae.Escape:v.preventDefault(),v.stopPropagation(),o.closeMenu(),ze(()=>{var w;return(w=oe(o.buttonRef))==null?void 0:w.focus({preventScroll:!0})});break;case ae.Tab:v.preventDefault(),v.stopPropagation(),o.closeMenu(),ze(()=>At(oe(o.buttonRef),v.shiftKey?mt.Previous:mt.Next));break;default:v.key.length===1&&(o.search(v.key),c.value=setTimeout(()=>o.clearSearch(),350));break}}function b(v){switch(v.key){case ae.Space:v.preventDefault();break}}let h=Dt(),$=j(()=>h!==null?(h.value&Be.Open)===Be.Open:o.menuState.value===0);return()=>{var v,k;let w={open:o.menuState.value===0},{...x}=e,_={"aria-activedescendant":o.activeItemIndex.value===null||(v=o.items.value[o.activeItemIndex.value])==null?void 0:v.id,"aria-labelledby":(k=oe(o.buttonRef))==null?void 0:k.id,id:s,onKeydown:m,onKeyup:b,role:"menu",tabIndex:0,ref:o.itemsRef};return Ve({ourProps:_,theirProps:x,slot:w,attrs:n,slots:t,features:ct.RenderStrategy|ct.Static,visible:$.value,name:"MenuItems"})}}}),Vn=H({name:"MenuItem",inheritAttrs:!1,props:{as:{type:[Object,String],default:"template"},disabled:{type:Boolean,default:!1},id:{type:String,default:null}},setup(e,{slots:n,attrs:t,expose:i}){var r;let s=(r=e.id)!=null?r:`headlessui-menu-item-${at()}`,o=Qe("MenuItem"),c=S(null);i({el:c,$el:c});let m=j(()=>o.activeItemIndex.value!==null?o.items.value[o.activeItemIndex.value].id===s:!1),b=_n(c),h=j(()=>({disabled:e.disabled,get textValue(){return b()},domRef:c}));_e(()=>o.registerItem(s,h)),Ne(()=>o.unregisterItem(s)),qt(()=>{o.menuState.value===0&&m.value&&o.activationTrigger.value!==0&&ze(()=>{var g,d;return(d=(g=oe(c))==null?void 0:g.scrollIntoView)==null?void 0:d.call(g,{block:"nearest"})})});function $(g){if(e.disabled)return g.preventDefault();o.closeMenu(),yt(oe(o.buttonRef))}function v(){if(e.disabled)return o.goToItem(pe.Nothing);o.goToItem(pe.Specific,s)}let k=In();function w(g){k.update(g)}function x(g){k.wasMoved(g)&&(e.disabled||m.value||o.goToItem(pe.Specific,s,0))}function _(g){k.wasMoved(g)&&(e.disabled||m.value&&o.goToItem(pe.Nothing))}return()=>{let{disabled:g,...d}=e,p={active:m.value,disabled:g,close:o.closeMenu};return Ve({ourProps:{id:s,ref:c,role:"menuitem",tabIndex:g===!0?void 0:-1,"aria-disabled":g===!0?!0:void 0,onClick:$,onFocus:v,onPointerenter:w,onMouseenter:w,onPointermove:x,onMousemove:x,onPointerleave:_,onMouseleave:_},theirProps:{...t,...d},slot:p,attrs:t,slots:n,name:"MenuItem"})}}});const Xe=Ae(we.ui.strategy,we.ui.dropdown,Zt),qn=H({components:{HMenu:On,HMenuButton:Bn,HMenuItems:Nn,HMenuItem:Vn,UIcon:be,UAvatar:kt,UKbd:xt},inheritAttrs:!1,props:{items:{type:Array,default:()=>[]},mode:{type:String,default:"click",validator:e=>["click","hover"].includes(e)},open:{type:Boolean,default:void 0},disabled:{type:Boolean,default:!1},popper:{type:Object,default:()=>({})},openDelay:{type:Number,default:()=>Xe.default.openDelay},closeDelay:{type:Number,default:()=>Xe.default.closeDelay},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})}},emits:["update:open"],setup(e,{emit:n}){const{ui:t,attrs:i}=De("dropdown",Fe(e,"ui"),Xe,Fe(e,"class")),r=j(()=>Le(e.mode==="hover"?{offsetDistance:0}:{},e.popper,t.value.popper)),[s,o]=en(r.value),c=S(null);let m=null,b=null;_e(()=>{var d,p;const _=(d=s.value)==null?void 0:d.$.provides;if(!_)return;const g=Object.getOwnPropertySymbols(_);c.value=g.length&&_[g[0]],e.open&&((p=c.value)==null||p.openMenu())});const h=j(()=>{var p,l,u;if(e.mode!=="hover")return{};const _=((p=e.popper)==null?void 0:p.offsetDistance)||((l=t.value.popper)==null?void 0:l.offsetDistance)||8,g=(u=r.value.placement)==null?void 0:u.split("-")[0],d=`${_}px`;return g==="top"||g==="bottom"?{paddingTop:d,paddingBottom:d}:g==="left"||g==="right"?{paddingLeft:d,paddingRight:d}:{paddingTop:d,paddingBottom:d,paddingLeft:d,paddingRight:d}});function $(_){!_.cancelable||!c.value||e.mode==="click"||(c.value.menuState===0?c.value.closeMenu():c.value.openMenu())}function v(){e.mode!=="hover"||!c.value||(b&&(clearTimeout(b),b=null),c.value.menuState!==0&&(m=m||setTimeout(()=>{c.value.openMenu&&c.value.openMenu(),m=null},e.openDelay)))}function k(){e.mode!=="hover"||!c.value||(m&&(clearTimeout(m),m=null),c.value.menuState!==1&&(b=b||setTimeout(()=>{c.value.closeMenu&&c.value.closeMenu(),b=null},e.closeDelay)))}function w(_,g,{href:d,navigate:p,close:l,isExternal:u}){g.click&&g.click(_),d&&!u&&(p(_),l())}me(()=>e.open,(_,g)=>{c.value&&(g===void 0||_===g||(_?c.value.openMenu():c.value.closeMenu()))}),me(()=>{var _;return(_=c.value)==null?void 0:_.menuState},(_,g)=>{g===void 0||_===g||n("update:open",_===0)});const x=bt;return tn(()=>nn()),{ui:t,attrs:i,popper:r,trigger:s,container:o,containerStyle:h,onTouchStart:$,onMouseEnter:v,onMouseLeave:k,onClick:w,getNuxtLinkProps:an,twMerge:je,twJoin:Pe,NuxtLink:x}}}),Dn=["disabled"];function An(e,n,t,i,r,s){const o=xe("HMenuButton"),c=be,m=kt,b=xt,h=xe("HMenuItem"),$=bt,v=xe("HMenuItems"),k=xe("HMenu");return f(),M(k,he({as:"div",class:e.ui.wrapper},e.attrs,{onMouseleave:e.onMouseLeave}),{default:P(({open:w})=>[y(o,{ref:"trigger",as:"div",disabled:e.disabled,class:L(e.ui.trigger),role:"button",onMouseenter:e.onMouseEnter,onTouchstartPassive:e.onTouchStart},{default:P(()=>[Re(e.$slots,"default",{open:w,disabled:e.disabled},()=>[I("button",{disabled:e.disabled}," Open ",8,Dn)])]),_:2},1032,["disabled","class","onMouseenter","onTouchstartPassive"]),w&&e.items.length?(f(),z("div",{key:0,ref:"container",class:L([e.ui.container,e.ui.width]),style:wt(e.containerStyle),onMouseenter:n[0]||(n[0]=(...x)=>e.onMouseEnter&&e.onMouseEnter(...x))},[y(Xt,he({appear:""},e.ui.transition),{default:P(()=>[I("div",null,[e.popper.arrow?(f(),z("div",{key:0,"data-popper-arrow":"",class:L(Object.values(e.ui.arrow))},null,2)):C("",!0),y(v,{class:L([e.ui.base,e.ui.divide,e.ui.ring,e.ui.rounded,e.ui.shadow,e.ui.background,e.ui.height]),static:""},{default:P(()=>[(f(!0),z(X,null,ie(e.items,(x,_)=>(f(),z("div",{key:_,class:L(e.ui.padding)},[(f(!0),z(X,null,ie(x,(g,d)=>(f(),M($,he({key:d,ref_for:!0},e.getNuxtLinkProps(g),{custom:""}),{default:P(({href:p,target:l,rel:u,navigate:R,isExternal:B,isActive:q})=>[y(h,{disabled:g.disabled},{default:P(({active:U,disabled:F,close:D})=>[(f(),M(Yt(p?"a":"button"),{href:F?void 0:p,rel:u,target:l,class:L(e.twMerge(e.twJoin(e.ui.item.base,e.ui.item.padding,e.ui.item.size,e.ui.item.rounded,U||q?e.ui.item.active:e.ui.item.inactive,F&&e.ui.item.disabled),g.class)),onClick:ee=>e.onClick(ee,g,{href:p,navigate:R,close:D,isExternal:B})},{default:P(()=>[Re(e.$slots,g.slot||"item",{item:g},()=>{var ee;return[g.icon?(f(),M(c,{key:0,name:g.icon,class:L(e.twMerge(e.twJoin(e.ui.item.icon.base,U||q?e.ui.item.icon.active:e.ui.item.icon.inactive),g.iconClass))},null,8,["name","class"])):g.avatar?(f(),M(m,he({key:1,ref_for:!0},{size:e.ui.item.avatar.size,...g.avatar},{class:e.ui.item.avatar.base}),null,16,["class"])):C("",!0),I("span",{class:L(e.twMerge(e.ui.item.label,g.labelClass))},A(g.label),3),(ee=g.shortcuts)!=null&&ee.length?(f(),z("span",{key:2,class:L(e.ui.item.shortcuts)},[(f(!0),z(X,null,ie(g.shortcuts,E=>(f(),M(b,{key:E},{default:P(()=>[V(A(E),1)]),_:2},1024))),128))],2)):C("",!0)]})]),_:2},1032,["href","rel","target","class","onClick"]))]),_:2},1032,["disabled"])]),_:2},1040))),128))],2))),128))]),_:3},8,["class"])])]),_:3},16)],38)):C("",!0)]),_:3},16,["class","onMouseleave"])}const Je=qe(qn,[["render",An]]),$e=Ae(we.ui.strategy,we.ui.textarea,ln),Ln=H({inheritAttrs:!1,props:{modelValue:{type:[String,Number],default:""},id:{type:String,default:null},name:{type:String,default:null},placeholder:{type:String,default:null},required:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},rows:{type:Number,default:3},maxrows:{type:Number,default:0},autoresize:{type:Boolean,default:!1},autofocus:{type:Boolean,default:!1},autofocusDelay:{type:Number,default:100},resize:{type:Boolean,default:!1},padded:{type:Boolean,default:!0},size:{type:String,default:null,validator(e){return Object.keys($e.size).includes(e)}},color:{type:String,default:()=>$e.default.color,validator(e){return[...we.ui.colors,...Object.keys($e.color)].includes(e)}},variant:{type:String,default:()=>$e.default.variant,validator(e){return[...Object.keys($e.variant),...Object.values($e.color).flatMap(n=>Object.keys(n))].includes(e)}},textareaClass:{type:String,default:null},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})},modelModifiers:{type:Object,default:()=>({})}},emits:["update:modelValue","blur","change"],setup(e,{emit:n}){const{ui:t,attrs:i}=De("textarea",Fe(e,"ui"),$e,Fe(e,"class")),{emitFormBlur:r,emitFormInput:s,inputId:o,color:c,size:m,name:b}=Rt(e,$e),h=S(Le({},e.modelModifiers,{trim:!1,lazy:!1,number:!1,nullify:!1})),$=S(null),v=()=>{var p;e.autofocus&&((p=$.value)==null||p.focus())},k=()=>{if(e.autoresize){if(!$.value)return;$.value.rows=e.rows;const p=$.value.style.overflow;$.value.style.overflow="hidden";const l=window.getComputedStyle($.value),u=Number.parseInt(l.paddingTop),R=Number.parseInt(l.paddingBottom),B=u+R,q=Number.parseInt(l.lineHeight),{scrollHeight:U}=$.value,F=(U-B)/q;F>e.rows&&($.value.rows=e.maxrows?Math.min(F,e.maxrows):F),$.value.style.overflow=p}},w=p=>{h.value.trim&&(p=p.trim()),h.value.number&&(p=on(p)),h.value.nullify&&(p||(p=null)),n("update:modelValue",p),s()},x=p=>{k(),h.value.lazy||w(p.target.value)},_=p=>{const l=p.target.value;n("change",l),h.value.lazy&&w(l),h.value.trim&&(p.target.value=l.trim())},g=p=>{n("blur",p),r()};_e(()=>{setTimeout(()=>{v()},e.autofocusDelay)}),me(()=>e.modelValue,()=>{ze(k)}),_e(()=>{setTimeout(()=>{v(),k()},100)});const d=j(()=>{var l,u;const p=((u=(l=t.value.color)==null?void 0:l[c.value])==null?void 0:u[e.variant])||t.value.variant[e.variant];return je(Pe(t.value.base,t.value.form,t.value.rounded,t.value.placeholder,t.value.size[m.value],e.padded?t.value.padding[m.value]:"p-0",p==null?void 0:p.replaceAll("{color}",c.value),!e.resize&&"resize-none"),e.textareaClass)});return{ui:t,attrs:i,name:b,inputId:o,textarea:$,textareaClass:d,onInput:x,onChange:_,onBlur:g}}}),En=["id","value","name","rows","required","disabled","placeholder"];function Wn(e,n,t,i,r,s){return f(),z("div",{class:L(e.ui.wrapper)},[I("textarea",he({id:e.inputId,ref:"textarea",value:e.modelValue,name:e.name,rows:e.rows,required:e.required,disabled:e.disabled,placeholder:e.placeholder,class:e.textareaClass},e.attrs,{onInput:n[0]||(n[0]=(...o)=>e.onInput&&e.onInput(...o)),onBlur:n[1]||(n[1]=(...o)=>e.onBlur&&e.onBlur(...o)),onChange:n[2]||(n[2]=(...o)=>e.onChange&&e.onChange(...o))}),null,16,En),Re(e.$slots,"default")],2)}const Hn=qe(Ln,[["render",Wn]]);async function Qn(e,n){return await Jn(n).catch(i=>(console.error("Failed to get image meta for "+n,i+""),{width:0,height:0,ratio:0}))}async function Jn(e){if(typeof Image>"u")throw new TypeError("Image not supported");return new Promise((n,t)=>{const i=new Image;i.onload=()=>{const r={width:i.width,height:i.height,ratio:i.width/i.height};n(r)},i.onerror=r=>t(r),i.src=e})}function vt(e){return n=>n?e[n]||n:e.missingValue}function Gn({formatter:e,keyMap:n,joinWith:t="/",valueMap:i}={}){e||(e=(s,o)=>`${s}=${o}`),n&&typeof n!="function"&&(n=vt(n));const r=i||{};return Object.keys(r).forEach(s=>{typeof r[s]!="function"&&(r[s]=vt(r[s]))}),(s={})=>Object.entries(s).filter(([c,m])=>typeof m<"u").map(([c,m])=>{const b=r[c];return typeof b=="function"&&(m=b(s[c])),c=typeof n=="function"?n(c):c,e(c,m)}).join(t)}function ye(e=""){if(typeof e=="number")return e;if(typeof e=="string"&&e.replace("px","").match(/^\d+$/g))return Number.parseInt(e,10)}function Kn(e=""){if(e===void 0||!e.length)return[];const n=new Set;for(const t of e.split(" ")){const i=Number.parseInt(t.replace("x",""));i&&n.add(i)}return Array.from(n)}function Xn(e){if(e.length===0)throw new Error("`densities` must not be empty, configure to `1` to render regular size only (DPR 1.0)")}function Yn(e){const n={};if(typeof e=="string")for(const t of e.split(/[\s,]+/).filter(i=>i)){const i=t.split(":");i.length!==2?n["1px"]=i[0].trim():n[i[0].trim()]=i[1].trim()}else Object.assign(n,e);return n}function Zn(e){const n={options:e},t=(r,s={})=>Tt(n,r,s),i=(r,s={},o={})=>t(r,{...o,modifiers:Le(s,o.modifiers||{})}).url;for(const r in e.presets)i[r]=(s,o,c)=>i(s,o,{...e.presets[r],...c});return i.options=e,i.getImage=t,i.getMeta=(r,s)=>ea(n,r,s),i.getSizes=(r,s)=>aa(n,r,s),n.$img=i,i}async function ea(e,n,t){const i=Tt(e,n,{...t});return typeof i.getMeta=="function"?await i.getMeta():await Qn(e,i.url)}function Tt(e,n,t){var b,h;if(n&&typeof n!="string")throw new TypeError(`input must be a string (received ${typeof n}: ${JSON.stringify(n)})`);if(!n||n.startsWith("data:"))return{url:n};const{provider:i,defaults:r}=ta(e,t.provider||e.options.provider),s=na(e,t.preset);if(n=ft(n)?n:sn(n),!i.supportsAlias){for(const $ in e.options.alias)if(n.startsWith($)){const v=e.options.alias[$];v&&(n=Ze(v,n.slice($.length)))}}if(i.validateDomains&&ft(n)){const $=rn(n).host;if(!e.options.domains.find(v=>v===$))return{url:n}}const o=Le(t,s,r);o.modifiers={...o.modifiers};const c=o.modifiers.format;(b=o.modifiers)!=null&&b.width&&(o.modifiers.width=ye(o.modifiers.width)),(h=o.modifiers)!=null&&h.height&&(o.modifiers.height=ye(o.modifiers.height));const m=i.getImage(n,o,e);return m.format=m.format||c||"",m}function ta(e,n){const t=e.options.providers[n];if(!t)throw new Error("Unknown provider: "+n);return t}function na(e,n){if(!n)return{};if(!e.options.presets[n])throw new Error("Unknown preset: "+n);return e.options.presets[n]}function aa(e,n,t){var w,x,_,g,d;const i=ye((w=t.modifiers)==null?void 0:w.width),r=ye((x=t.modifiers)==null?void 0:x.height),s=Yn(t.sizes),o=(_=t.densities)!=null&&_.trim()?Kn(t.densities.trim()):e.options.densities;Xn(o);const c=i&&r?r/i:0,m=[],b=[];if(Object.keys(s).length>=1){for(const p in s){const l=gt(p,String(s[p]),r,c,e);if(l!==void 0){m.push({size:l.size,screenMaxWidth:l.screenMaxWidth,media:`(max-width: ${l.screenMaxWidth}px)`});for(const u of o)b.push({width:l._cWidth*u,src:ht(e,n,t,l,u)})}}la(m)}else for(const p of o){const l=Object.keys(s)[0];let u=l?gt(l,String(s[l]),r,c,e):void 0;u===void 0&&(u={size:"",screenMaxWidth:0,_cWidth:(g=t.modifiers)==null?void 0:g.width,_cHeight:(d=t.modifiers)==null?void 0:d.height}),b.push({width:p,src:ht(e,n,t,u,p)})}oa(b);const h=b[b.length-1],$=m.length?m.map(p=>`${p.media?p.media+" ":""}${p.size}`).join(", "):void 0,v=$?"w":"x",k=b.map(p=>`${p.src} ${p.width}${v}`).join(", ");return{sizes:$,srcset:k,src:h==null?void 0:h.src}}function gt(e,n,t,i,r){const s=r.options.screens&&r.options.screens[e]||Number.parseInt(e),o=n.endsWith("vw");if(!o&&/^\d+$/.test(n)&&(n=n+"px"),!o&&!n.endsWith("px"))return;let c=Number.parseInt(n);if(!s||!c)return;o&&(c=Math.round(c/100*s));const m=i?Math.round(c*i):t;return{size:n,screenMaxWidth:s,_cWidth:c,_cHeight:m}}function ht(e,n,t,i,r){return e.$img(n,{...t.modifiers,width:i._cWidth?i._cWidth*r:void 0,height:i._cHeight?i._cHeight*r:void 0},t)}function la(e){var t;e.sort((i,r)=>i.screenMaxWidth-r.screenMaxWidth);let n=null;for(let i=e.length-1;i>=0;i--){const r=e[i];r.media===n&&e.splice(i,1),n=r.media}for(let i=0;i<e.length;i++)e[i].media=((t=e[i+1])==null?void 0:t.media)||""}function oa(e){e.sort((t,i)=>t.width-i.width);let n=null;for(let t=e.length-1;t>=0;t--){const i=e[t];i.width===n&&e.splice(t,1),n=i.width}}const sa=Gn({keyMap:{format:"f",fit:"fit",width:"w",height:"h",resize:"s",quality:"q",background:"b"},joinWith:"&",formatter:(e,n)=>pt(e)+"_"+pt(n)}),ia=(e,{modifiers:n={},baseURL:t}={},i)=>{n.width&&n.height&&(n.resize=`${n.width}x${n.height}`,delete n.width,delete n.height);const r=sa(n)||"_";return t||(t=Ze(i.options.nuxt.baseURL,"/_ipx")),{url:Ze(t,r,un(e))}},ra=!0,ua=!0,da=Object.freeze(Object.defineProperty({__proto__:null,getImage:ia,supportsAlias:ua,validateDomains:ra},Symbol.toStringTag,{value:"Module"})),jt={screens:{xs:320,sm:640,md:768,lg:1024,xl:1280,xxl:1536,"2xl":1536},presets:{},provider:"ipxStatic",domains:[],alias:{},densities:[1,2],format:["webp"]};jt.providers={ipxStatic:{provider:da,defaults:{}}};const dt=()=>{const e=dn(),n=_t();return n.$img||n._img||(n._img=Zn({...jt,nuxt:{baseURL:e.app.baseURL},runtimeConfig:e}))};function ca(e){var n;(n=performance==null?void 0:performance.mark)==null||n.call(performance,"mark_feature_usage",{detail:{feature:e}})}const ma={src:{type:String,required:!1},format:{type:String,required:!1},quality:{type:[Number,String],required:!1},background:{type:String,required:!1},fit:{type:String,required:!1},modifiers:{type:Object,required:!1},preset:{type:String,required:!1},provider:{type:String,required:!1},sizes:{type:[Object,String],required:!1},densities:{type:String,required:!1},preload:{type:[Boolean,Object],required:!1},width:{type:[String,Number],required:!1},height:{type:[String,Number],required:!1},alt:{type:String,required:!1},referrerpolicy:{type:String,required:!1},usemap:{type:String,required:!1},longdesc:{type:String,required:!1},ismap:{type:Boolean,required:!1},loading:{type:String,required:!1,validator:e=>["lazy","eager"].includes(e)},crossorigin:{type:[Boolean,String],required:!1,validator:e=>["anonymous","use-credentials","",!0,!1].includes(e)},decoding:{type:String,required:!1,validator:e=>["async","auto","sync"].includes(e)},nonce:{type:[String],required:!1}},fa=e=>{const n=j(()=>({provider:e.provider,preset:e.preset})),t=j(()=>({width:ye(e.width),height:ye(e.height),alt:e.alt,referrerpolicy:e.referrerpolicy,usemap:e.usemap,longdesc:e.longdesc,ismap:e.ismap,crossorigin:e.crossorigin===!0?"anonymous":e.crossorigin||void 0,loading:e.loading,decoding:e.decoding,nonce:e.nonce})),i=dt(),r=j(()=>({...e.modifiers,width:ye(e.width),height:ye(e.height),format:e.format,quality:e.quality||i.options.quality,background:e.background,fit:e.fit}));return{options:n,attrs:t,modifiers:r}},pa={...ma,placeholder:{type:[Boolean,String,Number,Array],required:!1},placeholderClass:{type:String,required:!1}},va=["src"],Se=H({__name:"NuxtImg",props:pa,emits:["load","error"],setup(e,{emit:n}){const t=e,i=cn(),r=n,s=!1,o=dt(),c=fa(t),m=S(!1),b=S(),h=j(()=>o.getSizes(t.src,{...c.options.value,sizes:t.sizes,densities:t.densities,modifiers:{...c.modifiers.value,width:ye(t.width),height:ye(t.height)}})),$=j(()=>{const g={...c.attrs.value,"data-nuxt-img":""};return(!t.placeholder||m.value)&&(g.sizes=h.value.sizes,g.srcset=h.value.srcset),g}),v=j(()=>{let g=t.placeholder;if(g===""&&(g=!0),!g||m.value)return!1;if(typeof g=="string")return g;const d=Array.isArray(g)?g:typeof g=="number"?[g,g]:[10,10];return o(t.src,{...c.modifiers.value,width:d[0],height:d[1],quality:d[2]||50,blur:d[3]||3},c.options.value)}),k=j(()=>t.sizes?h.value.src:o(t.src,c.modifiers.value,c.options.value)),w=j(()=>v.value?v.value:k.value),_=_t().isHydrating;return _e(()=>{if(v.value){const g=new Image;k.value&&(g.src=k.value),t.sizes&&(g.sizes=h.value.sizes||"",g.srcset=h.value.srcset),g.onload=d=>{m.value=!0,r("load",d)},ca("nuxt-image");return}b.value&&(b.value.complete&&_&&(b.value.getAttribute("data-error")?r("error",new Event("error")):r("load",new Event("load"))),b.value.onload=g=>{r("load",g)},b.value.onerror=g=>{r("error",g)})}),(g,d)=>(f(),z("img",he({ref_key:"imgEl",ref:b,class:t.placeholder&&!m.value?t.placeholderClass:void 0},{...a(s)?{onerror:"this.setAttribute('data-error', 1)"}:{},...$.value,...a(i)},{src:w.value}),null,16,va))}}),Oe=Ae(we.ui.strategy,we.ui.range,Fn),ga=H({inheritAttrs:!1,props:{modelValue:{type:Number,default:0},id:{type:String,default:null},name:{type:String,default:null},disabled:{type:Boolean,default:!1},min:{type:Number,default:0},max:{type:Number,default:100},step:{type:Number,default:1},size:{type:String,default:null,validator(e){return Object.keys(Oe.size).includes(e)}},color:{type:String,default:()=>Oe.default.color,validator(e){return we.ui.colors.includes(e)}},inputClass:{type:String,default:null},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})}},emits:["update:modelValue","change"],setup(e,{emit:n}){const{ui:t,attrs:i}=De("range",Fe(e,"ui"),Oe),{emitFormChange:r,inputId:s,color:o,size:c,name:m}=Rt(e,Oe),b=j({get(){return e.modelValue},set(g){n("update:modelValue",g)}}),h=g=>{n("change",g.target.value),r()},$=j(()=>je(Pe(t.value.wrapper,t.value.size[c.value]),e.class)),v=j(()=>je(Pe(t.value.base,t.value.background,t.value.rounded,o.value&&t.value.ring.replaceAll("{color}",o.value),t.value.size[c.value]),e.inputClass)),k=j(()=>Pe(t.value.thumb.base,o.value&&t.value.thumb.color.replaceAll("{color}",o.value),t.value.thumb.ring,t.value.thumb.background,t.value.thumb.size[c.value])),w=j(()=>Pe(t.value.track.base,t.value.track.background,t.value.track.rounded,t.value.track.size[c.value])),x=j(()=>Pe(t.value.progress.base,t.value.progress.rounded,o.value&&t.value.progress.background.replaceAll("{color}",o.value),t.value.progress.size[c.value])),_=j(()=>{const{modelValue:g,min:d,max:p}=e;return{width:`${(Math.max(d,Math.min(g,p))-d)/(p-d)*100}%`}});return{ui:t,attrs:i,name:m,inputId:s,value:b,wrapperClass:$,inputClass:v,thumbClass:k,trackClass:w,progressClass:x,progressStyle:_,onChange:h}}}),ha=["id","name","min","max","disabled","step"];function ya(e,n,t,i,r,s){return f(),z("div",{class:L(e.wrapperClass)},[lt(I("input",he({id:e.inputId,ref:"input","onUpdate:modelValue":n[0]||(n[0]=o=>e.value=o),name:e.name,min:e.min,max:e.max,disabled:e.disabled,step:e.step,type:"range",class:[e.inputClass,e.thumbClass,e.trackClass]},e.attrs,{onChange:n[1]||(n[1]=(...o)=>e.onChange&&e.onChange(...o))}),null,16,ha),[[mn,e.value,void 0,{number:!0}]]),I("span",{class:L(e.progressClass),style:wt(e.progressStyle)},null,6)],2)}const Ot=qe(ga,[["render",ya]]),wa={class:"image-mask flex flex-col w-full"},ba={class:"canvas flex flex-col items-center justify-center mb-3 w-full"},ka={class:"preview-over-original relative"},xa={class:"actions flex items-center justify-center mb-3 mx-auto"},_a={class:"options w-full max-w-[320px]"},Ia=H({__name:"ImageInpaint",props:tt({imageSrc:{type:String,required:!0}},{imageInpaintMask:{default:"",type:String},imageInpaintMaskModifiers:{},imageInpaintMaskData:{default:{},type:Object},imageInpaintMaskDataModifiers:{}}),emits:["update:imageInpaintMask","update:imageInpaintMaskData"],setup(e){const n=e,t=et(e,"imageInpaintMask"),i=et(e,"imageInpaintMaskData"),r=fe(),s=S(null),o=S(null),c=S(null),m=S(null),b=S(30),h=S([]),$=S({width:r.$state.outputMaxSize,height:r.$state.outputMaxSize}),v=S(null),k=S({x:0,y:0}),w=S({x:0,y:0,radius:b.value,fill:"rgba(255, 255, 255, 0.5)",stroke:null,strokeWidth:0,visible:!1}),x=S(5),_=S(!1),g=S([]),d=S([]);function p(){if(!s.value||!c.value){console.error("Could not get stage, image layer, or mask layer");return}const O=s.value.getNode(),N=m.value?m.value.width:O.width(),T=m.value?m.value.height:O.height(),G=document.createElement("canvas");G.width=N,G.height=T;const K=G.getContext("2d");if(!K){console.error("Could not get 2d context for mask canvas");return}K.fillStyle="black",K.fillRect(0,0,N,T);const de=N/O.width(),ce=T/O.height();K.fillStyle="white",h.value.forEach(Ie=>{K.beginPath(),K.arc(Ie.x*de,Ie.y*ce,Ie.radius*Math.max(de,ce),0,Math.PI*2,!0),K.closePath(),K.fill()});const ve=G.toDataURL("image/png",1);ve?(F(),t.value=ve,w.value.visible=!1,_.value=!1):console.error("Could not get data URI for masked image")}function l(O){const N=s.value.getNode();if(O.type.startsWith("touch")){const T=O.evt.touches[0]||O.evt.changedTouches[0];return{x:T.clientX-N.getContainer().offsetLeft,y:T.clientY-N.getContainer().offsetTop}}return N.getPointerPosition()}function u(O){O.type==="mousedown"&&O.evt.button!==0||(_.value=!0,k.value=l(O),U(),R(k.value))}function R(O){const N={x:O.x,y:O.y,radius:b.value,fill:"rgba(255, 255, 255, 1)"};h.value=h.value.filter(T=>!(B({x:T.x,y:T.y},O)+T.radius<=N.radius)),h.value.push(N)}function B(O,N){return Math.sqrt(Math.pow(N.x-O.x,2)+Math.pow(N.y-O.y,2))}function q(O){if(O.type.startsWith("touch")&&O.evt.preventDefault(),Z(O),!_.value)return;const N=l(O);B(k.value,l(O))>=x.value&&(R(N),k.value=N)}function U(){g.value.push([...h.value]),d.value=[]}function F(){i.value={circles:[...h.value],brushRadius:b.value,undoStack:g.value,redoStack:d.value}}function D(){i.value!==null&&(h.value=i.value.circles||[],b.value=i.value.brushRadius||30,g.value=i.value.undoStack||[],d.value=i.value.redoStack||[])}function ee(){g.value.length!==0&&(d.value.push([...h.value]),h.value=g.value.pop()||[])}function E(){d.value.length!==0&&(g.value.push([...h.value]),h.value=d.value.pop()||[])}function ge(){_.value=!1}function Me(){t.value=""}function re(){U(),h.value=[],t.value=""}const Q=j(()=>g.value.length>0),te=j(()=>d.value.length>0);function Z(O){const N=l(O);w.value.x=N.x,w.value.y=N.y}function ue(){w.value.visible=!1,_.value=!1}function ke(){w.value.visible=!0,w.value.radius=b.value}function W(){const O=new Image;O.src=n.imageSrc,O.onload=()=>{m.value=O,le(),Ce()}}function le(){if(!m.value)return;const O=window.innerWidth,N=window.innerHeight,T=m.value.width/m.value.height;let G,K;const de=Math.min(O*.9,1200),ce=Math.min(N*.8,r.outputMaxSize);T>de/ce?(G=de,K=G/T):(K=ce,G=K*T),$.value={width:Math.floor(G),height:Math.floor(K)},Ce()}function Ce(){const O=$.value.width,N=$.value.height,T=m.value.width,G=m.value.height,K=O/T,de=N/G,ce=Math.min(K,de);v.value={x:0,y:0,width:T*ce,height:G*ce}}return ot(()=>{W(),D()}),_e(()=>{if(s.value){const O=s.value.getNode();O.on("touchstart",u),O.on("touchmove",q),O.on("touchend",ge),O.on("touchcancel",ue)}}),It(()=>{if(s.value){const O=s.value.getNode();O.off("touchstart"),O.off("touchmove"),O.off("touchend"),O.off("touchcancel")}F()}),(O,N)=>{const T=Se,G=xe("v-image"),K=xe("v-layer"),de=xe("v-circle"),ce=xe("v-stage"),ve=ne,Ie=Ot,J=rt;return f(),z("div",wa,[I("div",ba,[N[1]||(N[1]=I("p",{class:"text-sm my-2 text-slate-500"},"Select the target area for image inpaint",-1)),I("div",ka,[e.imageSrc&&e.imageSrc!==""&&t.value!==""?(f(),M(T,{key:0,src:e.imageSrc,fit:"inside",width:a($).width,height:a($).height,draggable:"false",class:L({absolute:t.value!==""})},null,8,["src","width","height","class"])):C("",!0),t.value?(f(),M(T,{key:1,src:t.value,fit:"inside",width:a($).width,height:a($).height,draggable:"false",class:"opacity-50"},null,8,["src","width","height"])):C("",!0)]),t.value===""?(f(),M(ce,{key:0,ref_key:"stageRef",ref:s,config:a($),onMousedown:u,onMousemove:q,onMouseup:ge,onMouseleave:ue,onMouseenter:ke},{default:P(()=>[y(K,{ref_key:"imageLayerRef",ref:o},{default:P(()=>[y(G,{image:a(m),config:a($)},null,8,["image","config"])]),_:1},512),y(K,{ref_key:"maskLayerRef",ref:c},{default:P(()=>[(f(!0),z(X,null,ie(a(h),(Ke,Nt)=>(f(),M(de,{key:Nt,config:Ke},null,8,["config"]))),128)),a(w).visible?(f(),M(de,{key:0,config:a(w)},null,8,["config"])):C("",!0)]),_:1},512)]),_:1},8,["config"])):C("",!0)]),I("div",xa,[y(ve,{class:"mr-2",size:"xs",icon:"i-heroicons-clipboard-document-check-16-solid",variant:"soft",disabled:a(h).length===0||t.value!=="",onClick:p},{default:P(()=>N[2]||(N[2]=[V(" Apply ")])),_:1},8,["disabled"]),y(ve,{class:"mr-2",size:"xs",icon:"i-heroicons-arrow-uturn-left-16-solid",variant:"soft",color:"cyan",disabled:!a(Q)||t.value!=="",onClick:ee},null,8,["disabled"]),y(ve,{class:"mr-2",size:"xs",icon:"i-heroicons-arrow-uturn-right-16-solid",variant:"soft",color:"cyan",disabled:!a(te)||t.value!=="",onClick:E},null,8,["disabled"]),y(ve,{class:"mr-2",size:"xs",icon:"i-heroicons-arrow-turn-up-left-20-solid",variant:"soft",disabled:a(h).length===0&&t.value==="",color:"red",onClick:re},{default:P(()=>N[3]||(N[3]=[V(" Reset ")])),_:1},8,["disabled"]),y(ve,{size:"xs",icon:"i-heroicons-pencil-solid",variant:"soft",disabled:t.value==="",color:"orange",onClick:Me},{default:P(()=>N[4]||(N[4]=[V(" Edit ")])),_:1},8,["disabled"])]),I("div",_a,[y(J,{class:"mb-3 text-sm",hint:`value: ${a(b)}`,label:"Brush radius"},{default:P(()=>[y(Ie,{modelValue:a(b),"onUpdate:modelValue":N[0]||(N[0]=Ke=>Y(b)?b.value=Ke:null),min:1,max:100,size:"sm",class:"my-2",disabled:t.value!==""},null,8,["modelValue","disabled"])]),_:1},8,["hint"])])])}}}),$a="0.05";function Sa(e,n){const t=parseFloat(e);if(isNaN(t))return e;const i=t+n;return i<0?"0":String(Number(i.toFixed(10)))}function Ma(e,n){let t=n,i=n,r=0,s=0;for(;t>=0&&(t--,!(e[t]==="("&&r===s));)e[t]==="("&&r++,e[t]===")"&&s++;if(t<0)return!1;for(r=0,s=0;i<e.length&&!(e[i]===")"&&r===s);)e[i]==="("&&r++,e[i]===")"&&s++,i++;return i===e.length?!1:{start:t+1,end:i}}function Ca(e){const n=/^\((.*)\)$/,t=e.match(n),i=/:([+-]?(\d*\.)?\d+([eE][+-]?\d+)?)/,r=e.match(i);return t&&!r?`(${t[1]}:1.0)`:e}function Pa(e){const n=e.composedPath()[0],t=parseFloat($a);if(n.tagName!=="TEXTAREA"||!(e.key==="ArrowUp"||e.key==="ArrowDown")||!e.ctrlKey&&!e.metaKey)return;e.preventDefault();let i=n.selectionStart,r=n.selectionEnd,s=n.value.substring(i,r);if(!s){const m=Ma(n.value,i);if(m)i=m.start,r=m.end,s=n.value.substring(i,r);else{const b=" .,\\/!?%^*;:{}=-_`~()\r\n	";for(;!b.includes(n.value[i-1])&&i>0;)i--;for(;!b.includes(n.value[r])&&r<n.value.length;)r++;if(s=n.value.substring(i,r),!s)return}}s[s.length-1]===" "&&(s=s.substring(0,s.length-1),r-=1),n.value[i-1]==="("&&n.value[r]===")"&&(i-=1,r+=1,s=n.value.substring(i,r)),(s[0]!=="("||s[s.length-1]!==")")&&(s=`(${s})`),s=Ca(s);const o=e.key==="ArrowUp"?t:-t,c=s.replace(/\((.*):(\d+(?:\.\d+)?)\)/,(m,b,h)=>(h=Sa(h,o),Number(h)==1?b:`(${b}:${h})`));return n.setRangeText(c,i,r,"select"),n.value}const Ra={key:0,class:"text-red-300"},za={key:0,class:"flex items-center"},Fa={key:2,class:"flex flex-row flex-grow items-center justify-between"},Ua={key:3,class:"flex flex-row flex-grow items-center"},Ta={class:"sm:inline"},ja={class:"preview-over-original relative"},Oa={key:1,class:"text-red-300 text-sm"},Ba=H({__name:"InputParam",props:{inputParam:{type:Object,required:!0},index:{type:Number,required:!0},inputParamsMap:{type:Array,required:!0},advanced:{type:Boolean,default:!1}},setup(e){const n=e,t=S(!1),i=S(null),r=S(""),s=S({width:0,height:0}),o=S(""),c=S({}),m=S(null),b=n.inputParamsMap[n.index][n.inputParam.name].source_input_name,h=n.inputParamsMap.findIndex(l=>{if(Object.keys(l)[0]===n.inputParamsMap[n.index][n.inputParam.name].source_input_name)return!0});function $(){try{const l=n.inputParamsMap.find(u=>{const R=Object.keys(u)[0];if(R===b)return u[R]});_(l[b].value)}catch{s.value.width=0,s.value.height=0}}_e(()=>{n.inputParam.type==="range_scale"&&$(),n.inputParam.type==="image-mask"&&me(o,l=>{const u=new File([o.value],`image-mask-${n.inputParam.name}.png`,{type:"image/png"});n.inputParamsMap[n.index][n.inputParam.name].value=u,n.inputParamsMap[n.index][n.inputParam.name].mask_applied=l!==""})}),n.inputParam.type==="range_scale"&&me(n.inputParamsMap,()=>{$()});function v(l){return l?URL.createObjectURL(l):""}function k(){URL.revokeObjectURL(r.value),r.value="",i.value&&(i.value.$refs.input.value=""),n.inputParamsMap[n.index][n.inputParam.name].value=null,n.inputParamsMap[n.index][n.inputParam.name].image_preview_url=""}function w(){URL.revokeObjectURL(o.value),o.value="",c.value={},n.inputParamsMap[n.index][n.inputParam.name].value=null,n.inputParamsMap[n.index][n.inputParam.name].mask_applied=!1}const x=j(()=>n.inputParam.type!=="bool"?n.inputParam.display_name:"");function _(l){if(!(l instanceof File)){s.value.width=0,s.value.height=0;return}const u=URL.createObjectURL(l),R=new Image;R.onload=function(){s.value.width=R.naturalWidth,s.value.height=R.naturalHeight,URL.revokeObjectURL(R.src)},R.src=u}const g=j(()=>{if(n.inputParam.type==="range_scale"){const l=n.inputParamsMap[n.index][n.inputParam.name].value;return`value: ${l}x (${s.value.width}x${s.value.height} -> ${(s.value.width*l).toFixed(0)}x${(s.value.height*l).toFixed(0)})`}return["range","range_scale"].includes(n.inputParam.type)?`value: ${n.inputParamsMap[n.index][n.inputParam.name].value}`:""}),d=S(null);function p(l){const u=Pa(l);u&&(n.inputParamsMap[n.index][n.inputParam.name].value=u)}return _e(()=>{n.inputParam.type==="text"&&d.value&&d.value.$refs.textarea.addEventListener("keydown",p),n.inputParam.type==="image-mask"&&(m.value=n.inputParamsMap[h][b],me(n.inputParamsMap[h][b],l=>{o.value="",c.value={},m.value=l}))}),It(()=>{URL.revokeObjectURL(r.value),URL.revokeObjectURL(o.value),n.inputParam.type==="text"&&d.value&&d.value.$refs.textarea.removeEventListener("keydown",p)}),(l,u)=>{var re;const R=Hn,B=it,q=ne,U=Se,F=Ia,D=Ue,ee=Pt,E=ut,ge=Ot,Me=rt;return(((re=e.inputParam)==null?void 0:re.advanced)||!1)===e.advanced?(f(),M(Me,{key:0,label:a(x),class:"mb-3",help:a(g)},{hint:P(()=>[e.inputParam.optional?C("",!0):(f(),z("span",Ra,"required"))]),default:P(()=>{var Q,te,Z,ue,ke;return[e.inputParam.type==="text"?(f(),M(R,{key:0,ref_key:"textareaInput",ref:d,size:"md",placeholder:e.inputParam.display_name,required:!e.inputParam.optional,resize:!0,label:e.inputParam.display_name,value:e.inputParamsMap[e.index][e.inputParam.name].value,autoresize:"",variant:"outline",onInput:u[0]||(u[0]=W=>{const le=W.target;e.inputParamsMap[e.index][e.inputParam.name].value=le.value})},null,8,["placeholder","required","label","value"])):C("",!0),e.inputParam.type==="number"?(f(),z(X,{key:1},[e.inputParam.name==="seed"?(f(),z("div",za,[e.inputParam.type==="number"?(f(),M(B,{key:0,modelValue:e.inputParamsMap[e.index][e.inputParam.name].value,"onUpdate:modelValue":u[1]||(u[1]=W=>e.inputParamsMap[e.index][e.inputParam.name].value=W),type:"number",label:e.inputParam.display_name,required:!e.inputParam.optional,max:e.inputParam.max||100,min:e.inputParam.min||0,variant:"outline"},null,8,["modelValue","label","required","max","min"])):C("",!0),y(q,{icon:"i-heroicons-arrow-path",color:"violet",variant:"outline",size:"xs",class:"ml-2",onClick:u[2]||(u[2]=()=>{e.inputParamsMap[e.index][e.inputParam.name].value=Math.floor(Math.random()*1e7)})})])):(f(),M(B,{key:1,modelValue:e.inputParamsMap[e.index][e.inputParam.name].value,"onUpdate:modelValue":u[3]||(u[3]=W=>e.inputParamsMap[e.index][e.inputParam.name].value=W),type:"number",label:e.inputParam.display_name,required:!e.inputParam.optional,max:e.inputParam.max||100,min:e.inputParam.min||0,variant:"outline"},null,8,["modelValue","label","required","max","min"]))],64)):C("",!0),e.inputParam.type==="image"?(f(),z("div",Fa,[y(B,{ref_key:"imageInput",ref:i,type:"file",accept:"image/*",class:"w-full",variant:"outline",color:"gray",label:e.inputParam.display_name,onChange:u[4]||(u[4]=W=>{console.debug("files",W);const le=W==null?void 0:W[0];e.inputParamsMap[e.index][e.inputParam.name].value=le,r.value=v(le),e.inputParamsMap[e.index][e.inputParam.name].image_preview_url=a(r),console.debug("inputParamsMap",e.inputParamsMap)})},null,8,["label"]),a(r)!==""?(f(),M(U,{key:0,src:a(o)?a(o):a(r),class:"h-10 rounded-lg cursor-pointer ml-2",onClick:u[5]||(u[5]=()=>{t.value=!0})},null,8,["src"])):C("",!0),a(r)!==""?(f(),M(q,{key:1,icon:"i-heroicons-x-mark",variant:"outline",class:"ml-2",onClick:k})):C("",!0)])):C("",!0),e.inputParam.type==="image-mask"?(f(),z("div",Ua,[a(m)?(f(),M(q,{key:0,icon:"i-heroicons-paint-brush-16-solid",class:"mr-2",color:"violet",variant:"outline",size:"xs",disabled:!((Q=a(m))!=null&&Q.value),onClick:u[6]||(u[6]=()=>{t.value=!0})},{default:P(()=>[I("span",Ta,A(a(o)!==""?"Edit mask":"Draw mask"),1)]),_:1},8,["disabled"])):C("",!0),I("div",ja,[a(m)&&((te=a(m))!=null&&te.value)?(f(),M(U,{key:0,src:(Z=a(m))==null?void 0:Z.image_preview_url,class:L(["h-10 rounded-lg cursor-pointer",{absolute:a(o)!==""}]),onClick:u[7]||(u[7]=()=>{t.value=!0})},null,8,["src","class"])):C("",!0),a(o)?(f(),M(U,{key:1,src:a(o),class:"h-10 rounded-lg cursor-pointer opacity-50",onClick:u[8]||(u[8]=()=>{t.value=!0})},null,8,["src"])):C("",!0)]),!a(m)||a(m)&&!((ue=a(m))!=null&&ue.value)?(f(),z("span",Oa," Select source image ")):C("",!0),a(o)?(f(),M(q,{key:2,icon:"i-heroicons-x-mark",variant:"outline",color:"violet",class:"ml-2",onClick:w})):C("",!0)])):C("",!0),e.inputParam.type==="image"||e.inputParam.type==="image-mask"?(f(),M(D,{key:4,modelValue:a(t),"onUpdate:modelValue":u[13]||(u[13]=W=>Y(t)?t.value=W:null),class:"z-[90] overflow-y-auto",transition:!1,fullscreen:""},{default:P(()=>{var W;return[y(q,{class:"absolute top-4 right-4 z-[100]",icon:"i-heroicons-x-mark",variant:"ghost",onClick:u[9]||(u[9]=()=>t.value=!1)}),e.inputParam.type==="image"?(f(),z("div",{key:0,class:"flex items-center justify-center w-full h-full p-4",onClick:u[10]||(u[10]=Ee(()=>t.value=!1,["left"]))},[y(U,{class:"lg:h-full",fit:"inside",src:a(r)},null,8,["src"])])):(f(),M(F,{key:1,ref:"imageInpaint","image-inpaint-mask":a(o),"onUpdate:imageInpaintMask":u[11]||(u[11]=le=>Y(o)?o.value=le:null),"image-inpaint-mask-data":a(c),"onUpdate:imageInpaintMaskData":u[12]||(u[12]=le=>Y(c)?c.value=le:null),class:"flex items-center justify-center w-full h-full p-4","image-src":(W=a(m))==null?void 0:W.image_preview_url},null,8,["image-inpaint-mask","image-inpaint-mask-data","image-src"]))]}),_:1},8,["modelValue"])):C("",!0),e.inputParam.type==="list"?(f(),M(ee,{key:5,modelValue:e.inputParamsMap[e.index][e.inputParam.name].value,"onUpdate:modelValue":u[14]||(u[14]=W=>e.inputParamsMap[e.index][e.inputParam.name].value=W),placeholder:e.inputParam.display_name,options:Object.keys(e.inputParam.options)},null,8,["modelValue","placeholder","options"])):C("",!0),e.inputParam.type==="bool"?(f(),M(E,{key:6,modelValue:e.inputParamsMap[e.index][e.inputParam.name].value,"onUpdate:modelValue":u[15]||(u[15]=W=>e.inputParamsMap[e.index][e.inputParam.name].value=W),label:(ke=e.inputParam)==null?void 0:ke.display_name},null,8,["modelValue","label"])):C("",!0),["range","range_scale"].includes(e.inputParam.type)?(f(),M(ge,{key:7,modelValue:e.inputParamsMap[e.index][e.inputParam.name].value,"onUpdate:modelValue":u[16]||(u[16]=W=>e.inputParamsMap[e.index][e.inputParam.name].value=W),label:e.inputParam.display_name,size:"sm",min:e.inputParam.min,max:e.inputParam.max,step:e.inputParam.step},null,8,["modelValue","label","min","max","step"])):C("",!0)]}),_:1},8,["label","help"])):C("",!0)}}}),Na={key:0,class:"heading"},Va={key:1},qa=H({__name:"InputParams",props:{inputParamsMap:{type:Array,required:!0},additionalInputParamsMap:{type:Array,required:!1,default:[]},advanced:{type:Boolean,default:!1}},setup(e){const n=e,t=fe(),i=S(!n.advanced);return(r,s)=>{const o=be,c=Ba;return f(),z(X,null,[e.advanced?(f(),z("div",Na,[I("h4",{class:"text-md font-bold cursor-pointer select-none flex items-center mb-3",onClick:s[0]||(s[0]=()=>{i.value=!a(i)})},[y(o,{name:a(i)?"i-heroicons-chevron-up":"i-heroicons-chevron-down",class:"mr-2"},null,8,["name"]),s[1]||(s[1]=V(" Advanced options "))])])):C("",!0),a(i)?(f(),z("div",Va,[(f(!0),z(X,null,ie(a(t).currentFlow.input_params,(m,b)=>(f(),M(c,{key:b,"input-params-map":e.inputParamsMap,index:b,"input-param":m,advanced:e.advanced},null,8,["input-params-map","index","input-param","advanced"]))),128)),(f(!0),z(X,null,ie(e.additionalInputParamsMap,(m,b)=>(f(),M(c,{key:Object.keys(m)[0],"input-params-map":e.additionalInputParamsMap,index:b,"input-param":m[Object.keys(m)[0]],advanced:e.advanced},null,8,["input-params-map","index","input-param","advanced"]))),128))])):C("",!0)],64)}}}),Da={key:0,id:"prompt",class:"w-full my-10 lg:my-0 p-4 ring-1 ring-gray-200 dark:ring-gray-800 rounded-lg"},Aa={class:"action flex items-center"},La=H({__name:"Prompt",setup(e,{expose:n}){var _,g,d,p;const t=fe();let i=localStorage.getItem(`input_params_map_${(_=t.currentFlow)==null?void 0:_.name}`);if(i){const l=JSON.parse(i);"flow_version"in l&&l.flow_version.split(".")[0]===((g=t.currentFlow)==null?void 0:g.version.split(".")[0])?i=l:(i=null,localStorage.removeItem(`input_params_map_${(d=t.currentFlow)==null?void 0:d.name}`))}const r=S(((p=t.currentFlow)==null?void 0:p.input_params.map(l=>{var u;if(l.type==="text")return{[l.name]:{value:i!==null&&i[l.name]?i[l.name]:l.default||"",type:l.type,optional:l.optional,advanced:l.advanced||!1,default:l.default||"",translatable:l.translatable||!1}};if(l.type==="number")return{[l.name]:{value:i!==null&&i[l.name]?i[l.name]:l.default||0,type:l.type,optional:l.optional,advanced:l.advanced||!1,default:l.default||0}};if(l.type==="image")return{[l.name]:{value:null,type:l.type,optional:l.optional,advanced:l.advanced||!1}};if(l.type==="image-mask")return{[l.name]:{value:null,type:l.type,optional:l.optional,advanced:l.advanced||!1,source_input_name:l.source_input_name||null}};if(l.type==="list")return{[l.name]:{value:i!==null&&i[l.name]?i[l.name]:l.default||Object.keys(l.options)[0]||"",type:l.type,optional:l.optional,options:l.options,advanced:l.advanced||!1,default:Object.keys(l.options)[0]||""}};if(l.type==="bool")return{[l.name]:{value:i!==null&&i[l.name]?i[l.name]:l.default||!1,type:l.type,optional:l.optional,advanced:l.advanced||!1,default:l.default||!1}};if(["range","range_scale"].includes(l.type)){const R={value:i!==null&&i[l.name]?i[l.name]:l.default||0,type:l.type,optional:l.optional,advanced:l.advanced||!1,min:l.min||0,max:l.max||100,step:l.step||1,default:l.default||0};if(l.type==="range_scale"&&(R.source_input_name=l.source_input_name||null,R.source_input_name===null||R.source_input_name==="")){const B=(u=t.currentFlow)==null?void 0:u.input_params.find(q=>q.type==="image"&&!q.optional);B&&(R.source_input_name=B.name)}return{[l.name]:R}}}))||[]),s=S([]);t.currentFlow.is_seed_supported&&s.value.push({seed:{name:"seed",display_name:"Random seed",value:Math.floor(Math.random()*1e7),type:"number",optional:!0,advanced:!0,min:0,max:1e7}});const o=fn(),c=S(t.currentFlow.is_translations_supported&&o.settingsMap.translations_provider.value.trim()!==""),m=S(c.value);ot(()=>{const l=localStorage.getItem("translatePrompt");l&&(m.value=JSON.parse(l))}),me(m,l=>{localStorage.setItem("translatePrompt",JSON.stringify(l))});function b(l){console.debug("Copy prompt inputs",l),Object.keys(l).forEach(R=>{const B=r.value.findIndex(q=>Object.keys(q)[0]===R);B!==-1&&(r.value[B][R].value=l[R].value)});const u=document.getElementById("prompt");u&&u.scrollIntoView({behavior:"smooth"})}n({copyPromptInputs:b}),r.value.forEach(l=>{const u=Object.keys(l)[0];["image","image-mask"].includes(l[u].type)||me(()=>l[u].value,()=>{var B,q;const R={};r.value.forEach(U=>{const F=Object.keys(U)[0];R[F]=U[F].value}),localStorage.setItem(`input_params_map_${(B=t.currentFlow)==null?void 0:B.name}`,JSON.stringify({...R,flow_version:(q=t.currentFlow)==null?void 0:q.version}))})});const h=j(()=>r.value.filter(l=>{const u=Object.keys(l)[0];return!["image","image-mask"].includes(l[u].type)}).some(l=>{const u=Object.keys(l)[0];return l[u].value!==l[u].default}));function $(){r.value.forEach(l=>{const u=Object.keys(l)[0];l[u].type==="text"?l[u].value=l[u].default||"":l[u].type==="number"?l[u].value=l[u].default||l[u].min||0:l[u].type==="list"?l[u].value=Object.keys(l[u].options)[0]||"":l[u].type==="bool"?l[u].value=l[u].default||!1:["range","range_scale"].includes(l[u].type)&&(l[u].value=l[u].default||l[u].min||0)})}const v=S(!1),k=S(1),w=S(!1),x=j(()=>r.value.every(l=>{var B;const u=Object.keys(l)[0];if(l[u].optional)return!0;const R=l[u].value;if(l[u].type==="text")return R!=="";if(l[u].type==="number")return R>=l[u].min&&R<=l[u].max;if(l[u].type==="list")return R!==""&&Object.keys(l[u].options).includes(R);if(l[u].type==="bool")return!0;if(l[u].type==="range")return R>=l[u].min&&R<=l[u].max;if(l[u].type==="range_scale")return R>=l[u].min&&R<=l[u].max;if(l[u].type==="image")return R instanceof File&&R.size>0;if(l[u].type==="image-mask")return R instanceof File&&R.size>0&&(((B=l[u])==null?void 0:B.mask_applied)||!1)}));return(l,u)=>{const R=be,B=qa,q=it,U=rt,F=ut,D=ne,ee=We;return a(t).currentFlow?(f(),z("div",Da,[I("h2",{class:"text-lg font-bold cursor-pointer select-none flex items-center mb-3",onClick:u[0]||(u[0]=()=>{w.value=!a(w)})},[y(R,{name:a(w)?"i-heroicons-chevron-down":"i-heroicons-chevron-up",class:"mr-2"},null,8,["name"]),u[8]||(u[8]=V(" Prompt "))]),lt(I("div",null,[y(B,{"input-params-map":a(r),"onUpdate:inputParamsMap":u[1]||(u[1]=E=>Y(r)?r.value=E:null),"additional-input-params-map":a(s),"onUpdate:additionalInputParamsMap":u[2]||(u[2]=E=>Y(s)?s.value=E:null),advanced:!1},null,8,["input-params-map","additional-input-params-map"]),a(s).length>0?(f(),M(B,{key:0,"input-params-map":a(r),"onUpdate:inputParamsMap":u[3]||(u[3]=E=>Y(r)?r.value=E:null),"additional-input-params-map":a(s),"onUpdate:additionalInputParamsMap":u[4]||(u[4]=E=>Y(s)?s.value=E:null),advanced:!0},null,8,["input-params-map","additional-input-params-map"])):C("",!0),a(t).currentFlow.is_count_supported?(f(),M(U,{key:1,label:"Number of results"},{default:P(()=>[y(q,{modelValue:a(k),"onUpdate:modelValue":u[5]||(u[5]=E=>Y(k)?k.value=E:null),type:"number",min:"1",max:"50",label:"Batch size",class:"mb-3 max-w-fit flex justify-end"},null,8,["modelValue"])]),_:1})):C("",!0),a(c)?(f(),M(U,{key:2,class:"my-3 flex justify-end"},{default:P(()=>[y(F,{modelValue:a(m),"onUpdate:modelValue":u[6]||(u[6]=E=>Y(m)?m.value=E:null),label:"Translate prompt"},null,8,["modelValue"])]),_:1})):C("",!0),I("div",{class:L(["flex",{"justify-between":a(h),"justify-end":!a(h)}])},[a(h)?(f(),M(ee,{key:0,text:"Reset input params values to defaults"},{default:P(()=>[y(D,{icon:"i-heroicons-arrow-path-rounded-square",variant:"ghost",color:"amber",onClick:$},{default:P(()=>u[9]||(u[9]=[V(" Reset params ")])),_:1})]),_:1})):C("",!0),I("div",Aa,[y(D,{icon:"i-heroicons-sparkles-16-solid",variant:"outline",loading:a(v),disabled:!a(x),onClick:u[7]||(u[7]=()=>{v.value=!0,a(t).runFlow(a(t).currentFlow,[...a(r),...a(s)],a(k),a(c)&&a(m)).finally(()=>{v.value=!1;const E=a(s).find(ge=>Object.keys(ge)[0]==="seed");E.seed.value=Number(E.seed.value)+a(k)+1})})},{default:P(()=>u[10]||(u[10]=[V(" Run prompt ")])),_:1},8,["loading","disabled"])])],2)],512),[[$t,!a(w)]])])):C("",!0)}}}),Ea=e=>{const n=S(0);function t(s){e.value.style.scrollSnapType="none",e.value.style.scrollBehavior="auto",n.value=s.pageX,window.addEventListener("mousemove",r),window.addEventListener("mouseup",i)}function i(){e.value.style.removeProperty("scroll-behavior"),e.value.style.removeProperty("scroll-snap-type"),e.value.style.removeProperty("pointer-events"),window.removeEventListener("mousemove",r),window.removeEventListener("mouseup",i)}function r(s){s.preventDefault(),e.value.style.pointerEvents="none";const o=s.pageX-n.value;n.value=s.pageX,e.value.scrollBy(-o,0)}_e(()=>{e.value&&e.value.addEventListener("mousedown",t)}),Ne(()=>{e.value&&e.value.removeEventListener("mousedown",t)})},Ye=Ae(we.ui.strategy,we.ui.carousel,zn),Wa=H({components:{UButton:ne},inheritAttrs:!1,props:{items:{type:Array,default:()=>[]},arrows:{type:Boolean,default:!1},indicators:{type:Boolean,default:!1},dir:{type:String,default:"ltr"},prevButton:{type:Object,default:()=>Ye.default.prevButton},nextButton:{type:Object,default:()=>Ye.default.nextButton},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:void 0}},setup(e,{expose:n}){const{ui:t,attrs:i}=De("carousel",Fe(e,"ui"),Ye,Fe(e,"class")),r=S(),s=S(0),{x:o}=pn(r,{behavior:"smooth"}),{width:c}=vn(r);Ea(r),gn(r,_=>{var d,p;const[g]=_;s.value=((p=(d=g==null?void 0:g.target)==null?void 0:d.firstElementChild)==null?void 0:p.clientWidth)||0});const m=j(()=>e.dir==="rtl"),b=j(()=>s.value?m.value?Math.round(-o.value/s.value)+1:Math.round(o.value/s.value)+1:0),h=j(()=>{if(!s.value)return 0;const _=Math.round(c.value/s.value);return e.items.length<=_?0:e.items.length-_+1}),$=j(()=>b.value<=1),v=j(()=>b.value===h.value);function k(){o.value+=m.value?-s.value:s.value}function w(){o.value-=m.value?-s.value:s.value}function x(_){o.value=(_-1)*s.value*(m.value?-1:1)}return n({pages:h,page:b,prev:w,next:k,select:x}),{ui:t,attrs:i,isFirst:$,isLast:v,carouselRef:r,pages:h,currentPage:b,onClickNext:k,onClickPrev:w,onClick:x,twMerge:je}}}),Ha=["dir"],Qa=["role"],Ja=["aria-selected","aria-label","onClick"];function Ga(e,n,t,i,r,s){const o=ne;return f(),z("div",he({class:e.ui.wrapper},e.attrs,{dir:e.dir}),[I("div",{ref:"carouselRef",class:L([e.ui.container,"no-scrollbar"])},[(f(!0),z(X,null,ie(e.items,(c,m)=>(f(),z("div",{key:m,class:L(e.ui.item),role:e.indicators?"tabpanel":null},[Re(e.$slots,"default",{item:c,index:m},void 0,!0)],10,Qa))),128))],2),e.arrows?(f(),z("div",{key:0,class:L(e.ui.arrows.wrapper)},[Re(e.$slots,"prev",{onClick:e.onClickPrev,disabled:e.isFirst},()=>{var c;return[e.prevButton?(f(),M(o,he({key:0,disabled:e.isFirst},{...e.ui.default.prevButton,...e.prevButton},{class:e.twMerge(e.ui.default.prevButton.class,(c=e.prevButton)==null?void 0:c.class),"aria-label":"Prev",onClick:e.onClickPrev}),null,16,["disabled","class","onClick"])):C("",!0)]},!0),Re(e.$slots,"next",{onClick:e.onClickNext,disabled:e.isLast},()=>{var c;return[e.nextButton?(f(),M(o,he({key:0,disabled:e.isLast},{...e.ui.default.nextButton,...e.nextButton},{class:e.twMerge(e.ui.default.nextButton.class,(c=e.nextButton)==null?void 0:c.class),"aria-label":"Next",onClick:e.onClickNext}),null,16,["disabled","class","onClick"])):C("",!0)]},!0)],2)):C("",!0),e.indicators?(f(),z("div",{key:1,role:"tablist",class:L(e.ui.indicators.wrapper)},[(f(!0),z(X,null,ie(e.pages,c=>Re(e.$slots,"indicator",{key:c,onClick:e.onClick,active:c===e.currentPage,page:c},()=>[I("button",{type:"button",role:"tab","aria-selected":c===e.currentPage,class:L([e.ui.indicators.base,c===e.currentPage?e.ui.indicators.active:e.ui.indicators.inactive]),"aria-label":`set slide ${c}`,onClick:m=>e.onClick(c)},null,10,Ja)],!0)),128))],2)):C("",!0)],16,Ha)}const Ge=qe(Wa,[["render",Ga],["__scopeId","data-v-5fdb8633"]]),Ka={class:"flex flex-col basis-full"},Xa=H({__name:"InputFiles",props:{running:{type:Object,required:!0}},setup(e){const n=dt(),t=function(c,m){return`${St()}/tasks/inputs?task_id=${c}&input_index=${m}`},i=S(!1),r=S(""),s=S(0),o=S(!0);return(c,m)=>{var w,x,_,g,d;const b=be,h=Se,$=Ge,v=ne,k=Ue;return e.running&&e.running.input_files&&((w=Object.keys(e.running.input_files))==null?void 0:w.length)>0?(f(),z("div",{key:0,class:L(["ml-2 mt-2 mb-5",{"mb-10":((x=Object.keys(e.running.input_files))==null?void 0:x.length)>1&&!a(o)}])},[I("h4",{class:"mb-3 font-bold cursor-pointer select-none flex items-center text-sm",onClick:m[0]||(m[0]=()=>o.value=!a(o))},[y(b,{name:a(o)?"i-heroicons-chevron-down":"i-heroicons-chevron-up",class:"mr-2"},null,8,["name"]),I("span",null," Input files ("+A((_=Object.keys(e.running.input_files))==null?void 0:_.length)+") ",1)]),a(o)?C("",!0):(f(),z(X,{key:0},[((g=Object.keys(e.running.input_files))==null?void 0:g.length)===1?(f(),M(h,{key:0,class:"mb-5 rounded-lg cursor-pointer",fit:"outside",loading:"lazy",placeholder:a(n)(`${("buildBackendUrl"in c?c.buildBackendUrl:a(nt))()}/vix_logo.png`,{f:"png",blur:3,q:50}),src:t(e.running.task_id,0),onClick:m[1]||(m[1]=()=>{r.value=t(e.running.task_id,0),s.value=0,i.value=!0})},null,8,["placeholder","src"])):C("",!0),((d=Object.keys(e.running.input_files))==null?void 0:d.length)>1?(f(),M($,{key:1,items:Object.keys(e.running.input_files).map(p=>({task_id:e.running.task_id,index:p})),ui:{item:"basis-full md:basis-1/2",indicators:{wrapper:"relative bottom-0 mt-4"}},page:1,indicators:""},{default:P(({item:p})=>[I("div",Ka,[y(h,{class:"rounded-lg cursor-pointer",fit:"outside",loading:"lazy",placeholder:a(n)(`${("buildBackendUrl"in c?c.buildBackendUrl:a(nt))()}/vix_logo.png`,{f:"png",blur:3,q:50}),src:t(p.task_id,p.index),onClick:()=>{r.value=t(e.running.task_id,p.index),s.value=p.index,i.value=!0}},null,8,["placeholder","src","onClick"])])]),_:1},8,["items"])):C("",!0),y(k,{modelValue:a(i),"onUpdate:modelValue":m[4]||(m[4]=p=>Y(i)?i.value=p:null),class:"z-[90]",transition:!1,fullscreen:""},{default:P(()=>[y(v,{class:"absolute top-4 right-4",icon:"i-heroicons-x-mark",variant:"ghost",onClick:m[2]||(m[2]=()=>i.value=!1)}),I("div",{class:"flex items-center justify-center w-full h-full p-4",onClick:m[3]||(m[3]=Ee(()=>i.value=!1,["left"]))},[a(r)?(f(),M(h,{key:0,class:"lg:h-full",fit:"inside",loading:"lazy",placeholder:"/vix_logo.png",src:a(r)},null,8,["src"])):C("",!0)])]),_:1},8,["modelValue"])],64))],2)):C("",!0)}}}),Ya=H({__name:"ErrorAlert",props:{running:{type:Object,required:!0}},setup(e){const n=fe(),t=S(!1);return(i,r)=>{const s=Ft;return f(),M(s,{class:"mb-5",icon:"i-heroicons-exclamation-circle-16-solid",color:"red",variant:"soft",title:"Task failed",description:e.running.error,actions:[{variant:"outline",color:"yellow",label:"Restart",loading:a(t),icon:"i-heroicons-arrow-path",click:()=>{t.value=!0,a(n).restartFlow(e.running).finally(()=>{t.value=!1})}}]},null,8,["description","actions"])}}}),Za={class:"mb-5"},el={class:"text-sm mb-5 text-slate-500"},tl={class:"flex justify-between"},nl=H({__name:"Item",props:{running:{type:Object,required:!0}},setup(e){const n=fe(),t=S(!1),i=S(!1);function r(s){return[[{label:"Comfy flow",labelClass:"text-blue-500",icon:"i-heroicons-arrow-down-tray",iconClass:"bg-blue-500",click:()=>{var o;return n.downloadFlowComfy((o=n.currentFlow)==null?void 0:o.name,s.task_id)}}],[{label:`Raise priority ${s.priority>0?`(${s.priority})`:""}`,labelClass:"text-gray-500",icon:"i-heroicons-arrow-up",iconClass:"bg-gray-500",disabled:s.priority===15||s.progress>0,click:()=>{i.value=!0,n.raiseQueuePriority(s).finally(()=>{i.value=!1})}},{label:`Lower priority ${s.priority>0?`(${s.priority})`:""}`,labelClass:"text-gray-500",icon:"i-heroicons-arrow-down",iconClass:"bg-gray-500",disabled:s.priority===0||s.progress>0,click:()=>{i.value=!0,n.lowerQueuePriority(s).finally(()=>{i.value=!1})}},{label:`Reset priority ${s.priority>0?`(${s.priority})`:""}`,labelClass:"text-gray-500",icon:"i-heroicons-arrow-path-rounded-square-solid",iconClass:"bg-gray-500",disabled:s.priority===0||s.progress>0,click:()=>{i.value=!0,n.resetQueuePriority(s).finally(()=>{i.value=!1})}}]]}return(s,o)=>{var v,k;const c=zt,m=Xa,b=Ya,h=ne,$=Je;return f(),z("div",Za,[y(c,{class:"mb-3",value:(v=e.running)==null?void 0:v.progress,indicator:"",color:e.running.error?"red":"green"},null,8,["value","color"]),I("p",el,A([`${(k=e.running)!=null&&k.priority&&e.running.priority>0?"["+e.running.priority+"] ":""}#${e.running.task_id}`,...Object.keys(e.running.input_params_mapped).filter(w=>e.running.input_params_mapped[w].value&&e.running.input_params_mapped[w].value!=="").map(w=>`${e.running.input_params_mapped[w].display_name}: ${e.running.input_params_mapped[w].value}`)].join(" | ")+`${e.running.execution_time?" | execution_time: "+e.running.execution_time.toFixed(2)+"s":""}`),1),y(m,{running:e.running},null,8,["running"]),e.running.error?(f(),M(b,{key:0,running:e.running},null,8,["running"])):C("",!0),I("div",tl,[y(h,{icon:e.running.progress>=0&&e.running.progress<100?"i-heroicons-stop":"i-heroicons-minus-circle",color:e.running.error?"red":"orange",variant:"outline",loading:a(t),onClick:o[0]||(o[0]=()=>{t.value=!0,a(n).cancelRunningFlow(e.running).finally(()=>{t.value=!1})})},{default:P(()=>[V(A(e.running.progress>=0&&e.running.progress<100?"Cancel":"Remove"),1)]),_:1},8,["icon","color","loading"]),y($,{items:r(e.running),mode:"click",popper:{placement:"bottom-end"}},{default:P(()=>[y(h,{color:"blue",variant:"outline",icon:"i-heroicons-ellipsis-vertical-16-solid"})]),_:1},8,["items"])])])}}}),al={class:"w-full p-4 ring-1 ring-gray-200 dark:ring-gray-800 rounded-lg shadow-md mt-5 mb-10"},ll={class:"flex items-center justify-between mb-2"},ol={key:0},sl={key:1,class:"text-red-400"},il=H({__name:"Queue",setup(e){const n=fe(),t=S(!0),i=S(!1);return(r,s)=>{var b,h,$,v,k,w,x,_,g;const o=be,c=ne,m=nl;return f(),z("div",al,[I("div",ll,[I("h2",{class:"text-lg font-bold cursor-pointer select-none flex items-center",onClick:s[0]||(s[0]=()=>{t.value=!a(t)})},[y(o,{name:a(t)?"i-heroicons-chevron-down":"i-heroicons-chevron-up",class:"mr-2"},null,8,["name"]),I("span",null," Queue ("+A(a(n).flowsRunningByName((b=a(n).currentFlow)==null?void 0:b.name).length)+") ",1),a(n).flowsRunningByName((h=a(n).currentFlow)==null?void 0:h.name).length>0?(f(),z("span",ol,"  - "+A(`${((v=a(n).flowsRunningByName(($=a(n).currentFlow)==null?void 0:$.name).filter(d=>d.progress>0)[0])==null?void 0:v.progress.toFixed(0))??0}%`),1)):C("",!0),a(n).flowsRunningByNameWithErrors((k=a(n))==null?void 0:k.currentFlow.name).length>0?(f(),z("span",sl,"  ("+A(a(n).flowsRunningByNameWithErrors((w=a(n).currentFlow)==null?void 0:w.name).length)+") ",1)):C("",!0)]),(x=a(n).currentFlow)!=null&&x.name&&a(n).flowsRunningByName((_=a(n).currentFlow)==null?void 0:_.name).length>0?(f(),M(c,{key:0,icon:"i-heroicons-stop",color:"orange",variant:"outline",loading:a(i),onClick:s[1]||(s[1]=()=>{var d;i.value=!0,a(n).cancelRunningFlows((d=a(n).currentFlow)==null?void 0:d.name).finally(()=>{i.value=!1})})},{default:P(()=>s[2]||(s[2]=[V(" Cancel all ")])),_:1},8,["loading"])):C("",!0)]),a(t)?C("",!0):(f(!0),z(X,{key:0},ie(a(n).flowsRunningByName((g=a(n).currentFlow)==null?void 0:g.name),d=>(f(),M(m,{key:d.task_id,running:d},null,8,["running"]))),128))])}}}),rl=H({__name:"ScrollToTop",props:{show:{type:Boolean,required:!0},target:{type:String,required:!0}},setup(e){const n=e;function t(){const i=document.getElementById(n.target);i&&i.scrollIntoView({behavior:"smooth"})}return(i,r)=>{const s=ne;return e.show?(f(),M(s,{key:0,icon:"i-heroicons-arrow-small-up",color:"black",variant:"outline",onClick:t})):C("",!0)}}});function Bt(e={}){const{copy:n,isSupported:t}=hn(),i=He();function r(s,o={},c={}){t&&n(s).then(()=>{!o.title&&!o.description||i.add({...o,...e})},function(m){i.add({...c,description:c.description||m.message,...e})})}return{copy:r}}const ul={class:"flex flex-col items-center mb-2 max-w-fit mx-auto z-0"},dl={class:"text-slate-500 text-center text-sm w-full mx-auto flex flex-wrap items-center justify-center md:justify-between"},cl={class:"toggles py-2"},ml={class:"mr-2 inline-flex items-center text-sm"},fl=["for"],pl={class:"mr-2 inline-flex items-center text-sm"},vl=["for"],gl={key:0,class:"flex items-center"},hl=["title"],yl=H({__name:"Child",props:{flowResult:{type:Object,required:!0},outputsIndex:{type:Number,required:!1,default:()=>0},openImageModal:{type:Function,required:!0}},setup(e){const n=e,t=fe(),i=(d,p=null,l=!1)=>{if(d.child_tasks.length===0)return d;const u=d.child_tasks.findIndex(R=>R.parent_task_node_id===p);return u!==-1?(l||(s.value=d),i(d.child_tasks[u],d.child_tasks[u].outputs[0].comfy_node_id,l)):d};function r(d,p,l=null){if(l!==null&&d.parent_task_node_id===l||Number(d.task_id)===p)return d;for(let u=0;u<d.child_tasks.length;u++)for(let R=0;R<d.child_tasks[u].outputs.length;R++){const B=r(d.child_tasks[u],p,d.child_tasks[u].outputs[R].comfy_node_id);if(B!==null)return B}return null}const s=S(n.flowResult),o=S(i(n.flowResult,n.flowResult.outputs[n.outputsIndex].comfy_node_id,!1));function c(d){var p;return[[{label:`${(p=t.flowByName((d==null?void 0:d.flow_name)??(d==null?void 0:d.name)))==null?void 0:p.display_name}#${d.task_id}`,disabled:!0}],[{label:"View image",icon:"i-heroicons-eye",click:()=>{n.openImageModal(se({task_id:d.task_id,node_id:d.outputs.length>1?d.outputs[n.outputsIndex].comfy_node_id:d.outputs[0].comfy_node_id}))}}]]}function m(d){var l;const p=[[{label:`${(l=t.flowByName((d==null?void 0:d.flow_name)??(d==null?void 0:d.name)))==null?void 0:l.display_name}#${d.task_id}`,disabled:!0}],[{label:"View image",icon:"i-heroicons-eye",disabled:d.progress<100||d.error!=="",click:()=>{n.openImageModal(se({task_id:d.task_id,node_id:d.outputs.length>1?d.outputs[n.outputsIndex].comfy_node_id:d.outputs[0].comfy_node_id}))}},{label:d.progress<100?"Cancel":"Delete",labelClass:d.progress<100?"text-orange-500":"text-red-500",icon:d.progress<100?"i-heroicons-stop":"i-heroicons-trash",iconClass:d.progress<100?"bg-orange-500":"bg-red-500",click:()=>{t.deleteFlowHistory(d.task_id).then(()=>{const u=r(n.flowResult,d.parent_task_id,d.parent_task_node_id);u&&(u.child_tasks=u.child_tasks.filter(R=>Number(R.task_id)!==Number(d.task_id))),w(!1,n.flowResult)})}}]];return d.progress<100&&(p[0][1]={label:`Progress: ${Math.ceil(d.progress)}% (${d.execution_time.toFixed(2)}s)`,labelClass:"text-blue-500",disabled:!0}),d.error!==""&&p[0].push({label:`Error: ${d.error}`,labelClass:"text-red-500",slot:"error",click:()=>{Bt().copy(d.error),He().add({title:"Clipboard",description:`Task #${d.task_id} error copied to clipboard`,timeout:2e3})}}),p}function b(){const d=s.value.parent_task_id;if(!d)return;const p=r(n.flowResult,d,s.value.parent_task_node_id);p&&(s.value=p)}function h(){if(s.value.child_tasks.length===0)return;const d=s.value.outputs.length>1?s.value.outputs[n.outputsIndex].comfy_node_id:s.value.outputs[0].comfy_node_id,p=s.value.child_tasks.find(l=>l.parent_task_node_id===d);p&&(s.value=p)}const $=j(()=>{if(s.value.child_tasks.length===0)return;const d=s.value.outputs.length>1?s.value.outputs[n.outputsIndex].comfy_node_id:s.value.outputs[0].comfy_node_id;return s.value.child_tasks.find(l=>l.parent_task_node_id===d).task_id!==o.value.task_id});function v(){const d=o.value.parent_task_id;if(!d)return;const p=r(n.flowResult,d,o.value.parent_task_node_id);p&&(o.value=p)}function k(){if(o.value.child_tasks.length===0)return;const d=Number(o.value.outputs[0].comfy_node_id),p=o.value.child_tasks.find(l=>Number(l.parent_task_node_id)===d);p&&(o.value=p)}function w(d=!1,p=null){d||(s.value=p),o.value=i(p,p==null?void 0:p.outputs[n.outputsIndex].comfy_node_id,d),x.value=!1}me(n.flowResult,d=>{w(!0,d)});const x=S(!1),_=S(!0),g=S(null);return me(x,d=>{d?(g.value=s.value,s.value=n.flowResult):g.value&&(s.value=g.value,o.value=Mt(g.value,n.outputsIndex,s.value.outputs.length>1?s.value.outputs[n.outputsIndex].comfy_node_id:s.value.outputs[0].comfy_node_id))}),(d,p)=>{const l=Se,u=xe("ImgComparisonSlider"),R=Pn,B=ne,q=Je,U=be,F=We;return f(),z("div",ul,[lt(y(l,{class:"mb-2 rounded-lg cursor-pointer",height:a(t).outputMaxSize,width:a(t).outputMaxSize,draggable:"false",fit:"cover",loading:"lazy",src:("outputResultSrc"in d?d.outputResultSrc:a(se))({task_id:a(o).progress===100?a(o).task_id:e.flowResult.task_id,node_id:a(o).progress===100?a(o).outputs[0].comfy_node_id:e.flowResult.outputs[e.outputsIndex].comfy_node_id}),onClick:p[0]||(p[0]=D=>e.openImageModal(("outputResultSrc"in d?d.outputResultSrc:a(se))({task_id:a(o).task_id??e.flowResult.task_id,node_id:a(o).outputs[0].comfy_node_id??e.flowResult.outputs[e.outputsIndex].comfy_node_id})))},null,8,["height","width","src"]),[[$t,!a(_)]]),a(_)?(f(),M(u,{key:0,class:"mb-2 mx-auto outline-none w-fit rounded-lg"},{default:P(()=>{var D,ee,E;return[y(l,{slot:"first",height:a(t).outputMaxSize,width:a(t).outputMaxSize,fit:"cover",draggable:"false",src:("outputResultSrc"in d?d.outputResultSrc:a(se))({task_id:a(x)?e.flowResult.task_id:a(s).task_id,node_id:a(x)?e.flowResult.outputs[e.outputsIndex].comfy_node_id:a(s).parent_task_node_id!==null?(D=a(s))==null?void 0:D.outputs[0].comfy_node_id:((ee=a(s))==null?void 0:ee.outputs[e.outputsIndex].comfy_node_id)??((E=a(s))==null?void 0:E.outputs[0].comfy_node_id)})},null,8,["height","width","src"]),a(o)&&a(o).progress===100?(f(),M(l,{key:0,slot:"second",height:a(t).outputMaxSize,width:a(t).outputMaxSize,fit:"cover",draggable:"false",src:("outputResultSrc"in d?d.outputResultSrc:a(se))({task_id:a(o).task_id,node_id:a(o).outputs[0].comfy_node_id})},null,8,["height","width","src"])):(f(),M(l,{key:1,slot:"second",height:a(t).outputMaxSize,width:a(t).outputMaxSize,fit:"cover",draggable:"false",src:`${("buildBackendUrl"in d?d.buildBackendUrl:a(nt))()}/vix_logo.png`},null,8,["height","width","src"]))]}),_:1})):C("",!0),I("div",dl,[I("div",cl,[I("div",ml,[y(R,{id:`toggle-compare-${e.flowResult.task_id}-${e.outputsIndex}`,modelValue:a(_),"onUpdate:modelValue":p[1]||(p[1]=D=>Y(_)?_.value=D:null),size:"xs",class:"mr-2"},null,8,["id","modelValue"]),I("label",{class:"cursor-pointer select-none",for:`toggle-compare-${e.flowResult.task_id}-${e.outputsIndex}`}," Comparison ",8,fl)]),I("div",pl,[y(R,{id:`toggle-original-${e.flowResult.task_id}-${e.outputsIndex}`,modelValue:a(x),"onUpdate:modelValue":p[2]||(p[2]=D=>Y(x)?x.value=D:null),disabled:!a(_),size:"xs",class:"mr-2"},null,8,["id","modelValue","disabled"]),I("label",{class:"cursor-pointer select-none",for:`toggle-original-${e.flowResult.task_id}-${e.outputsIndex}`}," Original ",8,vl)])]),a(_)?(f(),z("div",gl,[y(B,{icon:"i-heroicons-arrow-small-left-20-solid",size:"2xs",variant:"soft",color:"cyan",disabled:a(x)||a(s).parent_task_id===null,onClick:b},null,8,["disabled"]),y(q,{items:c(a(s)),mode:"click",popper:{placement:"top"}},{default:P(()=>[y(B,{variant:"link",color:"white",size:"xs"},{default:P(()=>[V(" #"+A(a(x)?e.flowResult.task_id:a(s).task_id),1)]),_:1})]),_:1},8,["items"]),y(B,{icon:"i-heroicons-arrow-small-right-20-solid",size:"2xs",variant:"soft",color:"cyan",disabled:a(x)||!a($),onClick:h},null,8,["disabled"]),y(U,{class:"mx-3",name:"i-heroicons-arrows-right-left-16-solid"}),y(B,{icon:"i-heroicons-arrow-small-left-20-solid",size:"2xs",variant:"soft",color:"cyan",disabled:!r(n.flowResult,a(o).parent_task_id,a(o).parent_task_node_id)||a(o).parent_task_id===Number(a(s).task_id)||a(o).parent_task_id===null,onClick:v},null,8,["disabled"]),y(q,{items:m(a(o)),mode:"click",popper:{placement:"top"}},{error:P(({item:D})=>[I("div",{class:"text-red-500 truncate",title:D.label},A(D.label),9,hl)]),default:P(()=>[y(B,{class:L({"text-blue-500":a(o).progress!==100&&a(o).error==="","text-red-500":a(o).error!==""}),variant:"link",color:"white",size:"xs"},{default:P(()=>[V(A(a(o).progress===100?"#"+a(o).task_id:Math.ceil(a(o).progress)+"%"),1)]),_:1},8,["class"])]),_:1},8,["items"]),y(B,{icon:"i-heroicons-arrow-small-right-20-solid",size:"2xs",variant:"soft",color:"cyan",disabled:a(o).child_tasks.length===0,onClick:k},null,8,["disabled"]),y(F,{class:"ml-3",text:"Reset comparison",popper:{placement:"top"}},{default:P(()=>[y(B,{icon:"i-heroicons-arrow-path-rounded-square-solid",size:"2xs",variant:"outline",color:"white",onClick:p[3]||(p[3]=()=>w(!1,e.flowResult))})]),_:1})])):C("",!0)])])}}}),wl={class:"image-output"},bl={class:"flex flex-col basis-full justify-between mx-2"},kl=H({__name:"Image",props:{flowResult:{type:Object,required:!0},handleSendToFlow:{type:Function,required:!0},openImageModal:{type:Function,required:!0}},setup(e){const n=fe();return(t,i)=>{var m,b;const r=yl,s=Se,o=ne,c=Ge;return f(),z("div",wl,[e.flowResult.outputs.length===1?(f(),z(X,{key:0},[(m=e.flowResult)!=null&&m.child_tasks&&((b=e.flowResult)==null?void 0:b.child_tasks.length)>0?(f(),M(r,{key:0,"flow-result":e.flowResult,"open-image-modal":e.openImageModal},null,8,["flow-result","open-image-modal"])):e.flowResult.outputs.length===1?(f(),M(s,{key:1,class:"mb-2 mx-auto rounded-lg cursor-pointer",height:a(n).$state.outputMaxSize,width:a(n).$state.outputMaxSize,draggable:"false",fit:"cover",loading:"lazy",src:("outputResultSrc"in t?t.outputResultSrc:a(se))({task_id:e.flowResult.task_id,node_id:e.flowResult.outputs[0].comfy_node_id}),onClick:i[0]||(i[0]=h=>e.openImageModal(("outputResultSrc"in t?t.outputResultSrc:a(se))({task_id:e.flowResult.task_id,node_id:e.flowResult.outputs[0].comfy_node_id})))},null,8,["height","width","src"])):C("",!0)],64)):e.flowResult.outputs.length>1?(f(),M(c,{key:1,class:"mb-3 rounded-lg overflow-hidden",items:e.flowResult.outputs.map((h,$)=>({task_id:e.flowResult.task_id,node_id:h.comfy_node_id,index:$})),ui:{item:"basis-full md:basis-1/2",indicators:{wrapper:"relative bottom-0 mt-4 md:hidden"}},page:1,indicators:""},{default:P(({item:h})=>{var $;return[I("div",bl,[($=e.flowResult)!=null&&$.child_tasks&&("hasChildTaskByParentTaskNodeId"in t?t.hasChildTaskByParentTaskNodeId:a(Ct))(e.flowResult,h.index,h.node_id)?(f(),M(r,{key:0,"flow-result":e.flowResult,"outputs-index":h.index,"open-image-modal":e.openImageModal},null,8,["flow-result","outputs-index","open-image-modal"])):(f(),M(s,{key:1,class:L(`mb-2 h-100 max-h-[${a(n).$state.outputMaxSize}px] mx-auto rounded-lg cursor-pointer`),draggable:"false",height:a(n).$state.outputMaxSize,width:a(n).$state.outputMaxSize,fit:"cover",loading:"lazy",src:("outputResultSrc"in t?t.outputResultSrc:a(se))(h),onClick:v=>e.openImageModal(("outputResultSrc"in t?t.outputResultSrc:a(se))(h))},null,8,["class","height","width","src","onClick"])),y(o,{class:"mt-2 w-fit mx-auto",icon:"i-heroicons-arrow-uturn-up-solid",color:"violet",size:"xs",variant:"outline",onClick:()=>{e.handleSendToFlow(e.flowResult,h.index)}},{default:P(()=>i[1]||(i[1]=[V(" Send to flow ")])),_:2},1032,["onClick"])])]}),_:1},8,["items"])):C("",!0)])}}}),xl={class:"image-output"},_l=["width","height"],Il=["src"],$l={class:"flex flex-col basis-full justify-between mx-2"},Sl=["width","height"],Ml=["src"],Cl=H({__name:"Video",props:{flowResult:{type:Object,required:!0},handleSendToFlow:{type:Function,required:!0},openImageModal:{type:Function,required:!0}},setup(e){const n=fe();return(t,i)=>{const r=ne,s=Ge;return f(),z("div",xl,[e.flowResult.outputs.length===1?(f(),z("video",{key:0,controls:"",class:"mb-2 mx-auto rounded-lg",style:{"max-height":"80vh"},width:a(n).$state.outputMaxSize,height:a(n).$state.outputMaxSize},[I("source",{src:("outputResultSrc"in t?t.outputResultSrc:a(se))({task_id:e.flowResult.task_id,node_id:e.flowResult.outputs[0].comfy_node_id})},null,8,Il)],8,_l)):e.flowResult.outputs.length>1?(f(),M(s,{key:1,class:"mb-3 rounded-lg overflow-hidden",items:e.flowResult.outputs.map((o,c)=>({task_id:e.flowResult.task_id,node_id:o.comfy_node_id,index:c})),ui:{item:"basis-full md:basis-1/2",indicators:{wrapper:"relative bottom-0 mt-4 md:hidden"}},page:1,indicators:""},{default:P(({item:o})=>[I("div",$l,[I("video",{controls:"",class:"mb-2 mx-auto rounded-lg",width:a(n).$state.outputMaxSize,height:a(n).$state.outputMaxSize},[I("source",{src:("outputResultSrc"in t?t.outputResultSrc:a(se))({task_id:e.flowResult.task_id,node_id:e.flowResult.outputs[0].comfy_node_id})},null,8,Ml)],8,Sl),y(r,{class:"mt-2 w-fit mx-auto",icon:"i-heroicons-arrow-uturn-up-solid",color:"violet",size:"xs",variant:"outline",onClick:()=>{e.handleSendToFlow(e.flowResult,o.index)}},{default:P(()=>i[0]||(i[0]=[V(" Send to flow ")])),_:2},1032,["onClick"])])]),_:1},8,["items"])):C("",!0)])}}}),Pl=H({__name:"Params",props:{flowResult:{type:Object,required:!0}},setup(e){const n=e,t=S(!1),i=j(()=>["#"+n.flowResult.task_id,...Object.keys(n.flowResult.input_params_mapped).filter(r=>n.flowResult.input_params_mapped[r].value&&n.flowResult.input_params_mapped[r].value!=="").map(r=>t.value&&n.flowResult.translated_input_params_mapped&&n.flowResult.translated_input_params_mapped[r]?`${n.flowResult.input_params_mapped[r].display_name}: ${n.flowResult.translated_input_params_mapped[r].value}`:`${n.flowResult.input_params_mapped[r].display_name}: ${n.flowResult.input_params_mapped[r].value}`)].join(" | ")+`${n.flowResult.execution_time?" | execution_time: "+n.flowResult.execution_time.toFixed(2)+"s":""}`);return Ne(()=>{n.flowResult.showInputFiles=!1}),(r,s)=>{const o=ne,c=We,m=st,b=be;return f(),z(X,null,[e.flowResult.translated_input_params_mapped&&Object.keys(e.flowResult.translated_input_params_mapped).length>0?(f(),M(c,{key:0,text:a(t)?"Hide translated input params":"Show translated input params",popper:{placement:"top"}},{default:P(()=>[y(o,{class:"mb-2 mr-2",color:"white",size:"xs",variant:"outline",icon:"i-heroicons-language-solid",onClick:s[0]||(s[0]=()=>{t.value=!a(t)})})]),_:1},8,["text"])):C("",!0),(f(!0),z(X,null,ie(a(i).split("|"),h=>(f(),M(m,{key:h,class:"mr-2 mb-2 last:mr-0 hover:cursor-pointer",variant:"soft",color:"gray",onClick:()=>{("useCopyToClipboard"in r?r.useCopyToClipboard:a(Bt))().copy(h.split(":")[1].trim()),("useToast"in r?r.useToast:a(He))().add({title:"Clipboard",description:`${h.split(":")[0].trim()} copied to clipboard`,timeout:2e3})}},{default:P(()=>[V(A(h),1)]),_:2},1032,["onClick"]))),128)),e.flowResult.input_files.length>0?(f(),M(m,{key:1,class:"mr-2 mb-2 last:mr-0 hover:cursor-pointer select-none",variant:"subtle",color:"sky",onClick:s[1]||(s[1]=()=>{e.flowResult.showInputFiles=!e.flowResult.showInputFiles})},{default:P(()=>[y(b,{name:e.flowResult.showInputFiles?"i-heroicons-chevron-down":"i-heroicons-chevron-up",class:"mr-1"},null,8,["name"]),y(b,{name:"i-heroicons-document-solid",class:"mr-1"}),V(" "+A(`input_files: ${e.flowResult.input_files.length}`),1)]),_:1})):C("",!0)],64)}}}),Rl={key:0,class:L("w-full p-1")},zl={class:"flex flex-col basis-full justify-between mx-2"},Fl=H({__name:"InputFiles",props:{flowResult:{type:Object,required:!0}},setup(e){const n=fe(),t=(o,c)=>`${St()}/tasks/inputs?task_id=${o}&input_index=${c}`,i=S(!1),r=S(""),s=S(0);return(o,c)=>{var v,k;const m=Se,b=Ge,h=ne,$=Ue;return e.flowResult.showInputFiles?(f(),z("div",Rl,[((v=Object.keys(e.flowResult.input_files))==null?void 0:v.length)===1?(f(),M(m,{key:0,class:L(`mb-5 mx-auto rounded-lg cursor-pointer max-h-[${a(n).$state.outputMaxSize}px] w-auto`),fit:"outside",loading:"lazy",src:t(e.flowResult.task_id,0),onClick:c[0]||(c[0]=()=>{r.value=t(e.flowResult.task_id,0),s.value=0,i.value=!0})},null,8,["class","src"])):C("",!0),((k=Object.keys(e.flowResult.input_files))==null?void 0:k.length)>1?(f(),M(b,{key:1,items:Object.keys(e.flowResult.input_files).map(w=>({task_id:e.flowResult.task_id,index:w})),ui:{item:"basis-full md:basis-1/2",indicators:{wrapper:"relative bottom-0 my-2"}},page:1,indicators:""},{default:P(({item:w})=>[I("div",zl,[y(m,{class:L(`mb-5 mx-auto rounded-lg cursor-pointer max-h-[${a(n).$state.outputMaxSize}px] w-auto`),fit:"outside",loading:"lazy",draggable:"false",src:t(w.task_id,w.index),onClick:()=>{r.value=t(e.flowResult.task_id,w.index),s.value=w.index,i.value=!0}},null,8,["class","src","onClick"])])]),_:1},8,["items"])):C("",!0),y($,{modelValue:a(i),"onUpdate:modelValue":c[3]||(c[3]=w=>Y(i)?i.value=w:null),class:"z-[90]",transition:!1,fullscreen:""},{default:P(()=>[y(h,{class:"absolute top-4 right-4",icon:"i-heroicons-x-mark",variant:"ghost",onClick:c[1]||(c[1]=()=>i.value=!1)}),I("div",{class:"flex items-center justify-center w-full h-full p-4",onClick:c[2]||(c[2]=Ee(()=>i.value=!1,["left"]))},[a(r)?(f(),M(m,{key:0,class:"lg:h-full",fit:"inside",loading:"lazy",placeholder:"/vix_logo.png",src:a(r)},null,8,["src"])):C("",!0)])]),_:1},8,["modelValue"])])):C("",!0)}}}),Ul={class:"p-4"},Tl={class:"flex justify-center mb-4"},jl={key:0,class:"text-sm text-slate-500 text-center mb-4"},Ol={class:"text-md text-center text-red-500 mb-4"},Bl={key:1},Nl={class:"flex items-center justify-between"},Vl=H({__name:"SendToFlowModal",props:tt({flowResult:{type:Object,required:!1,default:()=>null},outputImgSrc:{type:String,required:!0},outputParamIndex:{type:Number,required:!0},inputParamsMapped:{type:Object,required:!0},isChildTask:{type:Boolean,required:!1,default:!1},translatePrompt:{type:Boolean,required:!1,default:!1}},{show:{default:!1,type:Boolean},showModifiers:{}}),emits:tt(["update:show"],["update:show"]),setup(e,{emit:n}){const t=e,i=et(e,"show"),r=fe(),s=j(()=>r.sub_flows.map(v=>({value:v.name,label:`${v.display_name} - ${v.description}`}))),o=S(s.value[0]||""),c=S(!1),m=n;function b(){console.debug("[Send to flow]: ",o.value);const v=r.sub_flows.find(w=>w.name===o.value.value&&w.display_name===o.value.label.split(" - ")[0]);if(console.debug("[Send to flow]: targetFlow",v),!v){He().add({title:`Target sub-flow "${o.value.value}" not found`,description:"Please, verify the target sub-flow is installed and available and try again",timeout:5e3});return}const k=v.input_params.reduce((w,x)=>{const _={};return x.type==="text"?_[x.name]={value:x.default||"",type:x.type}:x.type==="number"?_[x.name]={value:x.default||0,type:x.type}:x.type==="image"?_[x.name]={value:JSON.stringify({task_id:t.flowResult.task_id,node_id:t.flowResult.outputs.length>1?t.flowResult.outputs[t.outputParamIndex].comfy_node_id:t.flowResult.outputs[0].comfy_node_id})||"",type:x.type}:x.type==="list"?_[x.name]={value:x.default||Object.keys(x.options)[0]||"",type:x.type,options:x.options}:x.type==="bool"?_[x.name]={value:x.default||!1,type:x.type}:["range","range_scale"].includes(x.type)&&(_[x.name]={value:x.default||0,type:x.type}),w.push(_),w},[]);console.debug("[Send to flow]: input_params_map",k),c.value=!0,r.runFlow(v,k,1,t.translatePrompt,h.value,h.value?Number(t.flowResult.task_id):null).finally(()=>{c.value=!1,m("update:show",!1)})}const h=S(!1),$=j(()=>{var v;return t.flowResult.progress===100&&((v=t.flowResult)==null?void 0:v.error)===""});return ot(()=>{var k,w;const v=t.flowResult?((w=(k=t==null?void 0:t.flowResult)==null?void 0:k.outputs[t.outputParamIndex])==null?void 0:w.type)??"image":"image";r.fetchSubFlows(v).then(()=>{o.value=s.value[0]||""}),h.value=!1}),(v,k)=>{const w=Se,x=Ft,_=Pt,g=ut,d=ne,p=Ue;return f(),M(p,{modelValue:i.value,"onUpdate:modelValue":k[2]||(k[2]=l=>i.value=l),class:"z-[90]",transition:!1},{default:P(()=>[I("div",Ul,[k[4]||(k[4]=I("h2",{class:"text-lg text-center mb-4"},"Send to flow",-1)),I("div",Tl,[a($)?(f(),M(w,{key:0,src:e.outputImgSrc,class:"w-1/2 rounded-lg",draggable:!1},null,8,["src"])):(f(),M(x,{key:1,color:"orange",icon:"i-heroicons-exclamation-circle-solid",title:`Task is still running (${Math.ceil(e.flowResult.progress)}%, ${e.flowResult.execution_time.toFixed(2)}s)`,description:e.flowResult.error!==""?e.flowResult.error:""},null,8,["title","description"]))]),e.inputParamsMapped?(f(),z("p",jl,A(["#"+e.flowResult.task_id,...Object.keys(e.inputParamsMapped).filter(l=>e.inputParamsMapped[l].value!=="").map(l=>`${e.inputParamsMapped[l].display_name}: ${e.inputParamsMapped[l].value}`)].join(" | ")),1)):C("",!0),I("p",Ol,[a(s).length>0?(f(),M(_,{key:0,modelValue:a(o),"onUpdate:modelValue":k[0]||(k[0]=l=>Y(o)?o.value=l:null),class:"w-full",size:"lg",options:a(s)},null,8,["modelValue","options"])):(f(),z("span",Bl,"No sub-flows available"))]),e.isChildTask?(f(),M(x,{key:1,class:"mb-4",icon:"i-heroicons-exclamation-circle-solid",title:"Child task",description:"The latest child task is always used as input for sub-flow"})):C("",!0),I("div",Nl,[y(g,{modelValue:a(h),"onUpdate:modelValue":k[1]||(k[1]=l=>Y(h)?h.value=l:null),label:"Bind as child task"},null,8,["modelValue"]),y(d,{icon:"i-heroicons-arrow-uturn-up-solid",color:"violet",variant:"outline",loading:a(c),disabled:a(s).length===0||e.isChildTask&&!a($),onClick:b},{default:P(()=>k[3]||(k[3]=[V(" Send ")])),_:1},8,["loading","disabled"])])])]),_:1},8,["modelValue"])}}}),ql={class:"flex flex-col md:flex-row items-center justify-center mb-5 sticky top-1 z-[10]"},Dl={class:"flex items-center justify-center"},Al={class:"p-4"},Ll={class:"text-md text-center text-red-500 mb-4"},El={class:"flex justify-center"},Wl={key:0,class:"results overflow-auto"},Hl=["id"],Ql={class:"text-sm text-slate-500 text-center mb-1"},Jl={class:"w-5/6 mx-auto flex flex-wrap items-center justify-center"},Gl={class:"w-full flex justify-center items-center"},Kl={key:1,class:"text-center text-slate-500"},Xl=H({__name:"Output",emits:["copy-prompt-inputs"],setup(e,{emit:n}){const t=fe(),i=j(()=>{var U;return t.flowResultsByName((U=t.currentFlow)==null?void 0:U.name).length>0||!1}),r=j(()=>{var U;return t.flowResultsByName((U=t.currentFlow)==null?void 0:U.name)||[]}),s=j(()=>t.$state.resultsPageSize);me(r,()=>{r.value.length<=t.$state.resultsPageSize?t.$state.resultsPage=1:t.$state.resultsPage>Math.ceil(r.value.length/t.$state.resultsPageSize)&&(t.$state.resultsPage=Math.ceil(r.value.length/t.$state.resultsPageSize))}),me(s,()=>{r.value.length<=t.$state.resultsPageSize?t.$state.resultsPage=1:t.$state.resultsPage>Math.ceil(r.value.length/t.$state.resultsPageSize)&&(t.$state.resultsPage=Math.ceil(r.value.length/t.$state.resultsPageSize)),t.saveUserOptions()}),Ne(()=>{t.$state.flow_results_filter="",t.$state.resultsPage=1});const o=n;function c(U){o("copy-prompt-inputs",U.input_params_mapped)}function m(U){w.value=U,k.value=!0}const b=S(null),h=S(!1);window.addEventListener("scroll",()=>{var U;h.value=window.scrollY>(((U=b.value)==null?void 0:U.offsetTop)+window.screen.height||0)});const $=j(()=>t.$state.resultsPage);me($,()=>{const U=document.getElementById("output-container");U&&U.scrollIntoView({behavior:"smooth"})});const v=S(!1),k=S(!1),w=S(""),x=S(!1),_=S(!1),g=S(!1),d=S(""),p=S(null),l=S({}),u=S(0),R=S(!1);function B(U,F=0){if(U.child_tasks.length===0||!Ct(U,F,U.outputs[F].comfy_node_id))p.value=U,d.value=se({task_id:U.task_id,node_id:U.outputs[F].comfy_node_id}),l.value=U.input_params_mapped,R.value=!1;else{const D=Mt(U,F,U.outputs[F].comfy_node_id);p.value=D,l.value=U.input_params_mapped,d.value=se({task_id:D.task_id,node_id:D.outputs[0].comfy_node_id}),R.value=!0}u.value=F,g.value=!0}function q(U){const F=[[{label:"Use params",labelClass:"text-cyan-500 text-sm",icon:"i-heroicons-document-duplicate-16-solid",iconClass:"bg-cyan-500 h-4 w-4",click:()=>c(U)}],[{label:"Comfy flow",labelClass:"text-blue-500 text-sm",icon:"i-heroicons-arrow-down-tray",iconClass:"bg-blue-500 h-4 w-4",click:()=>{var D;return t.downloadFlowComfy((D=t.currentFlow)==null?void 0:D.name,U.task_id)}}]];return U.outputs.length===1&&U.outputs.every(D=>D.type==="image")&&F.splice(1,0,[{label:"Send to flow",labelClass:"text-violet-500 text-sm",icon:"i-heroicons-arrow-uturn-up-solid",iconClass:"bg-violet-500 h-4 w-4",click:()=>{B(U)}}]),F}return(U,F)=>{var N;const D=rl,ee=be,E=it,ge=Mn,Me=Rn,re=ne,Q=Je,te=st,Z=Ue,ue=kl,ke=Cl,W=Pl,le=Fl,Ce=Vl,O=Se;return f(),z("div",{id:"output-container",ref_key:"outputContainer",ref:b,class:"w-full p-4 ring-1 ring-gray-200 dark:ring-gray-800 rounded-lg shadow-md my-10"},[y(D,{show:a(h),class:"fixed bottom-5 right-5",target:"output-container"},null,8,["show"]),I("h2",{class:"text-lg font-bold cursor-pointer select-none flex items-center mb-3",onClick:F[0]||(F[0]=()=>{v.value=!a(v)})},[y(ee,{name:a(v)?"i-heroicons-chevron-down":"i-heroicons-chevron-up",class:"mr-2"},null,8,["name"]),V(" Output ("+A(a(r).filter(T=>T.parent_task_id===null).length)+") ",1)]),a(v)?C("",!0):(f(),z(X,{key:0},[I("div",ql,[y(E,{modelValue:a(t).$state.flow_results_filter,"onUpdate:modelValue":F[1]||(F[1]=T=>a(t).$state.flow_results_filter=T),icon:"i-heroicons-magnifying-glass-20-solid",color:"white",class:"md:mr-3",label:"Filter by prompt",trailing:!0,placeholder:"Filter results by prompt"},null,8,["modelValue"]),a(r).filter(T=>T.parent_task_id===null).length>a(t).$state.resultsPageSize?(f(),M(ge,{key:0,modelValue:a(t).$state.resultsPage,"onUpdate:modelValue":F[2]||(F[2]=T=>a(t).$state.resultsPage=T),class:"my-1 md:my-0","page-count":a(t).$state.resultsPageSize,total:a(r).filter(T=>T.parent_task_id===null).length,"show-first":"","show-last":""},null,8,["modelValue","page-count","total"])):C("",!0),I("div",Dl,[y(Me,{modelValue:a(t).resultsPageSize,"onUpdate:modelValue":F[3]||(F[3]=T=>a(t).resultsPageSize=T),class:"md:mx-3 w-fit mr-3",options:[5,10,20,50,100],label:"Results per page"},null,8,["modelValue"]),y(Q,{items:[[{label:"Delete all results",labelClass:"text-red-500",icon:"i-heroicons-trash",iconClass:"dark:text-red-500 text-red-500",click:()=>x.value=!0}]],mode:"click",label:"Options",popper:{placement:"bottom-end"}},{default:P(()=>[y(re,{color:"white",icon:"i-heroicons-ellipsis-vertical-16-solid"})]),_:1},8,["items"])]),y(Z,{modelValue:a(x),"onUpdate:modelValue":F[6]||(F[6]=T=>Y(x)?x.value=T:null),class:"z-[90]",transition:!1},{default:P(()=>[I("div",Al,[F[15]||(F[15]=I("p",{class:"text-lg text-center mb-4"},"Are you sure you want to delete all results?",-1)),I("p",Ll,[F[11]||(F[11]=V(" All history and images of ")),y(te,{class:"mx-1",color:"orange",variant:"outline"},{default:P(()=>[V(A(a(t).currentFlow.display_name),1)]),_:1}),F[12]||(F[12]=V(" will be deleted. "))]),I("div",El,[y(re,{class:"mr-2",color:"red",variant:"outline",loading:a(_),onClick:F[4]||(F[4]=()=>{var T;_.value=!0,a(t).deleteFlowResults((T=a(t).currentFlow)==null?void 0:T.name).then(()=>{_.value=!1,x.value=!1})})},{default:P(()=>F[13]||(F[13]=[V(" Yes ")])),_:1},8,["loading"]),y(re,{variant:"outline",onClick:F[5]||(F[5]=()=>x.value=!1)},{default:P(()=>F[14]||(F[14]=[V("No")])),_:1})])])]),_:1},8,["modelValue"])]),a(i)?(f(),z("div",Wl,[(f(!0),z(X,null,ie(a(t).flowResultsByNamePaginated((N=a(t).currentFlow)==null?void 0:N.name),T=>(f(),z("div",{id:"task_id_"+T.task_id,key:T.task_id,class:"flex flex-col justify-center mx-auto mb-5"},[T.outputs.some(G=>["image","image-animated"].includes(G.type))?(f(),M(ue,{key:0,"flow-result":T,"handle-send-to-flow":B,"open-image-modal":m},null,8,["flow-result"])):T.outputs.some(G=>G.type==="video")?(f(),M(ke,{key:1,"flow-result":T,"handle-send-to-flow":B,"open-image-modal":m},null,8,["flow-result"])):C("",!0),I("div",Ql,[I("div",Jl,[y(W,{"flow-result":T},null,8,["flow-result"])])]),y(le,{"flow-result":T},null,8,["flow-result"]),I("div",Gl,[y(re,{class:"mr-3",color:"red",icon:"i-heroicons-trash",variant:"outline",size:"xs",onClick:()=>a(t).deleteFlowHistory(T.task_id)},{default:P(()=>F[16]||(F[16]=[V(" Delete ")])),_:2},1032,["onClick"]),y(Q,{items:q(T),mode:"click",popper:{placement:"bottom-start"}},{default:P(()=>[y(re,{color:"white",icon:"i-heroicons-ellipsis-vertical-16-solid",size:"xs"})]),_:2},1032,["items"])])],8,Hl))),128)),y(Ce,{show:a(g),"onUpdate:show":F[7]||(F[7]=T=>Y(g)?g.value=T:null),"flow-result":a(p),"output-img-src":a(d),"output-param-index":a(u),"input-params-mapped":a(l),"is-child-task":a(R)},null,8,["show","flow-result","output-img-src","output-param-index","input-params-mapped","is-child-task"])])):(f(),z("p",Kl," No output results available "))],64)),y(Z,{modelValue:a(k),"onUpdate:modelValue":F[10]||(F[10]=T=>Y(k)?k.value=T:null),class:"z-[90]",transition:!1,fullscreen:""},{default:P(()=>[y(re,{class:"absolute top-4 right-4",icon:"i-heroicons-x-mark",variant:"ghost",onClick:F[8]||(F[8]=()=>k.value=!1)}),I("div",{class:"flex items-center justify-center w-full h-full p-4",onClick:F[9]||(F[9]=Ee(()=>k.value=!1,["left"]))},[a(w)?(f(),M(O,{key:0,class:"lg:h-full",fit:"inside",loading:"lazy",src:a(w)},null,8,["src"])):C("",!0)])]),_:1},8,["modelValue"])],512)}}}),Yl={class:"flex flex-col lg:flex-row flex-grow items-start w-full"},Zl={class:"card-wrapper w-full lg:pr-5"},eo={key:0,class:"p-0 text-sm"},to={class:"flex flex-row items-center text-slate-400 mb-2"},no={class:"flex flex-row flex-wrap items-center text-md mb-2"},ao=["href"],lo={class:"flex flex-row items-center text-md mb-2"},oo=["href"],so={key:1},io={class:"flex flex-row items-center text-md mb-2"},ro={key:0},uo={class:"flex flex-row items-center text-md mb-2"},co={key:0,class:"flex flex-row flex-wrap items-center text-md mb-2"},mo=["href"],fo={key:1},po={class:"flex flex-row items-center mb-2"},vo={key:1,class:"flex flex-row flex-wrap items-center text-md"},go={key:0,class:"flex justify-end"},ho={class:"flex flex-row items-center justify-center text-sm mr-2"},yo={key:1},wo={class:"text-sm flex justify-end"},bo={class:"flex flex-row items-center justify-center text-sm mr-3"},ko={key:0,class:"text-right"},xo={class:"prompt-wrapper w-full"},_o={class:"flex items-center justify-between"},Io={class:"pb-2"},$o={class:"flex justify-end items-center"},jo=H({__name:"[name]",setup(e){const n=yn(),t=fe();t.setCurrentFlow(n.params.name);const i=j(()=>t.flowInstallingByName(n.params.name)),r=j(()=>{var p;return i.value&&((p=i.value)==null?void 0:p.progress)<100||!1}),s=S(!1),o=j(()=>{var p;return i.value?"error"in i.value&&((p=i.value)==null?void 0:p.error)!==""?`${i.value.progress.toFixed(0)}% Error setting up`:`${i.value.progress.toFixed(0)}% Setting up`:"Setup flow"}),c=S(!1),m=S(!1),b=j(()=>{var l;const p=[[{label:"Delete flow",icon:"i-heroicons-trash",click:$}]];return((l=t==null?void 0:t.currentFlow)==null?void 0:l.new_version_available)!==""&&p[0].unshift({label:`Update to ${t.currentFlow.new_version_available}`,icon:"i-heroicons-arrow-path",click:()=>{t.updateFlow(t.currentFlow)}}),p});function h(p,l=!1){c.value=!0,t.deleteFlow(p).then(()=>{l&&wn().push("/")}).finally(()=>{c.value=!1,m.value=!1})}function $(){var l;const p=((l=t.currentFlow)==null?void 0:l.private)||!1;if(p){m.value=!0;return}h(t.currentFlow,p)}const v=S(!1),k=S(null),w=function(p){var l;(l=k.value)==null||l.copyPromptInputs(p)},x=bn(),_=j(()=>{var p;return(p=t.currentFlow)==null?void 0:p.models.filter(l=>l.installed).reduce((l,u)=>l+(u==null?void 0:u.file_size)||0,0)}),g=j(()=>{var p;return(p=t.currentFlow)==null?void 0:p.models.reduce((l,u)=>l+(u==null?void 0:u.file_size)||0,0)}),d=j(()=>!_.value&&!g.value?"":_.value===g.value?` - ${Te(g.value)}`:` - ${Te(_.value)} / ${Te(g.value)}`);return(p,l)=>{const u=be,R=We,B=st,q=ne,U=Je,F=Cn,D=La,ee=il,E=Xl,ge=zt,Me=Ue,re=xn;return f(),M(re,null,{default:P(()=>[!a(t).loading.flows_available&&!a(t).loading.flows_installed&&a(t).currentFlow&&!a(t).$state.loading.tasks_history?(f(),z(X,{key:0},[I("div",Yl,[I("div",Zl,[y(F,{as:"div",class:"w-full mb-5"},kn({header:P(()=>{var Q,te;return[I("h2",{class:"text-xl font-bold cursor-pointer select-none flex items-center",onClick:l[0]||(l[0]=()=>{v.value=!a(v)})},[(Q=a(t).currentFlow)!=null&&Q.private?(f(),M(R,{key:0,text:"This flow is local, manually added"},{default:P(()=>{var Z;return[y(u,{name:"i-heroicons-lock-closed",class:L(["mr-2",{"text-stone-500":!((Z=a(t).currentFlow)!=null&&Z.is_supported_by_workers)}])},null,8,["class"])]}),_:1})):C("",!0),y(u,{name:a(v)?"i-heroicons-chevron-down":"i-heroicons-chevron-up",class:"mr-2"},null,8,["name"]),y(R,{text:(te=a(t).currentFlow)!=null&&te.is_supported_by_workers?"":"No workers capable of running this flow",popper:{placement:"top"}},{default:P(()=>{var Z,ue;return[I("span",{class:L({"text-stone-500":!((Z=a(t).currentFlow)!=null&&Z.is_supported_by_workers)})},A((ue=a(t).currentFlow)==null?void 0:ue.display_name),3)]}),_:1},8,["text"])])]}),default:P(()=>{var Q,te,Z,ue,ke,W,le,Ce,O,N,T,G,K,de,ce,ve,Ie;return[a(v)?C("",!0):(f(),z("div",eo,[I("p",to,A((Q=a(t).currentFlow)==null?void 0:Q.description),1),I("p",no,[y(u,{name:"i-heroicons-user-16-solid",class:"mr-1"}),l[8]||(l[8]=I("b",null,"Author:",-1)),l[9]||(l[9]=V("  ")),I("a",{class:"hover:underline text-md",href:(te=a(t).currentFlow)==null?void 0:te.homepage,rel:"noopener",target:"_blank"},A((Z=a(t).currentFlow)==null?void 0:Z.author),9,ao)]),I("p",lo,[y(u,{name:"i-heroicons-document-text",class:"mr-1"}),(ue=a(t).currentFlow)!=null&&ue.documentation?(f(),z("a",{key:0,class:"hover:underline",href:(ke=a(t).currentFlow)==null?void 0:ke.documentation,rel:"noopener",target:"_blank"}," Documentation ",8,oo)):(f(),z("span",so,"No documentation"))]),I("p",io,[y(u,{name:"i-heroicons-clock",class:"mr-1"}),l[10]||(l[10]=I("b",null,"Version:",-1)),l[11]||(l[11]=V("  ")),I("span",null,A((W=a(t).currentFlow)==null?void 0:W.version),1),((le=a(t).currentFlow)==null?void 0:le.new_version_available)!==""?(f(),z("span",ro,"  (new version available: "+A((Ce=a(t).currentFlow)==null?void 0:Ce.new_version_available)+") ",1)):C("",!0)]),I("p",uo,[y(u,{name:"i-heroicons-tag",class:"mr-1"}),l[12]||(l[12]=I("b",null,"Tags:",-1)),l[13]||(l[13]=V("  ")),((O=a(t).currentFlow)==null?void 0:O.tags.length)>0?(f(!0),z(X,{key:0},ie((N=a(t).currentFlow)==null?void 0:N.tags,J=>(f(),M(B,{key:J,label:J,color:"white",variant:"solid",class:"m-1"},null,8,["label"]))),128)):(f(),M(B,{key:1,label:"No tags",color:"white",variant:"solid",class:"m-1"}))]),((G=(T=a(t).currentFlow)==null?void 0:T.models)==null?void 0:G.length)>0?(f(),z("p",co,[y(u,{name:"i-heroicons-arrow-down-on-square-stack",class:"mr-1"}),y(R,{text:a(g)-a(_)>0?`${("formatBytes"in p?p.formatBytes:a(Te))(a(g)-a(_))} to download`:"All models installed",popper:{placement:"top"}},{default:P(()=>{var J;return[I("b",null,"Models ("+A((J=a(t).currentFlow)==null?void 0:J.models.length)+A(a(d))+"):",1),l[14]||(l[14]=V("  "))]}),_:1},8,["text"]),(f(!0),z(X,null,ie((K=a(t).currentFlow)==null?void 0:K.models,J=>(f(),M(B,{key:J.name,class:"m-1",color:"white",variant:"solid"},{default:P(()=>[y(R,{text:J.installed?"Model installed":"Model not installed"},{default:P(()=>[y(u,{name:J.installed?"i-heroicons-check-circle-20-solid":"i-heroicons-x-mark-20-solid",class:L(J.installed?"text-green-500":"text-orange-500")},null,8,["name","class"])]),_:2},1032,["text"]),J.gated?(f(),M(R,{key:0,text:"Gated model, requires auth token for download",popper:{placement:"top"}},{default:P(()=>[y(u,{name:"i-heroicons-key",class:"mr-1"})]),_:1})):C("",!0),I("a",{class:"hover:underline underline-offset-4",href:J.homepage,rel:"noopener",target:"_blank"},A(J.name),9,mo),J.file_size?(f(),z("span",fo," ("+A(("formatBytes"in p?p.formatBytes:a(Te))(J.file_size))+") ",1)):C("",!0)]),_:2},1024))),128))])):C("",!0),I("p",po,[y(u,{name:"i-mdi-help-network-outline",class:"mr-1"}),l[17]||(l[17]=I("b",null,"Platforms:",-1)),l[18]||(l[18]=V("  ")),y(R,{text:"Linux"},{default:P(()=>[y(u,{name:"i-mdi-linux",class:"mr-1"})]),_:1}),y(R,{text:"Microsoft Windows"},{default:P(()=>[y(u,{name:"i-mdi-microsoft-windows",class:"mr-1"})]),_:1}),a(t).currentFlow.is_macos_supported?(f(),M(R,{key:0,text:"macOS"},{default:P(()=>[y(u,{name:"i-mdi-apple",class:"mr-1"})]),_:1})):C("",!0),(de=a(t).currentFlow)!=null&&de.required_memory_gb?(f(),M(R,{key:1,class:"flex flex-row items-center",text:"Required VRAM memory (GB)"},{default:P(()=>{var J;return[l[15]||(l[15]=V(" (")),y(u,{name:"i-mdi-memory",class:"mr-1"}),I("span",null,A((J=a(t).currentFlow)==null?void 0:J.required_memory_gb)+" GB",1),l[16]||(l[16]=V(") "))]}),_:1})):C("",!0)]),((ve=(ce=a(t).currentFlow)==null?void 0:ce.requires)==null?void 0:ve.length)>0?(f(),z("p",vo,[l[19]||(l[19]=I("b",null,"Requires:",-1)),l[20]||(l[20]=V("  ")),(f(!0),z(X,null,ie((Ie=a(t).currentFlow)==null?void 0:Ie.requires,J=>(f(),M(B,{key:J,class:"m-1",color:"yellow",variant:"outline"},{default:P(()=>[V(A(J),1)]),_:2},1024))),128))])):C("",!0)]))]}),_:2},[a(v)?void 0:{name:"footer",fn:P(()=>{var Q,te;return[a(x).isAdmin?(f(),z("div",go,[I("div",ho,[y(u,{name:a(t).isFlowInstalled(a(n).params.name)?"i-heroicons-check-badge":"i-heroicons-x-mark",class:"mx-1"},null,8,["name"]),I("span",{class:L({"text-green-500":a(t).isFlowInstalled(a(n).params.name),"text-red-500":!a(t).isFlowInstalled(a(n).params.name),"text-stone-500":a(t).isFlowInstalled(a(n).params.name)&&!((Q=a(t).currentFlow)!=null&&Q.is_supported_by_workers)})},A(a(t).isFlowInstalled(a(n).params.name)?(te=a(t).currentFlow)!=null&&te.is_supported_by_workers?"Installed":"Installed (no workers)":"Not installed"),3)]),a(t).isFlowInstalled(a(n).params.name)?C("",!0):(f(),M(R,{key:0,text:"Setup flow dependencies and configure it in ComfyUI",popper:{placement:"top"},"open-delay":500},{default:P(()=>[y(q,{icon:"i-heroicons-arrow-down-tray",class:"mx-3",color:"primary",variant:"outline",loading:a(r),onClick:l[1]||(l[1]=()=>a(t).setupFlow(a(t).currentFlow))},{default:P(()=>[V(A(a(o)),1)]),_:1},8,["loading"])]),_:1})),!a(t).isFlowInstalled(a(n).params.name)&&a(r)?(f(),M(R,{key:1,text:"Cancel flow installation",popper:{placement:"top"},"open-delay":500},{default:P(()=>[y(q,{icon:"i-heroicons-stop",variant:"outline",color:"orange",loading:a(s),onClick:l[2]||(l[2]=()=>{s.value=!0,a(t).cancelFlowSetup(a(t).currentFlow).then(()=>{s.value=!1})})},{default:P(()=>l[21]||(l[21]=[V(" Cancel ")])),_:1},8,["loading"])]),_:1})):C("",!0),a(t).isFlowInstalled(a(n).params.name)?(f(),M(U,{key:2,items:a(b),mode:"click",label:"Actions",popper:{placement:"bottom-end"}},{default:P(()=>[y(q,{color:"white",label:"Actions","trailing-icon":"i-heroicons-chevron-down-20-solid"})]),_:1},8,["items"])):C("",!0)])):(f(),z("div",yo,[I("div",wo,[I("div",bo,[y(u,{name:a(t).isFlowInstalled(a(n).params.name)?"i-heroicons-check-badge":"i-heroicons-x-mark",class:"mx-1"},null,8,["name"]),I("span",{class:L({"text-green-500":a(t).isFlowInstalled(a(n).params.name),"text-red-500":!a(t).isFlowInstalled(a(n).params.name)})},A(a(t).isFlowInstalled(a(n).params.name)?"Installed":"Not installed"),3)]),a(t).isFlowInstalled(a(n).params.name)?C("",!0):(f(),z("div",ko,l[22]||(l[22]=[I("p",{class:"text-orange-500"},"Only admin can manage workflows.",-1),I("span",{class:"text-slate-500"},"Ask your admin to setup this workflow",-1)])))])]))]}),key:"0"}]),1024)]),I("div",xo,[!a(c)&&a(t).isFlowInstalled(a(n).params.name)?(f(),M(D,{key:0,ref_key:"workflowPrompt",ref:k},null,512)):C("",!0)])]),!a(c)&&a(t).isFlowInstalled(a(n).params.name)?(f(),M(ee,{key:0})):C("",!0),!a(c)&&a(t).isFlowInstalled(a(n).params.name)||a(t).flowResultsByName(a(n).params.name).length>0?(f(),M(E,{key:1,onCopyPromptInputs:l[3]||(l[3]=Q=>w(Q))})):C("",!0)],64)):(f(),M(ge,{key:1,class:"mb-3"})),y(Me,{modelValue:a(m),"onUpdate:modelValue":l[7]||(l[7]=Q=>Y(m)?m.value=Q:null),"prevent-close":""},{default:P(()=>[y(F,{ui:{ring:"",divide:"divide-y divide-gray-100 dark:divide-gray-800"}},{header:P(()=>[I("div",_o,[l[23]||(l[23]=I("h3",{class:"text-base font-semibold leading-6 text-gray-900 dark:text-white"}," Confirm workflow deletion ",-1)),y(q,{color:"gray",variant:"ghost",icon:"i-heroicons-x-mark-20-solid",class:"-my-1",onClick:l[4]||(l[4]=Q=>m.value=!1)})])]),default:P(()=>{var Q;return[I("p",Io,[l[24]||(l[24]=V(" Are you sure you want to delete the ")),l[25]||(l[25]=I("b",null,"private",-1)),l[26]||(l[26]=V(" workflow ")),I("b",null,A((Q=a(t).currentFlow)==null?void 0:Q.display_name),1),l[27]||(l[27]=V("? "))]),I("div",$o,[y(q,{icon:"i-heroicons-x-mark-16-solid",variant:"outline",color:"green",class:"mr-2",onClick:l[5]||(l[5]=te=>m.value=!1)},{default:P(()=>l[28]||(l[28]=[V(" Cancel ")])),_:1}),y(q,{icon:"i-heroicons-trash",variant:"outline",color:"red",onClick:l[6]||(l[6]=te=>{var Z;return h(a(t).currentFlow,((Z=a(t).currentFlow)==null?void 0:Z.private)||!1)})},{default:P(()=>l[29]||(l[29]=[V(" Delete ")])),_:1})])]}),_:1})]),_:1},8,["modelValue"])]),_:1})}}});export{jo as default};
