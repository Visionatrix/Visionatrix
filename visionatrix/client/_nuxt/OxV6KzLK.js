import{_ as $}from"./CEyrYCwr.js";import{a as D,_ as E}from"./C9dR_2kC.js";import{_ as T,a as q}from"./VOc2Kaok.js";import{f as H,u as R,q as K,y as j,s as J,B as h,g as Q,x as W,v as X,C as Y,i as v,w as i,A as Z,o as p,a,b as t,p as o,c as w,k as g,d,t as S,m as ee,D as A}from"./B7Tj_oyF.js";import{a as oe,_ as le}from"./B8f9Jzcu.js";import{_ as te}from"./D5fddYu9.js";import{_ as se}from"./B5kuTgS3.js";const ae={class:"flex flex-col md:flex-row"},ie={class:"px-5 pb-5 md:w-4/5"},ne={key:0,class:"admin-settings mb-3"},re={key:0,class:"text-gray-400 text-sm"},de={key:0},ue={class:"flex items-center relative"},me={class:"flex items-center relative"},pe={class:"flex items-center relative"},ge={class:"flex items-center"},ce={class:"flex items-center relative"},_e={class:"flex w-full items-center my-2"},ve={class:"flex w-full items-center my-2"},fe={class:"flex items-center"},ye={class:"flex items-center"},ke={key:1,class:"mb-5 py-4"},xe={class:"flex items-center space-x-3"},he={class:"user-settings mb-3"},we={class:"flex items-center relative"},Ie=H({__name:"index",setup(be){R({title:"Settings - Visionatrix",meta:[{name:"description",content:"Settings - Visionatrix"}]});const z=K(),l=j(),y=J(),I=["huggingface_auth_token","civitai_auth_token","google_api_key","google_api_key_user","google_proxy","gemini_model","ollama_url","ollama_vision_model","ollama_llm_model","ollama_keepalive","translations_provider","llm_provider","save_metadata","user_settings_disabled"],b=h(!1);function F(){b.value=!0,l.saveChanges(I).finally(()=>{b.value=!1})}const f=Q(),M=h(null),V=h(!1),O=W(()=>l.ollamaFetchError!==""&&(l.settingsMap.ollama_vision_model.value!==""||l.settingsMap.ollama_llm_model.value!==""||l.settingsMap.translations_provider.value==="ollama"||l.settingsMap.llm_provider.value==="ollama"));function G(){const _=M.value.$refs.input.files[0]||null;if(!_){y.add({title:"No file selected",description:"Please select a file to upload"});return}V.value=!0,f.uploadFlow(_).then(e=>{if(console.debug("uploadFlow",e),e&&"detail"in e&&(e==null?void 0:e.detail)!==""){y.add({title:"Error uploading flow",description:e.detail});return}else y.add({title:"Flow uploaded",description:"Flow uploaded successfully"});M.value.$refs.input.value=""}).catch(e=>{console.debug("uploadFlow error",e),y.add({title:"Error uploading flow",description:e.message})}).finally(()=>{V.value=!1})}X(()=>f.outputMaxSize,()=>{f.saveUserOptions()}),Y(()=>{l.loadAllSettings()});const n=h({huggingface_auth_token:!1,civitai_auth_token:!1,google_api_key:!1,google_api_key_user:!1,google_proxy:!1});return(_,e)=>{const L=$,B=D,r=T,c=E,u=ee,k=oe,x=q,U=te,C=le,N=se,P=Z;return p(),v(P,{class:"lg:h-dvh"},{default:i(()=>[a("div",ae,[t(L,{links:o(l).links,class:"md:w-1/5"},null,8,["links"]),a("div",ie,[o(z).isAdmin?(p(),w("div",ne,[e[33]||(e[33]=a("h3",{class:"mb-3 text-xl font-bold"},"Admin preferences (global settings)",-1)),o(l).other.current_version!==""?(p(),w("div",re,[a("span",null,"Current version: "+S(o(l).other.current_version),1),e[27]||(e[27]=d("Â  ")),o(l).other.next_version!==""?(p(),w("span",de,"Next version: "+S(o(l).other.next_version),1)):g("",!0)])):g("",!0),t(r,{size:"md",class:"py-3",label:"Save metadata",description:"Save metadata to the output results."},{default:i(()=>[t(B,{modelValue:o(l).settingsMap.save_metadata.value,"onUpdate:modelValue":e[0]||(e[0]=s=>o(l).settingsMap.save_metadata.value=s),color:"primary",label:"Save metadata"},null,8,["modelValue"])]),_:1}),t(r,{size:"md",class:"py-3",label:"Huggingface Auth token",description:"Bearer authentication token from your Huggingface account to allow downloading gated models with limited access."},{default:i(()=>[a("div",ue,[t(c,{modelValue:o(l).settingsMap.huggingface_auth_token.value,"onUpdate:modelValue":e[1]||(e[1]=s=>o(l).settingsMap.huggingface_auth_token.value=s),placeholder:"Huggingface Auth token",class:"w-full",type:o(n).huggingface_auth_token?"text":"password",icon:"i-heroicons-shield-check",size:"md",autocomplete:"off"},null,8,["modelValue","type"]),t(u,{icon:o(n).huggingface_auth_token?"i-heroicons-eye-slash-solid":"i-heroicons-eye-solid",variant:"ghost",color:"white",class:"ml-1 absolute right-1",onClick:e[2]||(e[2]=()=>{o(n).huggingface_auth_token=!o(n).huggingface_auth_token})},null,8,["icon"])])]),_:1}),t(r,{size:"md",class:"py-3",label:"CivitAI Auth Token",description:"Auth token for CivitAI flows and models."},{default:i(()=>[a("div",me,[t(c,{modelValue:o(l).settingsMap.civitai_auth_token.value,"onUpdate:modelValue":e[3]||(e[3]=s=>o(l).settingsMap.civitai_auth_token.value=s),placeholder:"CivitAI Auth Token",class:"w-full",type:o(n).civitai_auth_token?"text":"password",icon:"i-heroicons-shield-check",size:"md",autocomplete:"off"},null,8,["modelValue","type"]),t(u,{icon:o(n).civitai_auth_token?"i-heroicons-eye-slash-solid":"i-heroicons-eye-solid",variant:"ghost",color:"white",class:"ml-1 absolute right-1",onClick:e[4]||(e[4]=()=>{o(n).civitai_auth_token=!o(n).civitai_auth_token})},null,8,["icon"])])]),_:1}),t(k,{color:"blue",variant:"soft",icon:"i-heroicons-exclamation-circle",title:"Note"},{description:i(()=>e[28]||(e[28]=[d(" Access tokens are required for gated models. More information can be found "),a("a",{class:"hover:underline font-bold",href:"https://visionatrix.github.io/VixFlowsDocs/FlowsDeveloping/gated_models/",target:"_blank"},"here",-1),d(". ")])),_:1}),t(x,{class:"mt-3",label:"Gemini"}),e[34]||(e[34]=a("p",{class:"text-slate text-sm text-orange-300 dark:text-orange-100 text-center"},"Can be used by flows and as a translation provider",-1)),t(r,{size:"md",class:"py-3",label:"Google API key"},{description:i(()=>e[29]||(e[29]=[d(" Global Google API key, required for Flows, e.g. where ComfyUI-Gemini Node is used. Instruction how to obtain key can be found "),a("a",{class:"hover:underline font-bold",href:"https://ai.google.dev/gemini-api/docs/api-key"},"here",-1),d(". ")])),default:i(()=>[a("div",pe,[t(c,{modelValue:o(l).settingsMap.google_api_key.value,"onUpdate:modelValue":e[5]||(e[5]=s=>o(l).settingsMap.google_api_key.value=s),placeholder:"Google API key",class:"w-full",type:o(n).google_api_key?"text":"password",icon:"i-heroicons-shield-check",size:"md",autocomplete:"off"},null,8,["modelValue","type"]),t(u,{icon:o(n).google_api_key?"i-heroicons-eye-slash-solid":"i-heroicons-eye-solid",variant:"ghost",color:"white",class:"ml-1 absolute right-1",onClick:e[6]||(e[6]=()=>{o(n).google_api_key=!o(n).google_api_key})},null,8,["icon"])])]),_:1}),t(r,{size:"md",class:"py-3",label:"Gemini model",description:"Override Gemini model to use."},{default:i(()=>[a("div",ge,[t(U,{modelValue:o(l).settingsMap.gemini_model.value,"onUpdate:modelValue":e[7]||(e[7]=s=>o(l).settingsMap.gemini_model.value=s),color:"white",variant:"outline",placeholder:"Select Gemini model",options:o(l).settingsMap.gemini_model.options},null,8,["modelValue","options"]),o(l).settingsMap.gemini_model.value?(p(),v(u,{key:0,icon:"i-heroicons-x-mark",variant:"outline",color:"white",class:"ml-2",onClick:e[8]||(e[8]=()=>o(l).settingsMap.gemini_model.value="")})):g("",!0)])]),_:1}),t(r,{size:"md",class:"py-3",label:"Proxy (for Google)"},{description:i(()=>e[30]||(e[30]=[d(" Proxy to access Gemini configuration "),a("a",{class:"hover:underline font-bold",href:"https://visionatrix.github.io/VixFlowsDocs/AdminManual/Installation/proxy_gemini/"},"string",-1),d(". ")])),default:i(()=>[a("div",ce,[t(c,{modelValue:o(l).settingsMap.google_proxy.value,"onUpdate:modelValue":e[9]||(e[9]=s=>o(l).settingsMap.google_proxy.value=s),placeholder:"Proxy",class:"w-full",type:o(n).google_proxy?"text":"password",size:"md",icon:"i-heroicons-shield-check",autocomplete:"off"},null,8,["modelValue","type"]),t(u,{icon:o(n).google_proxy?"i-heroicons-eye-slash-solid":"i-heroicons-eye-solid",variant:"ghost",color:"white",class:"ml-1 absolute right-1",onClick:e[10]||(e[10]=()=>{o(n).google_proxy=!o(n).google_proxy})},null,8,["icon"])])]),_:1}),t(x,{class:"mt-3",label:"Ollama"}),e[35]||(e[35]=a("p",{class:"text-slate text-sm text-orange-300 dark:text-orange-100 text-center"},"Can be used by flows and as a translation provider",-1)),t(r,{size:"md",class:"py-3",label:"Ollama URL",description:"URL to server where Ollama is running."},{default:i(()=>[t(c,{modelValue:o(l).settingsMap.ollama_url.value,"onUpdate:modelValue":e[11]||(e[11]=s=>o(l).settingsMap.ollama_url.value=s),placeholder:"Ollama URL",class:"w-full",type:"text",size:"md",autocomplete:"off"},null,8,["modelValue"]),o(O)?(p(),v(k,{key:0,color:"yellow",variant:"soft",class:"mt-3",icon:"i-heroicons-exclamation-circle",title:"Failed to fetch Ollama models list",description:o(l).ollamaFetchError},{actions:i(()=>[t(u,{icon:"i-heroicons-arrow-path-solid",variant:"outline",color:"white",onClick:e[12]||(e[12]=()=>o(l).getOllamaModelsList())},{default:i(()=>e[31]||(e[31]=[d(" Retry ")])),_:1,__:[31]})]),_:1},8,["description"])):g("",!0)]),_:1}),t(r,{size:"md",class:"py-3",label:"Ollama Vision Model",description:"Override Ollama Vision model used by default."},{default:i(()=>{var s;return[a("div",_e,[t(C,{modelValue:o(l).settingsMap.ollama_vision_model.value,"onUpdate:modelValue":e[13]||(e[13]=m=>o(l).settingsMap.ollama_vision_model.value=m),class:"w-full",options:(s=o(l).settingsMap.ollama_vision_model)!=null&&s.options?o(l).settingsMap.ollama_vision_model.options.map(m=>(m.label=`${m.model} (${("formatBytes"in _?_.formatBytes:o(A))(m.size)})`,m)):[],"value-attribute":"model",loading:o(l).settingsMap.ollama_vision_model.loading,placeholder:"Ollama Vision Model"},null,8,["modelValue","options","loading"]),o(l).settingsMap.ollama_vision_model.value?(p(),v(u,{key:0,icon:"i-heroicons-x-mark",variant:"outline",color:"white",class:"ml-2",onClick:e[14]||(e[14]=()=>o(l).settingsMap.ollama_vision_model.value="")})):g("",!0)])]}),_:1}),t(r,{size:"md",class:"py-3",label:"Ollama LLM Model",description:"Override Ollama LLM model used by default."},{default:i(()=>{var s;return[a("div",ve,[t(C,{modelValue:o(l).settingsMap.ollama_llm_model.value,"onUpdate:modelValue":e[15]||(e[15]=m=>o(l).settingsMap.ollama_llm_model.value=m),class:"w-full",options:(s=o(l).settingsMap.ollama_llm_model)!=null&&s.options?o(l).settingsMap.ollama_llm_model.options.map(m=>(m.label=`${m.model} (${("formatBytes"in _?_.formatBytes:o(A))(m.size)})`,m)):[],"value-attribute":"model",loading:o(l).settingsMap.ollama_llm_model.loading,placeholder:"Ollama LLM Model"},null,8,["modelValue","options","loading"]),o(l).settingsMap.ollama_llm_model.value?(p(),v(u,{key:0,icon:"i-heroicons-x-mark",variant:"outline",color:"white",class:"ml-2",onClick:e[16]||(e[16]=()=>o(l).settingsMap.ollama_llm_model.value="")})):g("",!0)])]}),_:1}),t(r,{size:"md",class:"py-3",label:"Ollama Keepalive",description:"Keep models in memory for specified minutes (e.g. 0.5 for 30 seconds). 0 unloads immediately; negative numbers keep indefinitely"},{default:i(()=>[t(c,{modelValue:o(l).settingsMap.ollama_keepalive.value,"onUpdate:modelValue":e[17]||(e[17]=s=>o(l).settingsMap.ollama_keepalive.value=s),placeholder:"Ollama Keepalive",class:"w-fit",type:"number",size:"md",step:"0.1",autocomplete:"off",onChange:e[18]||(e[18]=()=>{o(l).settingsMap.ollama_keepalive.value=o(l).settingsMap.ollama_keepalive.value.toString()})},null,8,["modelValue"])]),_:1}),t(x,{class:"mt-3",label:"AI providers"}),t(r,{size:"md",class:"py-3",label:"Translations provider",description:"Prompt translations provider. Empty if not enabled."},{default:i(()=>[a("div",fe,[t(U,{modelValue:o(l).settingsMap.translations_provider.value,"onUpdate:modelValue":e[19]||(e[19]=s=>o(l).settingsMap.translations_provider.value=s),color:"white",variant:"outline",placeholder:"Select translations provider",options:o(l).settingsMap.translations_provider.options},null,8,["modelValue","options"]),o(l).settingsMap.translations_provider.value?(p(),v(u,{key:0,icon:"i-heroicons-x-mark",variant:"outline",color:"white",class:"ml-2",onClick:e[20]||(e[20]=()=>o(l).settingsMap.translations_provider.value="")})):g("",!0)])]),_:1}),t(r,{size:"md",class:"py-3",label:"LLM provider",description:"LLM  provider. Empty if not enabled."},{default:i(()=>[a("div",ye,[t(U,{modelValue:o(l).settingsMap.llm_provider.value,"onUpdate:modelValue":e[21]||(e[21]=s=>o(l).settingsMap.llm_provider.value=s),color:"white",variant:"outline",placeholder:"Select LLM provider",options:o(l).settingsMap.llm_provider.options},null,8,["modelValue","options"]),o(l).settingsMap.llm_provider.value?(p(),v(u,{key:0,icon:"i-heroicons-x-mark",variant:"outline",color:"white",class:"ml-2",onClick:e[22]||(e[22]=()=>o(l).settingsMap.llm_provider.value="")})):g("",!0)])]),_:1}),t(r,{size:"md",class:"py-3",label:"Disable user settings",description:"Toggle Navbar button to open settings page for non-admin users"},{default:i(()=>[t(N,{modelValue:o(l).settingsMap.user_settings_disabled.value,"onUpdate:modelValue":e[23]||(e[23]=s=>o(l).settingsMap.user_settings_disabled.value=s),class:"mb-3"},null,8,["modelValue"]),t(k,{color:"blue",variant:"soft",icon:"i-heroicons-exclamation-circle",title:"Note"},{description:i(()=>e[32]||(e[32]=[d(" Disabling user settings will prevent users from changing their own settings. Only global (admin) settings will be applied for all users. ")])),_:1})]),_:1})])):g("",!0),o(z).isAdmin?(p(),w("div",ke,[e[38]||(e[38]=a("h4",{class:"mb-3 font-bold"},"Upload Flow",-1)),e[39]||(e[39]=a("p",{class:"text-gray-400 text-sm mb-3"}," Upload a Visionatrix workflow file (.json) to add it to the available flows. Upon successful upload of a valid workflow file, the installation will start automatically. ",-1)),a("div",xe,[t(c,{ref_key:"flowFileInput",ref:M,type:"file",accept:".json",class:"w-auto"},null,512),t(u,{icon:"i-heroicons-arrow-up-tray-16-solid",variant:"outline",loading:o(V),onClick:G},{default:i(()=>e[36]||(e[36]=[d(" Upload Flow ")])),_:1,__:[36]},8,["loading"])]),t(k,{class:"mt-3",color:"blue",variant:"soft",icon:"i-heroicons-exclamation-circle",title:"Note"},{description:i(()=>e[37]||(e[37]=[d(" Requires a Visionatrix-adapted ComfyUI workflow, not a standard ComfyUI workflow. Instructions for adapting a ComfyUI workflow for Visionatrix are available "),a("a",{class:"hover:underline font-bold",href:"https://visionatrix.github.io/VixFlowsDocs/FlowsDeveloping/comfyui_vix_migration/"},"here",-1),d(". Custom workflows may require manual installation of dependencies (e.g., custom nodes) before upload. ")])),_:1})])):g("",!0),a("div",he,[e[41]||(e[41]=a("h3",{class:"mb-3 text-xl font-bold"},"User preferences (overrides global)",-1)),t(r,{size:"md",class:"py-3",label:"Google API key"},{description:i(()=>e[40]||(e[40]=[d(" Google API key, required for Flows, e.g. where ComfyUI-Gemini Node is used. Instruction how to obtain key "),a("a",{class:"hover:underline font-bold",href:"https://ai.google.dev/gemini-api/docs/api-key"},"here",-1),d(". ")])),default:i(()=>[a("div",we,[t(c,{modelValue:o(l).settingsMap.google_api_key_user.value,"onUpdate:modelValue":e[24]||(e[24]=s=>o(l).settingsMap.google_api_key_user.value=s),placeholder:"Google API key",class:"w-full",type:o(n).google_api_key_user?"text":"password",icon:"i-heroicons-shield-check",size:"md",autocomplete:"off"},null,8,["modelValue","type"]),t(u,{icon:o(n).google_api_key_user?"i-heroicons-eye-slash-solid":"i-heroicons-eye-solid",variant:"ghost",color:"white",class:"ml-1 absolute right-1",onClick:e[25]||(e[25]=()=>{o(n).google_api_key_user=!o(n).google_api_key_user})},null,8,["icon"])])]),_:1}),t(x,{class:"mt-3",label:"UI preferences"}),e[42]||(e[42]=a("p",{class:"text-slate text-sm text-orange-300 dark:text-orange-100 text-center"},"Stored in browser local storage",-1)),t(r,{size:"md",class:"py-3",label:"Outputs maximum image size",description:"To keep the output seamless, we limit the size of the outputs (512px by default)."},{default:i(()=>[t(C,{modelValue:o(f).$state.outputMaxSize,"onUpdate:modelValue":e[26]||(e[26]=s=>o(f).$state.outputMaxSize=s),options:["512","768","1024","1536","2048"]},null,8,["modelValue"])]),_:1})]),t(u,{icon:"i-heroicons-check-16-solid",loading:o(b),onClick:F},{default:i(()=>e[43]||(e[43]=[d(" Save ")])),_:1,__:[43]},8,["loading"])])])]),_:1})}}});export{Ie as default};
